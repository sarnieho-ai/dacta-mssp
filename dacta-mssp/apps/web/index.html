<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DACTA SIEMLess | For Blue Team, By Blue Team</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&family=IBM+Plex+Sans:wght@300;400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<style>
/* ============================================================
   CSS CUSTOM PROPERTIES
   ============================================================ */
:root {
  --bg-base: #080c18;
  --bg-surface: #0d1220;
  --bg-card: #111827;
  --bg-card-hover: #141d2e;
  --bg-elevated: #1a2235;
  --bg-input: #0f1624;

  --border-subtle: rgba(255,255,255,0.06);
  --border-card: rgba(255,255,255,0.09);
  --border-accent: rgba(0, 212, 255, 0.3);

  --cyan: #00d4ff;
  --cyan-dim: rgba(0, 212, 255, 0.12);
  --cyan-glow: rgba(0, 212, 255, 0.25);
  --cyan-bright: #33dfff;

  --amber: #f59e0b;
  --amber-dim: rgba(245, 158, 11, 0.12);
  --red: #ef4444;
  --red-dim: rgba(239, 68, 68, 0.12);
  --red-bright: #ff6b6b;
  --green: #10b981;
  --green-dim: rgba(16, 185, 129, 0.12);
  --orange: #f97316;
  --orange-dim: rgba(249, 115, 22, 0.12);
  --purple: #8b5cf6;
  --purple-dim: rgba(139, 92, 246, 0.12);
  --blue: #3b82f6;
  --blue-dim: rgba(59, 130, 246, 0.12);

  --text-primary: #e8edf5;
  --text-secondary: #8892a4;
  --text-muted: #4d5a6e;
  --text-accent: #00d4ff;

  --font-display: 'Sora', sans-serif;
  --font-body: 'IBM Plex Sans', sans-serif;
  --font-mono: 'IBM Plex Mono', monospace;

  --sidebar-width: 240px;
  --sidebar-collapsed: 60px;
  --topbar-height: 56px;
  --transition: 0.2s cubic-bezier(0.4,0,0.2,1);
  --transition-slow: 0.4s cubic-bezier(0.4,0,0.2,1);
}

/* ============================================================
   RESET & BASE
   ============================================================ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; overflow: hidden; }
body {
  font-family: var(--font-body);
  background: var(--bg-base);
  color: var(--text-primary);
  font-size: 13px;
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
}
button { cursor: pointer; font-family: inherit; }
input, select, textarea { font-family: inherit; }
a { text-decoration: none; color: inherit; }

/* ============================================================
   SCROLLBARS
   ============================================================ */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 6px; }
::-webkit-scrollbar-thumb:hover { background: rgba(0,212,255,0.2); box-shadow: 0 0 6px rgba(0,212,255,0.15); }

/* ============================================================
   LAYOUT
   ============================================================ */
#app { display: flex; height: 100vh; overflow: hidden; }

/* ============================================================
   SIDEBAR
   ============================================================ */
#sidebar {
  width: var(--sidebar-width);
  min-width: var(--sidebar-width);
  height: 100vh;
  background: var(--bg-surface);
  border-right: 1px solid var(--border-subtle);
  display: flex;
  flex-direction: column;
  transition: width var(--transition-slow), min-width var(--transition-slow);
  z-index: 100;
  position: relative;
  overflow: hidden;
}
#sidebar::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 120px;
  background: linear-gradient(to top, rgba(0,30,60,0.08) 0%, transparent 100%);
  pointer-events: none;
  z-index: 0;
}
#sidebar.collapsed {
  width: var(--sidebar-collapsed);
  min-width: var(--sidebar-collapsed);
}

.sidebar-logo {
  height: var(--topbar-height);
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 0 12px;
  border-bottom: 1px solid var(--border-subtle);
  flex-shrink: 0;
  overflow: hidden;
}
.logo-mark {
  width: 32px;
  height: 32px;
  flex-shrink: 0;
  background: linear-gradient(135deg, #00d4ff 0%, #0066cc 100%);
  border-radius: 7px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-display);
  font-weight: 800;
  font-size: 14px;
  color: #fff;
  letter-spacing: -0.5px;
  box-shadow: 0 0 16px rgba(0,212,255,0.35);
}
.logo-text {
  font-family: var(--font-display);
  font-weight: 700;
  font-size: 15px;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  opacity: 1;
  transition: opacity var(--transition-slow), width var(--transition-slow);
}
.logo-sub {
  font-size: 8px;
  font-weight: 500;
  color: var(--text-muted);
  letter-spacing: 0.06em;
  text-transform: uppercase;
  display: block;
  margin-top: 0;
  white-space: nowrap;
}
#sidebar.collapsed .logo-text { opacity: 0; width: 0; }

.sidebar-nav {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 8px 0;
}
.nav-section {
  margin-bottom: 4px;
}
.nav-section-label {
  font-size: 9px;
  font-weight: 600;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--text-muted);
  padding: 8px 16px 4px;
  white-space: nowrap;
  overflow: hidden;
  transition: opacity var(--transition-slow);
}
#sidebar.collapsed .nav-section-label { opacity: 0; }

.nav-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 14px;
  cursor: pointer;
  border-radius: 0;
  transition: background var(--transition), color var(--transition);
  position: relative;
  white-space: nowrap;
  overflow: hidden;
  color: var(--text-secondary);
  border-left: 2px solid transparent;
  margin: 1px 6px;
  border-radius: 6px;
}
.nav-item:hover {
  background: rgba(255,255,255,0.04);
  color: var(--text-primary);
  box-shadow: inset 0 0 20px rgba(0,212,255,0.02);
}
.nav-item.active {
  background: var(--cyan-dim);
  color: var(--cyan);
  border-left: 2px solid var(--cyan);
  box-shadow: inset 3px 0 8px -3px rgba(0,212,255,0.2);
}
.nav-item.active .nav-icon { color: var(--cyan); }
.nav-icon {
  width: 18px;
  height: 18px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 15px;
  color: #64748b;
}
.nav-icon svg {
  width: 16px;
  height: 16px;
  stroke: #64748b;
  transition: stroke 0.18s ease;
}
.nav-item:hover .nav-icon svg,
.nav-item:hover .nav-icon { color: #94a3b8; }
.nav-item:hover .nav-icon svg { stroke: #94a3b8; }
.nav-item.active .nav-icon svg { stroke: var(--cyan); }
.nav-label {
  font-size: 12.5px;
  font-weight: 500;
  overflow: hidden;
  white-space: nowrap;
  transition: opacity var(--transition-slow);
}
#sidebar.collapsed .nav-label { opacity: 0; pointer-events: none; }

.sidebar-toggle {
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-top: 1px solid var(--border-subtle);
  flex-shrink: 0;
  cursor: pointer;
  color: var(--text-muted);
  transition: color var(--transition), background var(--transition);
}
.sidebar-toggle:hover { background: rgba(255,255,255,0.04); color: var(--text-primary); }
.toggle-icon { font-size: 16px; transition: transform var(--transition-slow); }
#sidebar.collapsed .toggle-icon { transform: rotate(180deg); }

/* Admin section collapse */
.admin-section .nav-section-label {
  display: flex;
  align-items: center;
  justify-content: space-between;
  cursor: pointer;
  padding-right: 16px;
}
.admin-section .nav-section-label:hover { color: var(--text-secondary); }
.admin-chevron { font-size: 10px; transition: transform var(--transition); }
.admin-section.collapsed-section .admin-chevron { transform: rotate(-90deg); }
.admin-section.collapsed-section .admin-items { display: none; }

/* ============================================================
   MAIN AREA
   ============================================================ */
#main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }

/* ============================================================
   TOP BAR
   ============================================================ */
#topbar {
  height: var(--topbar-height);
  background: rgba(13,18,32,0.85);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-bottom: 1px solid transparent;
  border-image: linear-gradient(90deg, rgba(0,212,255,0.15) 0%, rgba(139,92,246,0.08) 50%, transparent 100%) 1;
  display: flex;
  align-items: center;
  padding: 0 20px;
  gap: 12px;
  flex-shrink: 0;
  z-index: 50;
}
.topbar-brand {
  font-family: var(--font-display);
  font-weight: 700;
  font-size: 14px;
  color: var(--text-primary);
  letter-spacing: 0.02em;
  margin-right: 4px;
}
.topbar-brand span { color: var(--cyan); }
.topbar-sep { width: 1px; height: 20px; background: var(--border-subtle); }
.org-select {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 5px 10px;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 6px;
  cursor: pointer;
  font-size: 12px;
  color: var(--text-secondary);
  transition: border-color var(--transition), color var(--transition);
}
.org-select:hover { border-color: var(--border-accent); color: var(--text-primary); }
.topbar-right { margin-left: auto; display: flex; align-items: center; gap: 12px; position: relative; }
.live-badge {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  background: rgba(16, 185, 129, 0.08);
  border: 1px solid rgba(16, 185, 129, 0.2);
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  color: var(--green);
  font-family: var(--font-mono);
  box-shadow: 0 0 12px rgba(16,185,129,0.08);
  animation: liveBadgeGlow 3s ease-in-out infinite;
}
@keyframes liveBadgeGlow {
  0%, 100% { box-shadow: 0 0 12px rgba(16,185,129,0.08); }
  50% { box-shadow: 0 0 18px rgba(16,185,129,0.15); }
}
.live-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--green);
  animation: pulse-green 2s ease-in-out infinite;
}
@keyframes pulse-green {
  0%, 100% { box-shadow: 0 0 0 0 rgba(16,185,129,0.6); }
  50% { box-shadow: 0 0 0 5px rgba(16,185,129,0); }
}
.topbar-time { font-family: var(--font-mono); font-size: 12px; color: var(--text-secondary); }
.topbar-icon-btn {
  width: 32px;
  height: 32px;
  border-radius: 6px;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 15px;
  color: var(--text-secondary);
  transition: all var(--transition);
  position: relative;
}
.topbar-icon-btn:hover { border-color: var(--border-accent); color: var(--text-primary); box-shadow: 0 0 12px rgba(0,212,255,0.1); }
.notif-badge {
  position: absolute;
  top: -4px; right: -4px;
  width: 15px; height: 15px;
  background: var(--red);
  border-radius: 50%;
  font-size: 9px;
  font-weight: 700;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1.5px solid var(--bg-surface);
}
.user-chip {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 10px 4px 4px;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 20px;
  cursor: pointer;
}
.user-avatar {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: linear-gradient(135deg, #00d4ff, #8b5cf6);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 700;
  color: #fff;
}
.user-name { font-size: 12px; font-weight: 500; color: var(--text-secondary); }

/* ============================================================
   CONTENT AREA
   ============================================================ */
#content-area {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  position: relative;
  background: var(--bg-base);
}
#content-area::before {
  content: '';
  position: fixed;
  top: 0;
  left: var(--sidebar-width);
  right: 0;
  bottom: 0;
  background:
    radial-gradient(ellipse 80% 50% at 20% 40%, rgba(0,40,80,0.04) 0%, transparent 70%),
    radial-gradient(ellipse 60% 60% at 80% 20%, rgba(40,0,80,0.035) 0%, transparent 70%),
    radial-gradient(ellipse 70% 40% at 50% 90%, rgba(0,30,60,0.03) 0%, transparent 70%);
  animation: ambientMesh 20s ease-in-out infinite alternate;
  pointer-events: none;
  z-index: 0;
}
@keyframes ambientMesh {
  0% { opacity: 1; filter: hue-rotate(0deg); }
  50% { opacity: 0.8; filter: hue-rotate(15deg); }
  100% { opacity: 1; filter: hue-rotate(-10deg); }
}

.page { display: none; padding: 24px; animation: fadeIn 0.25s ease; min-height: 100%; position: relative; z-index: 1; }
.page.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

/* ============================================================
   COMMON COMPONENTS
   ============================================================ */
.page-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
}
.page-title {
  font-family: var(--font-display);
  font-size: 20px;
  font-weight: 700;
  color: var(--text-primary);
  letter-spacing: -0.02em;
  text-shadow: 0 0 30px rgba(0,212,255,0.15);
}
.page-subtitle { font-size: 12px; color: var(--text-muted); margin-top: 2px; }
.page-actions { display: flex; gap: 8px; }

/* Buttons */
.btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 7px 14px;
  border-radius: 6px;
  font-size: 12px;
  font-weight: 600;
  border: none;
  cursor: pointer;
  transition: all var(--transition);
  white-space: nowrap;
}
.btn-primary {
  background: linear-gradient(135deg, var(--cyan) 0%, #00b8d9 100%);
  color: #000;
}
.btn-primary:hover { background: linear-gradient(135deg, var(--cyan-bright) 0%, var(--cyan) 100%); box-shadow: 0 0 20px rgba(0,212,255,0.3); }
.btn-primary:active { transform: scale(0.97); transition: transform 0.1s; }
.btn-secondary {
  background: var(--bg-card);
  color: var(--text-secondary);
  border: 1px solid var(--border-card);
}
.btn-secondary:hover { border-color: var(--border-accent); color: var(--text-primary); box-shadow: 0 0 12px rgba(0,212,255,0.08); }
.btn-secondary:active { transform: scale(0.97); transition: transform 0.1s; }
.btn-danger {
  background: var(--red-dim);
  color: var(--red-bright);
  border: 1px solid rgba(239,68,68,0.25);
}
.btn-danger:hover { background: rgba(239,68,68,0.2); }
.btn-amber {
  background: var(--amber-dim);
  color: var(--amber);
  border: 1px solid rgba(245,158,11,0.25);
}
.btn-success {
  background: var(--green-dim);
  color: var(--green);
  border: 1px solid rgba(16,185,129,0.25);
}
.btn-sm { padding: 4px 10px; font-size: 11px; }
.btn-xs { padding: 3px 8px; font-size: 10px; }
.btn-icon { width: 28px; height: 28px; padding: 0; justify-content: center; border-radius: 5px; background: var(--bg-card); border: 1px solid var(--border-card); color: var(--text-secondary); }
.btn-icon:hover { border-color: var(--border-accent); color: var(--cyan); }

/* Cards */
.card {
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  padding: 16px;
  position: relative;
  transition: border-color var(--transition), box-shadow var(--transition), transform var(--transition);
  box-shadow: 0 0 0 1px rgba(255,255,255,0.03), 0 2px 12px rgba(0,0,0,0.25);
}
.card::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 10px;
  background: repeating-conic-gradient(rgba(255,255,255,0.008) 0% 25%, transparent 0% 50%) 0 0 / 3px 3px;
  pointer-events: none;
  z-index: 0;
}
.card > * { position: relative; z-index: 1; }
.card:hover {
  border-color: rgba(0,212,255,0.15);
  box-shadow: 0 0 0 1px rgba(255,255,255,0.05), 0 4px 24px rgba(0,0,0,0.4), 0 0 48px rgba(0,212,255,0.03);
  transform: scale(1.002) translateY(-1px);
}
.card-glass {
  background: rgba(17,24,39,0.7);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}
.card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 14px; }
.card-title { font-size: 11px; font-weight: 700; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.12em; }

/* Badges / Priority */
.badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 7px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.03em;
}
.badge-p1 { background: rgba(239,68,68,0.15); color: #ff6b6b; border: 1px solid rgba(239,68,68,0.3); box-shadow: 0 0 8px rgba(239,68,68,0.15); animation: badgePulseP1 2s ease-in-out infinite; }
@keyframes badgePulseP1 {
  0%, 100% { box-shadow: 0 0 8px rgba(239,68,68,0.15); }
  50% { box-shadow: 0 0 14px rgba(239,68,68,0.3); }
}
.badge-p2 { background: rgba(245,158,11,0.15); color: #fbbf24; border: 1px solid rgba(245,158,11,0.3); box-shadow: 0 0 6px rgba(245,158,11,0.1); }
.badge-p3 { background: rgba(249,115,22,0.12); color: #fb923c; border: 1px solid rgba(249,115,22,0.25); }
.badge-p4 { background: rgba(100,116,139,0.15); color: #94a3b8; border: 1px solid rgba(100,116,139,0.25); }
.badge-open { background: rgba(0,212,255,0.1); color: var(--cyan); border: 1px solid rgba(0,212,255,0.25); box-shadow: 0 0 6px rgba(0,212,255,0.1); }
.badge-closed { background: rgba(16,185,129,0.1); color: var(--green); border: 1px solid rgba(16,185,129,0.2); box-shadow: 0 0 6px rgba(16,185,129,0.08); }
.badge-escalated { background: rgba(239,68,68,0.12); color: #ff6b6b; border: 1px solid rgba(239,68,68,0.25); box-shadow: 0 0 6px rgba(239,68,68,0.1); }
.badge-investigating { background: rgba(139,92,246,0.12); color: #a78bfa; border: 1px solid rgba(139,92,246,0.25); box-shadow: 0 0 6px rgba(139,92,246,0.1); }
.badge-green { background: var(--green-dim); color: var(--green); border: 1px solid rgba(16,185,129,0.25); }
.badge-amber { background: var(--amber-dim); color: var(--amber); border: 1px solid rgba(245,158,11,0.25); }
.badge-red { background: var(--red-dim); color: var(--red-bright); border: 1px solid rgba(239,68,68,0.3); }
.badge-blue { background: var(--blue-dim); color: #60a5fa; border: 1px solid rgba(59,130,246,0.25); }
.badge-purple { background: var(--purple-dim); color: #a78bfa; border: 1px solid rgba(139,92,246,0.25); }
.badge-cyan { background: var(--cyan-dim); color: var(--cyan); border: 1px solid var(--border-accent); }

/* Tables */
.table-wrap { overflow-x: auto; }
table { width: 100%; border-collapse: collapse; }
thead tr { border-bottom: 1px solid var(--border-subtle); }
th {
  padding: 8px 12px;
  text-align: left;
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-muted);
  white-space: nowrap;
  background: rgba(255,255,255,0.02);
  backdrop-filter: blur(4px);
}
td { padding: 9px 12px; border-bottom: 1px solid var(--border-subtle); font-size: 12px; color: var(--text-secondary); }
tr:last-child td { border-bottom: none; }
tbody tr { transition: background var(--transition); cursor: pointer; }
tbody tr:nth-child(even) td { background: rgba(255,255,255,0.008); }
tbody tr:hover td { background: linear-gradient(90deg, rgba(0,212,255,0.03) 0%, rgba(255,255,255,0.025) 50%, transparent 100%); color: var(--text-primary); }
.mono { font-family: var(--font-mono); font-size: 11px; color: var(--text-accent); }

/* Status dot */
.status-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  flex-shrink: 0;
}
.status-dot.green { background: var(--green); box-shadow: 0 0 6px rgba(16,185,129,0.6); animation: pulse-green-smooth 3s ease-in-out infinite; }
.status-dot.red { background: var(--red); box-shadow: 0 0 6px rgba(239,68,68,0.6); animation: pulse-red-smooth 2s ease-in-out infinite; }
.status-dot.amber { background: var(--amber); box-shadow: 0 0 6px rgba(245,158,11,0.5); }
.status-dot.cyan { background: var(--cyan); box-shadow: 0 0 6px var(--cyan-glow); animation: pulse-cyan-smooth 3s ease-in-out infinite; }
.status-dot.gray { background: var(--text-muted); }

@keyframes pulse-green-smooth {
  0%, 100% { box-shadow: 0 0 4px 0 rgba(16,185,129,0.6), 0 0 0 0 rgba(16,185,129,0.3); }
  50% { box-shadow: 0 0 8px 2px rgba(16,185,129,0.4), 0 0 0 4px rgba(16,185,129,0); }
}
@keyframes pulse-red-smooth {
  0%, 100% { box-shadow: 0 0 4px 0 rgba(239,68,68,0.6), 0 0 0 0 rgba(239,68,68,0.3); }
  50% { box-shadow: 0 0 8px 2px rgba(239,68,68,0.4), 0 0 0 5px rgba(239,68,68,0); }
}
@keyframes pulse-cyan-smooth {
  0%, 100% { box-shadow: 0 0 4px 0 rgba(0,212,255,0.5), 0 0 0 0 rgba(0,212,255,0.3); }
  50% { box-shadow: 0 0 8px 2px rgba(0,212,255,0.3), 0 0 0 4px rgba(0,212,255,0); }
}

@keyframes pulse-red {
  0%, 100% { box-shadow: 0 0 0 0 rgba(239,68,68,0.6); }
  50% { box-shadow: 0 0 0 5px rgba(239,68,68,0); }
}
@keyframes pulse-cyan {
  0%, 100% { box-shadow: 0 0 0 0 rgba(0,212,255,0.5); }
  50% { box-shadow: 0 0 0 5px rgba(0,212,255,0); }
}

/* SLA counter */
.sla-bar {
  display: flex;
  gap: 2px;
  align-items: center;
  overflow: hidden;
  border-radius: 3px;
}
.progress-bar { height: 3px; background: var(--border-subtle); border-radius: 2px; overflow: hidden; }
.progress-fill { height: 100%; border-radius: 2px; }

/* Divider */
.divider { height: 1px; background: var(--border-subtle); margin: 16px 0; }

/* Filter bar */
.filter-bar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 16px;
  background: var(--bg-surface);
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  margin-bottom: 16px;
  flex-wrap: wrap;
}
.filter-label { font-size: 11px; color: var(--text-muted); font-weight: 600; white-space: nowrap; }
.filter-select, .filter-input {
  background: var(--bg-input);
  border: 1px solid var(--border-card);
  color: var(--text-secondary);
  border-radius: 5px;
  padding: 5px 10px;
  font-size: 11px;
  outline: none;
  transition: border-color var(--transition);
}
.filter-select:hover, .filter-input:hover, .filter-select:focus, .filter-input:focus {
  border-color: var(--border-accent);
  color: var(--text-primary);
}

/* Metric cards row */
.metrics-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
  margin-bottom: 20px;
}
.metric-card {
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  padding: 14px 16px;
  position: relative;
  overflow: hidden;
  transition: all var(--transition);
  box-shadow: 0 0 0 1px rgba(255,255,255,0.03), 0 2px 12px rgba(0,0,0,0.2);
}
.metric-card:hover {
  border-color: rgba(255,255,255,0.14);
  box-shadow: 0 0 0 1px rgba(255,255,255,0.05), 0 4px 24px rgba(0,0,0,0.35), 0 0 40px rgba(0,212,255,0.04);
  transform: translateY(-2px);
}
.metric-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 2px;
  border-radius: 10px 10px 0 0;
}
.metric-card.cyan::before { background: linear-gradient(90deg, var(--cyan), transparent); }
.metric-card.green::before { background: linear-gradient(90deg, var(--green), transparent); }
.metric-card.red::before { background: linear-gradient(90deg, var(--red), transparent); }
.metric-card.amber::before { background: linear-gradient(90deg, var(--amber), transparent); }
.metric-card.purple::before { background: linear-gradient(90deg, var(--purple), transparent); }
.metric-label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-muted); margin-bottom: 6px; }
.metric-value { font-family: var(--font-display); font-size: 30px; font-weight: 800; letter-spacing: -0.03em; color: var(--text-primary); line-height: 1; font-variant-numeric: tabular-nums; position: relative; }
.metric-card.cyan .metric-value { text-shadow: 0 0 24px rgba(0,212,255,0.15); }
.metric-card.green .metric-value { text-shadow: 0 0 24px rgba(16,185,129,0.15); }
.metric-card.red .metric-value { text-shadow: 0 0 24px rgba(239,68,68,0.15); }
.metric-card.amber .metric-value { text-shadow: 0 0 24px rgba(245,158,11,0.15); }
.metric-card.purple .metric-value { text-shadow: 0 0 24px rgba(139,92,246,0.15); }
.metric-sub { font-size: 11px; color: var(--text-muted); margin-top: 4px; }
.metric-icon { position: absolute; right: 14px; top: 14px; font-size: 20px; opacity: 0.25; }

/* Chip tags */
.chips { display: flex; flex-wrap: wrap; gap: 6px; }
.chip {
  padding: 3px 10px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  color: var(--text-secondary);
}

/* Tooltip (simple) */
[data-tooltip] { position: relative; }
[data-tooltip]:hover::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: calc(100% + 6px);
  left: 50%;
  transform: translateX(-50%);
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px;
  white-space: nowrap;
  color: var(--text-primary);
  z-index: 999;
  pointer-events: none;
}

/* ============================================================
   ANIMATED GRADIENT MESH (Dashboard Header)
   ============================================================ */
.dashboard-hero {
  position: relative;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 12px;
  padding: 24px;
  margin-bottom: 20px;
  overflow: hidden;
}
.dashboard-hero::before {
  content: '';
  position: absolute;
  inset: 0;
  background:
    radial-gradient(ellipse 60% 40% at 20% 50%, rgba(0,212,255,0.08) 0%, transparent 70%),
    radial-gradient(ellipse 40% 60% at 80% 20%, rgba(139,92,246,0.06) 0%, transparent 70%),
    radial-gradient(ellipse 50% 50% at 60% 80%, rgba(16,185,129,0.05) 0%, transparent 70%);
  animation: meshMove 8s ease-in-out infinite alternate;
}
@keyframes meshMove {
  0% { background-position: 20% 50%, 80% 20%, 60% 80%; }
  100% { background-position: 25% 55%, 75% 25%, 65% 75%; }
}
.hero-grid {
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(rgba(255,255,255,0.015) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.015) 1px, transparent 1px);
  background-size: 40px 40px;
}
.hero-content { position: relative; z-index: 1; }

/* SLA strip */
.sla-strip {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}
.sla-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 14px;
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--border-subtle);
  border-radius: 7px;
  flex: 1;
  min-width: 120px;
}
.sla-item .sla-val {
  font-family: var(--font-display);
  font-size: 22px;
  font-weight: 700;
  color: var(--cyan);
  letter-spacing: -0.03em;
  font-variant-numeric: tabular-nums;
}
.sla-item .sla-key { font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-muted); }
.sla-item .sla-desc { font-size: 10px; color: var(--text-muted); }

/* Summary cards */
.summary-cards {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}
.summary-card {
  flex: 1;
  min-width: 90px;
  padding: 12px;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 9px;
  transition: all var(--transition);
}
.summary-card:hover { border-color: rgba(255,255,255,0.14); }
.sc-num { font-family: var(--font-display); font-size: 26px; font-weight: 800; letter-spacing: -0.03em; font-variant-numeric: tabular-nums; }
.sc-label { font-size: 10px; color: var(--text-muted); margin-top: 2px; font-weight: 500; }

/* Chart containers */
.chart-grid {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 16px;
  margin-bottom: 20px;
}
.chart-container { position: relative; height: 200px; }

/* Open tickets list */
.ticket-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  border-radius: 7px;
  border: 1px solid transparent;
  transition: all var(--transition);
  cursor: pointer;
}
.ticket-row:hover {
  background: rgba(255,255,255,0.03);
  border-color: var(--border-subtle);
}
.ticket-row + .ticket-row { margin-top: 4px; }
.ticket-id { font-family: var(--font-mono); font-size: 11px; color: var(--cyan); min-width: 80px; }
.ticket-title { flex: 1; font-size: 12.5px; color: var(--text-primary); font-weight: 500; }
.ticket-meta { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }
.ticket-source { font-size: 10px; color: var(--text-muted); }
.ticket-time { font-size: 10px; color: var(--text-muted); white-space: nowrap; }

/* Org panel */
.org-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 0;
  border-bottom: 1px solid var(--border-subtle);
}
.org-row:last-child { border-bottom: none; }
.org-name { flex: 1; font-size: 12.5px; font-weight: 500; }
.org-count { font-size: 11px; color: var(--text-muted); }
.org-bar { width: 80px; height: 4px; background: var(--bg-elevated); border-radius: 2px; overflow: hidden; }
.org-fill { height: 100%; border-radius: 2px; background: var(--cyan); }

/* Dashboard bottom row */
.dash-bottom {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 16px;
}

/* Label chips */
.label-chip {
  display: inline-flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 5px 10px;
  border-radius: 6px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  font-size: 11px;
  font-weight: 600;
  color: var(--text-secondary);
  transition: all var(--transition);
}
.label-chip:hover { border-color: var(--border-accent); color: var(--text-primary); }
.label-count { font-family: var(--font-mono); font-size: 13px; color: var(--text-primary); font-weight: 700; }
.labels-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }

/* ============================================================
   INVESTIGATION WORKSPACE
   ============================================================ */
.investigation-layout {
  display: grid;
  grid-template-columns: 300px 1fr;
  gap: 16px;
  height: calc(100vh - var(--topbar-height) - 48px);
}
.inv-sidebar {
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.inv-main { overflow-y: auto; display: flex; flex-direction: column; gap: 12px; }

.verdict-banner {
  border-radius: 10px;
  padding: 16px;
  background: rgba(239,68,68,0.08);
  border: 1px solid rgba(239,68,68,0.3);
  position: relative;
  overflow: hidden;
}
.verdict-banner::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--red), var(--amber));
}
.verdict-title { font-family: var(--font-display); font-size: 15px; font-weight: 800; color: #ff6b6b; letter-spacing: -0.02em; }
.confidence-pill {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px;
  background: rgba(239,68,68,0.15);
  border-radius: 20px;
  font-size: 11px;
  font-weight: 700;
  color: #ff9999;
  margin-top: 4px;
}
.reasoning-item {
  display: flex;
  gap: 10px;
  align-items: flex-start;
  padding: 8px 0;
  border-bottom: 1px solid var(--border-subtle);
}
.reasoning-num {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--cyan-dim);
  border: 1px solid var(--border-accent);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 700;
  color: var(--cyan);
  flex-shrink: 0;
  margin-top: 1px;
}
.counter-item {
  display: flex;
  gap: 8px;
  align-items: flex-start;
  padding: 6px 0;
  font-size: 12px;
  color: var(--text-secondary);
}
.counter-icon { color: var(--amber); flex-shrink: 0; }
.action-checkbox {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 7px 10px;
  border-radius: 6px;
  background: rgba(255,255,255,0.02);
  border: 1px solid var(--border-subtle);
  margin-bottom: 6px;
  cursor: pointer;
  transition: all var(--transition);
}
.action-checkbox:hover { background: rgba(255,255,255,0.04); border-color: var(--border-card); }
.action-check { width: 16px; height: 16px; border: 2px solid var(--border-card); border-radius: 4px; transition: all var(--transition); }
.action-checkbox.checked .action-check { background: var(--cyan); border-color: var(--cyan); }
.action-checkbox.checked .action-check::after { content: 'âœ“'; display: block; font-size: 10px; color: #000; line-height: 1; text-align: center; }
.mitre-tag {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 7px;
  background: rgba(139,92,246,0.1);
  border: 1px solid rgba(139,92,246,0.25);
  border-radius: 4px;
  font-family: var(--font-mono);
  font-size: 10px;
  color: #a78bfa;
}
.attack-chain { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
.chain-link {
  padding: 8px 12px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  border-radius: 7px;
  font-size: 11px;
  flex: 1;
  min-width: 140px;
}
.chain-arrow { color: var(--text-muted); font-size: 14px; }

/* ============================================================
   ATTACK PATH DIAGRAM (Task 1)
   ============================================================ */
.attack-path-section {
  background: var(--bg-card);
  border: 1px solid rgba(0,212,255,0.15);
  border-radius: 12px;
  padding: 20px 24px;
  position: relative;
  margin-bottom: 4px;
  overflow: visible;
}
.attack-path-section .attack-path-flow {
  overflow-x: auto;
  overflow-y: visible;
  padding-top: 30px;
  padding-bottom: 8px;
  scrollbar-width: thin;
  scrollbar-color: rgba(0,212,255,0.2) transparent;
}
.attack-path-section::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, #10b981, #f59e0b 50%, #ef4444);
  border-radius: 12px 12px 0 0;
  z-index: 2;
  pointer-events: none;
}
.attack-path-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
}
.attack-path-title {
  font-size: 13px;
  font-weight: 700;
  color: var(--text-primary);
  letter-spacing: 0.05em;
  text-transform: uppercase;
}
.attack-path-subtitle {
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 2px;
}
.attack-path-flow {
  display: flex;
  align-items: stretch;
  gap: 0;
  width: 100%;
  position: relative;
  min-height: 190px;
  padding: 30px 0 6px;
}
.ap-node {
  flex: 1;
  min-width: 120px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  padding: 18px 12px 14px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  position: relative;
  transition: all 0.2s;
  text-align: center;
  overflow: visible;
}
.ap-node:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,0.4); }
.ap-node.ap-green { border-color: rgba(16,185,129,0.35); background: rgba(16,185,129,0.06); }
.ap-node.ap-teal  { border-color: rgba(6,182,212,0.35);  background: rgba(6,182,212,0.06); }
.ap-node.ap-amber { border-color: rgba(245,158,11,0.35); background: rgba(245,158,11,0.06); }
.ap-node.ap-orange{ border-color: rgba(249,115,22,0.35); background: rgba(249,115,22,0.06); }
.ap-node.ap-red   { border-color: rgba(239,68,68,0.4);  background: rgba(239,68,68,0.07); }
.ap-node.ap-current {
  box-shadow: 0 0 0 2px rgba(245,158,11,0.6), 0 0 20px rgba(245,158,11,0.2);
  animation: ap-pulse-amber 2s ease-in-out infinite;
}
@keyframes ap-pulse-amber {
  0%, 100% { box-shadow: 0 0 0 2px rgba(245,158,11,0.6), 0 0 20px rgba(245,158,11,0.2); }
  50% { box-shadow: 0 0 0 3px rgba(245,158,11,0.9), 0 0 30px rgba(245,158,11,0.35); }
}
.ap-node-icon { font-size: 22px; line-height: 1; }
.ap-node-tactic {
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-muted);
}
.ap-node-technique {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-primary);
  line-height: 1.3;
}
.ap-node-mitre {
  font-size: 9px;
  font-family: var(--font-mono);
  padding: 2px 6px;
  border-radius: 3px;
  background: rgba(139,92,246,0.12);
  border: 1px solid rgba(139,92,246,0.2);
  color: #a78bfa;
  margin-top: 2px;
}
.ap-node-badge {
  position: absolute;
  top: -24px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 9px;
  font-weight: 700;
  padding: 2px 8px;
  border-radius: 10px;
  white-space: nowrap;
  z-index: 5;
  pointer-events: none;
}
.ap-node-badge.current { background: rgba(245,158,11,0.25); color: var(--amber); border: 1px solid rgba(245,158,11,0.5); }
.ap-connector {
  display: flex;
  align-items: center;
  width: 32px;
  flex-shrink: 0;
  position: relative;
  overflow: hidden;
}
.ap-connector-line {
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, rgba(255,255,255,0.1), rgba(255,255,255,0.2));
  position: relative;
  overflow: hidden;
}
.ap-connector-line::after {
  content: '';
  position: absolute;
  top: 0; left: -100%; width: 60%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(0,212,255,0.8), transparent);
  animation: ap-particle 1.8s linear infinite;
}
.ap-connector:nth-child(2) .ap-connector-line::after { animation-delay: 0.3s; }
.ap-connector:nth-child(4) .ap-connector-line::after { animation-delay: 0.6s; }
.ap-connector:nth-child(6) .ap-connector-line::after { animation-delay: 0.9s; }
.ap-connector:nth-child(8) .ap-connector-line::after { animation-delay: 1.2s; }
.ap-connector:nth-child(10) .ap-connector-line::after { animation-delay: 1.5s; }
@keyframes ap-particle {
  0% { left: -60%; }
  100% { left: 110%; }
}
.ap-arrow { color: rgba(255,255,255,0.25); font-size: 12px; position: absolute; right: -2px; }
.attack-path-legend {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-top: 14px;
  padding-top: 12px;
  border-top: 1px solid var(--border-subtle);
  flex-wrap: wrap;
}
.ap-legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 10px;
  color: var(--text-muted);
}
.ap-legend-dot {
  width: 10px; height: 10px;
  border-radius: 50%;
}
.ap-progress-bar {
  flex: 1;
  height: 4px;
  background: rgba(255,255,255,0.06);
  border-radius: 4px;
  overflow: hidden;
  min-width: 80px;
}
.ap-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #10b981, #f59e0b 60%, #ef4444);
  border-radius: 4px;
  width: 67%;
}

/* ============================================================
   ESCALATION MODAL (Task 2)
   ============================================================ */
.esc-modal-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  z-index: 9000;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(4px);
}
.esc-modal-overlay.open { display: flex; }
.esc-modal {
  background: rgba(8,13,26,0.97);
  border: 1px solid rgba(0,212,255,0.18);
  border-radius: 14px;
  backdrop-filter: blur(20px);
  width: 680px;
  max-width: 95vw;
  max-height: 88vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  box-shadow: 0 24px 64px rgba(0,0,0,0.7), 0 0 80px rgba(0,212,255,0.05);
}
.esc-modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px 20px 14px;
  border-bottom: 1px solid rgba(0,212,255,0.1);
}
.esc-modal-title { font-size: 15px; font-weight: 700; color: var(--text-primary); }
.esc-modal-close {
  width: 28px; height: 28px;
  border-radius: 6px;
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--border-subtle);
  color: var(--text-muted);
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-size: 14px;
  transition: all var(--transition);
}
.esc-modal-close:hover { background: rgba(239,68,68,0.15); border-color: rgba(239,68,68,0.3); color: var(--red); }
.esc-modal-body { padding: 18px 20px; overflow-y: auto; flex: 1; display: flex; flex-direction: column; gap: 12px; }
.esc-field-row { display: flex; gap: 10px; }
.esc-field { display: flex; flex-direction: column; gap: 5px; flex: 1; }
.esc-field-label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.07em; color: var(--text-muted); }
.esc-input {
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--border-card);
  border-radius: 7px;
  padding: 8px 10px;
  font-size: 12px;
  color: var(--text-primary);
  font-family: var(--font-mono);
  transition: border-color var(--transition);
  width: 100%;
  box-sizing: border-box;
}
.esc-input:focus { outline: none; border-color: rgba(0,212,255,0.4); background: rgba(0,212,255,0.03); }
.esc-textarea {
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--border-card);
  border-radius: 7px;
  padding: 10px 12px;
  font-size: 12px;
  color: var(--text-secondary);
  font-family: var(--font-mono);
  resize: vertical;
  min-height: 180px;
  line-height: 1.6;
  width: 100%;
  box-sizing: border-box;
  transition: border-color var(--transition);
}
.esc-textarea:focus { outline: none; border-color: rgba(0,212,255,0.4); background: rgba(0,212,255,0.03); }
.esc-modal-footer {
  padding: 14px 20px;
  border-top: 1px solid rgba(0,212,255,0.1);
  display: flex;
  gap: 8px;
  align-items: center;
}
.esc-modal-footer .spacer { flex: 1; }

/* ============================================================
   OVERRIDE VERDICT (Task 4)
   ============================================================ */
.override-mode-bar {
  display: none;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  background: rgba(245,158,11,0.1);
  border: 1px solid rgba(245,158,11,0.35);
  border-radius: 8px;
  font-size: 12px;
}
.override-mode-bar.active { display: flex; }
.override-mode-text { color: var(--amber); font-weight: 600; flex: 1; }
.override-section-wrap { position: relative; }
.override-section-toolbar {
  display: none;
  align-items: center;
  justify-content: space-between;
  padding: 5px 8px;
  background: rgba(245,158,11,0.06);
  border: 1px solid rgba(245,158,11,0.2);
  border-bottom: none;
  border-radius: 7px 7px 0 0;
  font-size: 10px;
}
.override-mode-active .override-section-toolbar { display: flex; }
.override-toggle-seg {
  display: flex;
  background: rgba(0,0,0,0.3);
  border: 1px solid var(--border-subtle);
  border-radius: 5px;
  overflow: hidden;
}
.override-toggle-btn {
  padding: 3px 10px;
  font-size: 10px;
  font-weight: 600;
  cursor: pointer;
  border: none;
  background: transparent;
  color: var(--text-muted);
  transition: all 0.15s;
}
.override-toggle-btn.active { background: rgba(0,212,255,0.15); color: var(--cyan); }
.override-toggle-btn.active.amber { background: rgba(245,158,11,0.2); color: var(--amber); }
.override-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: 9px;
  font-weight: 700;
  padding: 2px 7px;
  border-radius: 4px;
  text-transform: uppercase;
}
.override-badge.ai { background: rgba(0,212,255,0.08); border: 1px solid rgba(0,212,255,0.2); color: var(--cyan); }
.override-badge.manual { background: rgba(245,158,11,0.12); border: 1px solid rgba(245,158,11,0.3); color: var(--amber); }
.original-ai-collapse {
  margin-top: 6px;
  background: rgba(0,0,0,0.2);
  border: 1px solid var(--border-subtle);
  border-radius: 7px;
  overflow: hidden;
  display: none;
}
.original-ai-collapse.open { display: block; }
.original-ai-collapse-header {
  padding: 7px 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  cursor: pointer;
  font-size: 11px;
  color: var(--text-muted);
  user-select: none;
}
.original-ai-collapse-body {
  padding: 10px 12px;
  font-size: 11px;
  color: var(--text-muted);
  font-style: italic;
  border-top: 1px solid var(--border-subtle);
  line-height: 1.6;
}

/* ============================================================
   RESPONSE CENTER ROUTING (Task 5)
   ============================================================ */
.route-response-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
  padding: 12px;
  background: linear-gradient(135deg, rgba(16,185,129,0.15), rgba(0,212,255,0.12));
  border: 1px solid rgba(16,185,129,0.4);
  border-radius: 8px;
  color: #10b981;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s;
  font-family: var(--font-display);
  margin-top: 10px;
}
.route-response-btn:hover {
  background: linear-gradient(135deg, rgba(16,185,129,0.25), rgba(0,212,255,0.2));
  border-color: rgba(16,185,129,0.6);
  box-shadow: 0 4px 16px rgba(16,185,129,0.2);
  transform: translateY(-1px);
}
.exec-in-rc-link {
  font-size: 10px;
  color: var(--cyan);
  text-decoration: none;
  cursor: pointer;
  opacity: 0.7;
  transition: opacity 0.15s;
  white-space: nowrap;
}
.exec-in-rc-link:hover { opacity: 1; text-decoration: underline; }
.route-confirm-dialog {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.65);
  z-index: 9001;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(4px);
}
.route-confirm-dialog.open { display: flex; }
.route-confirm-box {
  background: rgba(8,13,26,0.97);
  border: 1px solid rgba(16,185,129,0.25);
  border-radius: 12px;
  padding: 24px;
  max-width: 420px;
  width: 95vw;
  text-align: center;
  box-shadow: 0 20px 60px rgba(0,0,0,0.7);
}
.route-confirm-icon { font-size: 36px; margin-bottom: 12px; }
.route-confirm-title { font-size: 15px; font-weight: 700; color: var(--text-primary); margin-bottom: 8px; }
.route-confirm-sub { font-size: 12px; color: var(--text-muted); margin-bottom: 20px; line-height: 1.5; }
.route-confirm-btns { display: flex; gap: 10px; justify-content: center; }

/* ============================================================
   SHIFT HANDOVER ENHANCEMENTS (Task 6)
   ============================================================ */
.handover-artifact-zone {
  border: 2px dashed rgba(0,212,255,0.2);
  border-radius: 10px;
  padding: 24px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
  background: rgba(0,212,255,0.02);
}
.handover-artifact-zone:hover, .handover-artifact-zone.drag-over {
  border-color: rgba(0,212,255,0.5);
  background: rgba(0,212,255,0.05);
}
.handover-artifact-icon { font-size: 28px; margin-bottom: 8px; opacity: 0.5; }
.handover-artifact-text { font-size: 12px; color: var(--text-muted); }
.handover-artifact-sub { font-size: 10px; color: var(--text-muted); opacity: 0.7; margin-top: 4px; }
.handover-file-list { display: flex; flex-direction: column; gap: 6px; margin-top: 10px; }
.handover-file-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 7px 10px;
  background: rgba(255,255,255,0.03);
  border: 1px solid var(--border-subtle);
  border-radius: 6px;
}
.handover-file-icon { font-size: 16px; }
.handover-file-name { font-size: 11px; color: var(--text-primary); flex: 1; font-family: var(--font-mono); }
.handover-file-remove {
  width: 18px; height: 18px;
  border-radius: 4px;
  background: rgba(239,68,68,0.1);
  border: 1px solid rgba(239,68,68,0.2);
  color: var(--red);
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-size: 10px;
  transition: all var(--transition);
}
.handover-file-remove:hover { background: rgba(239,68,68,0.2); }
.send-to-client-section {
  margin-top: 0;
}
.client-send-toggle-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 0;
  border-bottom: 1px solid var(--border-subtle);
  margin-bottom: 12px;
}
.client-send-fields {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 12px;
  background: rgba(0,212,255,0.03);
  border: 1px solid rgba(0,212,255,0.1);
  border-radius: 8px;
  display: none;
}
.client-send-fields.visible { display: flex; }

/* ============================================================
   WAR ROOM SHARE MODAL + CHAT TOGGLE (Task 7)
   ============================================================ */
.wr-share-btn {
  padding: 5px 14px;
  background: rgba(0,212,255,0.1);
  border: 1px solid rgba(0,212,255,0.25);
  border-radius: 6px;
  color: var(--cyan);
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
  font-family: var(--font-display);
  display: flex;
  align-items: center;
  gap: 5px;
}
.wr-share-btn:hover { background: rgba(0,212,255,0.18); border-color: rgba(0,212,255,0.4); }
.wr-share-modal-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  z-index: 9000;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(4px);
}
.wr-share-modal-overlay.open { display: flex; }
.wr-share-modal {
  background: rgba(8,13,26,0.97);
  border: 1px solid rgba(0,212,255,0.18);
  border-radius: 14px;
  backdrop-filter: blur(20px);
  width: 520px;
  max-width: 95vw;
  max-height: 85vh;
  overflow-y: auto;
  box-shadow: 0 24px 64px rgba(0,0,0,0.7);
}
.wr-share-modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px 20px 14px;
  border-bottom: 1px solid rgba(0,212,255,0.1);
}
.wr-share-modal-body { padding: 18px 20px; display: flex; flex-direction: column; gap: 16px; }
.wr-share-section-title { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.07em; color: var(--text-muted); margin-bottom: 8px; }
.wr-collaborator-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 10px;
  background: rgba(255,255,255,0.03);
  border: 1px solid var(--border-subtle);
  border-radius: 7px;
  font-size: 11px;
}
.wr-collab-avatar {
  width: 28px; height: 28px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 10px; font-weight: 700;
  background: linear-gradient(135deg, var(--cyan-dim), rgba(0,212,255,0.3));
  color: var(--cyan);
  flex-shrink: 0;
}
.wr-collab-name { font-weight: 600; color: var(--text-primary); }
.wr-collab-org { font-size: 10px; color: var(--text-muted); }
.wr-collab-role {
  margin-left: auto;
  font-size: 9px;
  font-weight: 700;
  padding: 2px 7px;
  border-radius: 4px;
  text-transform: uppercase;
}
.wr-collab-role.internal { background: rgba(0,212,255,0.1); color: var(--cyan); border: 1px solid rgba(0,212,255,0.2); }
.wr-collab-role.external { background: rgba(139,92,246,0.1); color: #a78bfa; border: 1px solid rgba(139,92,246,0.2); }
.wr-collab-role.observer { background: rgba(255,255,255,0.06); color: var(--text-secondary); border: 1px solid var(--border-subtle); }
.wr-tlp-indicator {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: rgba(245,158,11,0.07);
  border: 1px solid rgba(245,158,11,0.2);
  border-radius: 7px;
  font-size: 11px;
  color: var(--text-secondary);
}

/* Chat mode toggle */
.wr-chat-mode-toggle {
  display: flex;
  background: rgba(0,0,0,0.3);
  border: 1px solid var(--border-subtle);
  border-radius: 7px;
  overflow: hidden;
  margin: 0 14px 8px;
  flex-shrink: 0;
}
.wr-chat-mode-btn {
  flex: 1;
  padding: 6px 8px;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  border: none;
  background: transparent;
  color: var(--text-muted);
  transition: all 0.15s;
  font-family: var(--font-display);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
}
.wr-chat-mode-btn.active {
  background: rgba(0,212,255,0.15);
  color: var(--cyan);
}
.wr-chat-mode-btn.active.internal {
  background: rgba(139,92,246,0.15);
  color: #a78bfa;
}
.wr-chat-internal-msg {
  display: flex;
  flex-direction: column;
  gap: 2px;
  padding: 8px 10px;
  background: rgba(139,92,246,0.07);
  border: 1px solid rgba(139,92,246,0.18);
  border-radius: 8px;
  margin-bottom: 6px;
}
.wr-chat-internal-msg .wr2-cop-msg-label { color: #a78bfa; }
.wr-chat-internal-msg .wr-chat-msg-text { font-size: 12px; color: var(--text-secondary); line-height: 1.4; }

/* ============================================================
   DETECTION RULES / MITRE HEATMAP
   ============================================================ */
.mitre-grid {
  display: grid;
  grid-template-columns: repeat(11, 1fr);
  gap: 3px;
}
.mitre-tactic {
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  border-radius: 4px;
  padding: 4px;
  text-align: center;
}
.mitre-tactic .tac-name { font-size: 9px; font-weight: 700; text-transform: uppercase; color: var(--text-muted); letter-spacing: 0.05em; }
.mitre-tech {
  width: 100%;
  height: 22px;
  border-radius: 3px;
  margin-top: 3px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 9px;
  cursor: pointer;
  transition: all var(--transition);
  overflow: hidden;
}
.mitre-tech.covered { background: rgba(0,212,255,0.15); border: 1px solid rgba(0,212,255,0.25); color: var(--cyan); }
.mitre-tech.partial { background: rgba(245,158,11,0.12); border: 1px solid rgba(245,158,11,0.2); color: var(--amber); }
.mitre-tech.empty { background: rgba(255,255,255,0.02); border: 1px solid var(--border-subtle); color: var(--text-muted); }
.mitre-tech:hover { transform: scale(1.05); z-index: 5; }

/* ============================================================
   INTEGRATIONS HUB
   ============================================================ */
.integrations-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 14px;
}
.integration-card {
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  padding: 18px;
  position: relative;
  transition: all var(--transition);
}
.integration-card:hover { border-color: rgba(0,212,255,0.15); transform: translateY(-2px); box-shadow: 0 8px 32px rgba(0,0,0,0.4), 0 0 40px rgba(0,212,255,0.03); }
.integration-card.connected { border-color: rgba(16,185,129,0.2); }
.integration-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
.integration-icon { width: 40px; height: 40px; border-radius: 9px; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: 700; }
.integration-name { font-size: 14px; font-weight: 700; color: var(--text-primary); }
.integration-vendor { font-size: 11px; color: var(--text-muted); }
.integration-stats { display: flex; gap: 12px; margin-top: 10px; }
.int-stat { flex: 1; }
.int-stat-val { font-family: var(--font-mono); font-size: 13px; font-weight: 600; color: var(--text-primary); }
.int-stat-lbl { font-size: 10px; color: var(--text-muted); }

/* ============================================================
   AI USAGE DASHBOARD
   ============================================================ */
.ai-provider-bar {
  display: flex;
  gap: 4px;
  height: 8px;
  border-radius: 4px;
  overflow: hidden;
  margin-top: 8px;
}
.ai-bar-seg { height: 100%; border-radius: 4px; }
.ai-legend { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 12px; }
.ai-legend-item { display: flex; align-items: center; gap: 6px; font-size: 11px; color: var(--text-secondary); }
.ai-dot { width: 8px; height: 8px; border-radius: 50%; }

/* ============================================================
   THREAT HUNTING
   ============================================================ */
.hunt-card {
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 9px;
  padding: 14px 16px;
  display: flex;
  align-items: center;
  gap: 14px;
  transition: all var(--transition);
  cursor: pointer;
  margin-bottom: 8px;
}
.hunt-card:hover { border-color: rgba(255,255,255,0.14); background: var(--bg-card-hover); }
.hunt-status-indicator { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.hunt-info { flex: 1; }
.hunt-title { font-size: 13px; font-weight: 600; color: var(--text-primary); }
.hunt-meta { font-size: 11px; color: var(--text-muted); margin-top: 2px; }
.hunt-stats { display: flex; gap: 16px; }
.hunt-stat { text-align: right; }
.hunt-stat-val { font-family: var(--font-mono); font-size: 13px; font-weight: 700; color: var(--text-primary); }
.hunt-stat-lbl { font-size: 9px; text-transform: uppercase; color: var(--text-muted); letter-spacing: 0.06em; }

/* ============================================================
   SHIFT HANDOVER
   ============================================================ */
.shift-header-bar {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
  margin-bottom: 20px;
}
.handover-note {
  padding: 14px;
  background: rgba(245,158,11,0.06);
  border: 1px solid rgba(245,158,11,0.2);
  border-radius: 8px;
  border-left: 3px solid var(--amber);
  font-size: 12.5px;
  color: var(--text-secondary);
  line-height: 1.6;
}

/* ============================================================
   AUDIT LOG
   ============================================================ */
.audit-row { font-family: var(--font-mono); font-size: 11px; }

/* ============================================================
   REPORT CARDS
   ============================================================ */
.report-card {
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 9px;
  padding: 16px;
  display: flex;
  align-items: center;
  gap: 14px;
  transition: all var(--transition);
  cursor: pointer;
  margin-bottom: 10px;
}
.report-card:hover { border-color: rgba(255,255,255,0.14); }
.report-icon { width: 42px; height: 42px; border-radius: 9px; display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0; }
.report-info { flex: 1; }
.report-title { font-size: 13px; font-weight: 600; color: var(--text-primary); }
.report-meta { font-size: 11px; color: var(--text-muted); margin-top: 2px; }

/* ============================================================
   RESPONSIVE GRID UTILS
   ============================================================ */
.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
.grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; }
.grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
.col-span-2 { grid-column: span 2; }

/* ============================================================
   MODAL
   ============================================================ */
.modal-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  backdrop-filter: blur(4px);
  z-index: 1000;
  align-items: center;
  justify-content: center;
}
.modal-overlay.open { display: flex; }
.modal-box {
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 12px;
  padding: 24px;
  max-width: 520px;
  width: 90%;
  box-shadow: 0 24px 80px rgba(0,0,0,0.8);
}
.modal-title { font-family: var(--font-display); font-size: 16px; font-weight: 700; margin-bottom: 16px; }
.modal-actions { display: flex; justify-content: flex-end; gap: 8px; margin-top: 20px; }

/* Scrollable sidebar nav */
#sidebar .sidebar-nav::-webkit-scrollbar { width: 3px; }
#sidebar .sidebar-nav::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); }

/* ============================================================
   DATA PRIVACY ENGINE â€” PAGE STYLES
   ============================================================ */

/* ---- Status indicator ---- */
.priv-status-indicator {
  display: inline-flex;
  align-items: center;
  gap: 7px;
  padding: 5px 12px;
  background: rgba(16,185,129,0.1);
  border: 1px solid rgba(16,185,129,0.3);
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  color: var(--green);
  letter-spacing: 0.03em;
}
.priv-status-dot {
  width: 7px;
  height: 7px;
  background: var(--green);
  border-radius: 50%;
  animation: priv-pulse-green 2s ease-in-out infinite;
}
@keyframes priv-pulse-green {
  0%, 100% { box-shadow: 0 0 0 0 rgba(16,185,129,0.6); opacity: 1; }
  50% { box-shadow: 0 0 0 5px rgba(16,185,129,0); opacity: 0.85; }
}

/* ---- Pipeline container ---- */
.privacy-pipeline {
  display: flex;
  align-items: flex-start;
  gap: 0;
  padding: 28px 20px;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 12px;
  overflow-x: auto;
  position: relative;
}
.privacy-pipeline::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 40px;
  right: 40px;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(0,212,255,0.15) 15%, rgba(0,212,255,0.15) 85%, transparent);
  transform: translateY(-50%);
  pointer-events: none;
  z-index: 0;
}

/* ---- Source / Sink nodes ---- */
.priv-io-node {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-width: 80px;
  z-index: 1;
  flex-shrink: 0;
}
.priv-io-box {
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  border-radius: 8px;
  padding: 10px 12px;
  text-align: center;
  font-size: 11px;
  color: var(--text-muted);
  white-space: nowrap;
}
.priv-io-icon { font-size: 22px; margin-bottom: 6px; display: block; }

/* ---- Pipeline stage ---- */
.pipeline-stage {
  display: flex;
  flex-direction: column;
  min-width: 200px;
  max-width: 220px;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  padding: 14px;
  position: relative;
  z-index: 1;
  flex-shrink: 0;
  transition: box-shadow 0.25s;
}
.pipeline-stage:hover {
  box-shadow: 0 0 24px rgba(0,212,255,0.08);
}
.pipeline-stage.stage-cyan  { border-left: 3px solid var(--cyan);   box-shadow: -4px 0 14px rgba(0,212,255,0.07); }
.pipeline-stage.stage-purple { border-left: 3px solid var(--purple); box-shadow: -4px 0 14px rgba(139,92,246,0.07); }
.pipeline-stage.stage-amber  { border-left: 3px solid var(--amber);  box-shadow: -4px 0 14px rgba(245,158,11,0.07); }
.pipeline-stage.stage-green  { border-left: 3px solid var(--green);  box-shadow: -4px 0 14px rgba(16,185,129,0.07); }
.pipeline-stage.stage-cyan:hover  { box-shadow: -4px 0 20px rgba(0,212,255,0.18), 0 0 30px rgba(0,212,255,0.06); }
.pipeline-stage.stage-purple:hover { box-shadow: -4px 0 20px rgba(139,92,246,0.18), 0 0 30px rgba(139,92,246,0.06); }
.pipeline-stage.stage-amber:hover  { box-shadow: -4px 0 20px rgba(245,158,11,0.18), 0 0 30px rgba(245,158,11,0.06); }
.pipeline-stage.stage-green:hover  { box-shadow: -4px 0 20px rgba(16,185,129,0.18), 0 0 30px rgba(16,185,129,0.06); }

.pipeline-stage-icon {
  font-size: 22px;
  margin-bottom: 4px;
}
.pipeline-stage-num {
  font-size: 9px;
  font-family: var(--font-mono);
  color: var(--text-muted);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  margin-bottom: 2px;
}
.pipeline-stage-title {
  font-family: var(--font-display);
  font-size: 12.5px;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 3px;
}
.pipeline-stage-sub {
  font-size: 10px;
  color: var(--text-muted);
  margin-bottom: 10px;
}
.pipeline-stage-body {
  display: flex;
  flex-direction: column;
  gap: 5px;
  flex: 1;
}
.pipeline-stage-badge {
  display: inline-flex;
  align-items: center;
  margin-top: 10px;
  padding: 3px 8px;
  border-radius: 10px;
  font-size: 9.5px;
  font-weight: 700;
  letter-spacing: 0.04em;
  align-self: flex-start;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  color: var(--text-secondary);
}

/* ---- Token mapping mini-table ---- */
.priv-token-map {
  background: var(--bg-elevated);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 6px;
  overflow: hidden;
  font-size: 10px;
  font-family: var(--font-mono);
}
.priv-token-map-row {
  display: flex;
  align-items: center;
  padding: 4px 7px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  gap: 5px;
}
.priv-token-map-row:last-child { border-bottom: none; }
.priv-token-orig { color: var(--text-muted); flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.priv-token-arrow { color: rgba(0,212,255,0.5); flex-shrink: 0; }
.priv-token-val { color: var(--cyan); flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

/* ---- Epsilon slider visual ---- */
.priv-epsilon-wrap {
  background: var(--bg-elevated);
  border: 1px solid rgba(139,92,246,0.2);
  border-radius: 6px;
  padding: 8px 10px;
  margin-bottom: 6px;
}
.priv-epsilon-label {
  display: flex;
  justify-content: space-between;
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-secondary);
  margin-bottom: 5px;
}
.priv-epsilon-val { color: var(--purple); font-weight: 700; }
.priv-epsilon-bar {
  height: 6px;
  background: rgba(139,92,246,0.15);
  border-radius: 3px;
  position: relative;
  overflow: hidden;
}
.priv-epsilon-fill {
  height: 100%;
  width: 40%;
  background: linear-gradient(90deg, var(--purple), rgba(139,92,246,0.5));
  border-radius: 3px;
}
.priv-epsilon-ticks {
  display: flex;
  justify-content: space-between;
  font-size: 8px;
  color: var(--text-muted);
  margin-top: 3px;
  font-family: var(--font-mono);
}

/* ---- Round badges in LLM stage ---- */
.priv-round-item {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  padding: 7px 8px;
  background: var(--bg-elevated);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 6px;
  position: relative;
}
.priv-round-num {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: rgba(245,158,11,0.15);
  border: 1px solid rgba(245,158,11,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 9px;
  font-weight: 700;
  color: var(--amber);
  flex-shrink: 0;
  margin-top: 1px;
}
.priv-round-model { font-size: 11px; font-weight: 700; color: var(--text-primary); line-height: 1.2; }
.priv-round-purpose { font-size: 9.5px; color: var(--text-muted); margin-top: 1px; }
.priv-round-conf {
  margin-left: auto;
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--amber);
  font-weight: 700;
  flex-shrink: 0;
}
.priv-round-arrow {
  text-align: center;
  font-size: 9px;
  color: rgba(245,158,11,0.4);
  height: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
}
.priv-flow-dot {
  position: absolute;
  width: 3px;
  height: 3px;
  background: var(--amber);
  border-radius: 50%;
  animation: priv-flow-down 1.5s linear infinite;
  opacity: 0.6;
}
@keyframes priv-flow-down {
  0% { top: -3px; opacity: 0; }
  20% { opacity: 0.7; }
  80% { opacity: 0.7; }
  100% { top: calc(100% + 3px); opacity: 0; }
}

/* ---- Pipeline connector (arrow between stages) ---- */
.pipeline-connector {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 4px;
  flex-shrink: 0;
  z-index: 2;
  position: relative;
  width: 36px;
  min-width: 36px;
  overflow: visible;
}
.pipeline-connector-line {
  position: relative;
  height: 2px;
  width: 100%;
  background: linear-gradient(90deg, rgba(0,212,255,0.12), rgba(0,212,255,0.45), rgba(0,212,255,0.12));
  border-radius: 1px;
  overflow: visible;
}
.pipeline-connector-arrow {
  position: absolute;
  right: -5px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-left: 7px solid rgba(0,212,255,0.7);
  border-top: 4px solid transparent;
  border-bottom: 4px solid transparent;
}
.pipeline-connector-dot {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: 4px;
  height: 4px;
  background: var(--cyan);
  border-radius: 50%;
  box-shadow: 0 0 6px var(--cyan);
  animation: priv-flow-right 2s linear infinite;
  opacity: 0;
}
.pipeline-connector-dot:nth-child(2) { animation-delay: 0.66s; }
.pipeline-connector-dot:nth-child(3) { animation-delay: 1.33s; }
@keyframes priv-flow-right {
  0% { left: -4px; opacity: 0; }
  10% { opacity: 0.9; }
  85% { opacity: 0.9; }
  100% { left: calc(100% + 4px); opacity: 0; }
}
.pipeline-connector-line.glow {
  animation: priv-connector-glow 3s ease-in-out infinite;
}
@keyframes priv-connector-glow {
  0%, 100% { box-shadow: 0 0 4px rgba(0,212,255,0.2); }
  50% { box-shadow: 0 0 10px rgba(0,212,255,0.5); }
}

/* ---- Classification table ---- */
.priv-class-table td.mono { font-family: var(--font-mono); font-size: 10px; }
.priv-risk-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: 10px;
  font-weight: 600;
  padding: 2px 8px;
  border-radius: 10px;
}
.priv-risk-critical { background: rgba(239,68,68,0.12); color: var(--red); border: 1px solid rgba(239,68,68,0.25); }
.priv-risk-safe     { background: rgba(16,185,129,0.12); color: var(--green); border: 1px solid rgba(16,185,129,0.25); }
.priv-risk-moderate { background: rgba(245,158,11,0.12); color: var(--amber); border: 1px solid rgba(245,158,11,0.25); }

/* ---- Compliance cards ---- */
.priv-compliance-item {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 11px 0;
  border-bottom: 1px solid var(--border-subtle);
}
.priv-compliance-item:last-child { border-bottom: none; }
.priv-compliance-badge {
  font-size: 10px;
  font-weight: 700;
  padding: 2px 8px;
  border-radius: 8px;
  flex-shrink: 0;
  margin-top: 1px;
}
.priv-compliance-badge.ok  { background: rgba(16,185,129,0.12); color: var(--green); border: 1px solid rgba(16,185,129,0.25); }
.priv-compliance-badge.wip { background: rgba(245,158,11,0.12); color: var(--amber); border: 1px solid rgba(245,158,11,0.25); }
.priv-compliance-badge.planned { background: rgba(59,130,246,0.12); color: var(--blue); border: 1px solid rgba(59,130,246,0.25); }
.priv-compliance-name { font-size: 12px; font-weight: 600; color: var(--text-primary); line-height: 1.2; }
.priv-compliance-note { font-size: 10.5px; color: var(--text-muted); margin-top: 2px; }

/* ---- Tenant isolation ---- */
.priv-tenant-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin-top: 4px;
}
.priv-tenant-item {
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 4px;
  transition: border-color 0.2s;
}
.priv-tenant-item:hover { border-color: rgba(0,212,255,0.2); }
.priv-tenant-name { font-size: 12px; font-weight: 700; color: var(--text-primary); }
.priv-tenant-ns { font-size: 10px; font-family: var(--font-mono); color: var(--cyan); }
.priv-tenant-badge {
  font-size: 9px;
  font-weight: 600;
  padding: 1px 6px;
  border-radius: 8px;
  background: rgba(16,185,129,0.1);
  border: 1px solid rgba(16,185,129,0.2);
  color: var(--green);
  align-self: flex-start;
  margin-top: 2px;
}

/* ---- Audit log entries ---- */
.priv-audit-item {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 10px 0;
  border-bottom: 1px solid var(--border-subtle);
}
.priv-audit-item:last-child { border-bottom: none; }
.priv-audit-ts {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-muted);
  flex-shrink: 0;
  min-width: 170px;
  padding-top: 1px;
}
.priv-audit-type {
  font-size: 10px;
  font-weight: 700;
  padding: 2px 7px;
  border-radius: 8px;
  flex-shrink: 0;
}
.priv-audit-type.tok  { background: rgba(0,212,255,0.1); color: var(--cyan); border: 1px solid rgba(0,212,255,0.2); }
.priv-audit-type.detok { background: rgba(139,92,246,0.1); color: var(--purple); border: 1px solid rgba(139,92,246,0.2); }
.priv-audit-type.query { background: rgba(16,185,129,0.1); color: var(--green); border: 1px solid rgba(16,185,129,0.2); }
.priv-audit-body { flex: 1; }
.priv-audit-main { font-size: 11.5px; color: var(--text-primary); line-height: 1.4; }
.priv-audit-meta { font-size: 10px; color: var(--text-muted); margin-top: 2px; }
.priv-audit-status {
  font-size: 9.5px;
  font-weight: 700;
  padding: 2px 7px;
  border-radius: 8px;
  flex-shrink: 0;
  background: rgba(16,185,129,0.1);
  color: var(--green);
  border: 1px solid rgba(16,185,129,0.2);
  align-self: flex-start;
}

/* ---- Tokenization chart area ---- */
.priv-chart-wrap {
  position: relative;
  height: 180px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.priv-chart-center {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
  pointer-events: none;
}
.priv-chart-center-val {
  font-family: var(--font-display);
  font-size: 22px;
  font-weight: 800;
  color: var(--text-primary);
  line-height: 1;
}
.priv-chart-center-lbl {
  font-size: 9px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-top: 2px;
}

/* ---- Privacy engine degrade on mobile ---- */
@media (max-width: 1100px) {
  .privacy-pipeline { flex-direction: column; align-items: stretch; }
  .privacy-pipeline::before { display: none; }
  .pipeline-connector { width: auto; min-width: unset; height: 24px; flex-direction: row; }
  .pipeline-connector-line { width: 2px; height: 100%; background: linear-gradient(180deg, rgba(0,212,255,0.12), rgba(0,212,255,0.45), rgba(0,212,255,0.12)); }
  .pipeline-stage { min-width: unset; max-width: unset; }
}

/* ============================================================
   INV-PIPELINE: Privacy Shield + 3-Round AI Pipeline Panel
   ============================================================ */
.inv-pipeline-shield {
  display: flex;
  align-items: center;
  gap: 0;
  height: 32px;
  padding: 0 14px;
  background: rgba(16,185,129,0.06);
  border: 1px solid rgba(16,185,129,0.2);
  border-left: 3px solid var(--green);
  border-radius: 6px;
  font-family: var(--font-mono);
  font-size: 11px;
  color: rgba(16,185,129,0.9);
  letter-spacing: 0.02em;
  box-shadow: 0 0 12px rgba(16,185,129,0.08);
  white-space: nowrap;
  overflow: hidden;
}
.inv-pipeline-shield-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--green);
  margin-right: 8px;
  box-shadow: 0 0 6px var(--green);
  animation: inv-shield-pulse 2s ease-in-out infinite;
  flex-shrink: 0;
}
@keyframes inv-shield-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}
.inv-pipeline-shield-text {
  overflow: hidden;
  text-overflow: ellipsis;
}
.inv-pipeline-shield-sep {
  margin: 0 8px;
  color: rgba(16,185,129,0.35);
}

.inv-pipeline-panel {
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  padding: 16px;
}
.inv-pipeline-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 14px;
}
.inv-pipeline-title {
  font-family: var(--font-display);
  font-size: 12px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-secondary);
}
.inv-pipeline-badge {
  font-family: var(--font-mono);
  font-size: 10px;
  font-weight: 600;
  padding: 2px 8px;
  border-radius: 4px;
  background: rgba(0,212,255,0.1);
  border: 1px solid rgba(0,212,255,0.25);
  color: var(--cyan);
  letter-spacing: 0.04em;
}

.inv-pipeline-flow {
  display: flex;
  align-items: stretch;
  gap: 0;
  overflow-x: auto;
  padding-bottom: 4px;
}
.inv-pipeline-stage {
  flex: 1;
  min-width: 120px;
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 8px;
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 4px;
  position: relative;
}
.inv-pipeline-stage.stage-tokenize  { border-left: 3px solid var(--cyan); }
.inv-pipeline-stage.stage-round1    { border-left: 3px solid #3b82f6; }
.inv-pipeline-stage.stage-round2    { border-left: 3px solid var(--purple); }
.inv-pipeline-stage.stage-round3    { border-left: 3px solid var(--amber); }
.inv-pipeline-stage.stage-detokenize { border-left: 3px solid var(--green); }

.inv-pipeline-stage-icon {
  font-size: 14px;
  line-height: 1;
  margin-bottom: 2px;
}
.inv-pipeline-stage-name {
  font-family: var(--font-display);
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--text-primary);
  line-height: 1.2;
}
.inv-pipeline-stage-sub {
  font-family: var(--font-mono);
  font-size: 9.5px;
  color: var(--text-secondary);
  line-height: 1.4;
}
.inv-pipeline-stage-metric {
  font-family: var(--font-mono);
  font-size: 9.5px;
  color: var(--text-secondary);
  line-height: 1.4;
}
.inv-pipeline-stage-status {
  margin-top: 4px;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-family: var(--font-mono);
  font-size: 9px;
  font-weight: 700;
  color: var(--green);
  letter-spacing: 0.04em;
}

.inv-pipeline-arrow {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 6px;
  font-size: 14px;
  color: var(--cyan);
  opacity: 0.7;
  flex-shrink: 0;
  align-self: center;
}

.inv-pipeline-summary {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 0;
  margin-top: 12px;
  padding: 8px 12px;
  background: rgba(0,212,255,0.04);
  border: 1px solid rgba(0,212,255,0.12);
  border-radius: 6px;
  font-family: var(--font-mono);
  font-size: 10.5px;
  color: var(--text-secondary);
}
.inv-pipeline-summary-sep {
  margin: 0 8px;
  color: rgba(255,255,255,0.2);
}
.inv-pipeline-summary-highlight {
  color: var(--cyan);
  font-weight: 700;
}
.inv-pipeline-summary-consensus {
  color: var(--green);
  font-weight: 700;
}

/* =====================================================
   TRIAGE QUEUE ENHANCEMENTS (.tq-)
   ===================================================== */
.tq-metrics { display:grid; grid-template-columns:repeat(4,1fr); gap:12px; margin-bottom:16px; }
.tq-metric { background:var(--bg-card); border:1px solid var(--border-card); border-radius:10px; padding:14px 16px; display:flex; align-items:center; gap:12px; }
.tq-metric-icon { width:36px; height:36px; border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:16px; flex-shrink:0; }
.tq-metric-body { flex:1; }
.tq-metric-value { font-family:var(--font-display); font-size:26px; font-weight:800; line-height:1; }
.tq-metric-label { font-size:11px; color:var(--text-muted); margin-top:3px; }
.tq-metric-sub { font-size:10px; color:var(--text-muted); margin-top:2px; }
.tq-metric.red .tq-metric-icon { background:rgba(239,68,68,0.12); }
.tq-metric.red .tq-metric-value { color:var(--red); }
.tq-metric.amber .tq-metric-icon { background:rgba(245,158,11,0.12); }
.tq-metric.amber .tq-metric-value { color:var(--amber); }
.tq-metric.cyan .tq-metric-icon { background:rgba(0,212,255,0.12); }
.tq-metric.cyan .tq-metric-value { color:var(--cyan); }
.tq-metric.green .tq-metric-icon { background:rgba(16,185,129,0.12); }
.tq-metric.green .tq-metric-value { color:var(--green); }

/* AI verdict badges */
.tq-verdict { display:inline-flex; align-items:center; gap:4px; padding:2px 7px; border-radius:4px; font-size:10px; font-weight:700; letter-spacing:0.03em; white-space:nowrap; }
.tq-verdict.tp { background:rgba(239,68,68,0.18); color:#ff7b7b; border:1px solid rgba(239,68,68,0.3); }
.tq-verdict.fp { background:rgba(156,163,175,0.15); color:#9ca3af; border:1px solid rgba(156,163,175,0.25); }
.tq-verdict.btp { background:rgba(245,158,11,0.18); color:var(--amber); border:1px solid rgba(245,158,11,0.3); }
.tq-verdict.inv { background:rgba(59,130,246,0.18); color:#60a5fa; border:1px solid rgba(59,130,246,0.3); }
.tq-verdict-conf { font-size:9px; opacity:0.8; }

/* SLA countdown colors */
.tq-sla-red { color:var(--red); font-family:var(--font-mono); font-size:11px; font-weight:700; }
.tq-sla-amber { color:var(--amber); font-family:var(--font-mono); font-size:11px; font-weight:600; }
.tq-sla-green { color:var(--green); font-family:var(--font-mono); font-size:11px; }
.tq-sla-grey { color:var(--text-muted); font-family:var(--font-mono); font-size:11px; }

/* Triage table row checkbox */
.tq-cb { width:14px; height:14px; border:1px solid var(--border-card); border-radius:3px; cursor:pointer; accent-color:var(--cyan); }

/* Filter bar bulk actions */
.tq-bulk-select { background:var(--bg-elevated); border:1px solid var(--border-card); color:var(--text-primary); font-size:12px; padding:5px 10px; border-radius:6px; cursor:pointer; }

/* Summary bar */
.tq-summary { padding:10px 16px; background:var(--bg-surface); border:1px solid var(--border-subtle); border-radius:0 0 10px 10px; font-size:11px; color:var(--text-muted); display:flex; align-items:center; gap:12px; }
.tq-summary span { color:var(--text-secondary); }
.tq-summary .sep { color:var(--border-card); }

/* Pulse dot for P1 */
@keyframes tq-pulse-red { 0%,100%{box-shadow:0 0 0 0 rgba(239,68,68,0.6)} 50%{box-shadow:0 0 0 5px rgba(239,68,68,0)} }
.tq-pulse { animation: tq-pulse-red 1.5s ease-in-out infinite; }

/* =====================================================
   RESPONSE CENTER ENHANCEMENTS (.resp-)
   ===================================================== */
.resp-playbook { background:var(--bg-card); border:1px solid rgba(0,212,255,0.2); border-radius:10px; padding:16px; margin-bottom:16px; }
.resp-playbook-header { display:flex; align-items:flex-start; justify-content:space-between; margin-bottom:14px; }
.resp-pb-title { font-family:var(--font-display); font-size:14px; font-weight:700; color:var(--text-primary); }
.resp-pb-sub { font-size:11px; color:var(--text-muted); margin-top:3px; font-family:var(--font-mono); }
.resp-pb-badge { background:rgba(0,212,255,0.1); border:1px solid rgba(0,212,255,0.25); color:var(--cyan); font-size:10px; font-weight:700; padding:3px 10px; border-radius:20px; white-space:nowrap; }

/* Phase list */
.resp-phases { display:flex; flex-direction:column; gap:0; }
.resp-phase { display:flex; gap:14px; padding:10px 0; border-left:2px solid var(--border-subtle); margin-left:10px; padding-left:16px; position:relative; }
.resp-phase:last-child { border-left-color:transparent; }
.resp-phase-dot { width:14px; height:14px; border-radius:50%; position:absolute; left:-8px; top:12px; border:2px solid var(--bg-card); flex-shrink:0; }
.resp-phase-dot.done { background:var(--green); }
.resp-phase-dot.active { background:var(--amber); animation:tq-pulse-amber 1.5s ease-in-out infinite; }
.resp-phase-dot.pending { background:var(--bg-elevated); border:2px solid var(--border-card); }
@keyframes tq-pulse-amber { 0%,100%{box-shadow:0 0 0 0 rgba(245,158,11,0.6)} 50%{box-shadow:0 0 0 5px rgba(245,158,11,0)} }

.resp-phase-body { flex:1; }
.resp-phase-header { display:flex; align-items:center; gap:8px; margin-bottom:4px; }
.resp-phase-num { font-size:10px; color:var(--text-muted); font-family:var(--font-mono); }
.resp-phase-name { font-size:12px; font-weight:700; color:var(--text-primary); }
.resp-phase-status { font-size:10px; font-weight:700; margin-left:auto; }
.resp-phase-status.done { color:var(--green); }
.resp-phase-status.active { color:var(--amber); }
.resp-phase-status.pending { color:var(--text-muted); }
.resp-phase-status.dur { color:var(--text-muted); font-family:var(--font-mono); font-size:10px; }
.resp-phase-detail { font-size:11px; color:var(--text-secondary); line-height:1.6; padding-left:2px; }
.resp-phase-detail li { list-style:none; padding:0; display:flex; align-items:center; gap:6px; }
.resp-phase-detail li::before { content:"â€º"; color:var(--text-muted); }

/* AI confidence overlay badge */
.resp-ai-overlay { display:inline-flex; align-items:center; gap:8px; padding:8px 12px; background:rgba(139,92,246,0.1); border:1px solid rgba(139,92,246,0.25); border-radius:8px; font-size:11px; }
.resp-ai-overlay-label { color:var(--text-muted); }
.resp-ai-overlay-rec { color:var(--purple); font-weight:600; }
.resp-ai-overlay-conf { background:rgba(139,92,246,0.2); color:var(--purple); font-weight:800; font-size:10px; padding:2px 7px; border-radius:4px; font-family:var(--font-mono); }

/* =====================================================
   CLIENT PORTAL ENHANCEMENTS (.cp-)
   ===================================================== */
.cp-sla-card { background:var(--bg-card); border:1px solid var(--border-card); border-radius:10px; padding:16px; margin-bottom:12px; }
.cp-sla-title { font-size:13px; font-weight:700; color:var(--text-primary); margin-bottom:12px; }
.cp-sla-row { display:flex; align-items:center; gap:10px; margin-bottom:8px; }
.cp-sla-label { font-size:11px; color:var(--text-secondary); width:200px; flex-shrink:0; }
.cp-sla-bar-wrap { flex:1; }
.cp-sla-bar { height:5px; background:var(--bg-elevated); border-radius:3px; overflow:hidden; margin-bottom:3px; }
.cp-sla-fill { height:100%; border-radius:3px; background:var(--green); }
.cp-sla-meta { display:flex; justify-content:space-between; font-size:10px; }
.cp-sla-val { color:var(--text-primary); font-family:var(--font-mono); font-weight:600; }
.cp-sla-target { color:var(--green); }

.cp-summary-card { background:var(--bg-card); border:1px solid var(--border-card); border-radius:10px; padding:16px; margin-bottom:12px; }
.cp-summary-title { font-size:13px; font-weight:700; color:var(--text-primary); margin-bottom:12px; display:flex; align-items:center; justify-content:space-between; }
.cp-summary-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:8px; }
.cp-summary-item { background:var(--bg-base); border:1px solid var(--border-subtle); border-radius:7px; padding:10px 12px; }
.cp-summary-item-label { font-size:10px; color:var(--text-muted); margin-bottom:3px; }
.cp-summary-item-val { font-size:18px; font-weight:800; font-family:var(--font-display); color:var(--text-primary); }
.cp-summary-item-pct { font-size:10px; color:var(--text-muted); }
.cp-summary-item.tp .cp-summary-item-val { color:var(--green); }
.cp-summary-item.fp .cp-summary-item-val { color:var(--amber); }
.cp-summary-item.btp .cp-summary-item-val { color:var(--cyan); }

.cp-privacy-banner { border-left:3px solid var(--green); background:rgba(16,185,129,0.06); border-radius:0 7px 7px 0; padding:10px 14px; font-size:11px; color:var(--text-secondary); line-height:1.6; margin-top:12px; }
.cp-privacy-banner strong { color:var(--green); }

/* ============================================================
   ENTITY DRILL-DOWN PANEL
   ============================================================ */
.entity-panel-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  z-index: 2000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}
.entity-panel-backdrop.open {
  opacity: 1;
  visibility: visible;
}
.entity-panel {
  position: fixed;
  top: 0;
  right: 0;
  width: 520px;
  max-width: 95vw;
  height: 100vh;
  background: var(--bg-surface);
  border-left: 1px solid rgba(0,212,255,0.15);
  box-shadow: -8px 0 60px rgba(0,0,0,0.6), -2px 0 20px rgba(0,212,255,0.06);
  z-index: 2001;
  transform: translateX(100%);
  transition: transform 0.35s cubic-bezier(0.16,1,0.3,1);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}
.entity-panel.open {
  transform: translateX(0);
}
.entity-panel-header {
  padding: 16px 20px;
  border-bottom: 1px solid var(--border-subtle);
  flex-shrink: 0;
  display: flex;
  align-items: center;
  gap: 12px;
  background: rgba(0,212,255,0.02);
}
.entity-panel-icon {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  background: var(--cyan-dim);
  border: 1px solid var(--border-accent);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  flex-shrink: 0;
}
.entity-panel-title-wrap { flex: 1; min-width: 0; }
.entity-panel-name {
  font-family: var(--font-display);
  font-size: 15px;
  font-weight: 700;
  color: var(--text-primary);
  letter-spacing: -0.01em;
}
.entity-panel-type {
  display: inline-flex;
  padding: 2px 8px;
  background: var(--cyan-dim);
  color: var(--cyan);
  font-size: 10px;
  font-weight: 700;
  border-radius: 4px;
  margin-top: 3px;
  letter-spacing: 0.05em;
}
.entity-panel-risk {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-display);
  font-size: 16px;
  font-weight: 800;
  flex-shrink: 0;
  position: relative;
}
.entity-panel-risk.risk-red {
  background: conic-gradient(var(--red) calc(var(--risk-pct) * 3.6deg), rgba(239,68,68,0.12) 0);
  color: #ff6b6b;
}
.entity-panel-risk-inner {
  width: 38px;
  height: 38px;
  border-radius: 50%;
  background: var(--bg-surface);
  display: flex;
  align-items: center;
  justify-content: center;
}
.entity-panel-close {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  background: rgba(255,255,255,0.05);
  border: 1px solid var(--border-card);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: var(--text-muted);
  font-size: 14px;
  transition: all var(--transition);
  flex-shrink: 0;
}
.entity-panel-close:hover { background: rgba(239,68,68,0.15); color: var(--red-bright); border-color: rgba(239,68,68,0.3); }

.entity-panel-timerange {
  display: flex;
  gap: 2px;
  padding: 8px 20px;
  border-bottom: 1px solid var(--border-subtle);
  flex-shrink: 0;
  background: rgba(0,0,0,0.15);
}
.entity-panel-timerange button {
  padding: 4px 12px;
  border-radius: 4px;
  border: 1px solid transparent;
  background: transparent;
  color: var(--text-muted);
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  transition: all var(--transition);
}
.entity-panel-timerange button:hover { color: var(--text-primary); background: rgba(255,255,255,0.04); }
.entity-panel-timerange button.active {
  background: var(--cyan-dim);
  color: var(--cyan);
  border-color: var(--border-accent);
}

.entity-panel-body {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 16px 20px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}
.entity-panel-body::-webkit-scrollbar { width: 5px; }
.entity-panel-body::-webkit-scrollbar-thumb { background: rgba(0,212,255,0.15); border-radius: 3px; }
.entity-panel-body::-webkit-scrollbar-thumb:hover { background: rgba(0,212,255,0.3); }

.ep-section-title {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--text-muted);
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.ep-section-title::after {
  content: '';
  flex: 1;
  height: 1px;
  background: var(--border-subtle);
}

/* Entity Profile grid */
.ep-profile-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px;
}
.ep-profile-item {
  padding: 6px 10px;
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: 6px;
}
.ep-profile-label {
  font-size: 9px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-muted);
  margin-bottom: 2px;
}
.ep-profile-value {
  font-size: 11px;
  color: var(--text-primary);
  font-weight: 500;
}
.ep-profile-value.mono { font-family: var(--font-mono); font-size: 10px; color: var(--cyan); }

/* Risk Timeline bar chart */
.ep-risk-chart {
  display: flex;
  align-items: flex-end;
  gap: 6px;
  height: 80px;
  padding: 8px 0;
}
.ep-risk-bar-wrap {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  height: 100%;
}
.ep-risk-bar {
  flex: 1;
  width: 100%;
  border-radius: 3px 3px 0 0;
  display: flex;
  align-items: flex-end;
  position: relative;
}
.ep-risk-bar-fill {
  width: 100%;
  border-radius: 3px 3px 0 0;
  transition: height 0.6s cubic-bezier(0.34,1.56,0.64,1);
  position: absolute;
  bottom: 0;
}
.ep-risk-bar-fill.green { background: var(--green); box-shadow: 0 0 8px rgba(16,185,129,0.3); }
.ep-risk-bar-fill.amber { background: var(--amber); box-shadow: 0 0 8px rgba(245,158,11,0.3); }
.ep-risk-bar-fill.red { background: var(--red); box-shadow: 0 0 8px rgba(239,68,68,0.3); }
.ep-risk-bar-label {
  font-size: 9px;
  color: var(--text-muted);
  font-weight: 600;
}
.ep-risk-bar-value {
  font-size: 9px;
  font-family: var(--font-mono);
  color: var(--text-secondary);
  position: absolute;
  top: -14px;
  width: 100%;
  text-align: center;
}

/* Activity Timeline */
.ep-timeline {
  display: flex;
  flex-direction: column;
  gap: 0;
  max-height: 340px;
  overflow-y: auto;
}
.ep-timeline::-webkit-scrollbar { width: 3px; }
.ep-timeline::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 2px; }
.ep-timeline-item {
  display: flex;
  gap: 10px;
  padding: 8px 0;
  border-bottom: 1px solid var(--border-subtle);
  cursor: pointer;
  transition: background var(--transition);
  padding-left: 4px;
  border-radius: 4px;
}
.ep-timeline-item:hover { background: rgba(255,255,255,0.02); }
.ep-timeline-item:last-child { border-bottom: none; }
.ep-timeline-time {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-muted);
  min-width: 56px;
  flex-shrink: 0;
  padding-top: 1px;
}
.ep-timeline-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
  margin-top: 3px;
}
.ep-timeline-dot.red { background: var(--red); box-shadow: 0 0 6px rgba(239,68,68,0.5); }
.ep-timeline-dot.amber { background: var(--amber); box-shadow: 0 0 6px rgba(245,158,11,0.5); }
.ep-timeline-dot.green { background: var(--green); box-shadow: 0 0 6px rgba(16,185,129,0.4); }
.ep-timeline-dot.gray { background: var(--text-muted); }
.ep-timeline-content { flex: 1; min-width: 0; }
.ep-timeline-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-primary);
  line-height: 1.3;
}
.ep-timeline-desc {
  font-size: 10px;
  color: var(--text-muted);
  line-height: 1.4;
  margin-top: 2px;
}
.ep-timeline-detail {
  display: none;
  font-size: 10px;
  color: var(--text-secondary);
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: 5px;
  padding: 8px 10px;
  margin-top: 6px;
  line-height: 1.5;
  font-family: var(--font-mono);
}
.ep-timeline-item.expanded .ep-timeline-detail { display: block; }

/* Connected Entities */
.ep-connections {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.ep-connection {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 7px 10px;
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: 6px;
  font-size: 11px;
  transition: all var(--transition);
  cursor: pointer;
}
.ep-connection:hover { border-color: var(--border-accent); background: var(--bg-card-hover); }
.ep-connection-dir {
  font-family: var(--font-mono);
  color: var(--cyan);
  font-size: 12px;
  flex-shrink: 0;
}
.ep-connection-host {
  font-weight: 600;
  color: var(--text-primary);
  font-family: var(--font-mono);
  font-size: 10px;
}
.ep-connection-detail {
  font-size: 10px;
  color: var(--text-muted);
}
.ep-connection-risk {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  margin-left: auto;
  flex-shrink: 0;
}
.ep-connection-risk.red { background: var(--red); box-shadow: 0 0 5px rgba(239,68,68,0.5); }
.ep-connection-risk.amber { background: var(--amber); box-shadow: 0 0 5px rgba(245,158,11,0.5); }
.ep-connection-risk.green { background: var(--green); box-shadow: 0 0 5px rgba(16,185,129,0.4); }

/* Associated Alerts */
.ep-alerts {
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.ep-alert-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  background: var(--bg-card);
  border: 1px solid var(--border-subtle);
  border-radius: 6px;
  transition: all var(--transition);
  cursor: pointer;
}
.ep-alert-item:hover { border-color: var(--border-accent); }
.ep-alert-id {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--cyan);
  min-width: 72px;
}
.ep-alert-title {
  flex: 1;
  font-size: 11px;
  color: var(--text-primary);
  font-weight: 500;
}
.ep-alert-status {
  font-size: 9px;
  font-weight: 700;
  padding: 2px 7px;
  border-radius: 4px;
}
.ep-alert-status.active { background: rgba(239,68,68,0.12); color: var(--red-bright); border: 1px solid rgba(239,68,68,0.25); }
.ep-alert-status.investigating { background: rgba(139,92,246,0.12); color: #a78bfa; border: 1px solid rgba(139,92,246,0.25); }
.ep-alert-status.resolved { background: rgba(100,116,139,0.12); color: #94a3b8; border: 1px solid rgba(100,116,139,0.2); }

/* Clickable entity references */
.entity-ref {
  color: var(--cyan);
  cursor: pointer;
  border-bottom: 1px dashed rgba(0,212,255,0.3);
  transition: all var(--transition);
}
.entity-ref:hover {
  color: var(--cyan-bright);
  border-bottom-color: var(--cyan);
  text-shadow: 0 0 8px rgba(0,212,255,0.25);
}

/* ============================================================
   ENTITY EXPLORER PAGE
   ============================================================ */
#page-entities { padding: 16px; }

/* Search & Filters Bar */
.ee-topbar {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
  margin-bottom: 16px;
}
.ee-search-wrap {
  flex: 1;
  min-width: 280px;
  position: relative;
}
.ee-search-icon {
  position: absolute;
  left: 14px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-muted);
  font-size: 15px;
  pointer-events: none;
}
.ee-search {
  width: 100%;
  padding: 10px 14px 10px 40px;
  background: rgba(17,24,39,0.7);
  backdrop-filter: blur(12px);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  color: var(--text-primary);
  font-size: 13px;
  outline: none;
  transition: all var(--transition);
}
.ee-search:focus {
  border-color: var(--cyan);
  box-shadow: 0 0 20px rgba(0,212,255,0.15), inset 0 0 20px rgba(0,212,255,0.03);
}
.ee-search::placeholder { color: var(--text-muted); }

.ee-filters {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}
.ee-chip {
  padding: 6px 14px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  font-family: var(--font-body);
  color: var(--text-secondary);
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  cursor: pointer;
  transition: all var(--transition);
  white-space: nowrap;
}
.ee-chip:hover { border-color: var(--border-accent); color: var(--text-primary); }
.ee-chip.active {
  background: var(--cyan-dim);
  border-color: var(--cyan);
  color: var(--cyan);
  box-shadow: 0 0 12px rgba(0,212,255,0.2);
}

.ee-time-filters { display: flex; gap: 4px; }
.ee-time-chip {
  padding: 5px 12px;
  border-radius: 6px;
  font-size: 10px;
  font-weight: 600;
  font-family: var(--font-mono);
  color: var(--text-muted);
  background: transparent;
  border: 1px solid var(--border-subtle);
  cursor: pointer;
  transition: all var(--transition);
}
.ee-time-chip:hover { color: var(--text-secondary); border-color: var(--border-card); }
.ee-time-chip.active {
  background: var(--bg-elevated);
  border-color: var(--cyan);
  color: var(--cyan);
}

.ee-sort-select {
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 11px;
  font-family: var(--font-body);
  color: var(--text-secondary);
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  cursor: pointer;
  outline: none;
}
.ee-sort-select:focus { border-color: var(--border-accent); }

/* Split Layout */
.ee-split {
  display: flex;
  gap: 16px;
  height: calc(100vh - 220px);
  min-height: 500px;
}

/* Entity Catalog */
.ee-catalog {
  width: 38%;
  min-width: 320px;
  display: flex;
  flex-direction: column;
  gap: 0;
}
.ee-catalog-header {
  font-family: var(--font-display);
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.ee-catalog-count {
  font-family: var(--font-mono);
  color: var(--cyan);
  font-size: 11px;
}
.ee-catalog-list {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding-right: 4px;
}

/* Entity Card */
.ee-card {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  background: rgba(17,24,39,0.6);
  backdrop-filter: blur(8px);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  cursor: pointer;
  transition: all var(--transition);
  position: relative;
  overflow: hidden;
}
.ee-card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, transparent 60%, rgba(0,212,255,0.03));
  opacity: 0;
  transition: opacity var(--transition);
}
.ee-card:hover {
  border-color: var(--border-accent);
  background: rgba(17,24,39,0.85);
  transform: translateY(-1px);
  box-shadow: 0 4px 20px rgba(0,0,0,0.3), 0 0 15px rgba(0,212,255,0.05);
}
.ee-card:hover::before { opacity: 1; }
.ee-card.selected {
  border-color: var(--cyan);
  box-shadow: 0 0 20px rgba(0,212,255,0.2), inset 0 0 30px rgba(0,212,255,0.03);
  background: rgba(0,212,255,0.06);
}
.ee-card-icon {
  width: 36px;
  height: 36px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  flex-shrink: 0;
}
.ee-card-icon.host { background: rgba(0,212,255,0.12); }
.ee-card-icon.ip { background: var(--purple-dim); }
.ee-card-icon.user { background: var(--green-dim); }
.ee-card-icon.domain { background: var(--amber-dim); }
.ee-card-icon.process { background: var(--orange-dim); }
.ee-card-icon.malicious { background: var(--red-dim); }

.ee-card-info { flex: 1; min-width: 0; position: relative; z-index: 1; }
.ee-card-name {
  font-family: var(--font-mono);
  font-size: 12px;
  font-weight: 500;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.ee-card-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 3px;
}
.ee-card-type {
  font-size: 10px;
  font-weight: 600;
  padding: 1px 6px;
  border-radius: 4px;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}
.ee-card-type.host { background: rgba(0,212,255,0.12); color: var(--cyan); }
.ee-card-type.ip { background: var(--purple-dim); color: var(--purple); }
.ee-card-type.user { background: var(--green-dim); color: var(--green); }
.ee-card-type.domain { background: var(--amber-dim); color: var(--amber); }
.ee-card-type.process { background: var(--orange-dim); color: var(--orange); }

.ee-card-lastseen { font-size: 10px; color: var(--text-muted); font-family: var(--font-mono); }

.ee-card-stats {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 4px;
  flex-shrink: 0;
  position: relative;
  z-index: 1;
}
.ee-risk-badge {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 700;
  font-family: var(--font-mono);
  position: relative;
}
.ee-risk-badge.risk-critical {
  background: rgba(239,68,68,0.15);
  color: var(--red);
  box-shadow: 0 0 12px rgba(239,68,68,0.3);
  animation: riskPulse 2s ease-in-out infinite;
}
.ee-risk-badge.risk-high {
  background: rgba(249,115,22,0.15);
  color: var(--orange);
  box-shadow: 0 0 8px rgba(249,115,22,0.2);
}
.ee-risk-badge.risk-medium {
  background: rgba(245,158,11,0.15);
  color: var(--amber);
}
.ee-risk-badge.risk-low {
  background: rgba(16,185,129,0.12);
  color: var(--green);
}
@keyframes riskPulse {
  0%, 100% { box-shadow: 0 0 12px rgba(239,68,68,0.3); }
  50% { box-shadow: 0 0 24px rgba(239,68,68,0.5); }
}
.ee-card-counts {
  display: flex;
  gap: 8px;
  font-size: 10px;
  color: var(--text-muted);
}
.ee-card-counts span { display: flex; align-items: center; gap: 2px; }

/* Canvas Container */
.ee-canvas-wrap {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0;
}
.ee-canvas-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 10px;
  flex-wrap: wrap;
  gap: 8px;
}
.ee-canvas-title {
  font-family: var(--font-display);
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}
.ee-canvas-controls {
  display: flex;
  align-items: center;
  gap: 6px;
}
.ee-canvas-btn {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  color: var(--text-secondary);
  font-size: 13px;
  cursor: pointer;
  transition: all var(--transition);
}
.ee-canvas-btn:hover { border-color: var(--border-accent); color: var(--cyan); }
.ee-canvas-btn.active { background: var(--cyan-dim); border-color: var(--cyan); color: var(--cyan); }
.ee-toggle-physics {
  padding: 4px 10px;
  border-radius: 6px;
  font-size: 10px;
  font-weight: 600;
  font-family: var(--font-mono);
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  color: var(--text-secondary);
  cursor: pointer;
  transition: all var(--transition);
}
.ee-toggle-physics:hover { border-color: var(--border-accent); color: var(--text-primary); }
.ee-toggle-physics.active { background: var(--cyan-dim); border-color: var(--cyan); color: var(--cyan); }

.ee-legend {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}
.ee-legend-item {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 10px;
  color: var(--text-muted);
  cursor: pointer;
  transition: color var(--transition);
}
.ee-legend-item:hover { color: var(--text-secondary); }
.ee-legend-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
}

.ee-canvas-container {
  flex: 1;
  position: relative;
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid var(--border-card);
  background:
    linear-gradient(rgba(0,212,255,0.02) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,212,255,0.02) 1px, transparent 1px),
    var(--bg-surface);
  background-size: 40px 40px, 40px 40px, 100% 100%;
  box-shadow: inset 0 0 60px rgba(0,0,0,0.3), 0 0 30px rgba(0,0,0,0.2);
}
.ee-canvas-container canvas {
  display: block;
  width: 100%;
  height: 100%;
}

/* Entity Detail Panel (Bottom) */
.ee-detail-panel {
  margin-top: 16px;
  background: rgba(17,24,39,0.7);
  backdrop-filter: blur(12px);
  border: 1px solid var(--border-card);
  border-radius: 12px;
  padding: 16px 20px;
  display: none;
  animation: fadeIn 0.25s ease;
}
.ee-detail-panel.visible { display: block; }
.ee-detail-header {
  display: flex;
  align-items: center;
  gap: 14px;
  margin-bottom: 14px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border-subtle);
}
.ee-detail-icon {
  width: 44px;
  height: 44px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
}
.ee-detail-name {
  font-family: var(--font-mono);
  font-size: 16px;
  font-weight: 600;
  color: var(--text-primary);
}
.ee-detail-type-badge {
  font-size: 10px;
  font-weight: 600;
  padding: 2px 8px;
  border-radius: 4px;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  margin-top: 2px;
  display: inline-block;
}
.ee-detail-risk-wrap {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 12px;
}
.ee-detail-risk-score {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  font-weight: 800;
  font-family: var(--font-mono);
}
.ee-detail-sparkline {
  width: 80px;
  height: 32px;
}
.ee-detail-close {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  color: var(--text-muted);
  cursor: pointer;
  font-size: 13px;
  transition: all var(--transition);
}
.ee-detail-close:hover { border-color: var(--red); color: var(--red); }

.ee-detail-body {
  display: grid;
  grid-template-columns: 1fr 1.5fr 1fr;
  gap: 16px;
}
.ee-detail-section-title {
  font-family: var(--font-display);
  font-size: 11px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-bottom: 10px;
}
.ee-profile-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px;
}
.ee-profile-item {}
.ee-profile-label { font-size: 9px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; }
.ee-profile-value { font-size: 11px; color: var(--text-primary); font-family: var(--font-mono); margin-top: 1px; }

.ee-alert-row {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 0;
  border-bottom: 1px solid var(--border-subtle);
  font-size: 11px;
}
.ee-alert-row:last-child { border-bottom: none; }
.ee-alert-sev {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  flex-shrink: 0;
}
.ee-alert-name { flex: 1; color: var(--text-secondary); }
.ee-alert-time { font-family: var(--font-mono); color: var(--text-muted); font-size: 10px; }

.ee-actions {
  display: flex;
  flex-direction: column;
  gap: 6px;
  align-self: start;
}
.ee-action-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 7px 14px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: 600;
  border: 1px solid var(--border-card);
  background: var(--bg-card);
  color: var(--text-secondary);
  cursor: pointer;
  transition: all var(--transition);
  white-space: nowrap;
}
.ee-action-btn:hover {
  border-color: var(--border-accent);
  color: var(--text-primary);
  box-shadow: 0 0 12px rgba(0,212,255,0.08);
}
.ee-action-btn.primary {
  background: linear-gradient(135deg, var(--cyan), #00b8d9);
  border-color: transparent;
  color: #000;
  font-weight: 700;
}
.ee-action-btn.primary:hover {
  box-shadow: 0 0 20px rgba(0,212,255,0.3);
}
.ee-action-btn.danger {
  border-color: rgba(239,68,68,0.3);
  color: var(--red-bright);
}
.ee-action-btn.danger:hover {
  background: var(--red-dim);
  box-shadow: 0 0 12px rgba(239,68,68,0.15);
}

/* Tooltip for canvas nodes */
.ee-tooltip {
  position: absolute;
  pointer-events: none;
  background: rgba(13,18,32,0.95);
  backdrop-filter: blur(12px);
  border: 1px solid var(--border-accent);
  border-radius: 8px;
  padding: 10px 14px;
  z-index: 100;
  display: none;
  box-shadow: 0 8px 32px rgba(0,0,0,0.5), 0 0 20px rgba(0,212,255,0.1);
  min-width: 180px;
}
.ee-tooltip.visible { display: block; }
.ee-tooltip-name {
  font-family: var(--font-mono);
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 4px;
}
.ee-tooltip-type {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  margin-bottom: 6px;
}
.ee-tooltip-stats {
  display: flex;
  gap: 12px;
  font-size: 10px;
  color: var(--text-muted);
}
.ee-tooltip-stats span { display: flex; align-items: center; gap: 3px; }

/* ============================================================
   COMMAND CENTER DASHBOARD
   ============================================================ */
.cc-greeting-bar {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 20px;
  padding: 0 4px;
}
.cc-greeting-left {}
.cc-greeting-title {
  font-family: var(--font-display);
  font-size: 20px;
  font-weight: 700;
  color: var(--text-primary);
  letter-spacing: -0.02em;
  margin: 0;
}
.cc-greeting-sub {
  font-family: var(--font-body);
  font-size: 12px;
  color: var(--text-muted);
  margin-top: 2px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}
.cc-greeting-right {
  display: flex;
  align-items: center;
  gap: 16px;
}
/* Command Bar */
.cc-command-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding: 10px 16px;
  background: rgba(17, 24, 39, 0.6);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--border-card);
  border-radius: 10px;
}
.cc-command-left {
  display: flex;
  align-items: center;
  gap: 20px;
}
.cc-brand-mark {
  display: flex;
  align-items: center;
  gap: 10px;
}
.cc-brand-icon {
  width: 28px;
  height: 28px;
  background: linear-gradient(135deg, #00d4ff, #0088cc);
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  color: #fff;
  font-weight: 700;
}
.cc-brand-name {
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 700;
  color: var(--cyan);
  letter-spacing: 0.06em;
  text-transform: uppercase;
}
.cc-brand-org {
  font-family: var(--font-body);
  font-size: 9px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-top: 1px;
}
.cc-status-pills {
  display: flex;
  align-items: center;
  gap: 8px;
}
.cc-status-pill {
  display: flex;
  align-items: center;
  gap: 5px;
  font-family: var(--font-mono);
  font-size: 9px;
  color: var(--text-secondary);
  border: 1px solid var(--border-card);
  border-radius: 20px;
  padding: 3px 10px;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}
.cc-status-pill.green { border-color: rgba(16,185,129,0.3); color: var(--green); }
.cc-status-pill.cyan { border-color: rgba(0,212,255,0.2); color: var(--cyan); }
.cc-status-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: inline-block;
  flex-shrink: 0;
}
.cc-status-dot.green { background: var(--green); box-shadow: 0 0 6px var(--green); }
.cc-status-dot.cyan { background: var(--cyan); box-shadow: 0 0 6px var(--cyan); }
.cc-command-right {
  display: flex;
  align-items: center;
  gap: 12px;
}
.cc-view-toggle {
  display: flex;
  align-items: center;
  gap: 6px;
  font-family: var(--font-body);
  font-size: 11px;
  color: var(--text-secondary);
  background: transparent;
  border: 1px solid var(--border-card);
  border-radius: 6px;
  padding: 6px 12px;
  transition: var(--transition);
}
.cc-view-toggle:hover { border-color: var(--cyan); color: var(--cyan); }
.cc-time-filter {
  display: flex;
  align-items: center;
  gap: 6px;
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--text-secondary);
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 6px;
  padding: 6px 12px;
  cursor: pointer;
  transition: var(--transition);
}
.cc-time-filter:hover { border-color: var(--cyan); color: var(--cyan); }
.cc-clock-display {
  display: flex;
  align-items: center;
  gap: 6px;
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--cyan);
}

/* Canvas Wrapper */
.cc-canvas-wrapper {
  position: relative;
  width: 100%;
  height: 500px;
  border-radius: 12px;
  overflow: hidden;
  margin-bottom: 20px;
  background: radial-gradient(ellipse at 50% 50%, rgba(0,212,255,0.03) 0%, transparent 70%),
              linear-gradient(180deg, var(--bg-card) 0%, var(--bg-surface) 100%);
  border: 1px solid var(--border-card);
}
.cc-canvas-grid-bg {
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
  background-size: 40px 40px;
  pointer-events: none;
  z-index: 0;
}
.cc-canvas-wrapper canvas {
  position: relative;
  z-index: 1;
  width: 100%;
  height: 100%;
  display: block;
}

/* Metric Cards */
.cc-metrics-row {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 10px;
  margin-bottom: 20px;
}
.cc-metric-card {
  background: rgba(17, 24, 39, 0.7);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  padding: 14px 14px 10px;
  position: relative;
  overflow: hidden;
  transition: var(--transition);
}
.cc-metric-card:hover {
  border-color: rgba(0,212,255,0.2);
  box-shadow: 0 0 20px rgba(0,212,255,0.05);
}
.cc-metric-top {
  display: flex;
  align-items: baseline;
  gap: 8px;
  margin-bottom: 4px;
}
.cc-metric-value {
  font-family: var(--font-display);
  font-size: 32px;
  font-weight: 800;
  color: var(--text-primary);
  letter-spacing: -0.03em;
  line-height: 1;
}
.cc-metric-unit {
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}
.cc-metric-label {
  font-family: var(--font-body);
  font-size: 11px;
  color: var(--text-secondary);
  margin-bottom: 8px;
}
.cc-sparkline {
  display: block;
  width: 100%;
  height: 32px;
  opacity: 0.7;
}

/* Severity dots */
.cc-severity-dots {
  display: flex;
  gap: 10px;
  margin-top: 4px;
}
.cc-sev-dot {
  display: flex;
  align-items: center;
  gap: 3px;
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--dot-color);
}
.cc-sev-dot::before {
  content: '';
  width: 7px;
  height: 7px;
  border-radius: 50%;
  background: var(--dot-color);
  box-shadow: 0 0 6px var(--dot-color);
}
.cc-sev-dot b {
  font-weight: 600;
}

/* Prevented bar */
.cc-prevented-bar {
  height: 4px;
  background: rgba(255,255,255,0.06);
  border-radius: 2px;
  margin-top: 10px;
  overflow: hidden;
}
.cc-prevented-fill {
  height: 100%;
  width: 85%;
  background: linear-gradient(90deg, var(--green), var(--cyan));
  border-radius: 2px;
  box-shadow: 0 0 8px rgba(16,185,129,0.4);
}

/* Bottom Grid */
.cc-bottom-grid {
  display: grid;
  grid-template-columns: 1.8fr 1fr;
  gap: 16px;
}
.cc-tickets-card {
  max-height: 420px;
  overflow-y: auto;
}
.cc-right-sidebar {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

@media (max-width: 1200px) {
  .cc-metrics-row { grid-template-columns: repeat(4, 1fr); }
  .cc-bottom-grid { grid-template-columns: 1fr; }
}
@media (max-width: 768px) {
  .cc-metrics-row { grid-template-columns: 1fr; }
  .cc-canvas-wrapper { height: 400px; }
  .cc-command-bar { flex-direction: column; gap: 10px; }
  .cc-status-pills { display: none; }
}

/* Heat Map Card */
.cc-heatmap-card {
  background: rgba(17, 24, 39, 0.7);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  padding: 16px 18px 12px;
  margin-bottom: 20px;
}
.cc-heatmap-header {
  display: flex;
  align-items: baseline;
  gap: 10px;
  margin-bottom: 10px;
}
.cc-heatmap-title {
  font-family: var(--font-display);
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
}
.cc-heatmap-subtitle {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-muted);
}
.cc-heatmap-container {
  position: relative;
  width: 100%;
  height: 160px;
}
.cc-heatmap-container canvas {
  width: 100%;
  height: 100%;
  display: block;
}
.cc-heatmap-legend {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 8px;
}
.cc-heatmap-legend-label {
  font-family: var(--font-mono);
  font-size: 9px;
  color: var(--text-muted);
  text-transform: uppercase;
}
.cc-heatmap-gradient {
  width: 100px;
  height: 6px;
  border-radius: 3px;
  background: linear-gradient(90deg, #0a1628, #00d4ff, #f59e0b, #ef4444);
}
.cc-heatmap-tooltip {
  position: absolute;
  pointer-events: none;
  background: rgba(17, 24, 39, 0.95);
  border: 1px solid var(--border-card);
  border-radius: 6px;
  padding: 4px 8px;
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-primary);
  white-space: nowrap;
  z-index: 10;
  display: none;
}

/* ============================================================
   CLIENT PORTAL SPLASH
   ============================================================ */
.cp-splash {
  position: relative;
  min-height: 80vh;
  display: flex;
  align-items: center;
  justify-content: center;
}
.cp-splash-bg {
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse at 50% 30%, rgba(0,212,255,0.06) 0%, transparent 60%),
              linear-gradient(180deg, var(--bg-base) 0%, var(--bg-surface) 100%);
  pointer-events: none;
}
.cp-splash-content {
  position: relative;
  z-index: 1;
  max-width: 640px;
  width: 100%;
  background: rgba(17, 24, 39, 0.7);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--border-card);
  border-radius: 16px;
  padding: 40px 36px 32px;
  text-align: center;
}
.cp-splash-icon {
  margin-bottom: 20px;
}
.cp-splash-shield {
  display: inline-block;
  font-size: 48px;
  animation: splashPulse 2s ease-in-out infinite;
}
@keyframes splashPulse {
  0%, 100% { filter: drop-shadow(0 0 8px rgba(0,212,255,0.3)); }
  50% { filter: drop-shadow(0 0 20px rgba(0,212,255,0.6)); }
}
.cp-splash-title {
  font-family: var(--font-display);
  font-size: 28px;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 4px;
}
.cp-splash-org {
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 600;
  color: var(--cyan);
  text-transform: uppercase;
  letter-spacing: 0.12em;
  margin-bottom: 8px;
}
.cp-splash-since {
  font-size: 12px;
  color: var(--text-secondary);
  margin-bottom: 28px;
}
.cp-splash-stats {
  text-align: left;
  margin: 0 auto 28px;
  max-width: 520px;
}
.cp-splash-stat-line {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 8px 0;
  border-bottom: 1px solid var(--border-subtle);
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.5;
}
.cp-splash-stat-line:last-child { border-bottom: none; }
.cp-splash-stat-line strong { color: var(--text-primary); }
.cp-splash-stat-icon {
  flex-shrink: 0;
  width: 22px;
  text-align: center;
  font-size: 14px;
  line-height: 1.4;
}
.cp-splash-stat-icon.green { color: var(--green); }
.cp-splash-stat-icon.amber { color: var(--amber); }
.cp-splash-stat-icon.red { color: var(--red); }
.cp-splash-stat-icon.cyan { color: var(--cyan); }
.cp-splash-continue {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 600;
  color: #fff;
  background: linear-gradient(135deg, #00d4ff, #0088cc);
  border: none;
  border-radius: 8px;
  padding: 12px 32px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 0 20px rgba(0,212,255,0.2);
}
.cp-splash-continue:hover {
  box-shadow: 0 0 30px rgba(0,212,255,0.4);
  transform: translateY(-1px);
}
.cp-splash-continue svg {
  transition: transform 0.2s ease;
}
.cp-splash-continue:hover svg {
  transform: translateX(3px);
}
.cp-splash-footer {
  margin-top: 24px;
  font-size: 10px;
  color: var(--text-muted);
  letter-spacing: 0.02em;
}
.cp-period-summary {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  background: rgba(0,212,255,0.04);
  border: 1px solid rgba(0,212,255,0.12);
  border-radius: 10px;
  padding: 14px 18px;
  margin-bottom: 20px;
}
.cp-period-icon {
  font-size: 20px;
  flex-shrink: 0;
}
.cp-period-text {
  font-size: 12px;
  color: var(--text-secondary);
  line-height: 1.6;
}
.cp-period-text strong {
  color: var(--text-primary);
}

/* ============================================================
   WAR ROOM v2 â€” DACTA BLUEPRINT
   ============================================================ */

/* ---- Engagement selector bar ---- */
.wr2-eng-bar {
  display: flex;
  align-items: center;
  gap: 0;
  background: var(--bg-surface);
  border: 1px solid var(--border-subtle);
  border-radius: 10px;
  margin-bottom: 16px;
  overflow-x: auto;
  padding: 0 8px;
}
.wr2-eng-tab {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  color: var(--text-secondary);
  font-size: 12px;
  transition: all 0.2s;
  white-space: nowrap;
  position: relative;
}
.wr2-eng-tab:hover { color: var(--text-primary); background: rgba(0,212,255,0.03); }
.wr2-eng-tab.active { color: var(--cyan); border-bottom-color: var(--cyan); }
.wr2-eng-tab .wr2-eng-id {
  font-family: var(--font-mono);
  font-size: 11px;
  font-weight: 600;
  color: inherit;
}
.wr2-eng-tab .wr2-eng-name { font-weight: 500; }
.wr2-eng-tab .wr2-mode-hot {
  background: rgba(239,68,68,0.12);
  color: #ff6b6b;
  border: 1px solid rgba(239,68,68,0.25);
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.08em;
  padding: 1px 5px;
  border-radius: 3px;
  text-transform: uppercase;
}
.wr2-eng-tab .wr2-mode-cold {
  background: rgba(59,130,246,0.12);
  color: #60a5fa;
  border: 1px solid rgba(59,130,246,0.25);
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.08em;
  padding: 1px 5px;
  border-radius: 3px;
  text-transform: uppercase;
}
.wr2-eng-add {
  margin-left: auto;
  flex-shrink: 0;
  padding: 6px 12px;
  font-size: 11px;
  color: var(--text-muted);
  cursor: pointer;
  transition: color 0.2s;
}
.wr2-eng-add:hover { color: var(--cyan); }

/* ---- Top status bar ---- */
.wr2-topbar {
  background: var(--bg-surface);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  padding: 12px 16px;
  margin-bottom: 14px;
  display: flex;
  align-items: center;
  gap: 0;
  flex-wrap: wrap;
  position: relative;
  overflow: hidden;
}
.wr2-topbar::before {
  content: '';
  position: absolute;
  left: 0; top: 0; bottom: 0;
  width: 3px;
  background: linear-gradient(180deg, #ff6b6b 0%, var(--red) 100%);
  border-radius: 10px 0 0 10px;
}
.wr2-topbar-item {
  display: flex;
  flex-direction: column;
  padding: 0 16px;
  border-right: 1px solid var(--border-subtle);
  min-width: 0;
}
.wr2-topbar-item:last-of-type { border-right: none; }
.wr2-tb-label {
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--text-muted);
  margin-bottom: 2px;
}
.wr2-tb-val {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  white-space: nowrap;
}
.wr2-tb-val.mono { font-family: var(--font-mono); font-size: 11px; color: var(--cyan); }
.wr2-topbar-spacer { flex: 1; }
.wr2-tlp-badge {
  display: inline-flex;
  align-items: center;
  padding: 3px 10px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 800;
  letter-spacing: 0.12em;
  font-family: var(--font-mono);
}
.wr2-tlp-badge.amber { background: rgba(245,158,11,0.15); color: #fbbf24; border: 1px solid rgba(245,158,11,0.3); }
.wr2-tlp-badge.red { background: rgba(239,68,68,0.15); color: #ff6b6b; border: 1px solid rgba(239,68,68,0.3); }
.wr2-tlp-badge.green { background: rgba(16,185,129,0.12); color: var(--green); border: 1px solid rgba(16,185,129,0.25); }
.wr2-sev-badge {
  display: inline-flex;
  align-items: center;
  padding: 3px 9px;
  border-radius: 4px;
  font-size: 10px;
  font-weight: 800;
  letter-spacing: 0.06em;
}
.wr2-sev-badge.sev1 { background: rgba(239,68,68,0.15); color: #ff6b6b; border: 1px solid rgba(239,68,68,0.3); animation: badgePulseP1 2s ease-in-out infinite; }
.wr2-sev-badge.sev2 { background: rgba(245,158,11,0.15); color: #fbbf24; border: 1px solid rgba(245,158,11,0.3); }
.wr2-sev-badge.sev3 { background: rgba(249,115,22,0.12); color: #fb923c; border: 1px solid rgba(249,115,22,0.25); }
.wr2-sev-badge.sev4 { background: rgba(100,116,139,0.15); color: #94a3b8; border: 1px solid rgba(100,116,139,0.25); }
.wr2-status-active { color: var(--red-bright); font-weight: 700; display: flex; align-items: center; gap: 5px; }
.wr2-status-active::before { content: ''; display: inline-block; width: 7px; height: 7px; border-radius: 50%; background: var(--red); box-shadow: 0 0 6px rgba(239,68,68,0.8); animation: pulse-red-smooth 2s ease-in-out infinite; }
.wr2-status-monitoring { color: var(--amber); font-weight: 700; display: flex; align-items: center; gap: 5px; }
.wr2-status-monitoring::before { content: ''; display: inline-block; width: 7px; height: 7px; border-radius: 50%; background: var(--amber); box-shadow: 0 0 6px rgba(245,158,11,0.7); }
.wr2-elapsed {
  font-family: var(--font-mono);
  font-size: 16px;
  font-weight: 700;
  color: var(--amber);
  letter-spacing: 0.05em;
}
.wr2-elapsed.paused {
  color: var(--text-muted);
  opacity: 0.6;
}
.wr2-timer-wrap {
  display: flex;
  align-items: center;
  gap: 6px;
}
.wr2-timer-btn {
  width: 22px; height: 22px;
  border-radius: 50%;
  border: 1px solid var(--border-subtle);
  background: rgba(255,255,255,0.04);
  color: var(--text-secondary);
  font-size: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
  padding: 0;
  line-height: 1;
}
.wr2-timer-btn:hover {
  background: rgba(255,255,255,0.08);
  color: var(--text-primary);
  border-color: var(--cyan);
}
.wr2-timer-btn.paused {
  border-color: var(--green);
  color: var(--green);
}
.wr2-timer-paused-label {
  font-size: 9px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-weight: 600;
}
.wr2-manhours-row {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-top: 4px;
  font-size: 10px;
  color: var(--text-muted);
}
.wr2-manhours-val {
  font-family: var(--font-mono);
  color: var(--cyan);
  font-weight: 600;
  font-size: 11px;
}

/* ---- Phase pipeline ---- */
.wr2-phase-row {
  display: flex;
  align-items: center;
  background: var(--bg-surface);
  border: 1px solid var(--border-subtle);
  border-radius: 10px;
  padding: 10px 16px;
  margin-bottom: 14px;
  overflow-x: auto;
}
.wr2-phase-item {
  display: flex;
  align-items: center;
  gap: 7px;
  flex-shrink: 0;
}
.wr2-phase-item + .wr2-phase-item::before {
  content: 'â€º';
  color: var(--text-muted);
  font-size: 14px;
  margin: 0 4px;
}
.wr2-ph-dot {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 700;
  flex-shrink: 0;
}
.wr2-phase-item.done .wr2-ph-dot { background: rgba(16,185,129,0.2); border: 2px solid var(--green); color: var(--green); }
.wr2-phase-item.current .wr2-ph-dot { background: rgba(245,158,11,0.2); border: 2px solid var(--amber); color: var(--amber); animation: phasePulse 2s ease-in-out infinite; }
.wr2-phase-item.pending .wr2-ph-dot { background: rgba(255,255,255,0.04); border: 2px solid rgba(255,255,255,0.12); color: rgba(255,255,255,0.2); }
.wr2-ph-label { font-size: 11px; font-weight: 600; }
.wr2-phase-item.done .wr2-ph-label { color: var(--green); }
.wr2-phase-item.current .wr2-ph-label { color: var(--amber); }
.wr2-phase-item.pending .wr2-ph-label { color: var(--text-muted); }

/* ---- Main layout: tabs + copilot ---- */
.wr2-layout {
  display: flex;
  gap: 14px;
  height: calc(100vh - 310px);
  min-height: 500px;
  max-height: calc(100vh - 280px);
  position: relative;
}
.wr2-main {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  overflow-x: hidden;
  overflow-y: auto;
  position: relative;
}
.wr2-main::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 10px;
  background: repeating-conic-gradient(rgba(255,255,255,0.007) 0% 25%, transparent 0% 50%) 0 0 / 3px 3px;
  pointer-events: none;
  z-index: 0;
}
.wr2-main > * { position: relative; z-index: 1; }

/* Copilot panel */
.wr2-copilot {
  width: 280px;
  min-width: 280px;
  display: flex;
  flex-direction: column;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  overflow: hidden;
  transition: width 0.3s ease, min-width 0.3s ease, opacity 0.3s;
  position: relative;
}
.wr2-copilot.collapsed {
  width: 44px;
  min-width: 44px;
}
.wr2-copilot.collapsed .wr2-cop-body,
.wr2-copilot.collapsed .wr2-cop-suggestions,
.wr2-copilot.collapsed .wr2-cop-input-row { display: none; }
.wr2-cop-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 14px;
  border-bottom: 1px solid var(--border-subtle);
  background: rgba(0,212,255,0.03);
  cursor: pointer;
  user-select: none;
  flex-shrink: 0;
}
.wr2-cop-icon {
  width: 26px;
  height: 26px;
  border-radius: 6px;
  background: linear-gradient(135deg, rgba(0,212,255,0.2), rgba(139,92,246,0.2));
  border: 1px solid rgba(0,212,255,0.25);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  flex-shrink: 0;
}
.wr2-cop-title {
  font-size: 11px;
  font-weight: 700;
  color: var(--cyan);
  letter-spacing: 0.06em;
  text-transform: uppercase;
  flex: 1;
}
.wr2-cop-toggle {
  font-size: 10px;
  color: var(--text-muted);
  flex-shrink: 0;
  transition: transform 0.2s;
}
.wr2-copilot.collapsed .wr2-cop-toggle { transform: rotate(180deg); }
.wr2-cop-body {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  padding: 12px 14px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.wr2-cop-msg {
  padding: 8px 10px;
  border-radius: 6px;
  font-size: 11px;
  line-height: 1.5;
}
.wr2-cop-msg.ai {
  background: rgba(0,212,255,0.07);
  border: 1px solid rgba(0,212,255,0.15);
  color: var(--text-secondary);
  border-radius: 8px 8px 8px 2px;
}
.wr2-cop-msg.user {
  background: rgba(139,92,246,0.08);
  border: 1px solid rgba(139,92,246,0.2);
  color: var(--text-primary);
  border-radius: 8px 8px 2px 8px;
  align-self: flex-end;
  max-width: 90%;
}
.wr2-cop-msg-label {
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 4px;
}
.wr2-cop-msg.ai .wr2-cop-msg-label { color: var(--cyan); }
.wr2-cop-msg.user .wr2-cop-msg-label { color: #a78bfa; }
.wr2-cop-suggestions {
  padding: 0 14px 10px;
  flex-shrink: 0;
}
.wr2-cop-sug-label {
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--text-muted);
  margin-bottom: 6px;
}
.wr2-cop-sug {
  display: block;
  background: rgba(255,255,255,0.03);
  border: 1px solid var(--border-subtle);
  border-radius: 5px;
  padding: 6px 10px;
  font-size: 10px;
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.2s;
  margin-bottom: 4px;
  text-align: left;
  width: 100%;
}
.wr2-cop-sug:hover { border-color: rgba(0,212,255,0.2); color: var(--cyan); background: rgba(0,212,255,0.04); }
.wr2-cop-input-row {
  display: flex;
  gap: 6px;
  padding: 10px 14px;
  border-top: 1px solid var(--border-subtle);
  flex-shrink: 0;
}
.wr2-cop-input {
  flex: 1;
  background: var(--bg-input);
  border: 1px solid var(--border-card);
  border-radius: 6px;
  padding: 6px 10px;
  font-size: 11px;
  color: var(--text-primary);
  outline: none;
  font-family: var(--font-body);
}
.wr2-cop-input:focus { border-color: rgba(0,212,255,0.3); }
.wr2-cop-send {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  background: linear-gradient(135deg, rgba(0,212,255,0.2), rgba(139,92,246,0.2));
  border: 1px solid rgba(0,212,255,0.25);
  color: var(--cyan);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s;
  flex-shrink: 0;
}
.wr2-cop-send:hover { background: rgba(0,212,255,0.2); box-shadow: 0 0 12px rgba(0,212,255,0.15); }

/* ---- Inner nav tabs ---- */
.wr2-nav {
  display: flex;
  align-items: center;
  gap: 0;
  border-bottom: 1px solid var(--border-subtle);
  overflow-x: auto;
  flex-shrink: 0;
  padding: 0 4px;
}
.wr2-nav-tab {
  padding: 11px 14px;
  font-size: 11px;
  font-weight: 600;
  color: var(--text-muted);
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.2s;
  white-space: nowrap;
  text-transform: uppercase;
  letter-spacing: 0.07em;
  display: flex;
  align-items: center;
  gap: 5px;
}
.wr2-nav-tab:hover { color: var(--text-secondary); }
.wr2-nav-tab.active { color: var(--cyan); border-bottom-color: var(--cyan); }
.wr2-nav-tab .tab-badge {
  background: rgba(239,68,68,0.2);
  color: #ff6b6b;
  border-radius: 8px;
  padding: 0 5px;
  font-size: 9px;
  font-weight: 700;
  min-width: 16px;
  text-align: center;
}

/* ---- Tab content area ---- */
.wr2-tab-pane {
  display: none;
  padding: 16px;
  overflow-y: auto;
  flex: 1;
  animation: fadeIn 0.25s ease;
}
.wr2-tab-pane.active { display: block; flex: 1; overflow-y: auto; max-height: 100%; }

/* ---- KPI cards row ---- */
.wr2-kpi-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
  margin-bottom: 16px;
}
.wr2-kpi {
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  padding: 12px 14px;
  position: relative;
  overflow: hidden;
}
.wr2-kpi::before {
  content: '';
  position: absolute;
  left: 0; top: 0; bottom: 0;
  width: 3px;
  border-radius: 8px 0 0 8px;
}
.wr2-kpi.cyan::before { background: var(--cyan); }
.wr2-kpi.red::before { background: var(--red); }
.wr2-kpi.amber::before { background: var(--amber); }
.wr2-kpi.green::before { background: var(--green); }
.wr2-kpi-label { font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-muted); margin-bottom: 6px; }
.wr2-kpi-value { font-size: 24px; font-weight: 800; font-family: var(--font-display); line-height: 1; }
.wr2-kpi.cyan .wr2-kpi-value { color: var(--cyan); }
.wr2-kpi.red .wr2-kpi-value { color: var(--red-bright); }
.wr2-kpi.amber .wr2-kpi-value { color: var(--amber); }
.wr2-kpi.green .wr2-kpi-value { color: var(--green); }
.wr2-kpi-sub { font-size: 10px; color: var(--text-muted); margin-top: 4px; }

/* ---- Horizontal attack timeline ---- */
.wr2-atk-timeline {
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  padding: 12px 14px;
  margin-bottom: 16px;
  overflow-x: auto;
}
.wr2-atk-title {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--text-muted);
  margin-bottom: 12px;
}
.wr2-atk-track {
  display: flex;
  align-items: center;
  gap: 0;
  position: relative;
  padding: 4px 0 20px;
}
.wr2-atk-track::before {
  content: '';
  position: absolute;
  top: 16px;
  left: 20px;
  right: 20px;
  height: 2px;
  background: rgba(255,255,255,0.06);
}
.wr2-atk-node {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  flex-shrink: 0;
  position: relative;
  width: 80px;
  cursor: pointer;
}
.wr2-atk-dot {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  border: 2px solid;
  transition: all 0.2s;
  position: relative;
  z-index: 1;
}
.wr2-atk-node:hover .wr2-atk-dot { transform: scale(1.15); box-shadow: 0 0 16px currentColor; }
.wr2-atk-dot.initial { background: rgba(59,130,246,0.15); border-color: #60a5fa; color: #60a5fa; }
.wr2-atk-dot.exec { background: rgba(239,68,68,0.15); border-color: #ff6b6b; color: #ff6b6b; }
.wr2-atk-dot.persist { background: rgba(249,115,22,0.15); border-color: #fb923c; color: #fb923c; }
.wr2-atk-dot.lateral { background: rgba(245,158,11,0.15); border-color: #fbbf24; color: #fbbf24; }
.wr2-atk-dot.c2 { background: rgba(139,92,246,0.15); border-color: #a78bfa; color: #a78bfa; }
.wr2-atk-dot.exfil { background: rgba(239,68,68,0.15); border-color: var(--red); color: var(--red); }
.wr2-atk-dot.impact { background: rgba(239,68,68,0.2); border-color: #ff6b6b; color: #ff6b6b; animation: pulse-red-smooth 2s infinite; }
.wr2-atk-dot.contain { background: rgba(16,185,129,0.15); border-color: var(--green); color: var(--green); }
.wr2-atk-node-time { font-size: 9px; color: var(--text-muted); font-family: var(--font-mono); text-align: center; }
.wr2-atk-node-label { font-size: 9px; color: var(--text-secondary); text-align: center; line-height: 1.3; }

/* ---- Overview grid ---- */
.wr2-overview-grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 12px;
}
.wr2-panel {
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  padding: 12px 14px;
}
.wr2-panel-title {
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--text-muted);
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.wr2-team-member {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 5px 0;
  border-bottom: 1px solid var(--border-subtle);
}
.wr2-team-member:last-child { border-bottom: none; }
.wr2-avatar {
  width: 26px;
  height: 26px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 700;
  flex-shrink: 0;
}
.wr2-avatar.lead { background: rgba(0,212,255,0.15); color: var(--cyan); border: 1px solid rgba(0,212,255,0.25); }
.wr2-avatar.analyst { background: rgba(139,92,246,0.15); color: #a78bfa; border: 1px solid rgba(139,92,246,0.25); }
.wr2-avatar.forensics { background: rgba(16,185,129,0.15); color: var(--green); border: 1px solid rgba(16,185,129,0.25); }
.wr2-avatar.threat { background: rgba(245,158,11,0.15); color: var(--amber); border: 1px solid rgba(245,158,11,0.25); }
.wr2-member-info { flex: 1; min-width: 0; }
.wr2-member-name { font-size: 11px; font-weight: 600; color: var(--text-primary); }
.wr2-member-role { font-size: 10px; color: var(--text-muted); }
.wr2-online-dot {
  width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0;
}
.wr2-online-dot.online { background: var(--green); box-shadow: 0 0 6px rgba(16,185,129,0.6); animation: pulse-green-smooth 3s ease-in-out infinite; }
.wr2-online-dot.away { background: var(--amber); }
.wr2-online-dot.offline { background: var(--text-muted); }

/* ---- MITRE mini heatmap ---- */
.wr2-mitre-grid {
  display: grid;
  grid-template-columns: repeat(11, 1fr);
  gap: 2px;
}
.wr2-mitre-cell {
  aspect-ratio: 1;
  border-radius: 2px;
  cursor: pointer;
  transition: transform 0.15s, opacity 0.15s;
  position: relative;
  min-width: 0;
}
.wr2-mitre-cell:hover { transform: scale(1.2); z-index: 10; }
.wr2-mitre-cell.none { background: rgba(255,255,255,0.04); }
.wr2-mitre-cell.low { background: rgba(245,158,11,0.25); }
.wr2-mitre-cell.med { background: rgba(245,158,11,0.55); }
.wr2-mitre-cell.high { background: rgba(239,68,68,0.45); }
.wr2-mitre-cell.crit { background: rgba(239,68,68,0.8); box-shadow: 0 0 4px rgba(239,68,68,0.4); }
.wr2-mitre-labels {
  display: flex;
  gap: 2px;
  margin-bottom: 3px;
}
.wr2-mitre-label {
  flex: 1;
  font-size: 7px;
  color: var(--text-muted);
  text-align: center;
  overflow: hidden;
  text-overflow: clip;
  white-space: nowrap;
  min-width: 0;
}

/* ---- Activity feed ---- */
.wr2-feed-item {
  display: flex;
  gap: 8px;
  padding: 7px 0;
  border-bottom: 1px solid var(--border-subtle);
  font-size: 11px;
}
.wr2-feed-item:last-child { border-bottom: none; }
.wr2-feed-time { font-family: var(--font-mono); font-size: 10px; color: var(--text-muted); white-space: nowrap; flex-shrink: 0; width: 42px; }
.wr2-feed-dot { width: 7px; height: 7px; border-radius: 50%; margin-top: 3px; flex-shrink: 0; }
.wr2-feed-dot.red { background: var(--red); box-shadow: 0 0 4px rgba(239,68,68,0.5); }
.wr2-feed-dot.amber { background: var(--amber); }
.wr2-feed-dot.green { background: var(--green); }
.wr2-feed-dot.cyan { background: var(--cyan); }
.wr2-feed-dot.purple { background: var(--purple); }
.wr2-feed-text { color: var(--text-secondary); flex: 1; line-height: 1.4; }
.wr2-feed-text strong { color: var(--text-primary); font-weight: 600; }

/* ---- Engagement details panel ---- */
.wr2-detail-table { width: 100%; }
.wr2-detail-row2 { display: flex; justify-content: space-between; align-items: center; padding: 5px 0; border-bottom: 1px solid var(--border-subtle); font-size: 11px; }
.wr2-detail-row2:last-child { border-bottom: none; }
.wr2-detail-key2 { color: var(--text-muted); font-weight: 500; }
.wr2-detail-val2 { color: var(--text-primary); font-weight: 600; text-align: right; }

/* ---- Scoping questionnaire ---- */
.wr2-question-group { margin-bottom: 16px; }
.wr2-qg-title {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--cyan);
  margin-bottom: 10px;
  padding-bottom: 6px;
  border-bottom: 1px solid var(--border-subtle);
}
.wr2-field-row { display: flex; gap: 10px; margin-bottom: 8px; flex-wrap: wrap; }
.wr2-field {
  display: flex;
  flex-direction: column;
  gap: 4px;
  flex: 1;
  min-width: 140px;
}
.wr2-field-label { font-size: 10px; color: var(--text-secondary); font-weight: 500; }
.wr2-field input, .wr2-field select, .wr2-field textarea {
  background: var(--bg-input);
  border: 1px solid var(--border-card);
  border-radius: 5px;
  padding: 6px 10px;
  font-size: 11px;
  color: var(--text-primary);
  outline: none;
  font-family: var(--font-body);
  transition: border-color 0.2s;
  width: 100%;
}
.wr2-field input:focus, .wr2-field select:focus, .wr2-field textarea:focus { border-color: rgba(0,212,255,0.3); }
.wr2-field select { cursor: pointer; }
.wr2-cold-notice {
  background: rgba(59,130,246,0.07);
  border: 1px solid rgba(59,130,246,0.2);
  border-radius: 8px;
  padding: 12px 14px;
  margin-bottom: 16px;
  font-size: 11px;
  color: #60a5fa;
  display: flex;
  align-items: flex-start;
  gap: 10px;
}

/* ---- Evidence tiers ---- */
.wr2-tier {
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  margin-bottom: 12px;
  overflow: hidden;
}
.wr2-tier-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  cursor: pointer;
  background: rgba(255,255,255,0.02);
  border-bottom: 1px solid var(--border-subtle);
  transition: background 0.2s;
}
.wr2-tier-header:hover { background: rgba(255,255,255,0.04); }
.wr2-tier-badge {
  width: 22px;
  height: 22px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 800;
  flex-shrink: 0;
}
.wr2-tier-badge.t1 { background: rgba(239,68,68,0.15); color: #ff6b6b; border: 1px solid rgba(239,68,68,0.25); }
.wr2-tier-badge.t2 { background: rgba(245,158,11,0.15); color: #fbbf24; border: 1px solid rgba(245,158,11,0.25); }
.wr2-tier-badge.t3 { background: rgba(139,92,246,0.15); color: #a78bfa; border: 1px solid rgba(139,92,246,0.25); }
.wr2-tier-badge.t4 { background: rgba(0,212,255,0.12); color: var(--cyan); border: 1px solid rgba(0,212,255,0.2); }
.wr2-tier-name { font-size: 12px; font-weight: 600; color: var(--text-primary); flex: 1; }
.wr2-tier-prog { font-size: 10px; color: var(--text-muted); }
.wr2-tier-body { padding: 10px 14px; }
.wr2-ev-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 0;
  border-bottom: 1px solid var(--border-subtle);
  font-size: 11px;
}
.wr2-ev-item:last-child { border-bottom: none; }
.wr2-ev-check { flex-shrink: 0; }
.wr2-ev-name { flex: 1; color: var(--text-secondary); }
.wr2-ev-status-badge {
  font-size: 9px;
  font-weight: 700;
  padding: 2px 7px;
  border-radius: 3px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  flex-shrink: 0;
}
.wr2-ev-status-badge.pending { background: rgba(100,116,139,0.15); color: #94a3b8; border: 1px solid rgba(100,116,139,0.2); }
.wr2-ev-status-badge.requested { background: rgba(59,130,246,0.12); color: #60a5fa; border: 1px solid rgba(59,130,246,0.2); }
.wr2-ev-status-badge.collecting { background: rgba(245,158,11,0.12); color: var(--amber); border: 1px solid rgba(245,158,11,0.2); }
.wr2-ev-status-badge.collected { background: rgba(249,115,22,0.12); color: #fb923c; border: 1px solid rgba(249,115,22,0.2); }
.wr2-ev-status-badge.analyzed { background: rgba(16,185,129,0.12); color: var(--green); border: 1px solid rgba(16,185,129,0.2); }

/* ---- IOC Registry ---- */
.wr2-ioc-row { cursor: pointer; }
.wr2-ioc-type {
  display: inline-flex;
  align-items: center;
  padding: 2px 6px;
  border-radius: 3px;
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}
.wr2-ioc-type.ip { background: rgba(239,68,68,0.12); color: #ff6b6b; }
.wr2-ioc-type.hash { background: rgba(245,158,11,0.12); color: var(--amber); }
.wr2-ioc-type.domain { background: rgba(139,92,246,0.12); color: #a78bfa; }
.wr2-ioc-type.email { background: rgba(0,212,255,0.1); color: var(--cyan); }
.wr2-ioc-type.file { background: rgba(16,185,129,0.1); color: var(--green); }
.wr2-vt-score {
  font-family: var(--font-mono);
  font-size: 11px;
  font-weight: 700;
}
.wr2-vt-score.high { color: var(--red-bright); }
.wr2-vt-score.med { color: var(--amber); }
.wr2-vt-score.clean { color: var(--green); }

/* ---- Vertical attack timeline ---- */
.wr2-vtl-item {
  display: flex;
  gap: 12px;
  padding: 10px 0;
  position: relative;
}
.wr2-vtl-item + .wr2-vtl-item::before {
  content: '';
  position: absolute;
  left: 15px;
  top: 0;
  bottom: 0;
  width: 1px;
  background: var(--border-subtle);
}
.wr2-vtl-dot {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  flex-shrink: 0;
  border: 2px solid;
  position: relative;
  z-index: 1;
}
.wr2-vtl-dot.initial { background: rgba(59,130,246,0.12); border-color: #60a5fa; color: #60a5fa; }
.wr2-vtl-dot.exec { background: rgba(239,68,68,0.12); border-color: #ff6b6b; color: #ff6b6b; }
.wr2-vtl-dot.persist { background: rgba(249,115,22,0.12); border-color: #fb923c; color: #fb923c; }
.wr2-vtl-dot.lateral { background: rgba(245,158,11,0.12); border-color: #fbbf24; color: #fbbf24; }
.wr2-vtl-dot.c2 { background: rgba(139,92,246,0.12); border-color: #a78bfa; color: #a78bfa; }
.wr2-vtl-dot.impact { background: rgba(239,68,68,0.2); border-color: var(--red); color: var(--red); }
.wr2-vtl-dot.contain { background: rgba(16,185,129,0.12); border-color: var(--green); color: var(--green); }
.wr2-vtl-body { flex: 1; min-width: 0; }
.wr2-vtl-time { font-family: var(--font-mono); font-size: 10px; color: var(--text-muted); margin-bottom: 2px; }
.wr2-vtl-title { font-size: 12px; font-weight: 600; color: var(--text-primary); margin-bottom: 2px; }
.wr2-vtl-desc { font-size: 11px; color: var(--text-secondary); line-height: 1.4; }
.wr2-vtl-mitre { font-family: var(--font-mono); font-size: 9px; color: var(--purple); background: rgba(139,92,246,0.1); border: 1px solid rgba(139,92,246,0.2); border-radius: 3px; padding: 1px 5px; display: inline-block; margin-top: 4px; }

/* ---- Analyst notebook ---- */
.wr2-notebook {
  background: var(--bg-input);
  border: 1px solid var(--border-card);
  border-radius: 6px;
  padding: 10px 12px;
  font-size: 12px;
  font-family: var(--font-mono);
  color: var(--text-secondary);
  line-height: 1.7;
  min-height: 120px;
  resize: vertical;
  width: 100%;
  outline: none;
}
.wr2-notebook:focus { border-color: rgba(0,212,255,0.3); }

/* ---- Assets kanban ---- */
.wr2-kanban {
  display: flex;
  gap: 10px;
  overflow-x: auto;
  padding-bottom: 6px;
}
.wr2-kanban-col {
  min-width: 170px;
  max-width: 200px;
  flex-shrink: 0;
}
.wr2-kanban-col-header {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-muted);
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 6px;
}
.wr2-kanban-col-count {
  background: rgba(255,255,255,0.06);
  border-radius: 8px;
  padding: 0 5px;
  font-size: 10px;
  color: var(--text-muted);
}
.wr2-asset-card {
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
  border-radius: 7px;
  padding: 9px 10px;
  margin-bottom: 6px;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
  overflow: hidden;
}
.wr2-asset-card:hover { border-color: rgba(0,212,255,0.2); transform: translateY(-1px); }
.wr2-asset-card.compromised { border-left: 3px solid var(--red); }
.wr2-asset-card.contained { border-left: 3px solid var(--amber); }
.wr2-asset-card.investigating { border-left: 3px solid var(--purple); }
.wr2-asset-card.clean { border-left: 3px solid var(--green); }
.wr2-asset-card.unexamined { border-left: 3px solid var(--text-muted); }
.wr2-asset-hostname { font-family: var(--font-mono); font-size: 11px; font-weight: 600; color: var(--text-primary); margin-bottom: 3px; }
.wr2-asset-ip { font-size: 10px; color: var(--text-muted); font-family: var(--font-mono); }
.wr2-asset-meta { display: flex; justify-content: space-between; margin-top: 5px; }
.wr2-asset-os { font-size: 9px; color: var(--text-muted); }
.wr2-asset-analyst { font-size: 9px; color: var(--cyan); }
.wr2-edr-status {
  display: inline-flex;
  align-items: center;
  gap: 3px;
  font-size: 8px;
  font-weight: 600;
  padding: 1px 5px;
  border-radius: 3px;
  margin-top: 4px;
}
.wr2-edr-status.active { background: rgba(16,185,129,0.12); color: var(--green); }
.wr2-edr-status.offline { background: rgba(239,68,68,0.12); color: #ff6b6b; }
.wr2-edr-status.unknown { background: rgba(100,116,139,0.12); color: #94a3b8; }

/* ---- Containment action tracker ---- */
.wr2-action-status {
  display: inline-flex;
  padding: 2px 7px;
  border-radius: 3px;
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}
.wr2-action-status.planned { background: rgba(100,116,139,0.15); color: #94a3b8; }
.wr2-action-status.approved { background: rgba(59,130,246,0.12); color: #60a5fa; }
.wr2-action-status.in_progress { background: rgba(245,158,11,0.12); color: var(--amber); }
.wr2-action-status.completed { background: rgba(16,185,129,0.12); color: var(--green); }
.wr2-action-priority { display: inline-flex; padding: 2px 6px; border-radius: 3px; font-size: 9px; font-weight: 700; }
.wr2-action-priority.critical { background: rgba(239,68,68,0.15); color: #ff6b6b; }
.wr2-action-priority.high { background: rgba(245,158,11,0.15); color: var(--amber); }
.wr2-action-priority.medium { background: rgba(59,130,246,0.12); color: #60a5fa; }

/* ---- Eradication checklist ---- */
.wr2-errad-group { margin-bottom: 14px; }
.wr2-errad-group-title {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--amber);
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 6px;
}
.wr2-errad-item {
  display: flex;
  align-items: flex-start;
  gap: 9px;
  padding: 7px 10px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
  border-radius: 6px;
  margin-bottom: 5px;
}
.wr2-errad-item.done { opacity: 0.6; }
.wr2-errad-item input[type=checkbox] { accent-color: var(--cyan); margin-top: 1px; flex-shrink: 0; }
.wr2-errad-body { flex: 1; min-width: 0; }
.wr2-errad-tech { font-family: var(--font-mono); font-size: 9px; color: var(--purple); margin-bottom: 2px; }
.wr2-errad-desc { font-size: 11px; color: var(--text-secondary); }
.wr2-errad-status { font-size: 9px; font-weight: 700; padding: 2px 6px; border-radius: 3px; flex-shrink: 0; }
.wr2-errad-status.open { background: rgba(239,68,68,0.12); color: #ff6b6b; }
.wr2-errad-status.done { background: rgba(16,185,129,0.12); color: var(--green); }
.wr2-errad-status.pending { background: rgba(100,116,139,0.12); color: #94a3b8; }

/* ---- Report sections ---- */
.wr2-report-section {
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
  border-radius: 8px;
  padding: 14px 16px;
  margin-bottom: 12px;
}
.wr2-report-section-title {
  font-size: 11px;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.wr2-export-btn-row { display: flex; gap: 8px; flex-wrap: wrap; }

/* ---- Comms log ---- */
.wr2-comm-item {
  display: flex;
  gap: 10px;
  padding: 9px 0;
  border-bottom: 1px solid var(--border-subtle);
}
.wr2-comm-item:last-child { border-bottom: none; }
.wr2-comm-type-badge {
  display: inline-flex;
  padding: 2px 7px;
  border-radius: 3px;
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  flex-shrink: 0;
  height: fit-content;
  margin-top: 1px;
}
.wr2-comm-type-badge.status_update { background: rgba(0,212,255,0.1); color: var(--cyan); }
.wr2-comm-type-badge.client_email { background: rgba(16,185,129,0.1); color: var(--green); }
.wr2-comm-type-badge.internal_brief { background: rgba(139,92,246,0.1); color: #a78bfa; }
.wr2-comm-type-badge.escalation { background: rgba(239,68,68,0.1); color: #ff6b6b; }
.wr2-comm-body { flex: 1; min-width: 0; }
.wr2-comm-subject { font-size: 12px; font-weight: 600; color: var(--text-primary); margin-bottom: 2px; }
.wr2-comm-meta { font-size: 10px; color: var(--text-muted); }

/* ---- Settings ---- */
.wr2-settings-section { margin-bottom: 20px; }
.wr2-settings-title {
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--text-secondary);
  margin-bottom: 10px;
  padding-bottom: 6px;
  border-bottom: 1px solid var(--border-subtle);
}
.wr2-settings-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 7px 0;
  border-bottom: 1px solid var(--border-subtle);
  font-size: 12px;
}
.wr2-settings-row:last-child { border-bottom: none; }
.wr2-settings-key { color: var(--text-secondary); }
.wr2-settings-val { color: var(--text-primary); font-weight: 500; }
.wr2-toggle {
  width: 34px;
  height: 18px;
  background: rgba(0,212,255,0.2);
  border-radius: 9px;
  position: relative;
  cursor: pointer;
  transition: background 0.2s;
  border: 1px solid rgba(0,212,255,0.3);
}
.wr2-toggle::after {
  content: '';
  position: absolute;
  left: 2px;
  top: 2px;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: var(--cyan);
  transition: transform 0.2s;
}
.wr2-toggle.on { background: rgba(0,212,255,0.3); }
.wr2-toggle.on::after { transform: translateX(14px); }
.wr2-toggle.off { background: rgba(255,255,255,0.05); border-color: var(--border-subtle); }
.wr2-toggle.off::after { background: var(--text-muted); }

/* ---- Engagement data sections ---- */
.wr2-engagement-panel {
  display: none;
}
.wr2-engagement-panel.active {
  display: block;
}


/* ============================================================
   CLIENT PORTAL SPLASH
   ============================================================ */
.cp-splash {
  position: relative;
  min-height: 80vh;
  display: flex;
  align-items: center;
  justify-content: center;
}
.cp-splash-bg {
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse at 50% 30%, rgba(0,212,255,0.06) 0%, transparent 60%),
              linear-gradient(180deg, var(--bg-base) 0%, var(--bg-surface) 100%);
  pointer-events: none;
}
.cp-splash-content {
  position: relative;
  z-index: 1;
  max-width: 640px;
  width: 100%;
  background: rgba(17, 24, 39, 0.7);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1px solid var(--border-card);
  border-radius: 16px;
  padding: 40px 36px 32px;
  text-align: center;
}
.cp-splash-icon {
  margin-bottom: 20px;
}
.cp-splash-shield {
  display: inline-block;
  font-size: 48px;
  animation: splashPulse 2s ease-in-out infinite;
}
@keyframes splashPulse {
  0%, 100% { filter: drop-shadow(0 0 8px rgba(0,212,255,0.3)); }
  50% { filter: drop-shadow(0 0 20px rgba(0,212,255,0.6)); }
}
.cp-splash-title {
  font-family: var(--font-display);
  font-size: 28px;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 4px;
}
.cp-splash-org {
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 600;
  color: var(--cyan);
  text-transform: uppercase;
  letter-spacing: 0.12em;
  margin-bottom: 8px;
}
.cp-splash-since {
  font-size: 12px;
  color: var(--text-secondary);
  margin-bottom: 28px;
}
.cp-splash-stats {
  text-align: left;
  margin: 0 auto 28px;
  max-width: 520px;
}
.cp-splash-stat-line {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 8px 0;
  border-bottom: 1px solid var(--border-subtle);
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.5;
}
.cp-splash-stat-line:last-child { border-bottom: none; }
.cp-splash-stat-line strong { color: var(--text-primary); }
.cp-splash-stat-icon {
  flex-shrink: 0;
  width: 22px;
  text-align: center;
  font-size: 14px;
  line-height: 1.4;
}
.cp-splash-stat-icon.green { color: var(--green); }
.cp-splash-stat-icon.amber { color: var(--amber); }
.cp-splash-stat-icon.red { color: var(--red); }
.cp-splash-stat-icon.cyan { color: var(--cyan); }
.cp-splash-continue {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 600;
  color: #fff;
  background: linear-gradient(135deg, #00d4ff, #0088cc);
  border: none;
  border-radius: 8px;
  padding: 12px 32px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 0 20px rgba(0,212,255,0.2);
}
.cp-splash-continue:hover {
  box-shadow: 0 0 30px rgba(0,212,255,0.4);
  transform: translateY(-1px);
}
.cp-splash-continue svg {
  transition: transform 0.2s ease;
}
.cp-splash-continue:hover svg {
  transform: translateX(3px);
}
.cp-splash-footer {
  margin-top: 24px;
  font-size: 10px;
  color: var(--text-muted);
  letter-spacing: 0.02em;
}
.cp-period-summary {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  background: rgba(0,212,255,0.04);
  border: 1px solid rgba(0,212,255,0.12);
  border-radius: 10px;
  padding: 14px 18px;
  margin-bottom: 20px;
}
.cp-period-icon {
  font-size: 20px;
  flex-shrink: 0;
}
.cp-period-text {
  font-size: 12px;
  color: var(--text-secondary);
  line-height: 1.6;
}
.cp-period-text strong {
  color: var(--text-primary);
}

/* ============================================================
   WAR ROOM â€” IR / DFIR CENTER
   ============================================================ */

/* Case selector bar */
.wr-case-bar {
  display: flex;
  gap: 0;
  border-bottom: 1px solid rgba(255,255,255,0.06);
  margin-bottom: 20px;
  overflow-x: auto;
}
.wr-case-tab {
  padding: 12px 24px;
  cursor: pointer;
  font-size: 13px;
  color: var(--text-secondary);
  border-bottom: 2px solid transparent;
  transition: all 0.25s;
  white-space: nowrap;
  display: flex;
  align-items: center;
  gap: 10px;
}
.wr-case-tab:hover {
  color: var(--text-primary);
  background: rgba(0,212,255,0.03);
}
.wr-case-tab.active {
  color: var(--accent);
  border-bottom: 2px solid var(--accent);
  box-shadow: 0 2px 12px rgba(0,212,255,0.15);
}
.wr-case-id {
  font-family: 'IBM Plex Mono', monospace;
  font-weight: 600;
  font-size: 12px;
}
.wr-case-name {
  font-size: 13px;
}
.wr-case-badge {
  font-size: 10px;
  padding: 2px 8px;
  border-radius: 4px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.wr-case-badge.p1 {
  background: rgba(255,59,48,0.15);
  color: #ff3b30;
  border: 1px solid rgba(255,59,48,0.3);
}
.wr-case-badge.p2 {
  background: rgba(255,159,10,0.15);
  color: #ff9f0a;
  border: 1px solid rgba(255,159,10,0.3);
}
.wr-case-badge.active-badge {
  background: rgba(48,209,88,0.15);
  color: #30d158;
  border: 1px solid rgba(48,209,88,0.3);
}
.wr-case-badge.monitoring-badge {
  background: rgba(0,212,255,0.12);
  color: var(--accent);
  border: 1px solid rgba(0,212,255,0.25);
}

/* Inner tabs */
.wr-tabs {
  display: flex;
  gap: 0;
  border-bottom: 1px solid rgba(255,255,255,0.06);
  margin-bottom: 20px;
  flex-wrap: wrap;
}
.wr-tab {
  padding: 10px 18px;
  cursor: pointer;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-secondary);
  border-bottom: 2px solid transparent;
  transition: all 0.2s;
  text-transform: uppercase;
  letter-spacing: 0.8px;
}
.wr-tab:hover {
  color: var(--text-primary);
}
.wr-tab.active {
  color: var(--accent);
  border-bottom: 2px solid var(--accent);
}
.wr-tab-content {
  display: none;
}
.wr-tab-content.active {
  display: block;
  animation: fadeIn 0.3s;
}

/* DFIR Phase pipeline */
.wr-phase-pipeline {
  display: flex;
  align-items: center;
  gap: 0;
  margin: 20px 0;
  overflow-x: auto;
  padding-bottom: 4px;
}
.wr-phase {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 18px;
  position: relative;
  flex-shrink: 0;
}
.wr-phase::after {
  content: '';
  width: 28px;
  height: 2px;
  background: rgba(255,255,255,0.1);
  flex-shrink: 0;
}
.wr-phase:last-child::after {
  display: none;
}
.wr-phase-dot {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 700;
  flex-shrink: 0;
  transition: all 0.3s;
}
.wr-phase.complete .wr-phase-dot {
  background: rgba(48,209,88,0.2);
  border: 2px solid #30d158;
  color: #30d158;
}
.wr-phase.current .wr-phase-dot {
  background: rgba(255,159,10,0.2);
  border: 2px solid #ff9f0a;
  color: #ff9f0a;
  animation: phasePulse 2s ease-in-out infinite;
}
.wr-phase.pending .wr-phase-dot {
  background: rgba(255,255,255,0.05);
  border: 2px solid rgba(255,255,255,0.15);
  color: rgba(255,255,255,0.25);
}
.wr-phase-label {
  font-size: 12px;
  font-weight: 500;
  white-space: nowrap;
}
.wr-phase.complete .wr-phase-label {
  color: #30d158;
}
.wr-phase.current .wr-phase-label {
  color: #ff9f0a;
}
.wr-phase.pending .wr-phase-label {
  color: rgba(255,255,255,0.3);
}
@keyframes phasePulse {
  0%, 100% { box-shadow: 0 0 0 0 rgba(255,159,10,0.4); }
  50% { box-shadow: 0 0 0 8px rgba(255,159,10,0); }
}

/* Summary detail grid */
.wr-summary-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin-bottom: 20px;
}
@media (max-width: 900px) {
  .wr-summary-grid { grid-template-columns: 1fr; }
}
.wr-detail-card {
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 10px;
  padding: 20px;
}
.wr-detail-card h4 {
  font-size: 13px;
  font-weight: 600;
  color: var(--accent);
  margin: 0 0 14px 0;
  text-transform: uppercase;
  letter-spacing: 0.8px;
}
.wr-detail-row {
  display: flex;
  justify-content: space-between;
  padding: 6px 0;
  font-size: 13px;
  border-bottom: 1px solid rgba(255,255,255,0.03);
}
.wr-detail-row:last-child {
  border-bottom: none;
}
.wr-detail-key {
  color: var(--text-secondary);
}
.wr-detail-val {
  color: var(--text-primary);
  font-weight: 500;
  text-align: right;
  max-width: 60%;
}

/* Quick stats row */
.wr-stats-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 12px;
  margin-bottom: 20px;
}
.wr-stat-card {
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 10px;
  padding: 16px;
  text-align: center;
}
.wr-stat-val {
  font-size: 26px;
  font-weight: 700;
  color: var(--text-primary);
  font-family: 'IBM Plex Mono', monospace;
}
.wr-stat-label {
  font-size: 11px;
  color: var(--text-secondary);
  margin-top: 4px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.wr-stat-card.cyan .wr-stat-val { color: var(--accent); }
.wr-stat-card.red .wr-stat-val { color: #ff3b30; }
.wr-stat-card.green .wr-stat-val { color: #30d158; }
.wr-stat-card.amber .wr-stat-val { color: #ff9f0a; }
.wr-stat-card.purple .wr-stat-val { color: #bf5af2; }

/* Timeline visualization */
.wr-timeline {
  position: relative;
  padding: 30px 0;
  overflow-x: auto;
}
.wr-timeline-track {
  display: flex;
  align-items: flex-start;
  gap: 0;
  position: relative;
  min-width: max-content;
  padding: 0 20px;
}
.wr-tl-node {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 160px;
  flex-shrink: 0;
  cursor: pointer;
  position: relative;
}
.wr-tl-time {
  font-size: 11px;
  font-family: 'IBM Plex Mono', monospace;
  color: var(--text-secondary);
  margin-bottom: 10px;
}
.wr-tl-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  position: relative;
  z-index: 2;
  transition: transform 0.2s, box-shadow 0.2s;
}
.wr-tl-node:hover .wr-tl-icon {
  transform: scale(1.15);
  box-shadow: 0 0 20px rgba(0,212,255,0.3);
}
.wr-tl-icon.exploit {
  background: rgba(255,59,48,0.2);
  border: 2px solid #ff3b30;
  color: #ff3b30;
}
.wr-tl-icon.lateral {
  background: rgba(255,159,10,0.2);
  border: 2px solid #ff9f0a;
  color: #ff9f0a;
}
.wr-tl-icon.discovery {
  background: rgba(0,212,255,0.2);
  border: 2px solid var(--accent);
  color: var(--accent);
}
.wr-tl-icon.c2 {
  background: rgba(191,90,242,0.2);
  border: 2px solid #bf5af2;
  color: #bf5af2;
}
.wr-tl-icon.contain {
  background: rgba(48,209,88,0.2);
  border: 2px solid #30d158;
  color: #30d158;
}
.wr-tl-connector {
  position: absolute;
  top: 55px;
  left: calc(50% + 20px);
  width: calc(100% - 40px);
  height: 2px;
  z-index: 1;
}
.wr-tl-connector-line {
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, rgba(255,255,255,0.15), rgba(0,212,255,0.3));
  position: relative;
}
.wr-tl-connector-line::after {
  content: 'â†’';
  position: absolute;
  right: -6px;
  top: -8px;
  font-size: 14px;
  color: rgba(0,212,255,0.5);
}
.wr-tl-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-primary);
  margin-top: 10px;
  text-align: center;
  line-height: 1.4;
}
.wr-tl-desc {
  font-size: 10px;
  color: var(--text-secondary);
  text-align: center;
  margin-top: 4px;
  line-height: 1.4;
}
.wr-tl-detail {
  display: none;
  margin-top: 10px;
  background: rgba(0,212,255,0.05);
  border: 1px solid rgba(0,212,255,0.15);
  border-radius: 8px;
  padding: 10px;
  font-size: 11px;
  color: var(--text-secondary);
  line-height: 1.5;
  text-align: left;
  width: 200px;
  position: relative;
  left: -20px;
}
.wr-tl-detail.open {
  display: block;
  animation: fadeIn 0.25s;
}

/* Tasks list */
.wr-task-list {
  list-style: none;
  padding: 0;
  margin: 0;
}
.wr-task-item {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 12px 16px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  font-size: 13px;
  transition: background 0.2s;
}
.wr-task-item:hover {
  background: rgba(255,255,255,0.02);
}
.wr-task-item:last-child {
  border-bottom: none;
}
.wr-task-icon {
  font-size: 15px;
  flex-shrink: 0;
  margin-top: 1px;
}
.wr-task-body {
  flex: 1;
}
.wr-task-title {
  color: var(--text-primary);
  font-weight: 500;
}
.wr-task-meta {
  font-size: 11px;
  color: var(--text-secondary);
  margin-top: 3px;
}

/* Notes */
.wr-note {
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 10px;
  padding: 18px;
  margin-bottom: 14px;
}
.wr-note-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}
.wr-note-author {
  font-size: 13px;
  font-weight: 600;
  color: var(--accent);
}
.wr-note-time {
  font-size: 11px;
  color: var(--text-secondary);
  font-family: 'IBM Plex Mono', monospace;
}
.wr-note-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 8px;
}
.wr-note-body {
  font-size: 13px;
  color: var(--text-secondary);
  line-height: 1.7;
}

/* Graph placeholder */
.wr-graph-container {
  min-height: 400px;
  background: rgba(0,212,255,0.02);
  border: 1px dashed rgba(0,212,255,0.15);
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px;
}
.wr-graph-icon {
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.5;
}
.wr-graph-text {
  font-size: 14px;
  color: var(--text-secondary);
  text-align: center;
  max-width: 420px;
  line-height: 1.7;
}
.wr-graph-entities {
  display: flex;
  gap: 20px;
  margin-top: 30px;
  flex-wrap: wrap;
  justify-content: center;
}
.wr-graph-entity {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 8px;
  padding: 12px 18px;
  font-size: 12px;
  color: var(--text-secondary);
  text-align: center;
  min-width: 100px;
}
.wr-graph-entity .entity-icon {
  font-size: 20px;
  margin-bottom: 6px;
}
.wr-graph-entity .entity-label {
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 2px;
}
.wr-graph-arrow {
  display: flex;
  align-items: center;
  color: rgba(0,212,255,0.4);
  font-size: 18px;
}

/* Status indicator in header */
.wr-status-indicator {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--text-secondary);
  margin-top: 6px;
}
.wr-status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #30d158;
  animation: phasePulse 2s ease-in-out infinite;
}

/* IOC/Evidence tables extra styles */
.wr-tlp {
  font-size: 10px;
  padding: 2px 7px;
  border-radius: 3px;
  font-weight: 700;
  letter-spacing: 0.5px;
}
.wr-tlp.red {
  background: rgba(255,59,48,0.15);
  color: #ff3b30;
  border: 1px solid rgba(255,59,48,0.25);
}
.wr-tlp.amber {
  background: rgba(255,159,10,0.12);
  color: #ff9f0a;
  border: 1px solid rgba(255,159,10,0.25);
}
.wr-ioc-tags {
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
}
.wr-ioc-tag {
  font-size: 10px;
  padding: 1px 6px;
  border-radius: 3px;
  background: rgba(0,212,255,0.08);
  color: var(--accent);
  border: 1px solid rgba(0,212,255,0.15);
}

/* Evidence status badges */
.wr-ev-status {
  font-size: 10px;
  padding: 2px 8px;
  border-radius: 4px;
  font-weight: 600;
}
.wr-ev-status.processing {
  background: rgba(255,159,10,0.12);
  color: #ff9f0a;
}
.wr-ev-status.acquired {
  background: rgba(0,212,255,0.1);
  color: var(--accent);
}
.wr-ev-status.analyzed {
  background: rgba(48,209,88,0.12);
  color: #30d158;
}
.wr-ev-status.parsed {
  background: rgba(191,90,242,0.12);
  color: #bf5af2;
}
.wr-ev-status.pending {
  background: rgba(255,255,255,0.05);
  color: var(--text-secondary);
}

/* Asset status in warroom */
.wr-asset-status {
  font-size: 10px;
  padding: 2px 8px;
  border-radius: 4px;
  font-weight: 600;
}
.wr-asset-status.compromised {
  background: rgba(255,59,48,0.15);
  color: #ff3b30;
}
.wr-asset-status.contained {
  background: rgba(255,159,10,0.12);
  color: #ff9f0a;
}
.wr-asset-status.monitoring {
  background: rgba(0,212,255,0.1);
  color: var(--accent);
}
.wr-asset-status.clean {
  background: rgba(48,209,88,0.12);
  color: #30d158;
}

/* ============================================================
   VULNERABILITY MANAGEMENT
   ============================================================ */
.vm-metrics { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 16px; }
.vm-metric-card { background: var(--bg-card); border: 1px solid var(--border-card); border-radius: 10px; padding: 16px 18px; display: flex; flex-direction: column; gap: 4px; }
.vm-metric-card .vm-metric-value { font-size: 28px; font-weight: 800; font-family: var(--font-display); }
.vm-metric-card .vm-metric-label { font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }

.vm-scanner-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
.vm-scanner-item { display: flex; align-items: center; justify-content: space-between; padding: 12px 14px; background: rgba(255,255,255,0.02); border: 1px solid var(--border-subtle); border-radius: 8px; }
.vm-scanner-info { display: flex; flex-direction: column; gap: 2px; }
.vm-scanner-name { font-size: 13px; font-weight: 600; color: var(--text-primary); }
.vm-scanner-meta { font-size: 10px; color: var(--text-muted); }
.vm-scanner-status { display: flex; align-items: center; gap: 6px; font-size: 11px; }
.vm-scanner-status .status-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.vm-scanner-status .status-dot.green { background: var(--green); box-shadow: 0 0 6px var(--green); }
.vm-scanner-status .status-dot.red { background: var(--red); box-shadow: 0 0 6px var(--red); }

.vm-vuln-table .cvss-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 700; font-family: var(--font-mono); min-width: 36px; text-align: center; }
.vm-vuln-table .cvss-critical { background: rgba(239,68,68,0.18); color: var(--red-bright); border: 1px solid rgba(239,68,68,0.3); }
.vm-vuln-table .cvss-high { background: var(--amber-dim); color: var(--amber); border: 1px solid rgba(245,158,11,0.3); }
.vm-vuln-table .cvss-medium { background: var(--cyan-dim); color: var(--cyan); border: 1px solid rgba(0,212,255,0.3); }
.vm-vuln-table .cvss-low { background: var(--green-dim); color: var(--green); border: 1px solid rgba(16,185,129,0.3); }

.vm-status-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.3px; }
.vm-status-open { background: rgba(239,68,68,0.12); color: var(--red-bright); }
.vm-status-inprogress { background: var(--amber-dim); color: var(--amber); }
.vm-status-remediated { background: var(--green-dim); color: var(--green); }

.vm-dist-row { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
.vm-dist-label { width: 70px; font-size: 11px; color: var(--text-secondary); font-weight: 600; text-align: right; }
.vm-dist-bar-wrap { flex: 1; height: 24px; background: rgba(255,255,255,0.03); border-radius: 4px; overflow: hidden; position: relative; }
.vm-dist-bar { height: 100%; border-radius: 4px; display: flex; align-items: center; padding-left: 8px; font-size: 11px; font-weight: 600; font-family: var(--font-mono); transition: width 0.6s ease; }
.vm-dist-count { width: 50px; font-size: 11px; color: var(--text-muted); text-align: right; font-family: var(--font-mono); }

.vm-host-row { display: flex; align-items: center; gap: 12px; margin-bottom: 8px; padding: 8px 12px; background: rgba(255,255,255,0.02); border-radius: 6px; border: 1px solid var(--border-subtle); cursor: pointer; transition: var(--transition); }
.vm-host-row:hover { background: rgba(0,212,255,0.04); border-color: rgba(0,212,255,0.15); }
.vm-host-name { width: 180px; font-size: 12px; font-weight: 600; color: var(--cyan); font-family: var(--font-mono); }
.vm-host-bar-wrap { flex: 1; height: 18px; background: rgba(255,255,255,0.03); border-radius: 3px; overflow: hidden; }
.vm-host-bar { height: 100%; background: linear-gradient(90deg, rgba(0,212,255,0.4), rgba(0,212,255,0.15)); border-radius: 3px; }
.vm-host-count { width: 70px; font-size: 12px; color: var(--text-secondary); font-family: var(--font-mono); text-align: right; }

.vm-timeline { display: flex; flex-direction: column; gap: 0; position: relative; padding-left: 20px; }
.vm-timeline::before { content: ''; position: absolute; left: 7px; top: 8px; bottom: 8px; width: 2px; background: rgba(0,212,255,0.15); }
.vm-timeline-item { position: relative; padding: 10px 14px; display: flex; flex-direction: column; gap: 2px; }
.vm-timeline-item::before { content: ''; position: absolute; left: -17px; top: 14px; width: 10px; height: 10px; border-radius: 50%; background: var(--bg-card); border: 2px solid var(--cyan); }
.vm-timeline-item.remediated::before { background: var(--green); border-color: var(--green); }
.vm-timeline-title { font-size: 12px; color: var(--text-primary); font-weight: 600; }
.vm-timeline-meta { font-size: 10px; color: var(--text-muted); }

/* ============================================================
   AVM DASHBOARD â€” NEW VM PAGE STYLES
   ============================================================ */

/* AVM Metric Cards */
.avm-metrics { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 16px; }
.avm-metric-card { background: var(--bg-card); border: 1px solid var(--border-card); border-radius: 12px; padding: 18px 20px; position: relative; overflow: hidden; transition: var(--transition); }
.avm-metric-card::before { content: ''; position: absolute; inset: 0; opacity: 0; transition: opacity var(--transition); }
.avm-metric-card:hover::before { opacity: 1; }
.avm-metric-card.avm-mc-red { border-color: rgba(239,68,68,0.2); }
.avm-metric-card.avm-mc-red::after { content: ''; position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: radial-gradient(circle, rgba(239,68,68,0.12) 0%, transparent 70%); pointer-events: none; }
.avm-metric-card.avm-mc-orange { border-color: rgba(249,115,22,0.2); }
.avm-metric-card.avm-mc-orange::after { content: ''; position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: radial-gradient(circle, rgba(249,115,22,0.12) 0%, transparent 70%); pointer-events: none; }
.avm-metric-card.avm-mc-amber { border-color: rgba(245,158,11,0.2); }
.avm-metric-card.avm-mc-amber::after { content: ''; position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: radial-gradient(circle, rgba(245,158,11,0.12) 0%, transparent 70%); pointer-events: none; }
.avm-metric-card.avm-mc-purple { border-color: rgba(139,92,246,0.2); }
.avm-metric-card.avm-mc-purple::after { content: ''; position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: radial-gradient(circle, rgba(139,92,246,0.12) 0%, transparent 70%); pointer-events: none; }
.avm-mc-label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.12em; color: var(--text-muted); margin-bottom: 8px; position: relative; z-index: 1; }
.avm-mc-value { font-size: 32px; font-weight: 800; font-family: var(--font-display); color: var(--text-primary); line-height: 1; margin-bottom: 4px; position: relative; z-index: 1; }
.avm-mc-value.red { color: var(--red-bright); }
.avm-mc-value.orange { color: var(--orange); }
.avm-mc-value.amber { color: var(--amber); }
.avm-mc-value.purple { color: #a78bfa; }
.avm-mc-sub { font-size: 11px; color: var(--text-muted); position: relative; z-index: 1; margin-bottom: 10px; }
.avm-mc-sparkline { display: flex; align-items: flex-end; gap: 2px; height: 28px; position: relative; z-index: 1; }
.avm-mc-sparkline span { flex: 1; border-radius: 2px 2px 0 0; min-width: 4px; transition: opacity var(--transition); opacity: 0.7; }
.avm-mc-sparkline span:last-child { opacity: 1; }

/* AVM Trend Chart */
.avm-trend-card { background: var(--bg-card); border: 1px solid var(--border-card); border-radius: 12px; padding: 18px 20px 12px; margin-bottom: 16px; }
.avm-trend-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 14px; }
.avm-trend-title { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.12em; color: var(--text-muted); }
.avm-trend-legend { display: flex; gap: 16px; align-items: center; }
.avm-trend-leg-item { display: flex; align-items: center; gap: 6px; font-size: 11px; color: var(--text-secondary); }
.avm-trend-leg-dot { width: 8px; height: 8px; border-radius: 2px; }
.avm-chart-wrap { position: relative; width: 100%; height: 180px; }
.avm-chart-wrap svg { width: 100%; height: 100%; overflow: visible; }
.avm-chart-xaxis { display: flex; justify-content: space-between; padding: 6px 8px 0; }
.avm-chart-xaxis span { font-size: 10px; color: var(--text-muted); font-family: var(--font-mono); }

/* Vulnerabilities By + CVEs columns */
.avm-mid-grid { display: grid; grid-template-columns: 1fr 1.6fr; gap: 12px; margin-bottom: 16px; }

/* Vuln By card */
.avm-by-card { background: var(--bg-card); border: 1px solid var(--border-card); border-radius: 12px; padding: 18px 20px; }
.avm-by-tabs { display: flex; gap: 4px; margin-bottom: 16px; }
.avm-by-tab { padding: 4px 10px; border-radius: 5px; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.08em; color: var(--text-muted); background: transparent; border: 1px solid var(--border-subtle); cursor: pointer; transition: var(--transition); }
.avm-by-tab.active { background: var(--cyan-dim); color: var(--cyan); border-color: var(--border-accent); }
.avm-by-tab:hover:not(.active) { color: var(--text-secondary); border-color: rgba(255,255,255,0.1); }
.avm-by-content { display: flex; gap: 18px; align-items: center; }
.avm-donut-wrap { position: relative; flex-shrink: 0; width: 120px; height: 120px; }
.avm-donut { width: 120px; height: 120px; border-radius: 50%; }
.avm-donut-center { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
.avm-donut-center-val { font-size: 16px; font-weight: 800; font-family: var(--font-display); color: var(--text-primary); line-height: 1.1; }
.avm-donut-center-label { font-size: 8px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em; margin-top: 2px; }
.avm-donut-legend { flex: 1; display: flex; flex-direction: column; gap: 6px; }
.avm-donut-leg-row { display: flex; align-items: center; gap: 7px; }
.avm-donut-leg-dot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; }
.avm-donut-leg-name { flex: 1; font-size: 11px; color: var(--text-secondary); }
.avm-donut-leg-count { font-size: 11px; font-family: var(--font-mono); color: var(--text-muted); }

/* CVEs In The Headlines */
.avm-cve-card { background: var(--bg-card); border: 1px solid var(--border-card); border-radius: 12px; padding: 18px 20px; }
.avm-cve-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-top: 14px; }
.avm-cve-item { background: rgba(255,255,255,0.025); border: 1px solid var(--border-subtle); border-radius: 8px; padding: 12px 10px; display: flex; flex-direction: column; gap: 5px; transition: var(--transition); cursor: pointer; }
.avm-cve-item:hover { background: rgba(0,212,255,0.04); border-color: rgba(0,212,255,0.15); transform: translateY(-1px); }
.avm-cve-name { font-size: 12px; font-weight: 700; color: var(--text-primary); font-family: var(--font-display); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.avm-cve-id { font-size: 9px; color: var(--cyan); font-family: var(--font-mono); margin-bottom: 2px; }
.avm-cve-count { font-size: 18px; font-weight: 800; font-family: var(--font-display); color: var(--amber); line-height: 1; }
.avm-cve-unit { font-size: 9px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em; }
.avm-cve-link { font-size: 9px; color: var(--cyan); text-decoration: none; opacity: 0.7; margin-top: 2px; }
.avm-cve-link:hover { opacity: 1; text-decoration: underline; }

/* Scanner Integration Row */
.avm-scanner-row { display: flex; gap: 10px; margin-bottom: 16px; flex-wrap: wrap; }
.avm-scanner-pill { display: flex; align-items: center; gap: 8px; padding: 8px 14px; background: var(--bg-card); border: 1px solid var(--border-card); border-radius: 8px; transition: var(--transition); }
.avm-scanner-pill:hover { border-color: rgba(255,255,255,0.12); }
.avm-scanner-pill-name { font-size: 12px; font-weight: 600; color: var(--text-secondary); }
.avm-scanner-pill-status { font-size: 10px; font-weight: 600; }
.avm-scanner-pill-status.connected { color: var(--green); }
.avm-scanner-pill-status.syncing { color: var(--amber); }
.avm-scanner-pill-status.pending { color: var(--text-muted); }
.avm-scanner-pill .status-dot.syncing { background: var(--amber); box-shadow: 0 0 6px rgba(245,158,11,0.5); animation: pulse-amber 2s ease-in-out infinite; }
.avm-scanner-pill .status-dot.gray { background: var(--text-muted); }

@keyframes pulse-amber {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(0.8); }
}

/* AVM Vuln Table */
.avm-vuln-table { background: var(--bg-card); border: 1px solid var(--border-card); border-radius: 12px; padding: 18px 20px; }
.avm-vuln-table table { width: 100%; border-collapse: collapse; }
.avm-vuln-table thead th { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-muted); padding: 0 10px 10px; text-align: left; border-bottom: 1px solid var(--border-subtle); }
.avm-vuln-table tbody tr { border-bottom: 1px solid rgba(255,255,255,0.03); transition: background var(--transition); }
.avm-vuln-table tbody tr:hover { background: rgba(255,255,255,0.02); }
.avm-vuln-table tbody tr:last-child { border-bottom: none; }
.avm-vuln-table td { padding: 9px 10px; font-size: 12px; color: var(--text-secondary); vertical-align: middle; }
.avm-cvss { display: inline-flex; align-items: center; justify-content: center; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 700; font-family: var(--font-mono); min-width: 36px; }
.avm-cvss.critical { background: rgba(239,68,68,0.18); color: var(--red-bright); border: 1px solid rgba(239,68,68,0.3); }
.avm-cvss.high { background: var(--amber-dim); color: var(--amber); border: 1px solid rgba(245,158,11,0.3); }
.avm-cvss.medium { background: var(--cyan-dim); color: var(--cyan); border: 1px solid rgba(0,212,255,0.3); }
.avm-exploit-badge { display: inline-flex; align-items: center; gap: 4px; font-size: 10px; font-weight: 600; padding: 2px 7px; border-radius: 4px; }
.avm-exploit-badge.yes { background: rgba(239,68,68,0.1); color: var(--red-bright); border: 1px solid rgba(239,68,68,0.25); }
.avm-exploit-badge.no { background: rgba(255,255,255,0.04); color: var(--text-muted); border: 1px solid var(--border-subtle); }
.avm-exploit-badge.poc { background: rgba(245,158,11,0.1); color: var(--amber); border: 1px solid rgba(245,158,11,0.25); }


/* ============================================================
   THREAT INTELLIGENCE - ENHANCED
   ============================================================ */
.ti-feed-strip { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; }
.ti-feed-badge { display: flex; align-items: center; gap: 6px; padding: 6px 12px; background: rgba(255,255,255,0.03); border: 1px solid var(--border-subtle); border-radius: 20px; font-size: 11px; color: var(--text-secondary); }
.ti-feed-badge .feed-dot { width: 7px; height: 7px; border-radius: 50%; flex-shrink: 0; }
.ti-feed-badge .feed-dot.green { background: var(--green); box-shadow: 0 0 6px var(--green); }
.ti-feed-badge .feed-dot.purple { background: var(--purple); box-shadow: 0 0 6px var(--purple); }
.ti-feed-badge .feed-dot.red { background: var(--red); box-shadow: 0 0 6px var(--red); }

.ti-3col { display: grid; grid-template-columns: 40% 35% 25%; gap: 12px; }
@media (max-width: 1200px) { .ti-3col { grid-template-columns: 1fr; } }

.ti-news-list { display: flex; flex-direction: column; gap: 0; max-height: 520px; overflow-y: auto; }
.ti-news-item { display: flex; gap: 10px; padding: 10px 12px; border-bottom: 1px solid var(--border-subtle); transition: var(--transition); cursor: pointer; }
.ti-news-item:hover { background: rgba(0,212,255,0.03); }
.ti-news-item:last-child { border-bottom: none; }
.ti-news-source { flex-shrink: 0; padding: 2px 8px; border-radius: 4px; font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.3px; height: fit-content; margin-top: 2px; }
.ti-news-source.thn { background: rgba(239,68,68,0.12); color: var(--red-bright); }
.ti-news-source.bleeping { background: rgba(59,130,246,0.12); color: var(--blue); }
.ti-news-source.krebs { background: rgba(245,158,11,0.12); color: var(--amber); }
.ti-news-source.darkreading { background: rgba(139,92,246,0.12); color: var(--purple); }
.ti-news-source.secweek { background: rgba(16,185,129,0.12); color: var(--green); }
.ti-news-source.record { background: rgba(0,212,255,0.12); color: var(--cyan); }
.ti-news-content { flex: 1; display: flex; flex-direction: column; gap: 3px; }
.ti-news-headline { font-size: 12px; font-weight: 600; color: var(--text-primary); line-height: 1.4; }
.ti-news-snippet { font-size: 11px; color: var(--text-muted); line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.ti-news-footer { display: flex; align-items: center; gap: 8px; margin-top: 2px; }
.ti-news-time { font-size: 10px; color: var(--text-muted); }
.ti-news-tag { font-size: 9px; padding: 1px 6px; border-radius: 3px; font-weight: 600; text-transform: uppercase; }
.ti-news-tag.ransomware { background: rgba(239,68,68,0.12); color: var(--red-bright); }
.ti-news-tag.apt { background: rgba(249,115,22,0.12); color: var(--orange); }
.ti-news-tag.vulnerability { background: rgba(0,212,255,0.12); color: var(--cyan); }
.ti-news-tag.databreach { background: rgba(139,92,246,0.12); color: var(--purple); }
.ti-news-tag.malware { background: rgba(245,158,11,0.12); color: var(--amber); }
.ti-news-tag.phishing { background: rgba(59,130,246,0.12); color: var(--blue); }
.ti-news-tag.zeroday { background: rgba(239,68,68,0.18); color: #ff8888; }
.ti-news-tag.supply-chain { background: rgba(16,185,129,0.12); color: var(--green); }

.ti-ioc-table .tlp-badge { display: inline-block; padding: 1px 7px; border-radius: 3px; font-size: 9px; font-weight: 700; letter-spacing: 0.3px; }
.ti-ioc-table .tlp-red { background: rgba(239,68,68,0.15); color: var(--red-bright); border: 1px solid rgba(239,68,68,0.3); }
.ti-ioc-table .tlp-amber { background: var(--amber-dim); color: var(--amber); border: 1px solid rgba(245,158,11,0.3); }
.ti-ioc-table .tlp-green { background: var(--green-dim); color: var(--green); border: 1px solid rgba(16,185,129,0.3); }
.ti-ioc-table .tlp-white { background: rgba(255,255,255,0.08); color: var(--text-secondary); border: 1px solid rgba(255,255,255,0.15); }
.ti-ioc-score { font-family: var(--font-mono); font-weight: 700; font-size: 12px; }
.ti-ioc-score.high { color: var(--red-bright); }
.ti-ioc-score.medium { color: var(--amber); }
.ti-ioc-score.low { color: var(--green); }

.ti-actor-card { padding: 10px 12px; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 10px; transition: var(--transition); }
.ti-actor-card:hover { background: rgba(255,255,255,0.02); }
.ti-actor-card:last-child { border-bottom: none; }
.ti-actor-icon { width: 32px; height: 32px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
.ti-actor-info { flex: 1; }
.ti-actor-name { font-size: 12px; font-weight: 700; color: var(--text-primary); }
.ti-actor-detail { font-size: 10px; color: var(--text-muted); }
.ti-actor-status { font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 4px; }
.ti-actor-status.active { background: rgba(239,68,68,0.12); color: var(--red-bright); }
.ti-actor-status.monitoring { background: var(--amber-dim); color: var(--amber); }

.ti-stix-card { padding: 12px; }
.ti-stix-row { display: flex; justify-content: space-between; align-items: center; padding: 6px 0; border-bottom: 1px solid var(--border-subtle); font-size: 11px; }
.ti-stix-row:last-child { border-bottom: none; }
.ti-stix-key { color: var(--text-muted); }
.ti-stix-val { color: var(--cyan); font-family: var(--font-mono); font-size: 11px; }

.ti-report-item { display: flex; align-items: center; gap: 10px; padding: 10px 12px; border-bottom: 1px solid var(--border-subtle); cursor: pointer; transition: var(--transition); }
.ti-report-item:hover { background: rgba(0,212,255,0.03); }
.ti-report-item:last-child { border-bottom: none; }
.ti-report-icon { font-size: 18px; }
.ti-report-info { flex: 1; }
.ti-report-title { font-size: 12px; font-weight: 600; color: var(--text-primary); }
.ti-report-meta { font-size: 10px; color: var(--text-muted); }

/* ============================================================
   KILL CHAIN VISUALIZATION
   ============================================================ */
.kc-pipeline { display: flex; align-items: stretch; gap: 0; overflow-x: auto; padding: 8px 0; }
.kc-phase { flex: 1; min-width: 130px; display: flex; flex-direction: column; align-items: center; position: relative; }
.kc-phase:not(:last-child)::after { content: ''; position: absolute; right: -2px; top: 50%; transform: translateY(-50%); width: 0; height: 0; border-left: 10px solid rgba(0,212,255,0.25); border-top: 10px solid transparent; border-bottom: 10px solid transparent; z-index: 2; }
.kc-card { width: 100%; padding: 14px 10px; background: rgba(255,255,255,0.03); border: 1px solid var(--border-subtle); border-radius: 8px; display: flex; flex-direction: column; align-items: center; gap: 6px; transition: var(--transition); text-align: center; }
.kc-card:hover { background: rgba(0,212,255,0.04); border-color: rgba(0,212,255,0.15); }
.kc-card.coverage-high { border-color: rgba(16,185,129,0.3); }
.kc-card.coverage-med { border-color: rgba(245,158,11,0.3); }
.kc-card.coverage-low { border-color: rgba(239,68,68,0.3); }
.kc-number { font-size: 10px; color: var(--text-muted); font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
.kc-name { font-size: 12px; font-weight: 700; color: var(--text-primary); font-family: var(--font-display); line-height: 1.3; }
.kc-rules { font-size: 18px; font-weight: 800; font-family: var(--font-display); }
.kc-rules-label { font-size: 9px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.3px; }
.kc-progress { width: 80%; height: 6px; background: rgba(255,255,255,0.06); border-radius: 3px; overflow: hidden; }
.kc-progress-fill { height: 100%; border-radius: 3px; transition: width 0.6s ease; }
.kc-progress-fill.high { background: var(--green); }
.kc-progress-fill.med { background: var(--amber); }
.kc-progress-fill.low { background: var(--red); }
.kc-coverage { font-size: 11px; font-weight: 700; font-family: var(--font-mono); }
.kc-coverage.high { color: var(--green); }
.kc-coverage.med { color: var(--amber); }
.kc-coverage.low { color: var(--red); }

/* ============================================================
   MITRE ICS / OT COVERAGE
   ============================================================ */
.ics-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
@media (max-width: 1200px) { .ics-grid { grid-template-columns: repeat(3, 1fr); } }
@media (max-width: 900px) { .ics-grid { grid-template-columns: repeat(2, 1fr); } }
.ics-cell { padding: 12px; background: rgba(255,255,255,0.02); border: 1px solid var(--border-subtle); border-radius: 8px; display: flex; flex-direction: column; gap: 6px; transition: var(--transition); }
.ics-cell:hover { background: rgba(0,212,255,0.03); border-color: rgba(0,212,255,0.1); }
.ics-tactic-name { font-size: 11px; font-weight: 700; color: var(--text-primary); line-height: 1.3; }
.ics-coverage-text { font-size: 10px; color: var(--text-muted); font-family: var(--font-mono); }
.ics-bar { width: 100%; height: 5px; background: rgba(255,255,255,0.06); border-radius: 3px; overflow: hidden; }
.ics-bar-fill { height: 100%; border-radius: 3px; }
.ics-bar-fill.high { background: var(--green); }
.ics-bar-fill.med { background: var(--amber); }
.ics-bar-fill.low { background: var(--red); }
.ics-bar-fill.none { background: rgba(255,255,255,0.08); }

.ics-summary { display: flex; align-items: center; justify-content: space-between; margin-top: 12px; padding: 12px 16px; background: rgba(249,115,22,0.04); border: 1px solid rgba(249,115,22,0.15); border-radius: 8px; }
.ics-summary-left { display: flex; align-items: center; gap: 12px; }
.ics-summary-value { font-size: 22px; font-weight: 800; font-family: var(--font-display); color: var(--orange); }
.ics-summary-text { font-size: 12px; color: var(--text-secondary); line-height: 1.4; }
.ics-summary-note { font-size: 11px; color: var(--text-muted); font-style: italic; }


/* ============================================================
   GEO MAP STYLES
   ============================================================ */
.cc-geomap-card {
  background: rgba(17, 24, 39, 0.7);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 10px;
  padding: 16px 18px 12px;
  margin-bottom: 20px;
}
.cc-geomap-header {
  display: flex;
  align-items: baseline;
  gap: 10px;
  margin-bottom: 10px;
}
.cc-geomap-title {
  font-family: var(--font-display);
  font-size: 13px;
  font-weight: 600;
  color: var(--text-primary);
}
.cc-geomap-subtitle {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-muted);
}
.cc-geomap-legend {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
  margin-top: 10px;
  padding-top: 8px;
  border-top: 1px solid rgba(255,255,255,0.04);
}
.cc-geomap-legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-muted);
}
.cc-geo-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  display: inline-block;
}
.cc-geomap-tooltip {
  position: absolute;
  pointer-events: none;
  background: rgba(17, 24, 39, 0.95);
  border: 1px solid rgba(0,212,255,0.3);
  border-radius: 6px;
  padding: 6px 10px;
  font-size: 11px;
  color: var(--text-primary);
  font-family: var(--font-mono);
  display: none;
  z-index: 10;
  backdrop-filter: blur(8px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);
  white-space: nowrap;
}

/* ============================================================
   CLIENT PORTAL ENHANCEMENTS
   ============================================================ */
/* Animated mesh gradient background */
.cp-mesh-bg {
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  background:
    radial-gradient(ellipse at 20% 50%, rgba(0,212,255,0.04) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 20%, rgba(139,92,246,0.03) 0%, transparent 50%),
    radial-gradient(ellipse at 60% 80%, rgba(16,185,129,0.03) 0%, transparent 50%);
  animation: cpMeshMove 20s ease-in-out infinite alternate;
  pointer-events: none;
  z-index: 0;
}
@keyframes cpMeshMove {
  0% { background-position: 0% 0%, 100% 0%, 50% 100%; }
  33% { background-position: 100% 50%, 0% 100%, 80% 0%; }
  66% { background-position: 50% 100%, 50% 0%, 0% 50%; }
  100% { background-position: 0% 0%, 100% 0%, 50% 100%; }
}
.cp-portal-inner > * {
  position: relative;
  z-index: 1;
}

/* Header row with security score */
.cp-header-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
}
.cp-shield-anim {
  animation: cpShieldPulse 3s ease-in-out infinite;
}
@keyframes cpShieldPulse {
  0%, 100% { filter: drop-shadow(0 0 4px rgba(0,212,255,0.3)); }
  50% { filter: drop-shadow(0 0 10px rgba(0,212,255,0.5)); }
}
.cp-security-score {
  position: relative;
  width: 80px;
  height: 80px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.cp-score-label {
  position: absolute;
  text-align: center;
}
.cp-score-val {
  font-family: var(--font-display);
  font-size: 22px;
  font-weight: 800;
  color: #10b981;
  line-height: 1;
}
.cp-score-sub {
  font-family: var(--font-mono);
  font-size: 8px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-top: 2px;
}

/* Glow metric cards */
.cp-glow-card.red {
  border: 1px solid rgba(239,68,68,0.25) !important;
  box-shadow: 0 0 15px rgba(239,68,68,0.08), inset 0 0 15px rgba(239,68,68,0.03);
}
.cp-glow-card.amber {
  border: 1px solid rgba(245,158,11,0.25) !important;
  box-shadow: 0 0 15px rgba(245,158,11,0.08), inset 0 0 15px rgba(245,158,11,0.03);
}
.cp-glow-card.green {
  border: 1px solid rgba(16,185,129,0.25) !important;
  box-shadow: 0 0 15px rgba(16,185,129,0.08), inset 0 0 15px rgba(16,185,129,0.03);
}
.cp-glow-card.cyan {
  border: 1px solid rgba(0,212,255,0.25) !important;
  box-shadow: 0 0 15px rgba(0,212,255,0.08), inset 0 0 15px rgba(0,212,255,0.03);
}
.cp-glow-card .metric-value {
  font-size: 32px !important;
}

/* Glassmorphism SLA card */
.cp-glass-card {
  background: rgba(17,24,39,0.5) !important;
  backdrop-filter: blur(16px) !important;
  -webkit-backdrop-filter: blur(16px) !important;
  border: 1px solid rgba(0,212,255,0.12) !important;
  box-shadow: 0 8px 32px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.05);
}

/* Incident items with severity borders */
.cp-incident-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  border-left: 3px solid transparent;
  transition: background 0.2s, border-color 0.2s;
  cursor: default;
}
.cp-incident-item:hover {
  background: rgba(255,255,255,0.02);
}
.cp-incident-item.cp-sev-p1 {
  border-left-color: #ef4444;
  background: rgba(239,68,68,0.04);
}
.cp-incident-item.cp-sev-p1:hover {
  background: rgba(239,68,68,0.08);
}
.cp-incident-item.cp-sev-p2 {
  border-left-color: #f59e0b;
}
.cp-incident-item.cp-sev-p2:hover {
  background: rgba(245,158,11,0.04);
}
.cp-incident-item.cp-sev-p3 {
  border-left-color: #00d4ff;
}
.cp-incident-item.cp-sev-p3:hover {
  background: rgba(0,212,255,0.04);
}
.cp-incident-item.cp-sev-p4 {
  border-left-color: #10b981;
}

/* Report cards grid */
.cp-reports-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
}
@media (max-width: 768px) {
  .cp-reports-grid { grid-template-columns: 1fr; }
}
.cp-report-card {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 14px;
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
}
.cp-report-card:hover {
  background: rgba(0,212,255,0.04);
  border-color: rgba(0,212,255,0.2);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}
.cp-report-icon {
  font-size: 20px;
  flex-shrink: 0;
}
.cp-report-info {
  flex: 1;
  min-width: 0;
}
.cp-report-name {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.cp-report-meta {
  font-size: 10px;
  color: var(--text-muted);
  font-family: var(--font-mono);
  margin-top: 2px;
}

/* Client portal geo card */
.cp-geo-card {
  border: 1px solid rgba(255,255,255,0.06) !important;
}


/* ============================================================
   DACTA COPILOT PAGE
   ============================================================ */

/* Page layout override â€” no padding for Copilot */
#page-copilot {
  padding: 0;
  display: none;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
}
#page-copilot.active {
  display: flex;
}

/* ---- Copilot Page Header ---- */
.copilot-header {
  padding: 16px 24px 0;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.copilot-header-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.copilot-title-row {
  display: flex;
  align-items: center;
  gap: 12px;
}
.copilot-logo-badge {
  width: 38px;
  height: 38px;
  border-radius: 10px;
  background: linear-gradient(135deg, rgba(0,212,255,0.2) 0%, rgba(139,92,246,0.25) 100%);
  border: 1px solid rgba(0,212,255,0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  box-shadow: 0 0 20px rgba(0,212,255,0.15), inset 0 1px 0 rgba(255,255,255,0.08);
  position: relative;
}
.copilot-logo-badge::after {
  content: '';
  position: absolute;
  top: -2px; right: -2px;
  width: 8px; height: 8px;
  background: var(--green);
  border-radius: 50%;
  border: 2px solid var(--bg-surface);
  box-shadow: 0 0 6px var(--green);
}
.copilot-title-text h1 {
  font-family: var(--font-display);
  font-size: 17px;
  font-weight: 700;
  color: var(--text-primary);
  letter-spacing: -0.01em;
}
.copilot-title-text h1 span {
  background: linear-gradient(90deg, var(--cyan) 0%, #a78bfa 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}
.copilot-title-text p {
  font-size: 11px;
  color: var(--text-muted);
  font-family: var(--font-mono);
  margin-top: 1px;
}
.copilot-header-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}
.copilot-shortcut-badge {
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  color: var(--text-muted);
  font-family: var(--font-mono);
  font-size: 10px;
  padding: 3px 8px;
  border-radius: 5px;
  display: flex;
  align-items: center;
  gap: 5px;
}
.copilot-shortcut-badge kbd {
  background: var(--bg-elevated);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 3px;
  padding: 1px 4px;
  font-size: 10px;
  color: var(--cyan);
}

/* ---- Domain Selector Bar ---- */
.copilot-domain-bar {
  display: flex;
  gap: 6px;
  padding: 0 24px;
  flex-shrink: 0;
  margin-top: 12px;
  overflow-x: auto;
  padding-bottom: 2px;
}
.copilot-domain-bar::-webkit-scrollbar { height: 0; }
.domain-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  border-radius: 7px;
  border: 1px solid var(--border-subtle);
  background: var(--bg-card);
  color: var(--text-secondary);
  font-size: 11.5px;
  font-weight: 500;
  font-family: var(--font-body);
  cursor: pointer;
  transition: all var(--transition);
  white-space: nowrap;
  flex-shrink: 0;
}
.domain-btn:hover {
  background: var(--bg-elevated);
  border-color: var(--border-card);
  color: var(--text-primary);
}
.domain-btn.active {
  background: var(--cyan-dim);
  border-color: rgba(0,212,255,0.35);
  color: var(--cyan);
  box-shadow: 0 0 12px rgba(0,212,255,0.1), inset 0 1px 0 rgba(0,212,255,0.1);
}
.domain-btn .domain-icon {
  font-size: 14px;
  line-height: 1;
}

/* ---- Main Copilot Body ---- */
.copilot-body {
  display: flex;
  flex: 1;
  gap: 16px;
  overflow: hidden;
  min-height: 0;
  height: calc(100vh - 220px);
  margin-top: 12px;
  padding: 0 24px 16px;
}

/* ---- Conversation Area ---- */
.copilot-conversation {
  flex: 1;
  min-width: 0;
  min-height: 0;
  display: flex;
  flex-direction: column;
  gap: 0;
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 12px;
  overflow: hidden;
  position: relative;
}
.copilot-conv-header {
  padding: 12px 16px;
  border-bottom: 1px solid var(--border-subtle);
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-shrink: 0;
  background: rgba(255,255,255,0.015);
}
.copilot-conv-title {
  font-size: 11px;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.12em;
  display: flex;
  align-items: center;
  gap: 8px;
}
.copilot-session-indicator {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 10px;
  color: var(--text-muted);
  font-family: var(--font-mono);
}
.copilot-session-dot {
  width: 6px; height: 6px;
  border-radius: 50%;
  background: var(--green);
  box-shadow: 0 0 6px var(--green);
  animation: pulseDot 2s ease-in-out infinite;
}
@keyframes pulseDot {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.copilot-messages {
  flex: 1;
  overflow-y: auto;
  padding: 20px 16px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* ---- Message Bubbles ---- */
.msg-row {
  display: flex;
  gap: 10px;
}
.msg-row.analyst {
  flex-direction: row-reverse;
}
.msg-avatar {
  width: 28px;
  height: 28px;
  border-radius: 8px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  margin-top: 2px;
}
.msg-avatar.copilot-av {
  background: linear-gradient(135deg, rgba(0,212,255,0.2), rgba(139,92,246,0.25));
  border: 1px solid rgba(0,212,255,0.25);
  box-shadow: 0 0 10px rgba(0,212,255,0.1);
}
.msg-avatar.analyst-av {
  background: rgba(245,158,11,0.15);
  border: 1px solid rgba(245,158,11,0.25);
}
.msg-content {
  max-width: 85%;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.msg-row.analyst .msg-content {
  align-items: flex-end;
}
.msg-meta {
  font-size: 10px;
  color: var(--text-muted);
  font-family: var(--font-mono);
  display: flex;
  align-items: center;
  gap: 6px;
}
.msg-sender {
  font-weight: 600;
  color: var(--text-secondary);
}
.msg-bubble-analyst {
  background: rgba(245,158,11,0.08);
  border: 1px solid rgba(245,158,11,0.15);
  border-radius: 10px 4px 10px 10px;
  padding: 10px 14px;
  font-size: 13px;
  color: var(--text-primary);
  font-family: var(--font-mono);
  font-weight: 500;
  line-height: 1.5;
}
.msg-bubble-copilot {
  background: rgba(0,212,255,0.04);
  border: 1px solid rgba(0,212,255,0.12);
  border-radius: 4px 10px 10px 10px;
  padding: 14px 16px;
  font-size: 12.5px;
  color: var(--text-primary);
  line-height: 1.6;
  width: 100%;
  max-width: 100%;
}

/* ---- IOC Enrichment Card ---- */
.ioc-enrichment-card {
  background: var(--bg-surface);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  overflow: hidden;
  margin-top: 4px;
}
.ioc-card-header {
  padding: 12px 14px;
  background: linear-gradient(135deg, rgba(239,68,68,0.12), rgba(239,68,68,0.04));
  border-bottom: 1px solid rgba(239,68,68,0.2);
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.ioc-verdict {
  display: flex;
  align-items: center;
  gap: 10px;
}
.ioc-verdict-badge {
  background: rgba(239,68,68,0.15);
  color: #ff6b6b;
  border: 1px solid rgba(239,68,68,0.4);
  padding: 4px 10px;
  border-radius: 5px;
  font-size: 11px;
  font-weight: 700;
  font-family: var(--font-mono);
  letter-spacing: 0.08em;
  box-shadow: 0 0 10px rgba(239,68,68,0.2), inset 0 0 8px rgba(239,68,68,0.05);
  animation: redPulse 2s ease-in-out infinite;
}
@keyframes redPulse {
  0%, 100% { box-shadow: 0 0 10px rgba(239,68,68,0.2), inset 0 0 8px rgba(239,68,68,0.05); }
  50% { box-shadow: 0 0 18px rgba(239,68,68,0.35), inset 0 0 12px rgba(239,68,68,0.1); }
}
.ioc-ip-display {
  font-family: var(--font-mono);
  font-size: 15px;
  font-weight: 600;
  color: var(--text-primary);
  letter-spacing: 0.02em;
}
.ioc-confidence {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  color: var(--text-muted);
}
.ioc-conf-bar {
  width: 60px;
  height: 4px;
  background: rgba(255,255,255,0.08);
  border-radius: 4px;
  overflow: hidden;
}
.ioc-conf-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--red) 0%, #ff6b6b 100%);
  border-radius: 4px;
  box-shadow: 0 0 6px rgba(239,68,68,0.5);
}

.ioc-sources-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0;
  border-bottom: 1px solid var(--border-subtle);
}
.ioc-source-row {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  padding: 10px 14px;
  border-bottom: 1px solid var(--border-subtle);
  border-right: 1px solid var(--border-subtle);
  transition: background var(--transition);
}
.ioc-source-row:hover { background: rgba(255,255,255,0.02); }
.ioc-source-row:nth-child(even) { border-right: none; }
.ioc-source-row:last-child, .ioc-source-row:nth-last-child(2):nth-child(odd) {
  border-bottom: none;
}
.ioc-source-icon {
  width: 24px;
  height: 24px;
  border-radius: 5px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  margin-top: 1px;
}
.src-vt { background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.2); }
.src-abuse { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.2); }
.src-shodan { background: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.2); }
.src-misp { background: rgba(139,92,246,0.1); border: 1px solid rgba(139,92,246,0.2); }
.src-tfox { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.2); }
.src-dns { background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.2); }
.src-geo { background: rgba(59,130,246,0.1); border: 1px solid rgba(59,130,246,0.2); }
.src-dacta { background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.25); }

.ioc-source-body { flex: 1; min-width: 0; }
.ioc-source-name {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 2px;
}
.ioc-source-value {
  font-size: 12px;
  color: var(--text-primary);
  line-height: 1.4;
  font-family: var(--font-body);
}
.ioc-source-value.mono { font-family: var(--font-mono); font-size: 11px; }
.ioc-indicator {
  width: 8px; height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
  margin-top: 4px;
}
.ind-red { background: var(--red); box-shadow: 0 0 6px rgba(239,68,68,0.6); }
.ind-amber { background: var(--amber); box-shadow: 0 0 6px rgba(245,158,11,0.6); }
.ind-green { background: var(--green); box-shadow: 0 0 6px rgba(16,185,129,0.6); }
.ind-cyan { background: var(--cyan); box-shadow: 0 0 6px rgba(0,212,255,0.6); }
.ind-purple { background: var(--purple); box-shadow: 0 0 6px rgba(139,92,246,0.6); }

.ioc-mitre-row {
  padding: 10px 14px;
  border-bottom: 1px solid var(--border-subtle);
  display: flex;
  align-items: center;
  gap: 10px;
}
.ioc-mitre-label {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  width: 90px;
  flex-shrink: 0;
}
.mitre-tag {
  background: rgba(139,92,246,0.12);
  border: 1px solid rgba(139,92,246,0.25);
  color: #a78bfa;
  font-family: var(--font-mono);
  font-size: 10.5px;
  padding: 2px 7px;
  border-radius: 4px;
  font-weight: 600;
}

.ioc-related-row {
  padding: 10px 14px;
  border-bottom: 1px solid var(--border-subtle);
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}
.ioc-related-label {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  width: 90px;
  flex-shrink: 0;
}
.related-ioc-chip {
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  color: var(--text-secondary);
  font-family: var(--font-mono);
  font-size: 10px;
  padding: 2px 7px;
  border-radius: 4px;
  cursor: pointer;
  transition: all var(--transition);
}
.related-ioc-chip:hover {
  border-color: var(--border-accent);
  color: var(--cyan);
}

.ioc-dacta-history {
  padding: 10px 14px;
  border-bottom: 1px solid var(--border-subtle);
  background: rgba(0,212,255,0.03);
  display: flex;
  align-items: flex-start;
  gap: 8px;
}
.dacta-hist-icon {
  font-size: 14px;
  flex-shrink: 0;
  margin-top: 1px;
}
.dacta-hist-text {
  font-size: 11.5px;
  color: var(--text-secondary);
  line-height: 1.5;
}
.dacta-hist-text strong { color: var(--cyan); font-family: var(--font-mono); }

.ioc-actions {
  padding: 10px 14px;
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}
.ioc-action-btn {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 5px 10px;
  border-radius: 6px;
  font-size: 11px;
  font-weight: 600;
  font-family: var(--font-body);
  cursor: pointer;
  transition: all var(--transition);
  border: none;
}
.ioc-btn-warroom {
  background: rgba(0,212,255,0.1);
  border: 1px solid rgba(0,212,255,0.3);
  color: var(--cyan);
}
.ioc-btn-warroom:hover {
  background: rgba(0,212,255,0.18);
  box-shadow: 0 0 12px rgba(0,212,255,0.2);
}
.ioc-btn-block {
  background: rgba(239,68,68,0.1);
  border: 1px solid rgba(239,68,68,0.3);
  color: #ff6b6b;
}
.ioc-btn-block:hover { background: rgba(239,68,68,0.18); box-shadow: 0 0 10px rgba(239,68,68,0.2); }
.ioc-btn-siem {
  background: rgba(245,158,11,0.1);
  border: 1px solid rgba(245,158,11,0.3);
  color: var(--amber);
}
.ioc-btn-siem:hover { background: rgba(245,158,11,0.18); }
.ioc-btn-stix {
  background: rgba(139,92,246,0.1);
  border: 1px solid rgba(139,92,246,0.25);
  color: #a78bfa;
}
.ioc-btn-stix:hover { background: rgba(139,92,246,0.18); }

/* ---- KQL Response Card ---- */
.kql-response {
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.kql-block {
  background: #0a0e1a;
  border: 1px solid rgba(0,212,255,0.15);
  border-radius: 8px;
  overflow: hidden;
}
.kql-block-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 7px 12px;
  background: rgba(0,212,255,0.06);
  border-bottom: 1px solid rgba(0,212,255,0.1);
}
.kql-lang-badge {
  font-family: var(--font-mono);
  font-size: 10px;
  font-weight: 600;
  color: var(--cyan);
  letter-spacing: 0.08em;
}
.kql-copy-btn {
  background: none;
  border: 1px solid rgba(255,255,255,0.1);
  color: var(--text-muted);
  font-size: 10px;
  padding: 2px 8px;
  border-radius: 4px;
  cursor: pointer;
  transition: all var(--transition);
  font-family: var(--font-body);
}
.kql-copy-btn:hover { border-color: var(--cyan); color: var(--cyan); }
.kql-block pre {
  padding: 12px 14px;
  font-family: var(--font-mono);
  font-size: 11.5px;
  line-height: 1.7;
  color: var(--text-secondary);
  overflow-x: auto;
  margin: 0;
}
.kql-block pre .kw { color: var(--cyan); }
.kql-block pre .str { color: #a3e635; }
.kql-block pre .op { color: #fb923c; }
.kql-block pre .fn { color: #a78bfa; }
.kql-block pre .num { color: #fbbf24; }
.kql-block pre .cmt { color: var(--text-muted); font-style: italic; }

.kql-explanation {
  background: rgba(245,158,11,0.04);
  border: 1px solid rgba(245,158,11,0.12);
  border-radius: 7px;
  padding: 10px 12px;
  font-size: 12px;
  color: var(--text-secondary);
  line-height: 1.6;
  display: flex;
  gap: 8px;
  align-items: flex-start;
}

.kql-results-table {
  background: var(--bg-surface);
  border: 1px solid var(--border-card);
  border-radius: 8px;
  overflow: hidden;
}
.kql-results-header {
  padding: 8px 12px;
  border-bottom: 1px solid var(--border-subtle);
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: rgba(255,255,255,0.015);
}
.kql-results-count {
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--text-primary);
}
.kql-results-count strong { color: var(--red-bright); }
.kql-results-meta {
  font-size: 10px;
  color: var(--text-muted);
}
.kql-table {
  width: 100%;
  border-collapse: collapse;
}
.kql-table th {
  padding: 6px 10px;
  text-align: left;
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  border-bottom: 1px solid var(--border-subtle);
  background: rgba(255,255,255,0.01);
}
.kql-table td {
  padding: 7px 10px;
  font-size: 11.5px;
  border-bottom: 1px solid rgba(255,255,255,0.03);
  color: var(--text-secondary);
}
.kql-table tr:hover td { background: rgba(255,255,255,0.02); }
.kql-table td.mono { font-family: var(--font-mono); font-size: 11px; }
.kql-table td.suspicious {
  color: var(--red-bright);
  font-weight: 600;
}
.kql-highlight-row td { background: rgba(239,68,68,0.04) !important; }
.kql-suggestion {
  background: rgba(0,212,255,0.05);
  border: 1px solid rgba(0,212,255,0.15);
  border-radius: 7px;
  padding: 10px 12px;
  font-size: 12px;
  color: var(--cyan);
  display: flex;
  align-items: center;
  gap: 8px;
}
.kql-suggestion-btn {
  margin-left: auto;
  background: rgba(0,212,255,0.12);
  border: 1px solid rgba(0,212,255,0.3);
  color: var(--cyan);
  font-size: 11px;
  padding: 4px 10px;
  border-radius: 5px;
  cursor: pointer;
  font-family: var(--font-body);
  font-weight: 600;
  transition: all var(--transition);
  white-space: nowrap;
}
.kql-suggestion-btn:hover { background: rgba(0,212,255,0.2); box-shadow: 0 0 10px rgba(0,212,255,0.2); }

/* ---- MITRE Technique Card ---- */
.mitre-card {
  background: var(--bg-surface);
  border: 1px solid rgba(139,92,246,0.2);
  border-radius: 10px;
  overflow: hidden;
}
.mitre-card-header {
  padding: 12px 14px;
  background: linear-gradient(135deg, rgba(139,92,246,0.12), rgba(139,92,246,0.04));
  border-bottom: 1px solid rgba(139,92,246,0.15);
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 12px;
}
.mitre-technique-id {
  font-family: var(--font-mono);
  font-size: 13px;
  font-weight: 700;
  color: #a78bfa;
  letter-spacing: 0.05em;
}
.mitre-technique-name {
  font-size: 15px;
  font-weight: 700;
  color: var(--text-primary);
  font-family: var(--font-display);
  margin-top: 3px;
}
.mitre-tactic-badges {
  display: flex;
  gap: 5px;
  margin-top: 6px;
  flex-wrap: wrap;
}
.mitre-tactic-badge {
  background: rgba(139,92,246,0.12);
  border: 1px solid rgba(139,92,246,0.25);
  color: #a78bfa;
  font-size: 10px;
  font-weight: 600;
  padding: 2px 8px;
  border-radius: 4px;
  letter-spacing: 0.06em;
  text-transform: uppercase;
}
.mitre-card-body {
  padding: 12px 14px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.mitre-desc {
  font-size: 12.5px;
  color: var(--text-secondary);
  line-height: 1.65;
}
.mitre-detection-section {
  background: rgba(16,185,129,0.04);
  border: 1px solid rgba(16,185,129,0.12);
  border-radius: 7px;
  padding: 10px 12px;
}
.mitre-section-label {
  font-size: 10px;
  font-weight: 700;
  color: var(--green);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 6px;
}
.mitre-detection-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.mitre-detection-list li {
  font-size: 11.5px;
  color: var(--text-secondary);
  padding-left: 16px;
  position: relative;
  line-height: 1.5;
}
.mitre-detection-list li::before {
  content: 'â€º';
  position: absolute;
  left: 4px;
  color: var(--green);
}
.mitre-related-section {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}
.mitre-related-label {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.1em;
}
.mitre-related-tag {
  background: rgba(139,92,246,0.1);
  border: 1px solid rgba(139,92,246,0.2);
  color: #c4b5fd;
  font-family: var(--font-mono);
  font-size: 10.5px;
  padding: 2px 7px;
  border-radius: 4px;
  cursor: pointer;
  transition: all var(--transition);
}
.mitre-related-tag:hover { background: rgba(139,92,246,0.2); }
.mitre-card-actions {
  padding: 10px 14px;
  border-top: 1px solid var(--border-subtle);
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}
.mitre-action-btn {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 5px 10px;
  border-radius: 6px;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  transition: all var(--transition);
  border: none;
}
.mitre-btn-search {
  background: rgba(245,158,11,0.1);
  border: 1px solid rgba(245,158,11,0.3);
  color: var(--amber);
}
.mitre-btn-search:hover { background: rgba(245,158,11,0.18); }
.mitre-btn-rule {
  background: rgba(16,185,129,0.1);
  border: 1px solid rgba(16,185,129,0.25);
  color: var(--green);
}
.mitre-btn-rule:hover { background: rgba(16,185,129,0.18); }

/* ---- Input Area ---- */
.copilot-input-area {
  padding: 12px 16px;
  border-top: 1px solid var(--border-subtle);
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  gap: 8px;
  background: rgba(255,255,255,0.01);
}
.copilot-input-modes {
  display: flex;
  gap: 2px;
  align-items: center;
}
.copilot-mode-btn {
  padding: 3px 9px;
  font-size: 10.5px;
  font-weight: 600;
  font-family: var(--font-body);
  border: 1px solid transparent;
  background: none;
  color: var(--text-muted);
  border-radius: 4px;
  cursor: pointer;
  transition: all var(--transition);
}
.copilot-mode-btn.active {
  background: var(--bg-elevated);
  border-color: var(--border-card);
  color: var(--text-primary);
}
.copilot-mode-sep { font-size: 10px; color: var(--text-muted); margin: 0 3px; }
.copilot-input-row {
  display: flex;
  gap: 8px;
  align-items: flex-end;
}
.copilot-org-select {
  flex-shrink: 0;
  background: var(--bg-input);
  border: 1px solid var(--border-card);
  border-radius: 7px;
  color: var(--text-secondary);
  font-family: var(--font-mono);
  font-size: 11px;
  padding: 8px 10px;
  cursor: pointer;
  transition: border-color var(--transition);
  appearance: none;
  width: 130px;
}
.copilot-org-select:hover { border-color: var(--border-accent); }
.copilot-text-input {
  flex: 1;
  background: var(--bg-input);
  border: 1px solid var(--border-card);
  border-radius: 9px;
  color: var(--text-primary);
  font-family: var(--font-body);
  font-size: 13px;
  padding: 10px 14px;
  resize: none;
  height: 42px;
  line-height: 1.4;
  transition: border-color var(--transition), box-shadow var(--transition);
  outline: none;
}
.copilot-text-input:focus {
  border-color: rgba(0,212,255,0.35);
  box-shadow: 0 0 0 3px rgba(0,212,255,0.06);
}
.copilot-text-input::placeholder {
  color: var(--text-muted);
  font-size: 12px;
}
.copilot-send-btn {
  width: 42px;
  height: 42px;
  border-radius: 9px;
  background: linear-gradient(135deg, var(--cyan) 0%, rgba(0,180,220,0.9) 100%);
  border: none;
  color: #080c18;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex-shrink: 0;
  transition: all var(--transition);
  box-shadow: 0 0 16px rgba(0,212,255,0.3);
}
.copilot-send-btn:hover {
  box-shadow: 0 0 24px rgba(0,212,255,0.5);
  transform: scale(1.04);
}
.copilot-send-btn:active { transform: scale(0.96); }

/* ---- Saved Searches (below chat) ---- */
.copilot-saved-searches {
  flex-shrink: 0;
  border-top: 1px solid var(--border-subtle);
  max-height: 140px;
  overflow: hidden;
  transition: max-height var(--transition-slow);
}
.copilot-saved-searches.collapsed {
  max-height: 38px;
}
.saved-searches-toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 9px 16px;
  cursor: pointer;
  font-size: 10.5px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  transition: color var(--transition);
}
.saved-searches-toggle:hover { color: var(--text-secondary); }
.saved-searches-chevron {
  font-size: 10px;
  transition: transform var(--transition);
}
.copilot-saved-searches.collapsed .saved-searches-chevron {
  transform: rotate(-90deg);
}
.saved-searches-list {
  display: flex;
  gap: 6px;
  padding: 0 16px 10px;
  overflow-x: auto;
}
.saved-searches-list::-webkit-scrollbar { height: 0; }
.saved-search-chip {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  border-radius: 7px;
  border: 1px solid var(--border-card);
  background: var(--bg-surface);
  color: var(--text-secondary);
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: all var(--transition);
  white-space: nowrap;
  flex-shrink: 0;
}
.saved-search-chip:hover {
  border-color: var(--border-accent);
  color: var(--text-primary);
  background: var(--bg-elevated);
}
.search-chip-lang {
  font-family: var(--font-mono);
  font-size: 9.5px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-subtle);
  color: var(--text-muted);
  padding: 1px 5px;
  border-radius: 3px;
}

/* ---- Context Panel (right) ---- */
.copilot-context-panel {
  width: 280px;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  gap: 10px;
  overflow-y: auto;
}
.copilot-context-panel::-webkit-scrollbar { width: 4px; }

.ctx-card {
  background: var(--bg-card);
  border: 1px solid var(--border-card);
  border-radius: 10px;
  overflow: hidden;
  flex-shrink: 0;
}
.ctx-card-header {
  padding: 9px 12px;
  border-bottom: 1px solid var(--border-subtle);
  font-size: 10px;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.12em;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: rgba(255,255,255,0.01);
}
.ctx-card-body {
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 7px;
}
.ctx-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}
.ctx-label {
  font-size: 11px;
  color: var(--text-muted);
  flex-shrink: 0;
}
.ctx-value {
  font-size: 11px;
  color: var(--text-primary);
  font-weight: 500;
  text-align: right;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.ctx-value.mono { font-family: var(--font-mono); font-size: 10.5px; }
.ctx-value.cyan { color: var(--cyan); }
.ctx-value.amber { color: var(--amber); }
.ctx-divider { height: 1px; background: var(--border-subtle); margin: 2px 0; }

/* Data Sources */
.ds-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 5px 0;
  border-bottom: 1px solid rgba(255,255,255,0.03);
}
.ds-item:last-child { border-bottom: none; }
.ds-icon {
  width: 22px;
  height: 22px;
  border-radius: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  flex-shrink: 0;
}
.ds-name {
  flex: 1;
  font-size: 11.5px;
  color: var(--text-secondary);
}
.ds-status {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 10px;
  font-weight: 600;
}
.ds-dot {
  width: 6px; height: 6px;
  border-radius: 50%;
}
.ds-dot.connected { background: var(--green); box-shadow: 0 0 5px var(--green); }
.ds-dot.api { background: var(--cyan); box-shadow: 0 0 5px var(--cyan); }
.ds-dot.warning { background: var(--amber); box-shadow: 0 0 5px var(--amber); }
.ds-status.connected-txt { color: var(--green); }
.ds-status.api-txt { color: var(--cyan); }

/* Recent IOCs */
.recent-ioc-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 5px 0;
  border-bottom: 1px solid rgba(255,255,255,0.03);
  cursor: pointer;
  transition: background var(--transition);
}
.recent-ioc-item:last-child { border-bottom: none; }
.recent-ioc-item:hover { background: rgba(255,255,255,0.02); border-radius: 5px; }
.recent-ioc-type {
  width: 20px; height: 20px;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  flex-shrink: 0;
}
.ioc-type-ip { background: rgba(239,68,68,0.12); color: var(--red); border: 1px solid rgba(239,68,68,0.2); }
.ioc-type-domain { background: rgba(245,158,11,0.12); color: var(--amber); border: 1px solid rgba(245,158,11,0.2); }
.ioc-type-hash { background: rgba(139,92,246,0.12); color: #a78bfa; border: 1px solid rgba(139,92,246,0.2); }
.recent-ioc-value {
  flex: 1;
  font-family: var(--font-mono);
  font-size: 10.5px;
  color: var(--text-secondary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.recent-ioc-verdict {
  font-size: 9px;
  font-weight: 700;
  padding: 1px 5px;
  border-radius: 3px;
  text-transform: uppercase;
  flex-shrink: 0;
}
.verdict-mal {
  background: rgba(239,68,68,0.15);
  color: #ff6b6b;
  border: 1px solid rgba(239,68,68,0.3);
}
.verdict-sus {
  background: rgba(245,158,11,0.15);
  color: var(--amber);
  border: 1px solid rgba(245,158,11,0.3);
}
.verdict-clean {
  background: rgba(16,185,129,0.12);
  color: var(--green);
  border: 1px solid rgba(16,185,129,0.2);
}

/* Quick Actions */
.quick-action-btn {
  display: flex;
  align-items: center;
  gap: 7px;
  padding: 7px 10px;
  border-radius: 7px;
  border: 1px solid var(--border-card);
  background: var(--bg-surface);
  color: var(--text-secondary);
  font-size: 11.5px;
  font-weight: 500;
  cursor: pointer;
  transition: all var(--transition);
  width: 100%;
  text-align: left;
  font-family: var(--font-body);
}
.quick-action-btn:hover {
  background: var(--bg-elevated);
  border-color: var(--border-accent);
  color: var(--text-primary);
}
.quick-action-icon { font-size: 14px; flex-shrink: 0; }

/* ---- Command Bar Overlay ---- */
.copilot-cmdbar-overlay {
  position: fixed;
  inset: 0;
  background: rgba(8,12,24,0.85);
  backdrop-filter: blur(8px);
  z-index: 9999;
  display: none;
  align-items: flex-start;
  justify-content: center;
  padding-top: 15vh;
}
.copilot-cmdbar-overlay.open { display: flex; }
.copilot-cmdbar {
  width: 640px;
  max-width: 90vw;
  background: var(--bg-card);
  border: 1px solid rgba(0,212,255,0.25);
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 0 32px 80px rgba(0,0,0,0.7), 0 0 0 1px rgba(0,212,255,0.08), 0 0 60px rgba(0,212,255,0.08);
  animation: cmdSlideIn 0.18s cubic-bezier(0.34,1.56,0.64,1);
}
@keyframes cmdSlideIn {
  from { opacity: 0; transform: translateY(-20px) scale(0.96); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}
.cmdbar-input-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 14px 16px;
  border-bottom: 1px solid var(--border-subtle);
}
.cmdbar-icon { font-size: 18px; color: var(--cyan); flex-shrink: 0; }
.cmdbar-input {
  flex: 1;
  background: none;
  border: none;
  outline: none;
  font-family: var(--font-body);
  font-size: 15px;
  color: var(--text-primary);
}
.cmdbar-input::placeholder { color: var(--text-muted); font-size: 14px; }
.cmdbar-esc {
  font-family: var(--font-mono);
  font-size: 10px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  color: var(--text-muted);
  padding: 2px 6px;
  border-radius: 4px;
  flex-shrink: 0;
}
.cmdbar-suggestions {
  padding: 8px 0;
}
.cmdbar-suggestion-group-label {
  padding: 4px 16px;
  font-size: 9.5px;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.12em;
}
.cmdbar-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 16px;
  cursor: pointer;
  transition: background var(--transition);
  font-size: 13px;
  color: var(--text-secondary);
}
.cmdbar-item:hover, .cmdbar-item.selected {
  background: var(--cyan-dim);
  color: var(--text-primary);
}
.cmdbar-item-icon {
  width: 28px; height: 28px;
  border-radius: 6px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  flex-shrink: 0;
}
.cmdbar-item-label { flex: 1; }
.cmdbar-item-shortcut {
  font-family: var(--font-mono);
  font-size: 9.5px;
  color: var(--text-muted);
}
.cmdbar-footer {
  padding: 8px 16px;
  border-top: 1px solid var(--border-subtle);
  display: flex;
  gap: 16px;
  font-size: 10.5px;
  color: var(--text-muted);
  font-family: var(--font-mono);
}
.cmdbar-footer kbd {
  background: var(--bg-elevated);
  border: 1px solid var(--border-card);
  border-radius: 3px;
  padding: 1px 4px;
  color: var(--text-secondary);
  font-size: 10px;
}

/* Thinking animation for copilot */
.copilot-thinking {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  color: var(--text-muted);
  font-size: 11.5px;
}
.thinking-dots {
  display: flex;
  gap: 4px;
}
.thinking-dot {
  width: 5px; height: 5px;
  border-radius: 50%;
  background: var(--cyan);
  animation: thinkBounce 1.2s ease-in-out infinite;
}
.thinking-dot:nth-child(2) { animation-delay: 0.2s; }
.thinking-dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes thinkBounce {
  0%, 80%, 100% { transform: scale(0.6); opacity: 0.4; }
  40% { transform: scale(1); opacity: 1; }
}

/* ============================================================
   SETTINGS PAGE â€” Connector Config + RAG Router (stg- prefix)
   ============================================================ */

/* Connector Config Section */
.stg-section { margin-bottom: 24px; }
.stg-section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 10px;
}
.stg-section-title {
  font-family: 'Sora', sans-serif;
  font-size: 15px;
  font-weight: 600;
  color: #e8edf5;
}
.stg-section-sub {
  font-size: 11px;
  color: #8892a4;
  margin-top: 2px;
}
.stg-org-selector {
  display: flex;
  align-items: center;
  gap: 8px;
}
.stg-org-label {
  font-size: 11px;
  color: #8892a4;
  white-space: nowrap;
}
.stg-org-select {
  background: #1a2235;
  border: 1px solid rgba(255,255,255,0.09);
  border-radius: 7px;
  color: #e8edf5;
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 12px;
  padding: 6px 10px;
  cursor: pointer;
  min-width: 260px;
  outline: none;
  transition: border-color 0.2s;
}
.stg-org-select:focus { border-color: rgba(0,212,255,0.45); }

/* 7-connector grid */
.stg-connector-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 14px;
}
@media (max-width: 1100px) {
  .stg-connector-grid { grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 700px) {
  .stg-connector-grid { grid-template-columns: 1fr; }
}
.stg-conn-card {
  background: #111827;
  border: 1px solid rgba(255,255,255,0.09);
  border-radius: 10px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  transition: border-color 0.2s, box-shadow 0.2s;
}
.stg-conn-card:hover {
  border-color: rgba(0,212,255,0.25);
  box-shadow: 0 0 0 1px rgba(0,212,255,0.08);
}
.stg-conn-top {
  display: flex;
  align-items: center;
  gap: 10px;
}
.stg-conn-icon {
  width: 34px;
  height: 34px;
  border-radius: 8px;
  background: #1a2235;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  flex-shrink: 0;
}
.stg-conn-meta { flex: 1; min-width: 0; }
.stg-conn-name {
  font-size: 12px;
  font-weight: 600;
  color: #e8edf5;
  font-family: 'Sora', sans-serif;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.stg-conn-status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
  margin-top: 1px;
}
.stg-conn-status-dot.connected { background: #10b981; box-shadow: 0 0 6px rgba(16,185,129,0.6); }
.stg-conn-status-dot.disconnected { background: #ef4444; box-shadow: 0 0 6px rgba(239,68,68,0.5); }
.stg-conn-status-dot.pending { background: #f59e0b; box-shadow: 0 0 6px rgba(245,158,11,0.5); }

.stg-conn-field { display: flex; flex-direction: column; gap: 4px; }
.stg-conn-field-label { font-size: 10px; color: #4d5a6e; font-family: 'IBM Plex Sans', sans-serif; letter-spacing: 0.03em; }
.stg-conn-select {
  background: #1a2235;
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 6px;
  color: #e8edf5;
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 11px;
  padding: 5px 8px;
  cursor: pointer;
  outline: none;
  width: 100%;
}
.stg-conn-select:focus { border-color: rgba(0,212,255,0.35); }
.stg-conn-input {
  background: #1a2235;
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 6px;
  color: #8892a4;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 10px;
  padding: 5px 8px;
  outline: none;
  width: 100%;
  box-sizing: border-box;
}
.stg-conn-input::placeholder { color: #4d5a6e; }
.stg-conn-input:focus { border-color: rgba(0,212,255,0.35); color: #e8edf5; }
.stg-conn-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-top: 2px;
}
.stg-conn-test-btn {
  background: rgba(0,212,255,0.10);
  border: 1px solid rgba(0,212,255,0.25);
  border-radius: 5px;
  color: #00d4ff;
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 10px;
  font-weight: 600;
  padding: 4px 10px;
  cursor: pointer;
  transition: background 0.2s;
  white-space: nowrap;
}
.stg-conn-test-btn:hover { background: rgba(0,212,255,0.20); }
.stg-conn-sync {
  font-size: 10px;
  color: #4d5a6e;
  font-family: 'IBM Plex Sans', sans-serif;
  text-align: right;
}

/* Data residency footer row */
.stg-residency-row {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 12px 16px;
  background: rgba(0,212,255,0.04);
  border: 1px solid rgba(0,212,255,0.10);
  border-radius: 8px;
  margin-top: 14px;
  flex-wrap: wrap;
  gap: 10px;
}
.stg-residency-item {
  display: flex;
  align-items: center;
  gap: 7px;
  font-size: 11px;
  color: #8892a4;
  font-family: 'IBM Plex Sans', sans-serif;
}
.stg-residency-item strong { color: #e8edf5; font-weight: 600; }

/* ============================================================
   RAG Router Section
   ============================================================ */
.stg-rag-subtitle {
  font-size: 11px;
  color: #8892a4;
  margin-top: 2px;
}
.stg-rag-lanes {
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.stg-rag-lane {
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 12px 14px;
  background: #0d1220;
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 9px;
  min-height: 58px;
  flex-wrap: wrap;
}
.stg-rag-lane-sev {
  flex-shrink: 0;
  width: 82px;
}
.stg-sev-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 5px;
  font-size: 10px;
  font-weight: 700;
  font-family: 'IBM Plex Mono', monospace;
  padding: 3px 8px;
  letter-spacing: 0.04em;
  white-space: nowrap;
}
.stg-sev-badge.p1 { background: rgba(239,68,68,0.15); color: #ef4444; border: 1px solid rgba(239,68,68,0.35); }
.stg-sev-badge.p2 { background: rgba(249,115,22,0.15); color: #f97316; border: 1px solid rgba(249,115,22,0.35); }
.stg-sev-badge.p3 { background: rgba(245,158,11,0.15); color: #f59e0b; border: 1px solid rgba(245,158,11,0.35); }
.stg-sev-badge.p4 { background: rgba(16,185,129,0.12); color: #10b981; border: 1px solid rgba(16,185,129,0.30); }
.stg-sev-label {
  font-size: 9px;
  color: #4d5a6e;
  font-family: 'IBM Plex Sans', sans-serif;
  margin-top: 3px;
  white-space: nowrap;
}

.stg-rag-flow {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 4px;
  flex-wrap: wrap;
  min-width: 0;
}
.stg-chip {
  display: inline-flex;
  align-items: center;
  font-size: 10px;
  font-family: 'IBM Plex Mono', monospace;
  border-radius: 5px;
  padding: 3px 9px;
  white-space: nowrap;
  border: 1px solid;
  font-weight: 500;
}
.stg-chip.p1 { background: rgba(239,68,68,0.10); border-color: rgba(239,68,68,0.28); color: #ef4444; }
.stg-chip.p2 { background: rgba(249,115,22,0.10); border-color: rgba(249,115,22,0.28); color: #f97316; }
.stg-chip.p3 { background: rgba(245,158,11,0.10); border-color: rgba(245,158,11,0.28); color: #f59e0b; }
.stg-chip.p4 { background: rgba(16,185,129,0.09); border-color: rgba(16,185,129,0.25); color: #10b981; }
.stg-chip.neutral { background: rgba(255,255,255,0.04); border-color: rgba(255,255,255,0.10); color: #8892a4; }
.stg-arrow {
  font-size: 10px;
  flex-shrink: 0;
  margin: 0 1px;
}
.stg-arrow.p1 { color: rgba(239,68,68,0.6); }
.stg-arrow.p2 { color: rgba(249,115,22,0.6); }
.stg-arrow.p3 { color: rgba(245,158,11,0.6); }
.stg-arrow.p4 { color: rgba(16,185,129,0.5); }

.stg-rag-stats {
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  gap: 3px;
  min-width: 150px;
  padding-left: 10px;
  border-left: 1px solid rgba(255,255,255,0.06);
}
.stg-stat-row {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 10px;
  font-family: 'IBM Plex Sans', sans-serif;
  color: #8892a4;
}
.stg-stat-label { color: #4d5a6e; min-width: 70px; }
.stg-stat-val { color: #e8edf5; font-family: 'IBM Plex Mono', monospace; font-size: 10px; }

.stg-rag-override {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  background: rgba(0,212,255,0.04);
  border: 1px solid rgba(0,212,255,0.10);
  border-radius: 8px;
  margin-top: 12px;
  font-size: 11px;
  color: #8892a4;
  font-family: 'IBM Plex Sans', sans-serif;
}
.stg-rag-override kbd {
  background: #1a2235;
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 4px;
  color: #e8edf5;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 10px;
  padding: 1px 6px;
}


/* ================================================================
   DATA ARCHITECTURE PAGE  (da- prefix)
   ================================================================ */

/* Page layout */
.da-page-grid {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

/* Zone wrapper â€” holds the three-column diagram */
.da-diagram-wrapper {
  background: var(--bg-surface);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 14px;
  padding: 28px 20px 20px;
  position: relative;
  overflow: hidden;
}
.da-diagram-title {
  font-family: 'Sora', sans-serif;
  font-size: 11px;
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--text-muted);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.da-diagram-title::after {
  content: '';
  flex: 1;
  height: 1px;
  background: rgba(255,255,255,0.05);
}

/* 3-column grid */
.da-diagram-grid {
  display: grid;
  grid-template-columns: 1fr 36px 1fr 36px 1fr;
  gap: 0;
  align-items: center;
  min-height: 460px;
}

/* ---- ZONE 1: Client environment ---- */
.da-zone-client {
  border: 1.5px dashed rgba(255,255,255,0.14);
  border-radius: 12px;
  padding: 14px 12px 12px;
  position: relative;
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.da-zone-label {
  font-family: 'Sora', sans-serif;
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.10em;
  text-transform: uppercase;
  color: var(--text-muted);
  margin-bottom: 4px;
}
.da-source-card {
  background: var(--bg-card);
  border: 1px solid rgba(255,255,255,0.07);
  border-left-width: 3px;
  border-radius: 7px;
  padding: 7px 10px;
  display: flex;
  flex-direction: column;
  gap: 2px;
  position: relative;
}
.da-source-card:hover {
  border-color: rgba(0,212,255,0.3);
  background: var(--bg-elevated);
  transition: all 0.2s;
}
.da-source-card.da-edr  { border-left-color: #10b981; }
.da-source-card.da-fw   { border-left-color: #ef4444; }
.da-source-card.da-id   { border-left-color: #8b5cf6; }
.da-source-card.da-email{ border-left-color: #f59e0b; }
.da-source-card.da-os   { border-left-color: #00d4ff; }
.da-source-card.da-tick { border-left-color: #f97316; }
.da-source-title {
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 11.5px;
  font-weight: 600;
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: 5px;
}
.da-source-sub {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 9px;
  color: var(--text-muted);
  line-height: 1.3;
}

/* ---- CONNECTOR COLUMNS (arrows / animated flows) ---- */
.da-connector {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  gap: 6px;
  position: relative;
  padding: 0 2px;
}
.da-flow-line {
  width: 2px;
  flex: 1;
  position: relative;
  overflow: hidden;
  border-radius: 2px;
  background: rgba(255,255,255,0.04);
}
.da-flow-line::after {
  content: '';
  position: absolute;
  left: 0;
  width: 100%;
  height: 40%;
  border-radius: 2px;
  animation: da-flow-down 1.8s linear infinite;
}
.da-flow-line.da-green::after  { background: linear-gradient(to bottom, transparent, #10b981, transparent); }
.da-flow-line.da-cyan::after   { background: linear-gradient(to bottom, transparent, #00d4ff, transparent); }
.da-flow-line.da-purple::after { background: linear-gradient(to bottom, transparent, #8b5cf6, transparent); }
.da-flow-line.da-amber::after  { background: linear-gradient(to bottom, transparent, #f59e0b, transparent); }
.da-flow-line.da-up::after {
  animation: da-flow-up 1.8s linear infinite;
}
.da-flow-line.da-bidir::after {
  height: 60%;
  animation: da-flow-down 2.2s linear infinite alternate;
}
.da-arrow-head {
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
}
.da-arrow-head.da-down.da-green  { border-top: 7px solid #10b981; }
.da-arrow-head.da-down.da-cyan   { border-top: 7px solid #00d4ff; }
.da-arrow-head.da-down.da-purple { border-top: 7px solid #8b5cf6; }
.da-arrow-head.da-up.da-purple   { border-bottom: 7px solid #8b5cf6; }

@keyframes da-flow-down {
  0%   { top: -40%; }
  100% { top: 100%; }
}
@keyframes da-flow-up {
  0%   { bottom: -40%; top: auto; }
  100% { bottom: 100%; top: auto; }
}

/* connector horizontal lines inside connector zone */
.da-h-arrow {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  position: relative;
}
.da-h-line {
  height: 2px;
  flex: 1;
  position: relative;
  overflow: hidden;
  border-radius: 2px;
  background: rgba(255,255,255,0.04);
}
.da-h-line::after {
  content: '';
  position: absolute;
  top: 0;
  height: 100%;
  width: 40%;
  border-radius: 2px;
  animation: da-flow-right 1.6s linear infinite;
}
.da-h-line.da-green::after  { background: linear-gradient(to right, transparent, #10b981, transparent); }
.da-h-line.da-cyan::after   { background: linear-gradient(to right, transparent, #00d4ff, transparent); }
.da-h-line.da-purple::after { background: linear-gradient(to right, transparent, #8b5cf6, transparent); }
.da-h-line.da-bidir::after  {
  animation: da-flow-right 2s linear infinite alternate;
  background: linear-gradient(to right, transparent, #8b5cf6, transparent);
}
@keyframes da-flow-right {
  0%   { left: -40%; }
  100% { left: 100%; }
}
.da-chevron {
  font-size: 11px;
  line-height: 1;
}
.da-chevron.da-green  { color: #10b981; }
.da-chevron.da-cyan   { color: #00d4ff; }
.da-chevron.da-purple { color: #8b5cf6; }

/* ---- ZONE 2: Elastic SIEM ---- */
.da-zone-siem {
  height: 100%;
  display: flex;
  flex-direction: column;
}
.da-siem-card {
  background: linear-gradient(160deg, #111827 0%, #0d1628 100%);
  border: 1.5px solid rgba(255, 220, 80, 0.22);
  border-radius: 12px;
  padding: 16px 14px;
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: 12px;
  box-shadow: 0 0 28px rgba(255,180,0,0.04);
}
.da-siem-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding-bottom: 10px;
  border-bottom: 1px solid rgba(255,255,255,0.06);
}
.da-siem-logo {
  width: 32px;
  height: 32px;
  background: linear-gradient(135deg, #f0a800 0%, #e25400 100%);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  flex-shrink: 0;
  box-shadow: 0 2px 10px rgba(240,168,0,0.3);
}
.da-siem-name {
  font-family: 'Sora', sans-serif;
  font-size: 13px;
  font-weight: 700;
  color: var(--text-primary);
}
.da-siem-sub {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 9px;
  color: var(--text-muted);
}
.da-siem-section {
  background: rgba(255,255,255,0.025);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  padding: 9px 11px;
  display: flex;
  flex-direction: column;
  gap: 5px;
  flex: 1;
}
.da-siem-section-label {
  font-family: 'Sora', sans-serif;
  font-size: 9.5px;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text-muted);
}
.da-eps-badge {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  background: rgba(16,185,129,0.12);
  border: 1px solid rgba(16,185,129,0.25);
  border-radius: 6px;
  padding: 3px 8px;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 11px;
  font-weight: 700;
  color: #10b981;
}
.da-eps-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #10b981;
  animation: da-pulse-green 1.5s ease-in-out infinite;
}
@keyframes da-pulse-green {
  0%, 100% { opacity: 1; transform: scale(1); }
  50%       { opacity: 0.5; transform: scale(0.7); }
}
.da-detect-badge {
  background: rgba(239,68,68,0.1);
  border: 1px solid rgba(239,68,68,0.22);
  border-radius: 5px;
  padding: 2px 8px;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 10px;
  color: #ef4444;
  font-weight: 600;
}
.da-siem-desc {
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 10.5px;
  color: var(--text-secondary);
  line-height: 1.4;
}

/* ---- ZONE 3: MCC Platform ---- */
.da-zone-mcc {
  height: 100%;
  display: flex;
  flex-direction: column;
}
.da-mcc-card {
  background: linear-gradient(160deg, #0e1524 0%, #0d1a30 100%);
  border: 1.5px solid rgba(0,212,255,0.2);
  border-radius: 12px;
  padding: 16px 14px;
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: 10px;
  box-shadow: 0 0 32px rgba(0,212,255,0.05);
}
.da-mcc-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding-bottom: 10px;
  border-bottom: 1px solid rgba(255,255,255,0.06);
}
.da-mcc-icon {
  width: 32px;
  height: 32px;
  background: rgba(0,212,255,0.12);
  border: 1px solid rgba(0,212,255,0.3);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 17px;
  flex-shrink: 0;
}
.da-mcc-name {
  font-family: 'Sora', sans-serif;
  font-size: 12px;
  font-weight: 700;
  color: var(--text-primary);
  line-height: 1.2;
}
.da-mcc-sub {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 9px;
  color: var(--text-accent);
}
.da-layer {
  background: rgba(255,255,255,0.025);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  padding: 9px 11px;
  display: flex;
  flex-direction: column;
  gap: 4px;
  flex: 1;
  transition: border-color 0.2s, background 0.2s;
}
.da-layer:hover {
  border-color: rgba(0,212,255,0.18);
  background: rgba(0,212,255,0.03);
}
.da-layer-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;
}
.da-layer-title {
  font-family: 'Sora', sans-serif;
  font-size: 11px;
  font-weight: 700;
  color: var(--text-primary);
}
.da-badge {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 8.5px;
  font-weight: 700;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  border-radius: 4px;
  padding: 2px 7px;
  white-space: nowrap;
}
.da-badge-green  { background: rgba(16,185,129,0.15); color: #10b981; border: 1px solid rgba(16,185,129,0.3); }
.da-badge-cyan   { background: rgba(0,212,255,0.12);  color: #00d4ff; border: 1px solid rgba(0,212,255,0.25); }
.da-badge-purple { background: rgba(139,92,246,0.12); color: #8b5cf6; border: 1px solid rgba(139,92,246,0.25); }
.da-badge-amber  { background: rgba(245,158,11,0.12); color: #f59e0b; border: 1px solid rgba(245,158,11,0.25); }
.da-layer-route {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 9.5px;
  color: var(--text-accent);
  font-weight: 600;
}
.da-layer-desc {
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 10px;
  color: var(--text-secondary);
  line-height: 1.45;
}

/* ---- Summary Table ---- */
.da-table-wrapper {
  background: var(--bg-card);
  border: 1px solid rgba(255,255,255,0.09);
  border-radius: 10px;
  padding: 20px;
  overflow-x: auto;
}
.da-table-heading {
  font-family: 'Sora', sans-serif;
  font-size: 13px;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.da-table {
  width: 100%;
  border-collapse: collapse;
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 12px;
}
.da-table th {
  font-family: 'Sora', sans-serif;
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text-muted);
  padding: 8px 14px;
  text-align: left;
  border-bottom: 1px solid rgba(255,255,255,0.07);
  white-space: nowrap;
}
.da-table td {
  padding: 10px 14px;
  color: var(--text-secondary);
  border-bottom: 1px solid rgba(255,255,255,0.04);
  vertical-align: middle;
}
.da-table tr:last-child td { border-bottom: none; }
.da-table tr:hover td {
  background: rgba(255,255,255,0.015);
}
.da-table td:first-child {
  color: var(--text-primary);
  font-weight: 600;
}
.da-dir-push     { color: #10b981; }
.da-dir-pull     { color: #00d4ff; }
.da-dir-bidir    { color: #8b5cf6; }
.da-dir-internal { color: #f59e0b; }
.da-latency {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 11px;
  color: var(--text-accent);
}
.da-proto {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 11px;
  color: var(--text-muted);
}

/* ---- Stats row at top ---- */
.da-stats-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
}
.da-stat-card {
  background: var(--bg-card);
  border: 1px solid rgba(255,255,255,0.09);
  border-radius: 10px;
  padding: 16px 18px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.da-stat-label {
  font-family: 'Sora', sans-serif;
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text-muted);
}
.da-stat-value {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 22px;
  font-weight: 700;
  color: var(--text-primary);
  line-height: 1;
}
.da-stat-value.da-green  { color: #10b981; }
.da-stat-value.da-cyan   { color: #00d4ff; }
.da-stat-value.da-amber  { color: #f59e0b; }
.da-stat-value.da-purple { color: #8b5cf6; }
.da-stat-sub {
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 11px;
  color: var(--text-muted);
}

/* pulse ring on zone headers */
@keyframes da-ring-pulse {
  0%   { box-shadow: 0 0 0 0 rgba(0,212,255,0.25); }
  70%  { box-shadow: 0 0 0 7px rgba(0,212,255,0); }
  100% { box-shadow: 0 0 0 0 rgba(0,212,255,0); }
}
.da-pulse-ring {
  animation: da-ring-pulse 2.5s ease-out infinite;
}

/* ================================================================
   DATA ARCHITECTURE â€” DUAL MODEL (new da- additions)
   ================================================================ */

/* Dual-model diagram outer grid */
.da-dual-grid {
  display: grid;
  grid-template-columns: 1fr 54px 1fr 54px 1fr;
  gap: 0;
  align-items: stretch;
  min-height: 520px;
}

/* Client column â€” houses Model A + Model B stacked */
.da-clients-col {
  display: grid;
  grid-template-rows: 1fr 1fr;
  gap: 14px;
  align-items: stretch;
}

/* Model containers (dashed bordered zone) */
.da-model-zone {
  border: 1.5px dashed rgba(255,255,255,0.13);
  border-radius: 12px;
  padding: 13px 12px 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  position: relative;
}
.da-model-zone.da-model-a {
  border-left: 3px solid #10b981;
}
.da-model-zone.da-model-b {
  border-left: 3px solid #00d4ff;
}
.da-model-label {
  font-family: 'Sora', sans-serif;
  font-size: 9.5px;
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  margin-bottom: 2px;
}
.da-model-label.da-green { color: #10b981; }
.da-model-label.da-cyan  { color: #00d4ff; }

/* Horizontal connector zone between client col and jira */
.da-h-connector-zone {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
  position: relative;
  height: 100%;
}
.da-merge-arrow {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  height: 50%;
  justify-content: center;
  gap: 4px;
}
.da-merge-arrow .da-h-line {
  height: 2px;
  width: 100%;
}

/* Jira central card */
.da-zone-jira {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: stretch;
}
.da-jira-card {
  background: linear-gradient(160deg, #0e1730 0%, #0a1520 100%);
  border: 2px solid rgba(16,185,129,0.35);
  border-radius: 14px;
  padding: 18px 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  box-shadow: 0 0 40px rgba(16,185,129,0.08);
  position: relative;
  height: 100%;
}
.da-jira-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding-bottom: 10px;
  border-bottom: 1px solid rgba(255,255,255,0.06);
}
.da-jira-icon {
  width: 34px;
  height: 34px;
  background: linear-gradient(135deg, #0052cc 0%, #2684ff 100%);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 17px;
  flex-shrink: 0;
  box-shadow: 0 2px 12px rgba(0,82,204,0.4);
}
.da-jira-name {
  font-family: 'Sora', sans-serif;
  font-size: 12.5px;
  font-weight: 700;
  color: var(--text-primary);
  line-height: 1.2;
}
.da-jira-subtitle {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 9px;
  color: #10b981;
  font-weight: 600;
}
.da-convergence-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: rgba(16,185,129,0.12);
  border: 1px solid rgba(16,185,129,0.3);
  border-radius: 6px;
  padding: 4px 10px;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 9px;
  font-weight: 700;
  color: #10b981;
  letter-spacing: 0.05em;
  text-transform: uppercase;
}
.da-convergence-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #10b981;
  animation: da-pulse-green 1.5s ease-in-out infinite;
}
.da-jira-detail {
  background: rgba(255,255,255,0.025);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  padding: 10px 12px;
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 10.5px;
  color: var(--text-secondary);
  line-height: 1.5;
  flex: 1;
}

/* client count label inside source cards */
.da-client-count {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 8.5px;
  color: var(--text-muted);
  margin-top: 1px;
  font-weight: 600;
  letter-spacing: 0.06em;
}

/* On-demand return label */
.da-ondemand-label {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 8px;
  color: #00d4ff;
  letter-spacing: 0.07em;
  white-space: nowrap;
  opacity: 0.7;
  text-align: center;
}

/* Table model badge */
.da-model-badge {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 8.5px;
  font-weight: 700;
  border-radius: 4px;
  padding: 2px 6px;
  white-space: nowrap;
}
.da-model-badge.da-a    { background: rgba(16,185,129,0.12); color: #10b981; border: 1px solid rgba(16,185,129,0.25); }
.da-model-badge.da-b    { background: rgba(0,212,255,0.10);  color: #00d4ff; border: 1px solid rgba(0,212,255,0.22); }
.da-model-badge.da-both { background: rgba(139,92,246,0.10); color: #8b5cf6; border: 1px solid rgba(139,92,246,0.22); }

/* h-line left animation (for Model B right-to-left merge) */
.da-h-line.da-left::after {
  animation: da-flow-left 1.6s linear infinite;
  background: linear-gradient(to left, transparent, #00d4ff, transparent);
}
@keyframes da-flow-left {
  0%   { right: -40%; left: auto; }
  100% { right: 100%; left: auto; }
}

/* h-line amber */
.da-h-line.da-amber::after { background: linear-gradient(to right, transparent, #f59e0b, transparent); }

/* h-line for return arrow (cyan dashed style) */
.da-return-arrow {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  gap: 4px;
  opacity: 0.55;
}
.da-return-label {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 7.5px;
  color: #00d4ff;
  letter-spacing: 0.06em;
  white-space: nowrap;
}

/* ============================================================
   LOGIN OVERLAY
   ============================================================ */
#loginOverlay {
  position: fixed;
  inset: 0;
  z-index: 99999;
  background: var(--bg-base);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}
#loginOverlay.fade-out {
  animation: loginFadeOut 0.5s ease forwards;
}
@keyframes loginFadeOut {
  0% { opacity: 1; transform: scale(1); }
  100% { opacity: 0; transform: scale(1.03); }
}
.login-grid-bg {
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(rgba(0,212,255,0.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,212,255,0.04) 1px, transparent 1px);
  background-size: 40px 40px;
  pointer-events: none;
}
.login-grid-bg::after {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse 60% 60% at 50% 50%, transparent 30%, var(--bg-base) 100%);
}
.login-card {
  position: relative;
  z-index: 1;
  width: 400px;
  max-width: calc(100vw - 32px);
  background: rgba(13, 18, 32, 0.85);
  border: 1px solid rgba(0,212,255,0.2);
  border-radius: 16px;
  padding: 40px 36px 32px;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  box-shadow: 0 0 60px rgba(0,212,255,0.08), 0 24px 80px rgba(0,0,0,0.6);
}
.login-brand {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  margin-bottom: 24px;
}
.login-shield {
  width: 52px;
  height: 52px;
  color: var(--cyan);
  filter: drop-shadow(0 0 12px rgba(0,212,255,0.5));
}
.login-title {
  font-family: var(--font-display);
  font-weight: 800;
  font-size: 28px;
  color: var(--text-primary);
  letter-spacing: 2px;
  line-height: 1;
}
.login-subtitle {
  font-family: var(--font-mono);
  font-size: 11px;
  letter-spacing: 3px;
  color: var(--cyan);
  text-transform: uppercase;
}
.login-heading {
  font-family: var(--font-display);
  font-size: 17px;
  font-weight: 600;
  color: var(--text-primary);
  text-align: center;
  margin-bottom: 4px;
}
.login-tagline {
  font-size: 11px;
  color: var(--text-muted);
  text-align: center;
  margin-bottom: 0;
  font-family: var(--font-mono);
  letter-spacing: 1.5px;
}
.login-form {
  display: flex;
  flex-direction: column;
  gap: 14px;
}
.login-field {
  display: flex;
  flex-direction: column;
  gap: 5px;
}
.login-label {
  font-size: 11px;
  font-weight: 500;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-family: var(--font-mono);
}
.login-input {
  width: 100%;
  background: var(--bg-input);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  padding: 10px 14px;
  color: var(--text-primary);
  font-family: var(--font-body);
  font-size: 13px;
  outline: none;
  transition: border-color 0.2s, box-shadow 0.2s;
}
.login-input:focus {
  border-color: var(--cyan);
  box-shadow: 0 0 0 3px rgba(0,212,255,0.12);
}
.login-input::placeholder {
  color: var(--text-muted);
}
.login-pw-wrap {
  position: relative;
}
.login-pw-wrap .login-input {
  padding-right: 42px;
}
.login-pw-toggle {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  padding: 0;
  color: var(--text-muted);
  cursor: pointer;
  font-size: 14px;
  display: flex;
  align-items: center;
  transition: color 0.2s;
}
.login-pw-toggle:hover { color: var(--cyan); }
.login-btn {
  width: 100%;
  padding: 11px;
  background: var(--cyan);
  color: #080c18;
  border: none;
  border-radius: 8px;
  font-family: var(--font-display);
  font-weight: 700;
  font-size: 14px;
  letter-spacing: 0.5px;
  cursor: pointer;
  transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
  margin-top: 4px;
}
.login-btn:hover {
  background: var(--cyan-bright);
  box-shadow: 0 0 20px rgba(0,212,255,0.35);
}
.login-btn:active { transform: scale(0.98); }
.login-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}
.login-error {
  display: none;
  background: rgba(239,68,68,0.12);
  border: 1px solid rgba(239,68,68,0.3);
  border-radius: 7px;
  padding: 9px 12px;
  font-size: 12px;
  color: #ff6b6b;
  font-family: var(--font-mono);
}
.login-error.show { display: block; }
.login-footer {
  margin-top: 24px;
  text-align: center;
  border-top: 1px solid rgba(255,255,255,0.06);
  padding-top: 16px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.login-footer-line {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-muted);
  letter-spacing: 0.03em;
}

</style>
</head>
<body>

<!-- ============================================================
     LOGIN OVERLAY
     ============================================================ -->
<div id="loginOverlay">
  <div class="login-grid-bg"></div>
  <div class="login-card">
    <div class="login-brand">
      <img src="" id="loginLogoImg" alt="DACTA SIEMLess" style="height:48px;width:auto;filter:drop-shadow(0 0 12px rgba(0,212,255,0.3));">
      <div class="login-tagline" style="margin-bottom:0;">For Blue Team, By Blue Team</div>
    </div>
    <div class="login-heading">Sign in to your account</div>
    <div class="login-error" id="loginError"></div>
    <form class="login-form" id="loginForm" onsubmit="handleLogin(event)">
      <div class="login-field">
        <label class="login-label" for="loginEmail">Email</label>
        <input class="login-input" type="email" id="loginEmail" placeholder="analyst@dacta.sg" autocomplete="email" required>
      </div>
      <div class="login-field">
        <label class="login-label" for="loginPassword">Password</label>
        <div class="login-pw-wrap">
          <input class="login-input" type="password" id="loginPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" required>
          <button type="button" class="login-pw-toggle" id="pwToggle" onclick="togglePassword()" aria-label="Show/hide password">
            <svg id="pwEyeIcon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
        </div>
      </div>
      <button type="submit" class="login-btn" id="loginBtn">Sign In</button>
    </form>
    <div class="login-footer">
      <div class="login-footer-line">Protected by DACTA SIEMLess &middot; Omni Platform v2.0</div>
      <div class="login-footer-line">&copy; 2026 DACTA GLOBAL &middot; Authorized Personnel Only</div>
    </div>
  </div>
</div>

<div id="app">

  <!-- ============================================================
       SIDEBAR
       ============================================================ -->
  <nav id="sidebar">
    <div class="sidebar-logo">
      <div style="display:flex;flex-direction:column;align-items:flex-start;">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAACyMAAAGkCAYAAACYOhvJAAEAAElEQVR4nOzdd5gkR30+8Leqe9LmnHV7p0vKWQIUECgggg0GjDFgkySLnKNNciAYbASILLJtbMCGn8lGRCEkUM4oXdDp8t3u3qbZndBd9fuju3p6emd2Z/PM7vu5557ZnZ3Q09NdXeFb3xKNLb044YRtZ1ha4dDh/XcLDQAKWoCo5mnI1d6EdWq97ffqKDBV8FO17f+l2R69JK9SiWrbf1FLe7ypOR9Rrftjkdul/eeLuffAajDHe3WULjNJfwPVPDew2j8X0arS1VrerrJFltNy5SoQq6x4P9ViOStE6a3WuvAlrp/vk2g1rO/rUHW2CqrZ+j5eaH7KXb/LtSc5LlEtvJJR+N9fue9FrLX6WZX2E5VTrg4NePXo9VN/rq3vbS61XgwKXWkP4Lo5QKtKoRZXbefN+qpfrrnr5xq36PopK7hUwnzH14iWxuwXIBZX1VY/WqRla9+usf00b6zIFSlxnK2vmj0RERERERERERERERHRGjdbsDIRERERERER0VKzV3sDiIiIiFZclWe6qfahooXO2K72z0VEVLvMPOPqvr4RERHR+lNp+5EZmKoF65NrhRAC0N5teLWRtYXHa21aq8djreB5Q0RUDRa6AinRcmB7nIiWEjMjExEREREREREREREREdWQtRtkTERERERERES1iJmRiYhomZmZ9pz/Ulv4fZXmHc/a3z/LN1F0rvNmrgwWK/39ldseHkdEtLpMZgnJMfqaEg2q4PdHRFQtWL+npccMTNWCmTJrldbay4JcgmkPCdanaVXwwKsmrMUtD5av64P5nllvJaK1plrKteB6KorH4alaRb8f9idQMZ7BRERERERERFQVmN2NiIiIiGh+WIcmIiIiIiIiomrAzMhERLRCmCGZqkcwwbLsA/zjVBTP5CvMEPVnZur5Zkieb8bj5cqAvNjXLb1fopkgpPYep4SMPF6VfHz1lA8sr4ioVplya23MRGdGZCIiotpXLZmWaGHWzfcn1kb9uZy1t2LM2v6+iJZHtZ83tdEfy0zI61ul3/+M+hNTK9MsovUzxcOE1pFy5arASmdIrvZ6UrVbW+NS5bEiWKnqrtETERERERERERERERERERERERERERFR1WJmZCIiIgpZ6/OUKsywUGlGHGFmZvq/6ujr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lP5wMI87Ec0c7+REREREREREREREREREREREREREREQ0J8yMTERE5UVwZiytBKHzOJwRWZsuU3KxjMrFzPb5tCpIUdrl6dxnhPN+AYCZkBdYeP4/925p0uWakAudsYFHfHnNd//PN5PLcmWCmWkG4MV6/Ww/R1vq/VNMyaeWoUUx3fkY/vtSXSczs1AZkdj8I6U0zmuamuBxKguOm2PXYP2CZmOhVqqSpVVfIaKlN9MMw/PNoLzc6ws5brlpsF97mc22n2el9pyX5n136dv75VIPCW/nwmzvzDO804Iq/ZThVMRKuQMQERERERERERERERERERERERERERHREmNmZCIiIqIlF5oPNt0UVs78o0WkM4eWeobkvHKZgV0iFioDDxERLZP53u94vyTKW531IWZIJip90i2fmCGZaOGUzG2P/TFEVGZmOhpVLFOozsw830yi882Q7AjWq4hoYSxUuUa0WrAFRERERERERERERERERERERERERERERHPCzMhEREQLSs+05XwfWgAzzYg801RXTIVFZUiftpMvh3A5y0wHtHR4l18teKRpMc030z9XCiBaeCv7umKG5NVqZZ/XKw+PF9GKsWgZkVlOENHUdOZOY4EX3JxpRtCFzhw62wzJ882IHP4cZlimUsR2fTG8XolKAUfWiIiIiIiIiIiIiIiIiIiIiIiIiIiIaE6YGZmIiIioVMw0E/J0r+eUWJoDIdWMYSlKc75i8QzJWrHtDs+ELs3vt+h0BodFy8xDVHp0eabLt5kLXyf6vrrAKWVolVrocrhUM6OV6nbR6sT6DxHL5fKga5uCx6u0Td9BQctI5C+kFYnrMhLRTC1UhuSFznQ8V7PNkLxQ9OcxQzKtbjz/gXx5WirlIlGpYluFiIiIiIiIiIiIiIiIiIiIiIiIiIiI5oSZkYmIiBYFcxTQMmKGZJqXlVZ+rZTvsUCYIZlWoeIZ39X1wIRmq1WxjINLXT4ud+bD8Pdd7kwnK60eQlR62FwkIiJaCZa7HUFEtDwWK0PyUmdcJpoLtuOJqBzwjkpERERERERERERERERERERERERERERzwszIRERERETkyWdKK83MhHq7BDMVzA8zJM/LbK+O0ryaSB+RfLmiHw8fMaZOXtnmemUuVyaycitJSi3zMhHRasXytxwIHqfyolPTcamVkuIdluXdjEXHfgailcdYoNuJIxb2/fT7OCVWsDoiWG+aa2bj6V4X/hxa6Xi8g7g/Cpl/ucj9Sisb2yhEREREREREREREREREREREREREREQ0J8yMTEREtKiYo4AWATOv0BIIn16yxDIfMEMylQPOby8XxTLczvUIslyiclDsPF3sjM8zfX+2o4iIFgZrpGXBW7lmeTeDiBbQkq1ItVwrthDRfC1U5uJyf9+Fyrg82wzGxTIiMxNyuQsfv+nuwzzeREQLjT36RERERERERERERERERERERERERERENCfMjExERERU6oqlpGWGZFoSwQzEy50hOZwRmRmSiWjhFMkotWQZrWhlY0Y0IiIiCvHas8u8HUQrkL6sln2hL7YniYimpDMuL1SG5Ok/j+Xx6lJs5S32nxERLRbeaYmIiIiIiIiIiIiIiIiIiIiIiIiIiGhOmBmZiGiOvBmay50icrUIz1Qtm93OeT+0AMIpclju0LIojQzJzIC8wJihZ15mmz8h/Hzu9dKSX3AglGGW1wdNaaEyq8w0s3GxjC7L9T5zxUzOVMpWR8YkNjNXqpV5vq4YInh8mBG5PDmhA8fWQmla9tvakrUjWe4TlatimYCNVVc/UOXlTL93fr/NrPxjJuSlNt/9PV1/1Ww/v9h5Up79UtO1H9iuX1rhcmupMrwTlTreeYmIiIiIiIiIiIiIiIiIiIiIiIiIiGhOmBmZiGiuOLVsaTFzIxFRidAZktVvUpRKuTzfGfNERESloDwzs8zdavu+RES0KjEjMhEREc3Q6suYPLt+fb0fmIF0pVqo8R32MxERLReO1BMREREREREREREREREREREREREREdGcMDMyERGVF8HMl0QzTqGTT107s8eJypg+nYXkfYLKx0zPVp7VROUkfKXONRNLsYzBMy0JljrjMEsqWsmYwZuI5kbocmPFZjJcrXR/Gg9sKfK6TVdNtyfrKUSrRTgT8MrNlDwzRmglXb1/Vvt+WT1m2w+1OvqtOPxLRKVgZZe0REREREREREREREREREREREREREREtGiYGZmIiMqS4c5gdDivhmh6zJBMi6jUTiNmSKaVhHmNiFaC+d6HmOmMqHSs7Oux1Or1NFcr+zwlIipmpgvJLTq5tP1Q+d4vlv9Eq83KywQ815Wh3GevmP1AU5vvfW513Cfn375fHfuJSlTJVOxprjgyT0RERERERERERERERERE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WJ543BbDKq++liSOMRIREREREREREREREREREREREREREdGcMDMyEREREREREXmYIZmIiGgx6TvsysyIE84ouNozLC6/lXmeERHRPOkMye6vxiq/XzAjMq0kTqj+Hc6AXiqKbVd4+4mIysfqrk8RaRxbJCIiIiIiIiIiIiIiIiIiIiIiIiIiojlhZmQiIiIiIlqxpFAzkYXkPMwpufsJ3E+rGo8+EREREa1GokgGK+nWkIv9nQjwZXZkJsdlpTPxM8Pt3DihHoHVkimZ5wutBjrTcKlmSA5b6ozJ4c9jZmZaDfT9jysZEdFi4FgjERERERERERERERERERERERERERERzQkzIxMRERER0YrHDMnT4H5ZlXjUl1o4sxSPABERrXzFMg4yAxMtK699OM3TVklmUJofL+Pk8m4GubwMycu7GUREtMBmmsHYCPVzzz7TMet/VA70ec7zlcqfLt+ZmX7lYNuYiIiIiIiIiIiIiIiIiIiIiIiIiIiI5oSZkYmIiIiIaMFJUZrzHpkhmWjudJ4FXj0LhXuUiGh1YcYiv3BG2sXKlLxUn0Plwct0PE1GZKK5cEK5eI0VdqJNl0mcVgixuspJL5P2Kvm+VN7CmYG11ZpJstj+mK3Vuv9opZhfhmR9/2M7mZYDR0VWLh5bIiIiIiIiIiIiIiIiIiIiIiIiIiIimhNmRiYiIiIionkr1UzINA1miF7ViuXlZd7GpcYMyUREKxvvrDNRLCPhQmdoYqbklYmHkWjhMVPs6rRQmUbLDTMkUymb7roM/z2c6Xe213WxTMHlWj7o7XYE22W0kjFDMpW/6e5nVD440kVERERERERERERERERERERERERERERzwszIRERERES06kg3E4JgZmBaRYpl+pkuX0L4dczjOw/CYUZyIiIqK/PLr1QCpsmAphPtFE/0Vu737WLbX7ZHdI5W2/clIpodg+UkAGZIppVloTMZ6wyVpZ8hebblWfj55V7/JyIiWl68kxIREREREREREREREREREREREREREdGcMDMyERGVB2aQI1p6xVJA6BQRRERUVuaa2Sf8OtbKZieQWclXpy12O2UGJiIiKiXLnScxfF9cuuboSqnxlH1u6xkpVn3Kny7THc+VvX9oeZT7ijLlmiHW296lul+U+bhFOCOy3n/h+60zzZmc/yvLU6KF5hQpz4plKJ5v5uLp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" alt="DACTA SIEMLess" style="height:26px;width:auto;object-fit:contain;" />
        <div style="font-family:var(--font-mono);font-size:9px;color:#64748b;letter-spacing:0.5px;margin-top:3px;">For Blue Team, By Blue Team</div>
      </div>
    </div>

    <div class="sidebar-nav">

      <!-- SOC OPERATIONS -->
      <div class="nav-section">
        <div class="nav-section-label">SOC Operations</div>
        <div class="nav-item active" data-page="dashboard">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="4" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="11" width="7" height="10" rx="1"/></svg></span>
          <span class="nav-label">Dashboard</span>
        </div>
        <div class="nav-item" data-page="triage">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg></span>
          <span class="nav-label">Triage Queue</span>
        </div>
        <div class="nav-item" data-page="investigation">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg></span>
          <span class="nav-label">Investigation</span>
        </div>
        <div class="nav-item" data-page="copilot" style="position:relative;">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"/><path d="M16 14H8a4 4 0 0 0-4 4v2h16v-2a4 4 0 0 0-4-4z"/><circle cx="9" cy="7" r="0.5" fill="currentColor" stroke="none"/><circle cx="15" cy="7" r="0.5" fill="currentColor" stroke="none"/></svg></span>
          <span class="nav-label">DACTA Copilot</span>
          <span style="position:absolute;right:8px;top:50%;transform:translateY(-50%);font-size:8px;font-weight:700;background:linear-gradient(135deg,var(--cyan),#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;letter-spacing:0.05em;">AI</span>
        </div>
        <div class="nav-item" data-page="response">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></span>
          <span class="nav-label">Response Center</span>
        </div>
        <div class="nav-item" data-page="handover">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M17 1l4 4-4 4"/><path d="M3 11V9a4 4 0 0 1 4-4h14"/><path d="M7 23l-4-4 4-4"/><path d="M21 13v2a4 4 0 0 1-4 4H3"/></svg></span>
          <span class="nav-label">Shift Handover</span>
        </div>
      </div>

      <!-- WAR ROOM -->
      <div class="nav-section">
        <div class="nav-section-label">War Room</div>
        <div class="nav-item" data-page="warroom">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><path d="M12 18v-6"/><path d="M9 15l3-3 3 3"/></svg></span>
          <span class="nav-label">IR / DFIR Center</span>
        </div>
      </div>

      <!-- ENGINEERING -->
      <div class="nav-section">
        <div class="nav-section-label">Engineering</div>
        <div class="nav-item" data-page="rules">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M9 15l2 2 4-4"/></svg></span>
          <span class="nav-label">Detection Rules</span>
        </div>
        <div class="nav-item" data-page="rulelab">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M9 3h6v7l4 8H5l4-8V3z"/><path d="M8 3h8"/></svg></span>
          <span class="nav-label">Rule Testing Lab</span>
        </div>
        <div class="nav-item" data-page="logsources">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M2 16.1A5 5 0 0 1 5.9 20M2 12.05A9 9 0 0 1 9.95 20M2 8V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6"/><circle cx="4" cy="18" r="2"/></svg></span>
          <span class="nav-label">Log Source Catalog</span>
        </div>
        <div class="nav-item" data-page="parsers">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M16 18l2-2 2 2"/><path d="M20 16v4h-4"/><path d="M4 6h16"/><path d="M4 10h16"/><path d="M4 14h10"/><path d="M4 18h6"/></svg></span>
          <span class="nav-label">Log Parser</span>
        </div>
      </div>

      <!-- HUNTING & INTEL -->
      <div class="nav-section">
        <div class="nav-section-label">Hunting &amp; Intel</div>
        <div class="nav-item" data-page="hunting">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg></span>
          <span class="nav-label">Threat Hunting</span>
        </div>
        <div class="nav-item" data-page="intel">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M2 12h20"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg></span>
          <span class="nav-label">Threat Intelligence</span>
        </div>
        <div class="nav-item" data-page="entities">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="5" r="3"/><circle cx="5" cy="19" r="3"/><circle cx="19" cy="19" r="3"/><path d="M12 8v4"/><path d="M7.5 17.2L10.5 13"/><path d="M16.5 17.2L13.5 13"/></svg></span>
          <span class="nav-label">Entity Explorer</span>
        </div>
      </div>

      <!-- DATA PRIVACY -->
      <div class="nav-section">
        <div class="nav-section-label">Data Privacy</div>
        <div class="nav-item" data-page="privacy">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/><circle cx="12" cy="16" r="1"/></svg></span>
          <span class="nav-label">Privacy Engine</span>
        </div>
      </div>

      <!-- MANAGEMENT -->
      <div class="nav-section">
        <div class="nav-section-label">Management</div>
        <div class="nav-item" data-page="assets">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><path d="M8 21h8"/><path d="M12 17v4"/></svg></span>
          <span class="nav-label">Asset Management</span>
        </div>
        <div class="nav-item" data-page="vulnmgmt">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="M12 8v4"/><circle cx="12" cy="16" r="0.5" fill="currentColor" stroke="none"/></svg></span>
          <span class="nav-label">Vuln Management</span>
        </div>
        <div class="nav-item" data-page="reporting">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M18 20V10"/><path d="M12 20V4"/><path d="M6 20v-6"/><path d="M2 20h20"/></svg></span>
          <span class="nav-label">Reporting &amp; Compliance</span>
        </div>
        <div class="nav-item" data-page="clientportal">
          <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><path d="M9 22V12h6v10"/></svg></span>
          <span class="nav-label">Client Portal</span>
        </div>
      </div>

      <!-- ADMIN -->
      <div class="nav-section admin-section" id="adminSection">
        <div class="nav-section-label" id="adminToggle">Admin <span class="admin-chevron">â–¾</span></div>
        <div class="admin-items">
          <div class="nav-item" data-page="integrations">
            <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></span>
            <span class="nav-label">Integrations Hub</span>
          </div>
          <div class="nav-item" data-page="aiusage">
            <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/><circle cx="12" cy="12" r="4"/></svg></span>
            <span class="nav-label">AI Usage Dashboard</span>
          </div>
          <div class="nav-item" data-page="dataarch">
            <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 3 21 3 21 8"/><line x1="4" y1="20" x2="21" y2="3"/><polyline points="21 16 21 21 16 21"/><line x1="15" y1="15" x2="21" y2="21"/><line x1="4" y1="4" x2="9" y2="9"/></svg></span>
            <span class="nav-label">Data Architecture</span>
          </div>
          <div class="nav-item" data-page="users">
            <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></span>
            <span class="nav-label">User Management</span>
          </div>
          <div class="nav-item" data-page="settings">
            <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></span>
            <span class="nav-label">Settings</span>
          </div>
          <div class="nav-item" data-page="audit">
            <span class="nav-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/></svg></span>
            <span class="nav-label">Audit Log</span>
          </div>
        </div>
      </div>

    </div><!-- end sidebar-nav -->

    <div class="sidebar-toggle" id="sidebarToggle">
      <span class="toggle-icon">â—€</span>
    </div>
  </nav>

  <!-- ============================================================
       MAIN
       ============================================================ -->
  <div id="main">

    <!-- TOP BAR -->
    <div id="topbar">

      <div class="topbar-sep"></div>
      <div class="org-select">
        <span>ðŸ¢</span>
        <span>All Organizations</span>
        <span>â–¾</span>
      </div>
      <div class="demo-toggle-wrap" style="display:flex;align-items:center;gap:6px;padding:0 12px;border-left:1px solid var(--border-subtle);">
        <span class="demo-label-text" style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);text-transform:uppercase;letter-spacing:0.05em;">Demo</span><span class="prod-label-text" style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);text-transform:uppercase;letter-spacing:0.05em;">View</span>
        <label style="position:relative;width:32px;height:18px;cursor:pointer;">
          <input type="checkbox" id="demoModeToggle" style="display:none;">
          <span style="position:absolute;inset:0;background:rgba(77,90,110,0.2);border-radius:9px;transition:0.2s;" id="demoSlider"></span>
          <span style="position:absolute;top:2px;left:2px;width:14px;height:14px;background:#4d5a6e;border-radius:50%;transition:0.2s;" id="demoKnob"></span>
        </label>
      </div>
      <div class="prod-badge">PRODUCTION</div>
      <div class="topbar-right">
        <div class="live-badge">
          <div class="live-dot"></div>
          <span>LIVE</span>
        </div>
        <div class="topbar-time" id="topbarTime">00:00:00 SGT</div>
        <div class="topbar-icon-btn" data-tooltip="Notifications">
          ðŸ””
          <span class="notif-badge">3</span>
        </div>
        <div class="topbar-icon-btn" data-tooltip="Help">â“</div>
        <div class="user-chip" id="topbarUserChip" style="cursor:pointer;" onclick="toggleUserMenu()">
          <div class="user-avatar" id="topbarUserAvatar">JL</div>
          <span class="user-name" id="topbarUserName">John Lim</span>
        </div>
        <div id="userMenu" style="display:none;position:absolute;top:48px;right:12px;background:var(--bg-card);border:1px solid var(--border-card);border-radius:8px;min-width:180px;z-index:9999;box-shadow:0 8px 32px rgba(0,0,0,0.5);overflow:hidden;">
          <div style="padding:12px 14px 8px;border-bottom:1px solid var(--border-subtle);">
            <div style="font-size:11px;color:var(--text-muted);font-family:var(--font-mono);margin-bottom:2px;">SIGNED IN AS</div>
            <div style="font-size:12px;color:var(--text-primary);font-family:var(--font-mono);" id="userMenuEmail">admin@dacta.sg</div>
          </div>
          <button onclick="handleLogout()" style="width:100%;display:flex;align-items:center;gap:8px;padding:10px 14px;background:none;border:none;color:var(--red-bright);font-size:12px;font-family:var(--font-body);cursor:pointer;text-align:left;transition:background 0.15s;" onmouseover="this.style.background='rgba(239,68,68,0.1)'" onmouseout="this.style.background='none'">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
            Sign Out
          </button>
        </div>
      </div>
    </div>

    <!-- CONTENT AREA -->
    <div id="content-area">

      <!-- =====================================================
           PAGE 1: DASHBOARD
           ===================================================== -->
      <div class="page active" id="page-dashboard">

        <!-- Command Bar -->
        <div class="cc-command-bar">
          <div class="cc-command-left">
            <div class="cc-brand-mark">
              <div class="cc-brand-text">
                <div class="cc-brand-name">Mission Control Center</div>
                <div class="cc-brand-org">UNIFIED SECURITY OPERATIONS</div>
              </div>
            </div>
            <div class="cc-status-pills">
              <div class="cc-status-pill green"><span class="cc-status-dot green"></span>SYSTEMS OPERATIONAL</div>
              <div class="cc-status-pill cyan"><span class="cc-status-dot cyan"></span>SHIFT B Â· 14:00â€“22:00</div>
              <div class="cc-status-pill">ANALYST: JOHN LIM</div>
            </div>
          </div>
          <div class="cc-command-right">
            <div class="cc-time-filter" style="cursor:pointer;" onclick="refreshDashboardData()" title="Refresh dashboard data">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:4px;"><path d="M1 4v6h6"/><path d="M23 20v-6h-6"/><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/></svg>
              <span>Live Â· 24H</span>
            </div>
            <div class="cc-clock-display">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
              <span id="ccClockTime">01:22</span> SGT
            </div>
            <div id="multiTzClocks" style="display:flex;gap:12px;font-family:var(--font-mono);font-size:10px;color:var(--text-muted);align-items:center;">
              <span id="tz-pht"></span>
              <span style="opacity:0.3;">|</span>
              <span id="tz-wib"></span>
              <span style="opacity:0.3;">|</span>
              <span id="tz-ict"></span>
              <span style="opacity:0.3;">|</span>
              <span id="tz-aest"></span>
            </div>
            <button class="cc-view-toggle" id="dashViewToggle" onclick="toggleDashView()">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
              <span>Classic View</span>
            </button>
          </div>
        </div>

        <!-- ====== COMMAND VIEW ====== -->
        <div class="cc-command-view" id="commandView">
        <!-- Command Center Canvas -->
        <div class="cc-canvas-wrapper">
          <div class="cc-canvas-grid-bg"></div>
          <canvas id="commandCenterCanvas"></canvas>
        </div>

        <!-- Metric Cards Row -->
        <div class="cc-metrics-row">
          <div class="cc-metric-card">
            <div class="cc-metric-top">
              <div class="cc-metric-value">22</div>
              <div class="cc-metric-unit">GB/24H</div>
            </div>
            <div class="cc-metric-label">Events Ingestion</div>
            <canvas class="cc-sparkline" id="sparkEventsIng" width="120" height="32"></canvas>
          </div>
          <div class="cc-metric-card">
            <div class="cc-metric-top">
              <div class="cc-metric-value">36</div>
              <div class="cc-metric-unit">TB/24H</div>
            </div>
            <div class="cc-metric-label">Data Ingestion</div>
            <canvas class="cc-sparkline" id="sparkDataIng" width="120" height="32"></canvas>
          </div>
          <div class="cc-metric-card">
            <div class="cc-metric-top">
              <div class="cc-metric-value">12</div>
              <div class="cc-metric-unit">TOTAL</div>
            </div>
            <div class="cc-metric-label">Total Open Incidents</div>
            <div class="cc-severity-dots">
              <span class="cc-sev-dot" style="--dot-color:#ef4444;">C<b>3</b></span>
              <span class="cc-sev-dot" style="--dot-color:#f59e0b;">H<b>7</b></span>
              <span class="cc-sev-dot" style="--dot-color:#00d4ff;">M<b>5</b></span>
              <span class="cc-sev-dot" style="--dot-color:#10b981;">L<b>1</b></span>
            </div>
          </div>
          <div class="cc-metric-card" style="border-color:rgba(16,185,129,0.15);">
            <div class="cc-metric-top">
              <div class="cc-metric-value">157.5K</div>
            </div>
            <div class="cc-metric-label">Auto-Resolved</div>
            <div class="cc-prevented-bar">
              <div class="cc-prevented-fill"></div>
            </div>
          </div>
          <div class="cc-metric-card" style="border-color:rgba(0,212,255,0.15);">
            <div class="cc-metric-top">
              <div class="cc-metric-value" id="cc-mttd" style="color:var(--cyan);">â€”</div>
              <div class="cc-metric-unit">MIN</div>
            </div>
            <div class="cc-metric-label">MTTD</div>
            <div style="font-size:8px;color:var(--text-muted);margin-top:2px;line-height:1.3;">Mean Time to Detect â€” avg time from event to alert creation</div>
          </div>
          <div class="cc-metric-card" style="border-color:rgba(16,185,129,0.15);">
            <div class="cc-metric-top">
              <div class="cc-metric-value" id="cc-mttr" style="color:var(--green);">â€”</div>
              <div class="cc-metric-unit">MIN</div>
            </div>
            <div class="cc-metric-label">MTTR</div>
            <div style="font-size:8px;color:var(--text-muted);margin-top:2px;line-height:1.3;">Mean Time to Resolve â€” avg time from detection to resolution</div>
          </div>
          <div class="cc-metric-card" style="border-color:rgba(139,92,246,0.15);">
            <div class="cc-metric-top">
              <div class="cc-metric-value" id="cc-sla" style="color:#a78bfa;">â€”</div>
              <div class="cc-metric-unit">%</div>
            </div>
            <div class="cc-metric-label">SLA Compliance</div>
            <div style="font-size:8px;color:var(--text-muted);margin-top:2px;line-height:1.3;">% of incidents resolved within SLA target window</div>
          </div>
        </div><!-- end cc-metrics-row -->

        <!-- Heat Map -->
        <div class="cc-heatmap-card">
          <div class="cc-heatmap-header">
            <span class="cc-heatmap-title">Alert Activity Heat Map</span>
            <span class="cc-heatmap-subtitle">7-Day Â· Hourly Distribution</span>
          </div>
          <div class="cc-heatmap-container">
            <canvas id="heatmapCanvas"></canvas>
            <div class="cc-heatmap-tooltip" id="heatmapTooltip"></div>
          </div>
          <div class="cc-heatmap-legend">
            <span class="cc-heatmap-legend-label">Low</span>
            <div class="cc-heatmap-gradient"></div>
            <span class="cc-heatmap-legend-label">High</span>
          </div>
        </div>

        <!-- Threat Geography â€” Two Cards -->
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px;">

          <!-- Card 1: Attack Trail (existing) -->
          <div class="cc-geomap-card" style="margin-bottom:0;">
            <div class="cc-geomap-header">
              <span class="cc-geomap-title">Threat Attack Trail</span>
              <span class="cc-geomap-subtitle">Source â†’ Destination routes</span>
            </div>
            <div style="position:relative;overflow:hidden;border-radius:8px;">
              <canvas id="geoMapCanvas" style="width:100%;height:260px;display:block;"></canvas>
              <!-- Tooltip -->
              <div id="geoSvgTooltip" style="position:absolute;display:none;pointer-events:none;background:rgba(8,12,24,0.95);border:1px solid rgba(0,212,255,0.2);border-radius:6px;padding:8px 12px;font-size:11px;color:#e8edf5;font-family:'IBM Plex Sans',sans-serif;box-shadow:0 4px 16px rgba(0,0,0,0.5);z-index:10;white-space:nowrap;">
                <div id="geoTipName" style="font-weight:700;margin-bottom:3px;"></div>
                <div id="geoTipInfo" style="color:#8892a4;font-size:10px;"></div>
              </div>
            </div>
            <div class="cc-geomap-legend">
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#ef4444;box-shadow:0 0 6px #ef4444;"></span>Malicious</span>
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#f59e0b;box-shadow:0 0 6px #f59e0b;"></span>Suspicious</span>
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#10b981;box-shadow:0 0 6px #10b981;"></span>Internal</span>
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#00d4ff;box-shadow:0 0 6px #00d4ff;"></span>Informational</span>
            </div>
          </div>

          <!-- Card 2: Threat Heat Map (new) -->
          <div class="cc-geomap-card" style="margin-bottom:0;">
            <div class="cc-geomap-header">
              <span class="cc-geomap-title">Threat Heat Map</span>
              <span class="cc-geomap-subtitle">Alert volume by country</span>
            </div>
            <div style="position:relative;overflow:hidden;border-radius:8px;">
              <canvas id="geoHeatMapCanvas" style="width:100%;height:260px;display:block;"></canvas>
            </div>
            <div class="cc-geomap-legend">
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:rgba(200,200,210,0.6);box-shadow:0 0 3px rgba(200,200,210,0.3);"></span>N/A</span>
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#3b82f6;box-shadow:0 0 6px #3b82f6;"></span>&lt;50</span>
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#06b6d4;box-shadow:0 0 6px #06b6d4;"></span>50â€“500</span>
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#22c55e;box-shadow:0 0 6px #22c55e;"></span>500â€“2K</span>
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#eab308;box-shadow:0 0 6px #eab308;"></span>2Kâ€“5K</span>
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#f97316;box-shadow:0 0 6px #f97316;"></span>5Kâ€“10K</span>
              <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#ef4444;box-shadow:0 0 6px #ef4444;"></span>10K+</span>
            </div>
          </div>

        </div><!-- end geo map 2-col grid -->

        </div><!-- end commandView -->
        <div class="cc-classic-view" id="classicView" style="display:none;">
          <!-- SLA Strip -->
          <div class="sla-strip" style="margin-bottom:16px;">
            <div class="sla-item">
              <div><div class="sla-key">MTTD</div><div class="sla-desc">Mean Time to Detect</div></div>
              <div class="sla-val">4.2<span style="font-size:12px;color:var(--text-muted);">min</span></div>
            </div>
            <div class="sla-item">
              <div><div class="sla-key">MTTR</div><div class="sla-desc">Mean Time to Respond</div></div>
              <div class="sla-val">18<span style="font-size:12px;color:var(--text-muted);">min</span></div>
            </div>
            <div class="sla-item">
              <div><div class="sla-key">P1 RESP</div><div class="sla-desc">P1 Response Time</div></div>
              <div class="sla-val">6<span style="font-size:12px;color:var(--text-muted);">min</span></div>
            </div>
            <div class="sla-item">
              <div><div class="sla-key">SLA</div><div class="sla-desc">Compliance Rate</div></div>
              <div class="sla-val">98.4<span style="font-size:12px;color:var(--text-muted);">%</span></div>
            </div>
          </div>

          <!-- Summary Cards -->
          <div class="summary-cards">
            <div class="summary-card"><div class="sc-num" style="color:var(--text-primary);">22</div><div class="sc-label">Total Alerts</div></div>
            <div class="summary-card"><div class="sc-num" style="color:var(--red);">1</div><div class="sc-label">P1 Critical</div></div>
            <div class="summary-card"><div class="sc-num" style="color:var(--amber);">5</div><div class="sc-label">P3+ High</div></div>
            <div class="summary-card"><div class="sc-num" style="color:var(--orange);">2</div><div class="sc-label">Escalated</div></div>
            <div class="summary-card"><div class="sc-num" style="color:var(--text-muted);">3</div><div class="sc-label">Auto-Cancelled</div></div>
            <div class="summary-card"><div class="sc-num" style="color:var(--green);">10</div><div class="sc-label">Resolved</div></div>
          </div>

          <!-- Chart Grid -->
          <div class="chart-grid" style="margin-bottom:20px;">
            <div class="card"><div class="card-header"><span class="card-title">Alert Volume (Hourly)</span></div><div style="height:240px;"><canvas id="classicAlertChart"></canvas></div></div>
            <div class="card"><div class="card-header"><span class="card-title">Source Breakdown</span></div><div style="height:240px;"><canvas id="classicSourceChart"></canvas></div></div>
          </div>
        </div><!-- end classicView -->

        <!-- Bottom Row: Tickets + Sidebar -->
        <div class="cc-bottom-grid">
          <!-- Open Tickets (left wider) -->
          <div class="card cc-tickets-card">
            <div class="card-header">
              <span class="card-title">Open Tickets</span>
              <span class="badge badge-open">6 OPEN</span>
            </div>
            <div class="ticket-row" onclick="navigate('investigation')">
              <span class="ticket-id">DAC-18158</span>
              <span class="badge badge-p1">P1</span>
              <span class="ticket-title">Potential Ransomware Activity Detected</span>
              <div class="ticket-meta">
                <span class="ticket-source">Jira</span>
                <div class="status-dot red"></div>
                <span class="ticket-time">9h ago</span>
              </div>
            </div>
            <div class="ticket-row">
              <span class="ticket-id">DAC-18157</span>
              <span class="badge badge-p2">P2</span>
              <span class="ticket-title">Unusual Host Communication with Internal Hosts</span>
              <div class="ticket-meta">
                <span class="ticket-source">Jira</span>
                <div class="status-dot amber"></div>
                <span class="ticket-time">9h ago</span>
              </div>
            </div>
            <div class="ticket-row">
              <span class="ticket-id">DAC-18138</span>
              <span class="badge badge-p3">P3</span>
              <span class="ticket-title">Suspicious Mailbox Permission Delegation in Exchange Online</span>
              <div class="ticket-meta">
                <span class="ticket-source">Jira</span>
                <div class="status-dot cyan"></div>
                <span class="ticket-time">10h ago</span>
              </div>
            </div>
            <div class="ticket-row">
              <span class="ticket-id">DAC-18128</span>
              <span class="badge badge-p3">P3</span>
              <span class="ticket-title">O365 Exchange Suspicious Mailbox Right Delegation</span>
              <div class="ticket-meta">
                <span class="ticket-source">Jira</span>
                <div class="status-dot cyan"></div>
                <span class="ticket-time">10h ago</span>
              </div>
            </div>
            <div class="ticket-row">
              <span class="ticket-id">DAC-18125</span>
              <span class="badge badge-p3">P3</span>
              <span class="ticket-title">EDR Alert â€” Suspicious Process Execution Score: 42</span>
              <div class="ticket-meta">
                <span class="ticket-source">Jira</span>
                <div class="status-dot cyan"></div>
                <span class="ticket-time">9h ago</span>
              </div>
            </div>
            <div class="ticket-row">
              <span class="ticket-id">DAC-18120</span>
              <span class="badge badge-p3">P3</span>
              <span class="ticket-title">Application Control â€” Unauthorized Execution Request</span>
              <div class="ticket-meta">
                <span class="ticket-source">Jira</span>
                <div class="status-dot cyan"></div>
                <span class="ticket-time">10h ago</span>
              </div>
            </div>
          </div>

          <!-- Right sidebar -->
          <div class="cc-right-sidebar">
            <!-- By Organization -->
            <div class="card">
              <div class="card-header">
                <span class="card-title">By Organization</span>
              </div>
              <div class="org-row">
                <div class="status-dot amber"></div>
                <span class="org-name">Dacta Global</span>
                <div class="org-bar"><div class="org-fill" style="width:80%;"></div></div>
                <span class="org-count">12 Â· <span style="color:var(--amber);">4 open</span></span>
              </div>
              <div class="org-row">
                <div class="status-dot cyan"></div>
                <span class="org-name">SPMT</span>
                <div class="org-bar"><div class="org-fill" style="width:27%;background:var(--cyan);"></div></div>
                <span class="org-count">4 Â· <span style="color:var(--cyan);">1 open</span></span>
              </div>
              <div class="org-row">
                <div class="status-dot cyan"></div>
                <span class="org-name">Naga World</span>
                <div class="org-bar"><div class="org-fill" style="width:20%;background:var(--cyan);"></div></div>
                <span class="org-count">3 Â· <span style="color:var(--cyan);">1 open</span></span>
              </div>
              <div class="org-row">
                <div class="status-dot green"></div>
                <span class="org-name">ADV Partners</span>
                <div class="org-bar"><div class="org-fill" style="width:13%;background:var(--green);"></div></div>
                <span class="org-count">2 Â· <span style="color:var(--green);">clear</span></span>
              </div>
              <div class="org-row">
                <div class="status-dot green"></div>
                <span class="org-name">Global Advisor Co</span>
                <div class="org-bar"><div class="org-fill" style="width:7%;background:var(--green);"></div></div>
                <span class="org-count">1 Â· <span style="color:var(--green);">clear</span></span>
              </div>
            </div>

            <!-- Triage Labels -->
            <div class="card">
              <div class="card-header">
                <span class="card-title">Triage Labels</span>
              </div>
              <div class="labels-grid">
                <div class="label-chip"><span>AAR</span><span class="label-count">6</span></div>
                <div class="label-chip"><span>Automated</span><span class="label-count">6</span></div>
                <div class="label-chip"><span>Recon</span><span class="label-count">3</span></div>
                <div class="label-chip"><span>Compromise</span><span class="label-count">2</span></div>
                <div class="label-chip"><span>Attack</span><span class="label-count">2</span></div>
                <div class="label-chip"><span>Audit</span><span class="label-count">2</span></div>
              </div>
            </div>

            <!-- Analyst Distribution -->
            <div class="card">
              <div class="card-header">
                <span class="card-title">Analyst Workload</span>
              </div>
              <div class="analyst-distribution" style="display:flex;flex-direction:column;gap:6px;">
                <div style="padding:8px;font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">Loading...</div>
              </div>
            </div>

            <!-- Priority Distribution -->
            <div class="card">
              <div class="card-header">
                <span class="card-title">Priority Distribution</span>
              </div>
              <div class="priority-distribution" style="display:flex;flex-direction:column;gap:6px;">
                <div style="padding:8px;font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">Loading...</div>
              </div>
            </div>
          </div>
        </div>
      </div><!-- end dashboard -->


      <!-- =====================================================
           PAGE 2: TRIAGE QUEUE
           ===================================================== -->
      <div class="page" id="page-triage">
        <div class="page-header">
          <div>
            <div class="page-title">Triage Queue</div>
            <div class="page-subtitle">22 tickets in last 24h â€” 8 requiring action</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm">â†“ Export</button>
            <button class="btn btn-primary btn-sm" onclick="openCreateTicketModal()">+ Create Ticket</button>
          </div>
        </div>

        <!-- Metrics Strip -->
        <div class="tq-metrics">
          <div class="tq-metric red">
            <div class="tq-metric-icon tq-pulse">ðŸ”´</div>
            <div class="tq-metric-body">
              <div class="tq-metric-value">1</div>
              <div class="tq-metric-label">P1 Critical</div>
              <div class="tq-metric-sub">Active now</div>
            </div>
          </div>
          <div class="tq-metric amber">
            <div class="tq-metric-icon">â³</div>
            <div class="tq-metric-body">
              <div class="tq-metric-value">8</div>
              <div class="tq-metric-label">Awaiting Triage</div>
              <div class="tq-metric-sub">Needs analyst review</div>
            </div>
          </div>
          <div class="tq-metric cyan">
            <div class="tq-metric-icon">ðŸ¤–</div>
            <div class="tq-metric-body">
              <div class="tq-metric-value">14</div>
              <div class="tq-metric-label">AI Pre-Triaged</div>
              <div class="tq-metric-sub">Auto-classified</div>
            </div>
          </div>
          <div class="tq-metric green">
            <div class="tq-metric-icon">âš¡</div>
            <div class="tq-metric-body">
              <div class="tq-metric-value">2.3<span style="font-size:14px;">m</span></div>
              <div class="tq-metric-label">Avg Triage Time</div>
              <div class="tq-metric-sub">Last 24 hours</div>
            </div>
          </div>
        </div>

        <!-- Filter Bar -->
        <div class="filter-bar">
          <span class="filter-label">Filter:</span>
          <select id="tqFilterPriority" class="filter-select"><option>All Priorities</option><option>P1</option><option>P2</option><option>P3</option><option>P4</option></select>
          <select id="tqFilterOrg" class="filter-select"><option>All Organizations</option><option>Dacta Global</option><option>SPMT</option><option>Naga World</option><option>ADV Partners</option></select>
          <input type="date" id="tqFilterDateFrom" class="filter-select" style="width:140px;" title="From date">
          <input type="date" id="tqFilterDateTo" class="filter-select" style="width:140px;" title="To date">
          <select id="tqFilterDatePreset" class="filter-select"><option value="">Time Range</option><option value="today">Today</option><option value="24h">Last 24h</option><option value="7d">Last 7 Days</option><option value="30d">Last 30 Days</option><option value="90d">Last 90 Days</option><option value="custom">Custom</option></select>
          <select id="tqFilterStatus" class="filter-select"><option>All Statuses</option><option>Open</option><option>Investigating</option><option>Escalated</option><option>Closed</option></select>
          <select id="tqFilterAnalyst" class="filter-select"><option>All Analysts</option><option>John Lim</option><option>Sarah Tan</option><option>Marcus Wong</option><option>Unassigned</option></select>
          <select class="filter-select"><option>AI Confidence: All</option><option>High (&gt;80%)</option><option>Medium (50â€“80%)</option><option>Low (&lt;50%)</option></select>
          <select class="tq-bulk-select"><option>Bulk Actions</option><option>Assign</option><option>Change Priority</option><option>Close</option></select>
          <input id="tqFilterSearch" class="filter-input" placeholder="Search tickets..." style="margin-left:auto;width:200px;">
        </div>

        <!-- Rich Alert Table -->
        <div class="card" style="border-radius:10px 10px 0 0;margin-bottom:0;">
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th style="width:32px;"><input type="checkbox" class="tq-cb"></th>
                  <th>ID</th>
                  <th>P</th>
                  <th>Title</th>
                  <th>AI Verdict</th>
                  <th>Organization</th>
                  <th>Source</th>
                  <th>Status</th>
                  <th>Analyst</th>
                  <th id="thCreated" style="cursor:pointer;user-select:none;" onclick="toggleTriageSort()">Created <span id="triageSortIcon">â–¼</span></th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>

                <!-- Row 1: DAC-18158 P1 TP 87% -->  
                <tr style="background:rgba(239,68,68,0.04);" onclick="navigate('investigation')" style="cursor:pointer;">
                  <td><input type="checkbox" class="tq-cb"></td>
                  <td><span class="mono" style="color:var(--cyan);font-size:11px;cursor:pointer;">DAC-18158</span></td>
                  <td><span class="badge badge-p1">P1</span></td>
                  <td style="max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:var(--text-primary);font-size:12px;">Potential Ransomware Activity Detected</td>
                  <td><span class="tq-verdict tp">TP <span class="tq-verdict-conf">87%</span></span></td>
                  <td style="font-size:11px;">Dacta Global</td>
                  <td style="font-size:11px;">Jira</td>
                  <td><span class="badge badge-investigating">Investigating</span></td>
                  <td style="font-size:11px;color:var(--cyan);">John Lim</td>
                  <td style="font-family:var(--font-mono);font-size:10px;white-space:nowrap;"><div style="color:var(--text-primary);">01 Mar 07:42</div><div style="color:var(--text-muted);font-size:9px;">9h ago</div></td>
                  <td><div style="display:flex;gap:4px;"><button class="btn btn-xs btn-secondary">Assign</button><button class="btn btn-xs btn-amber">Escalate</button></div></td>
                </tr>

                <!-- Row 2: DAC-18157 P2 TP 74% -->
                <tr onclick="navigate('investigation')" style="cursor:pointer;">
                  <td><input type="checkbox" class="tq-cb"></td>
                  <td><span class="mono" style="color:var(--cyan);font-size:11px;">DAC-18157</span></td>
                  <td><span class="badge badge-p2">P2</span></td>
                  <td style="max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:var(--text-primary);font-size:12px;">Unusual Host Communication with Internal Hosts</td>
                  <td><span class="tq-verdict tp">TP <span class="tq-verdict-conf">74%</span></span></td>
                  <td style="font-size:11px;">Dacta Global</td>
                  <td style="font-size:11px;">Jira</td>
                  <td><span class="badge badge-investigating">Investigating</span></td>
                  <td style="font-size:11px;color:var(--cyan);">John Lim</td>
                  <td style="font-family:var(--font-mono);font-size:10px;white-space:nowrap;"><div style="color:var(--text-primary);">01 Mar 07:19</div><div style="color:var(--text-muted);font-size:9px;">9h ago</div></td>
                  <td><div style="display:flex;gap:4px;"><button class="btn btn-xs btn-secondary">Assign</button><button class="btn btn-xs btn-amber">Escalate</button></div></td>
                </tr>

                <!-- Row 3: DAC-18156 P3 FP 92% -->
                <tr>
                  <td><input type="checkbox" class="tq-cb"></td>
                  <td><span class="mono" style="color:var(--cyan);font-size:11px;">DAC-18156</span></td>
                  <td><span class="badge badge-p3">P3</span></td>
                  <td style="max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:var(--text-primary);font-size:12px;">Failed Login Attempts â€” Brute Force Pattern</td>
                  <td><span class="tq-verdict fp">FP <span class="tq-verdict-conf">92%</span></span></td>
                  <td style="font-size:11px;">SPMT</td>
                  <td style="font-size:11px;">Jira</td>
                  <td><span class="badge badge-blue">AI Pre-Triaged</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">â€”</td>
                  <td style="font-family:var(--font-mono);font-size:10px;white-space:nowrap;"><div style="color:var(--text-primary);">01 Mar 06:38</div><div style="color:var(--text-muted);font-size:9px;">10h ago</div></td>
                  <td><div style="display:flex;gap:4px;"><button class="btn btn-xs btn-secondary">Assign</button><button class="btn btn-xs btn-amber">Escalate</button></div></td>
                </tr>

                <!-- Row 4: DAC-18155 P2 BTP 65% -->
                <tr style="background:rgba(239,68,68,0.02);">
                  <td><input type="checkbox" class="tq-cb"></td>
                  <td><span class="mono" style="color:var(--cyan);font-size:11px;">DAC-18155</span></td>
                  <td><span class="badge badge-p2">P2</span></td>
                  <td style="max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:var(--text-primary);font-size:12px;">Application Control â€” Unauthorized Execution Blocked</td>
                  <td><span class="tq-verdict btp">BTP <span class="tq-verdict-conf">65%</span></span></td>
                  <td style="font-size:11px;">Naga World</td>
                  <td style="font-size:11px;">Jira</td>
                  <td><span class="badge badge-open">Open</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">Unassigned</td>
                  <td style="font-family:var(--font-mono);font-size:10px;white-space:nowrap;"><div style="color:var(--text-primary);">01 Mar 05:45</div><div style="color:var(--text-muted);font-size:9px;">11h ago</div></td>
                  <td><div style="display:flex;gap:4px;"><button class="btn btn-xs btn-primary">Assign</button><button class="btn btn-xs btn-amber">Escalate</button></div></td>
                </tr>

                <!-- Row 5: DAC-18154 P3 TP 81% -->
                <tr>
                  <td><input type="checkbox" class="tq-cb"></td>
                  <td><span class="mono" style="color:var(--cyan);font-size:11px;">DAC-18154</span></td>
                  <td><span class="badge badge-p3">P3</span></td>
                  <td style="max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:var(--text-primary);font-size:12px;">Suspicious Email Attachment â€” Macro Detected</td>
                  <td><span class="tq-verdict tp">TP <span class="tq-verdict-conf">81%</span></span></td>
                  <td style="font-size:11px;">ADV Partners</td>
                  <td style="font-size:11px;">Jira</td>
                  <td><span class="badge badge-blue">AI Pre-Triaged</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">â€”</td>
                  <td style="font-family:var(--font-mono);font-size:10px;white-space:nowrap;"><div style="color:var(--text-primary);">01 Mar 04:16</div><div style="color:var(--text-muted);font-size:9px;">12h ago</div></td>
                  <td><div style="display:flex;gap:4px;"><button class="btn btn-xs btn-secondary">Assign</button><button class="btn btn-xs btn-amber">Escalate</button></div></td>
                </tr>

                <!-- Row 6: DAC-18153 P4 FP 95% Auto-Closed -->
                <tr style="opacity:0.65;">
                  <td><input type="checkbox" class="tq-cb"></td>
                  <td><span class="mono" style="color:var(--cyan);font-size:11px;">DAC-18153</span></td>
                  <td><span class="badge badge-p4">P4</span></td>
                  <td style="max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:var(--text-primary);font-size:12px;">DNS Query to Known Suspicious Domain</td>
                  <td><span class="tq-verdict fp">FP <span class="tq-verdict-conf">95%</span></span></td>
                  <td style="font-size:11px;">Dacta Global</td>
                  <td style="font-size:11px;">Jira</td>
                  <td><span class="badge badge-closed">Auto-Closed</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">System</td>
                  <td style="font-family:var(--font-mono);font-size:10px;white-space:nowrap;"><div style="color:var(--text-primary);">28 Feb 22:10</div><div style="color:var(--text-muted);font-size:9px;">18h ago</div></td>
                  <td><div style="display:flex;gap:4px;"><button class="btn btn-xs btn-secondary">Review</button></div></td>
                </tr>

                <!-- Row 7: DAC-18152 P3 TP 78% Escalated -->
                <tr>
                  <td><input type="checkbox" class="tq-cb"></td>
                  <td><span class="mono" style="color:var(--cyan);font-size:11px;">DAC-18152</span></td>
                  <td><span class="badge badge-p3">P3</span></td>
                  <td style="max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:var(--text-primary);font-size:12px;">Blocked Lateral Movement Attempt â€” SMB Exploit</td>
                  <td><span class="tq-verdict tp">TP <span class="tq-verdict-conf">78%</span></span></td>
                  <td style="font-size:11px;">SPMT</td>
                  <td style="font-size:11px;">Jira</td>
                  <td><span class="badge badge-escalated">Escalated</span></td>
                  <td style="font-size:11px;color:var(--cyan);">Sarah Tan</td>
                  <td style="font-family:var(--font-mono);font-size:10px;white-space:nowrap;"><div style="color:var(--text-primary);">28 Feb 20:05</div><div style="color:var(--text-muted);font-size:9px;">20h ago</div></td>
                  <td><div style="display:flex;gap:4px;"><button class="btn btn-xs btn-secondary">Assign</button><button class="btn btn-xs btn-amber">Escalate</button></div></td>
                </tr>

                <!-- Row 8: DAC-18151 P2 TP 83% Open -->
                <tr style="background:rgba(239,68,68,0.02);">
                  <td><input type="checkbox" class="tq-cb"></td>
                  <td><span class="mono" style="color:var(--cyan);font-size:11px;">DAC-18151</span></td>
                  <td><span class="badge badge-p2">P2</span></td>
                  <td style="max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:var(--text-primary);font-size:12px;">PowerShell Execution via Scheduled Task</td>
                  <td><span class="tq-verdict tp">TP <span class="tq-verdict-conf">83%</span></span></td>
                  <td style="font-size:11px;">Naga World</td>
                  <td style="font-size:11px;">Jira</td>
                  <td><span class="badge badge-open">Open</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">Unassigned</td>
                  <td style="font-family:var(--font-mono);font-size:10px;white-space:nowrap;"><div style="color:var(--text-primary);">28 Feb 18:52</div><div style="color:var(--text-muted);font-size:9px;">21h ago</div></td>
                  <td><div style="display:flex;gap:4px;"><button class="btn btn-xs btn-primary">Assign</button><button class="btn btn-xs btn-amber">Escalate</button></div></td>
                </tr>

              </tbody>
            </table>
          </div>
        </div>

        <!-- Summary Bar -->
        <div class="tq-summary">
          <span>Showing <strong style="color:var(--cyan);">8</strong> of <strong style="color:var(--text-primary);">22</strong> tickets</span>
          <span class="sep">Â·</span>
          <span><strong style="color:var(--amber);">6</strong> open</span>
          <span class="sep">Â·</span>
          <span><strong style="color:var(--green);">10</strong> resolved</span>
          <span class="sep">Â·</span>
          <span><strong style="color:var(--text-muted);">3</strong> auto-closed</span>
          <span class="sep">Â·</span>
          <span><strong style="color:var(--red);">3</strong> escalated</span>
        </div>

      </div><!-- end triage -->


      <!-- =====================================================
           PAGE 3: INVESTIGATION WORKSPACE
           ===================================================== -->
      <div class="page" id="page-investigation">
        <div class="page-header">
          <div>
            <div class="page-title">Investigation Workspace</div>
            <div class="page-subtitle" style="font-family:var(--font-mono);">DAC-18158 Â· Potential Ransomware Activity Detected</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm" onclick="navigate('triage')">&#x2190; Back to Queue</button>
            <button class="btn btn-secondary btn-sm" onclick="sendToCopilot()" style="background:rgba(139,92,246,0.12);border-color:rgba(139,92,246,0.3);color:#a78bfa;">&#x1F680; Send to Copilot</button>
            <button class="btn btn-amber btn-sm" onclick="toggleOverrideMode()">&#x26A0; Override Verdict</button>
            <button class="btn btn-primary btn-sm">&#x2713; Accept AI Verdict</button>
          </div>
        </div>

        <div class="investigation-layout">
          <!-- Left panel -->
          <div class="inv-sidebar">
            <div class="card">
              <div class="card-header"><span class="card-title">Ticket Details</span></div>
              <div style="display:flex;flex-direction:column;gap:8px;">
                <div style="display:flex;justify-content:space-between;align-items:center;">
                  <span class="mono">DAC-18158</span>
                  <span class="badge badge-p1">P1 CRITICAL</span>
                </div>
                <div style="font-size:13px;font-weight:600;color:var(--text-primary);line-height:1.4;">Potential Ransomware Activity Detected</div>
                <div class="divider" style="margin:8px 0;"></div>
                <div style="display:flex;flex-direction:column;gap:6px;font-size:11px;">
                  <div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Organization</span><span style="color:var(--text-primary);font-weight:500;">Dacta Global</span></div>
                  <div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Source</span><span style="color:var(--text-primary);">Jira</span></div>
                  <div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Created</span><span style="color:var(--text-primary);font-family:var(--font-mono);">2026-02-27 13:21</span></div>
                  <div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Assigned</span><span style="color:var(--cyan);">John Lim</span></div>
                  <div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Status</span><span class="badge badge-investigating" style="font-size:10px;">INVESTIGATING</span></div>
                  <div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">SLA</span><span style="color:var(--red-bright);font-weight:700;font-family:var(--font-mono);">02:18 remaining</span></div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header"><span class="card-title">Raw Alert</span></div>
              <div style="background:var(--bg-base);border:1px solid var(--border-subtle);border-radius:6px;padding:10px;font-family:var(--font-mono);font-size:10px;color:var(--text-secondary);max-height:200px;overflow-y:auto;line-height:1.7;">
                <span style="color:var(--cyan);">rule_name:</span> "Potential.Ransomware.File.Rename"<br>
                <span style="color:var(--cyan);">host:</span> "<span class="entity-ref" onclick="openEntityPanel('host','DACTASG-WS-047')">DACTASG-WS-047</span>"<br>
                <span style="color:var(--cyan);">user:</span> "john.santos@dactaglobal.com"<br>
                <span style="color:var(--cyan);">process:</span> "svchost.exe"<br>
                <span style="color:var(--cyan);">parent_process:</span> "powershell.exe"<br>
                <span style="color:var(--cyan);">file_count:</span> 847<br>
                <span style="color:var(--cyan);">extension_changed:</span> [".docxâ†’.enc", ".xlsxâ†’.enc"]<br>
                <span style="color:var(--cyan);">risk_score:</span> 92<br>
                <span style="color:var(--cyan);">severity:</span> "critical"<br>
                <span style="color:var(--cyan);">timestamp:</span> "2026-02-27T13:21:44Z"
              </div>
            </div>

            <div class="card">
              <div class="card-header"><span class="card-title">Timeline</span></div>
              <div style="display:flex;flex-direction:column;gap:0;">
                <div style="display:flex;gap:10px;padding-bottom:10px;border-left:2px solid var(--border-subtle);margin-left:7px;padding-left:14px;position:relative;">
                  <div style="width:8px;height:8px;border-radius:50%;background:var(--red);position:absolute;left:-5px;top:3px;box-shadow:0 0 6px var(--red);"></div>
                  <div><div style="font-size:11px;color:var(--text-primary);font-weight:600;">Alert triggered</div><div style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">13:21:44 â€” 847 files renamed</div></div>
                </div>
                <div style="display:flex;gap:10px;padding-bottom:10px;border-left:2px solid var(--border-subtle);margin-left:7px;padding-left:14px;position:relative;">
                  <div style="width:8px;height:8px;border-radius:50%;background:var(--amber);position:absolute;left:-5px;top:3px;"></div>
                  <div><div style="font-size:11px;color:var(--text-primary);font-weight:600;">AI analysis started</div><div style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">13:21:51 â€” 7s after trigger</div></div>
                </div>
                <div style="display:flex;gap:10px;padding-bottom:10px;border-left:2px solid var(--border-subtle);margin-left:7px;padding-left:14px;position:relative;">
                  <div style="width:8px;height:8px;border-radius:50%;background:var(--cyan);position:absolute;left:-5px;top:3px;"></div>
                  <div><div style="font-size:11px;color:var(--text-primary);font-weight:600;">Correlated with DAC-18157</div><div style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">13:22:03 â€” Lateral movement</div></div>
                </div>
                <div style="display:flex;gap:10px;margin-left:7px;padding-left:14px;position:relative;">
                  <div style="width:8px;height:8px;border-radius:50%;background:var(--green);position:absolute;left:-5px;top:3px;"></div>
                  <div><div style="font-size:11px;color:var(--text-primary);font-weight:600;">Assigned to John Lim</div><div style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">13:22:15 â€” P1 escalated</div></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Main investigation content -->
          <div class="inv-main">
            <!-- ===== ATTACK PATH DIAGRAM (Task 1) ===== -->
            <div class="attack-path-section">
              <div class="attack-path-header">
                <div>
                  <div class="attack-path-title">âš” Attack Path â€” DAC-18158</div>
                  <div class="attack-path-subtitle">MITRE ATT&amp;CK Â· 6 stages identified Â· Stage 4 active on DACTASG-WS-047</div>
                </div>
                <div style="display:flex;gap:8px;align-items:center;">
                  <span class="badge badge-red" style="animation:pulse-red 2s ease-in-out infinite;">ACTIVE THREAT</span>
                  <span class="badge badge-amber">Stage 4 of 6</span>
                </div>
              </div>

              <div class="attack-path-flow">

                <!-- Node 1: Initial Access -->
                <div class="ap-node ap-green">
                  <div class="ap-node-icon">ðŸ“§</div>
                  <div class="ap-node-tactic">Initial Access</div>
                  <div class="ap-node-technique">Spear-<br>Phishing</div>
                  <div class="ap-node-mitre">T1566.001</div>
                </div>

                <div class="ap-connector"><div class="ap-connector-line"></div></div>

                <!-- Node 2: Execution -->
                <div class="ap-node ap-teal">
                  <div class="ap-node-icon">âš¡</div>
                  <div class="ap-node-tactic">Execution</div>
                  <div class="ap-node-technique">PowerShell<br>Script</div>
                  <div class="ap-node-mitre">T1059.001</div>
                </div>

                <div class="ap-connector"><div class="ap-connector-line"></div></div>

                <!-- Node 3: Persistence -->
                <div class="ap-node ap-teal">
                  <div class="ap-node-icon">ðŸ”‘</div>
                  <div class="ap-node-tactic">Persistence</div>
                  <div class="ap-node-technique">Registry<br>Run Key</div>
                  <div class="ap-node-mitre">T1547.001</div>
                </div>

                <div class="ap-connector"><div class="ap-connector-line"></div></div>

                <!-- Node 4: Privilege Escalation â€” CURRENT HOST -->
                <div class="ap-node ap-amber ap-current">
                  <div class="ap-node-badge current">â— YOU ARE HERE</div>
                  <div class="ap-node-icon">ðŸ›¡ï¸</div>
                  <div class="ap-node-tactic">Priv. Escalation</div>
                  <div class="ap-node-technique">UAC<br>Bypass</div>
                  <div class="ap-node-mitre">T1548.002</div>
                </div>

                <div class="ap-connector"><div class="ap-connector-line"></div></div>

                <!-- Node 5: Lateral Movement -->
                <div class="ap-node ap-orange">
                  <div class="ap-node-icon">ðŸŒ</div>
                  <div class="ap-node-tactic">Lateral Move</div>
                  <div class="ap-node-technique">PsExec<br>ADMIN$</div>
                  <div class="ap-node-mitre">T1021.002</div>
                </div>

                <div class="ap-connector"><div class="ap-connector-line"></div></div>

                <!-- Node 6: Impact -->
                <div class="ap-node ap-red">
                  <div class="ap-node-icon">ðŸ’€</div>
                  <div class="ap-node-tactic">Impact</div>
                  <div class="ap-node-technique">Ransomware<br>Deployment</div>
                  <div class="ap-node-mitre">T1486</div>
                </div>

              </div><!-- end attack-path-flow -->

              <!-- Legend + Progress -->
              <div class="attack-path-legend">
                <div class="ap-legend-item"><div class="ap-legend-dot" style="background:#10b981;"></div>Safe / Contained</div>
                <div class="ap-legend-item"><div class="ap-legend-dot" style="background:#f59e0b;"></div>Active Stage</div>
                <div class="ap-legend-item"><div class="ap-legend-dot" style="background:#ef4444;"></div>High Impact</div>
                <div class="ap-legend-item" style="margin-left:8px;">ðŸ”— Related: <span class="mono" style="color:var(--cyan);font-size:10px;">DAC-18138 â†’ DAC-18157 â†’ DAC-18158</span></div>
                <div style="flex:1;"></div>
                <div style="display:flex;align-items:center;gap:8px;">
                  <span style="font-size:10px;color:var(--text-muted);">Attack progress</span>
                  <div class="ap-progress-bar"><div class="ap-progress-fill"></div></div>
                  <span style="font-size:10px;color:var(--amber);font-weight:700;">4/6 stages</span>
                </div>
              </div>
            </div><!-- end attack-path-section -->

            <!-- Correlated Alerts (compact) -->
            <div class="card">
              <div class="card-header"><span class="card-title">Correlated Alerts â€” Ticket Chain</span><span class="badge badge-red">3 tickets</span></div>
              <div class="attack-chain">
                <div class="chain-link" style="border-color:rgba(245,158,11,0.3);">
                  <div class="mono" style="font-size:10px;">DAC-18138</div>
                  <div style="font-size:11px;font-weight:600;color:var(--text-primary);margin:3px 0;">Mailbox Permission Delegation</div>
                  <div style="display:flex;gap:4px;"><span class="mitre-tag">T1098.002</span></div>
                  <div style="font-size:10px;color:var(--text-muted);margin-top:4px;">Persistence Â· 10h ago</div>
                </div>
                <div class="chain-arrow">â†’</div>
                <div class="chain-link" style="border-color:rgba(249,115,22,0.3);">
                  <div class="mono" style="font-size:10px;">DAC-18157</div>
                  <div style="font-size:11px;font-weight:600;color:var(--text-primary);margin:3px 0;">Unusual Host Communication</div>
                  <div style="display:flex;gap:4px;"><span class="mitre-tag">T1021.002</span></div>
                  <div style="font-size:10px;color:var(--text-muted);margin-top:4px;">Lateral Movement Â· 9h ago</div>
                </div>
                <div class="chain-arrow">â†’</div>
                <div class="chain-link" style="border-color:rgba(239,68,68,0.3);background:rgba(239,68,68,0.04);">
                  <div class="mono" style="font-size:10px;">DAC-18158 â† YOU ARE HERE</div>
                  <div style="font-size:11px;font-weight:600;color:#ff6b6b;margin:3px 0;">Ransomware Activity</div>
                  <div style="display:flex;gap:4px;"><span class="mitre-tag">T1486</span><span class="mitre-tag">T1059.001</span></div>
                  <div style="font-size:10px;color:var(--text-muted);margin-top:4px;">Impact Â· NOW</div>
                </div>
              </div>
            </div>

            <!-- ===== OVERRIDE MODE BAR (Task 4) ===== -->
            <div class="override-mode-bar" id="overrideModeBar">
              <span style="font-size:16px;">&#x270F;&#xFE0F;</span>
              <span class="override-mode-text" id="overrideModeText">Override Mode Active â€” 0 of 5 sections overridden</span>
              <button class="btn btn-amber btn-sm" onclick="confirmOverride()" style="padding:4px 12px;">Confirm Overrides</button>
              <button class="btn btn-secondary btn-sm" onclick="toggleOverrideMode()" style="padding:4px 12px;">Cancel</button>
            </div>

            <!-- Verdict -->
            <div class="override-section-wrap">
              <div class="override-section-toolbar" id="toolbar-verdict">
                <span style="font-size:10px;font-weight:600;color:var(--text-muted);">VERDICT</span>
                <div style="display:flex;align-items:center;gap:8px;">
                  <span class="override-badge ai" id="badge-verdict">âœ¨ AI-Generated</span>
                  <div class="override-toggle-seg">
                    <button class="override-toggle-btn active" id="keepVerdict" onclick="keepSection('verdict')">Keep AI</button>
                    <button class="override-toggle-btn" id="overrideVerdict" onclick="overrideSection('verdict')">Override</button>
                  </div>
                </div>
              </div>
            <div class="verdict-banner" id="section-verdict">
              <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
                <div>
                  <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.1em;color:rgba(255,107,107,0.7);margin-bottom:4px;">AI Investigation Brief Â· Claude 3.5 Sonnet</div>
                  <div class="verdict-title">âš  TRUE POSITIVE â€” Likely Ransomware + Lateral Movement</div>
                  <div class="confidence-pill">87% CONFIDENCE</div>
                </div>
                <div style="margin-left:auto;display:flex;gap:8px;">
                  <span class="mitre-tag">T1486</span>
                  <span class="mitre-tag">T1021</span>
                  <span class="mitre-tag">T1059.001</span>
                </div>
              </div>
            </div>
            </div><!-- end verdict override-section-wrap -->

            <!-- Privacy Shield Banner -->
            <div class="inv-pipeline-shield">
              <span class="inv-pipeline-shield-dot"></span>
              <span class="inv-pipeline-shield-text">
                ðŸ” Privacy Shield: <strong style="color:var(--green);">ACTIVE</strong>
                <span class="inv-pipeline-shield-sep">Â·</span>
                847 tokens generated
                <span class="inv-pipeline-shield-sep">Â·</span>
                Îµ = 2.0
                <span class="inv-pipeline-shield-sep">Â·</span>
                Tenant: NS_DACT_*
                <span class="inv-pipeline-shield-sep">Â·</span>
                <strong style="color:var(--green);">0 PII exposed to LLMs</strong>
              </span>
            </div>

            <!-- AI Pipeline Execution Panel -->
            <div class="inv-pipeline-panel">
              <div class="inv-pipeline-header">
                <span class="inv-pipeline-title">AI Investigation Pipeline â€” 3-Round Cross-Check</span>
                <span class="inv-pipeline-badge">DAC-18158</span>
              </div>

              <!-- Pipeline flow -->
              <div class="inv-pipeline-flow">

                <!-- Stage 1: Tokenize -->
                <div class="inv-pipeline-stage stage-tokenize">
                  <div class="inv-pipeline-stage-icon">ðŸ”</div>
                  <div class="inv-pipeline-stage-name">Tokenize</div>
                  <div class="inv-pipeline-stage-sub">847 PII tokens generated</div>
                  <div class="inv-pipeline-stage-metric">23ms Â· Vault: NS_DACT_*</div>
                  <div class="inv-pipeline-stage-status">âœ“ Complete</div>
                </div>

                <div class="inv-pipeline-arrow">â†’</div>

                <!-- Stage 2: Round 1 â€” Claude Opus -->
                <div class="inv-pipeline-stage stage-round1">
                  <div class="inv-pipeline-stage-icon">ðŸ¤–</div>
                  <div class="inv-pipeline-stage-name">Round 1 â€” Claude Opus</div>
                  <div class="inv-pipeline-stage-sub">Primary Investigation</div>
                  <div class="inv-pipeline-stage-sub" style="color:var(--text-primary);font-weight:600;">Verdict: TRUE POSITIVE</div>
                  <div class="inv-pipeline-stage-metric">Confidence: 91% Â· 4.2s</div>
                  <div class="inv-pipeline-stage-status">âœ“ Complete</div>
                </div>

                <div class="inv-pipeline-arrow">â†’</div>

                <!-- Stage 3: Round 2 â€” GPT 5.2 -->
                <div class="inv-pipeline-stage stage-round2">
                  <div class="inv-pipeline-stage-icon">ðŸ§ </div>
                  <div class="inv-pipeline-stage-name">Round 2 â€” GPT 5.2</div>
                  <div class="inv-pipeline-stage-sub">Cross-Validation</div>
                  <div class="inv-pipeline-stage-sub" style="color:var(--purple);font-weight:600;">Agrees: TRUE POSITIVE</div>
                  <div class="inv-pipeline-stage-metric">Found 1 additional IOC Â· 3.1s</div>
                  <div class="inv-pipeline-stage-status">âœ“ Complete</div>
                </div>

                <div class="inv-pipeline-arrow">â†’</div>

                <!-- Stage 4: Round 3 â€” Gemini 3.1 Pro -->
                <div class="inv-pipeline-stage stage-round3">
                  <div class="inv-pipeline-stage-icon">âœ¨</div>
                  <div class="inv-pipeline-stage-name">Round 3 â€” Gemini 3.1 Pro</div>
                  <div class="inv-pipeline-stage-sub">Final Synthesis</div>
                  <div class="inv-pipeline-stage-sub" style="color:var(--amber);font-weight:600;">Consensus: TRUE POSITIVE</div>
                  <div class="inv-pipeline-stage-metric">Final confidence: 87% Â· 2.8s</div>
                  <div class="inv-pipeline-stage-status">âœ“ Complete</div>
                </div>

                <div class="inv-pipeline-arrow">â†’</div>

                <!-- Stage 5: Detokenize -->
                <div class="inv-pipeline-stage stage-detokenize">
                  <div class="inv-pipeline-stage-icon">ðŸ”“</div>
                  <div class="inv-pipeline-stage-name">Detokenize</div>
                  <div class="inv-pipeline-stage-sub">Re-identified for analyst</div>
                  <div class="inv-pipeline-stage-sub">RBAC: John Lim âœ“</div>
                  <div class="inv-pipeline-stage-metric">19ms Â· Audit logged</div>
                  <div class="inv-pipeline-stage-status">âœ“ Complete</div>
                </div>

              </div><!-- end inv-pipeline-flow -->

              <!-- Summary bar -->
              <div class="inv-pipeline-summary">
                <span>Total pipeline time: <span class="inv-pipeline-summary-highlight">10.3s</span></span>
                <span class="inv-pipeline-summary-sep">Â·</span>
                <span><span class="inv-pipeline-summary-highlight">3/3</span> models agree</span>
                <span class="inv-pipeline-summary-sep">Â·</span>
                <span>Consensus: <span class="inv-pipeline-summary-consensus">TRUE POSITIVE</span></span>
                <span class="inv-pipeline-summary-sep">Â·</span>
                <span>Privacy budget consumed: <span class="inv-pipeline-summary-highlight">Îµ = 0.47</span> of 2.0</span>
              </div>

            </div><!-- end inv-pipeline-panel -->

            <!-- Reasoning chain -->
            <div class="card">
              <div class="card-header"><span class="card-title">Reasoning Chain</span><span class="badge badge-blue">5 indicators</span></div>
              <div>
                <div class="reasoning-item">
                  <div class="reasoning-num">1</div>
                  <div style="font-size:12px;color:var(--text-secondary);line-height:1.5;"><strong style="color:var(--text-primary);">Mass file rename event</strong> â€” 847 files renamed from .docx/.xlsx to .enc extension within 43 seconds on host <span class="entity-ref" onclick="openEntityPanel('host','DACTASG-WS-047')">DACTASG-WS-047</span>. This rate (19.7 files/sec) is consistent with automated ransomware encryption behavior.</div>
                </div>
                <div class="reasoning-item">
                  <div class="reasoning-num">2</div>
                  <div style="font-size:12px;color:var(--text-secondary);line-height:1.5;"><strong style="color:var(--text-primary);">Suspicious parent process chain</strong> â€” svchost.exe spawned by powershell.exe (PID 4821) is anomalous. Legitimate svchost is spawned exclusively by services.exe. This indicates process injection or masquerading.</div>
                </div>
                <div class="reasoning-item">
                  <div class="reasoning-num">3</div>
                  <div style="font-size:12px;color:var(--text-secondary);line-height:1.5;"><strong style="color:var(--text-primary);">Correlated lateral movement</strong> â€” DAC-18157 (Unusual Host Communication) fired 12 minutes prior on the same user account accessing ADMIN$ shares on 4 additional hosts. Indicative of pre-ransomware staging.</div>
                </div>
                <div class="reasoning-item">
                  <div class="reasoning-num">4</div>
                  <div style="font-size:12px;color:var(--text-secondary);line-height:1.5;"><strong style="color:var(--text-primary);">IOC match</strong> â€” SHA256 hash of powershell payload (a3f4b8c2...) matches known LockBit 3.0 dropper variant in VirusTotal with 43/68 vendor detections. MISP feed confirmation pending.</div>
                </div>
                <div class="reasoning-item" style="border-bottom:none;">
                  <div class="reasoning-num">5</div>
                  <div style="font-size:12px;color:var(--text-secondary);line-height:1.5;"><strong style="color:var(--text-primary);">High-value target context</strong> â€” john.santos has Domain Admin privileges. The affected host contains Finance shared drives. Blast radius assessment: 12 additional hosts accessible via current credentials.</div>
                </div>
              </div>
            </div>

            <!-- Counter-evidence -->
            <div class="card">
              <div class="card-header"><span class="card-title">Counter-Evidence Considered</span><span class="badge badge-amber">3 factors</span></div>
              <div class="counter-item"><span class="counter-icon">âš </span><span>No network beacon/C2 communication detected to external IPs â€” could indicate offline encryption mode or blocked egress</span></div>
              <div class="counter-item"><span class="counter-icon">âš </span><span>User john.santos had IT maintenance scheduled for 13:00â€“14:00 SGT (per calendar), potentially legitimate bulk operations</span></div>
              <div class="counter-item" style="padding-bottom:0;border:none;"><span class="counter-icon">âš </span><span>Endpoint agent returned status "Active" (not isolated) â€” if true ransomware, shadow copy deletion expected but not yet observed</span></div>
            </div>

            <!-- Enrichment -->
            <div class="grid-2">
              <div class="card">
                <div class="card-header"><span class="card-title">Enrichment Summary</span></div>
                <div style="display:flex;flex-direction:column;gap:7px;font-size:11px;">
                  <div style="padding:8px;background:var(--bg-base);border-radius:6px;border:1px solid var(--border-subtle);">
                    <div style="color:var(--text-muted);margin-bottom:3px;">Affected Host</div>
                    <div style="color:var(--text-primary);font-weight:600;"><span class="entity-ref" onclick="openEntityPanel('host','DACTASG-WS-047')">DACTASG-WS-047</span></div>
                    <div style="color:var(--text-muted);">Windows 11 Pro Â· <span class="entity-ref" onclick="openEntityPanel('ip','10.0.4.47')">10.0.4.47</span> Â· Finance Dept</div>
                    <div style="display:flex;gap:4px;margin-top:4px;"><span class="badge badge-red" style="font-size:9px;">Risk: 94</span><span class="badge badge-amber" style="font-size:9px;">EDR: Degraded</span></div>
                  </div>
                  <div style="padding:8px;background:var(--bg-base);border-radius:6px;border:1px solid var(--border-subtle);">
                    <div style="color:var(--text-muted);margin-bottom:3px;">IOCs Found</div>
                    <div style="font-family:var(--font-mono);font-size:10px;color:var(--amber);">SHA256: a3f4b8c2d9e1f0a7...</div>
                    <div style="font-family:var(--font-mono);font-size:10px;color:var(--amber);">File: %TEMP%\svcupdate.ps1</div>
                    <div style="font-family:var(--font-mono);font-size:10px;color:var(--amber);">Registry: HKCU\Software\CryptoLock</div>
                  </div>
                  <div style="padding:8px;background:var(--bg-base);border-radius:6px;border:1px solid var(--border-subtle);">
                    <div style="color:var(--text-muted);margin-bottom:3px;">GeoIP / Network</div>
                    <div style="font-family:var(--font-mono);font-size:10px;color:var(--text-primary);">Last external contact: None detected</div>
                    <div style="font-family:var(--font-mono);font-size:10px;color:var(--text-secondary);">Subnet: 10.0.4.0/24 (Finance VLAN)</div>
                  </div>
                </div>
              </div>

              <!-- Recommended Actions -->
              <div class="card">
                <div class="card-header"><span class="card-title">Recommended Actions</span><span style="font-size:10px;color:var(--text-muted);">Click to mark done</span></div>
                <div id="actionItems">
                  <div class="action-checkbox" onclick="this.classList.toggle('checked')">
                    <div class="action-check"></div>
                    <div style="flex:1;"><div style="font-size:12px;font-weight:600;color:var(--red-bright);">&#x1F534; ISOLATE host <span class="entity-ref" onclick="event.stopPropagation();openEntityPanel('host','DACTASG-WS-047')">DACTASG-WS-047</span> immediately</div><div style="font-size:10px;color:var(--text-muted);">Via Elastic endpoint agent Â· HIGH PRIORITY</div></div>
                    <span class="badge badge-green" style="font-size:9px;margin-right:6px;">RC Ready</span>
                    <span class="exec-in-rc-link" onclick="event.stopPropagation();navigate('response');">Execute in Response Center â†’</span>
                  </div>
                  <div class="action-checkbox" onclick="this.classList.toggle('checked')">
                    <div class="action-check"></div>
                    <div style="flex:1;"><div style="font-size:12px;font-weight:600;color:var(--text-primary);">Disable AD account: john.santos</div><div style="font-size:10px;color:var(--text-muted);">Domain Admin â€” prevent further lateral movement</div></div>
                    <span class="badge badge-green" style="font-size:9px;margin-right:6px;">RC Ready</span>
                    <span class="exec-in-rc-link" onclick="event.stopPropagation();navigate('response');">Execute in Response Center â†’</span>
                  </div>
                  <div class="action-checkbox" onclick="this.classList.toggle('checked')">
                    <div class="action-check"></div>
                    <div style="flex:1;"><div style="font-size:12px;font-weight:600;color:var(--text-primary);">Block hash: a3f4b8c2d9e1f0a7</div><div style="font-size:10px;color:var(--text-muted);">Push IOC to EDR + Block List</div></div>
                    <span class="badge badge-green" style="font-size:9px;margin-right:6px;">RC Ready</span>
                    <span class="exec-in-rc-link" onclick="event.stopPropagation();navigate('response');">Execute in Response Center â†’</span>
                  </div>
                  <div class="action-checkbox action-manual" style="opacity:0.6;cursor:default;">
                    <div class="action-check" style="border-color:rgba(255,255,255,0.08);background:rgba(255,255,255,0.02);"></div>
                    <div style="flex:1;"><div style="font-size:12px;font-weight:600;color:var(--text-secondary);">Snapshot Finance drive shares</div><div style="font-size:10px;color:var(--text-muted);">Preserve evidence before further encryption</div></div>
                    <span class="badge" style="font-size:9px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:var(--text-muted);">Manual</span>
                  </div>
                  <div class="action-checkbox action-manual" style="opacity:0.6;cursor:default;">
                    <div class="action-check" style="border-color:rgba(255,255,255,0.08);background:rgba(255,255,255,0.02);"></div>
                    <div style="flex:1;"><div style="font-size:12px;font-weight:600;color:var(--text-secondary);">Escalate to client â€” Dacta Global CISO</div><div style="font-size:10px;color:var(--text-muted);">P1 SLA requires notification within 6 minutes</div></div>
                    <span class="badge" style="font-size:9px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:var(--text-muted);">Manual</span>
                  </div>
                </div>
                <!-- Task 5: Route to Response Center button -->
                <button class="route-response-btn" onclick="showRouteConfirm()">
                  &#x2713;&nbsp; Approve &amp; Route 3 Actions to Response Center
                </button>
              </div>
            </div>

            <!-- ===== ESCALATION DRAFT (Task 2) ===== -->
            <div class="card" style="border-color:rgba(0,212,255,0.2);">
              <div class="card-header">
                <span class="card-title">Client Escalation Draft</span>
                <div style="display:flex;align-items:center;gap:8px;">
                  <span class="badge badge-cyan">AI Generated</span>
                  <span style="display:inline-flex;align-items:center;gap:4px;padding:2px 8px;background:rgba(16,185,129,0.12);border:1px solid rgba(16,185,129,0.3);border-radius:4px;font-size:9px;font-weight:700;color:#10b981;">&#x2714; DRAFT READY</span>
                </div>
              </div>

              <!-- Email meta -->
              <div style="display:flex;flex-direction:column;gap:6px;margin-bottom:12px;padding:10px;background:rgba(0,212,255,0.03);border:1px solid rgba(0,212,255,0.1);border-radius:8px;font-size:11px;">
                <div style="display:flex;gap:6px;align-items:flex-start;">
                  <span style="color:var(--text-muted);width:44px;flex-shrink:0;">To:</span>
                  <span style="color:var(--text-primary);font-family:var(--font-mono);">d.sok@nagaworld.com</span>
                  <span style="color:var(--text-muted);font-size:10px;margin-left:4px;">(CISO)</span>
                </div>
                <div style="display:flex;gap:6px;align-items:flex-start;">
                  <span style="color:var(--text-muted);width:44px;flex-shrink:0;">CC:</span>
                  <span style="color:var(--text-secondary);font-family:var(--font-mono);">it-security@nagaworld.com, soc-lead@dacta.global</span>
                </div>
                <div style="display:flex;gap:6px;align-items:flex-start;">
                  <span style="color:var(--text-muted);width:44px;flex-shrink:0;">Subj:</span>
                  <span style="color:var(--amber);font-weight:600;">[P1] Potential Ransomware Activity â€” DAC-18158</span>
                </div>
              </div>

              <!-- Preview -->
              <div id="escDraftBody" contenteditable="true" style="background:var(--bg-base);border:1px solid var(--border-subtle);border-radius:7px;padding:14px;font-size:12px;line-height:1.7;color:var(--text-secondary);max-height:320px;min-height:180px;overflow-y:auto;position:relative;cursor:text;outline:none;" onfocus="this.style.borderColor='rgba(0,212,255,0.3)'" onblur="this.style.borderColor='var(--border-subtle)'">
                <strong style="color:var(--text-primary);">Dear D. Sok and NagaWorld Security Team,</strong><br><br>
                Dacta SG SOC has detected a critical security incident on your environment requiring immediate attention. Ransomware-like encryption activity has been observed on host DACTASG-WS-047 (Finance Dept). 847 files renamed .enc.<br><br>
                <strong style="color:var(--text-primary);">Summary of Findings:</strong><br>
                â€¢ Automated file encryption detected at 13:21:44 SGT (19.7 files/sec)<br>
                â€¢ Extensions changed: .docxâ†’.enc, .xlsxâ†’.enc, .pdfâ†’.enc<br>
                â€¢ Process chain: powershell.exe â†’ svchost.exe (PID 4821 â†’ 7842)<br>
                â€¢ Lateral movement to 4 additional hosts via ADMIN$ shares<br>
                â€¢ User account: john.santos (Domain Admin privileges)<br><br>
                <strong style="color:var(--text-primary);">Immediate Actions Taken:</strong><br>
                â€¢ Alert correlated with DAC-18157 (Unusual Host Communication)<br>
                â€¢ Assigned P1 priority â€” SLA timer active<br>
                â€¢ AI investigation pipeline returned TRUE POSITIVE (87% confidence, 3/3 models agree)<br>
                â€¢ Host isolation pending your authorisation<br><br>
                <strong style="color:var(--text-primary);">Recommended Client Actions:</strong><br>
                â€¢ Authorise immediate isolation of DACTASG-WS-047<br>
                â€¢ Notify Finance department of potential data impact<br>
                â€¢ Engage legal/compliance if data exfiltration confirmed<br><br>
                We will continue to provide updates as investigation progresses. Please respond to confirm receipt and isolation authorisation.<br><br>
                <em>Regards,</em><br>
                <strong style="color:var(--cyan);">Dacta SG SOC Team</strong><br>
                <span style="font-size:10px;color:var(--text-muted);">soc-lead@dacta.global Â· +65 6XXX XXXX</span>
              </div>
              <div style="display:flex;align-items:center;gap:4px;margin-top:6px;">
                <span style="font-size:9px;color:var(--text-muted);">&#x270F; Click body above to edit directly</span>
              </div>

              <div style="display:flex;gap:8px;margin-top:10px;">
                <button class="btn btn-primary btn-sm" onclick="showEscModal()">&#x270F; Edit Draft</button>
                <button class="btn btn-success btn-sm" onclick="showEscModal()">&#x1F4E4; Send Escalation</button>
                <button class="btn btn-secondary btn-sm" style="margin-left:auto;">&#x1F4CE; Attach Artifacts</button>
              </div>
            </div>

            <!-- Analyst actions -->
            <div style="display:flex;gap:10px;padding:16px;background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:10px;align-items:center;flex-wrap:wrap;">
              <span style="font-size:12px;color:var(--text-muted);margin-right:8px;">Analyst Verdict:</span>
              <button class="btn btn-success" onclick="showToast('Verdict accepted â€” ticket closing...')">&#x2713; Accept AI Verdict</button>
              <button class="btn btn-amber" onclick="toggleOverrideMode()">&#x26A0; Override Verdict</button>
              <button class="btn btn-secondary">&#x21BA; Request Re-analysis</button>
              <button class="btn btn-secondary" style="margin-left:auto;">Add Comment</button>
              <button class="btn btn-secondary" onclick="sendToCopilot()" style="background:rgba(139,92,246,0.12);border-color:rgba(139,92,246,0.3);color:#a78bfa;">&#x1F680; Send to Copilot</button>
            </div>

          </div>
        </div>
      </div><!-- end investigation -->


      <!-- =====================================================
           PAGE 4: RESPONSE CENTER
           ===================================================== -->
      <div class="page" id="page-response">
        <div class="page-header">
          <div>
            <div class="page-title">Response Center</div>
            <div class="page-subtitle">Active containment actions and automation management</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm">ðŸ“‹ Playbooks</button>
            <button class="btn btn-primary btn-sm">+ New Response</button>
          </div>
        </div>

        <!-- Active responses -->
        <div class="card" style="margin-bottom:16px;border-color:rgba(239,68,68,0.2);">
          <div class="card-header"><span class="card-title">Active Responses</span><div class="status-dot red" style="animation:pulse-red 1.5s ease-in-out infinite;"></div></div>
          <div style="display:flex;flex-direction:column;gap:8px;">
            <div style="padding:12px;background:rgba(239,68,68,0.05);border:1px solid rgba(239,68,68,0.2);border-radius:8px;display:flex;align-items:center;gap:12px;">
              <div class="status-dot red"></div>
              <div style="flex:1;">
                <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Host Isolation â€” <span class="entity-ref" onclick="openEntityPanel('host','DACTASG-WS-047')">DACTASG-WS-047</span></div>
                <div style="font-size:11px;color:var(--text-muted);">Elastic Endpoint Agent Â· DAC-18158 Â· Initiated by: John Lim</div>
              </div>
              <span class="badge badge-red" style="animation:none;">IN PROGRESS</span>
              <button class="btn btn-sm btn-secondary">View</button>
            </div>
            <div style="padding:12px;background:rgba(245,158,11,0.05);border:1px solid rgba(245,158,11,0.2);border-radius:8px;display:flex;align-items:center;gap:12px;">
              <div class="status-dot amber"></div>
              <div style="flex:1;">
                <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Account Disable â€” john.santos@dactaglobal.com</div>
                <div style="font-size:11px;color:var(--text-muted);">Azure AD Â· DAC-18158 Â· Awaiting approval</div>
              </div>
              <span class="badge badge-amber">PENDING APPROVAL</span>
              <button class="btn btn-sm btn-primary">Approve</button>
            </div>
          </div>
        </div>

        <!-- Quick Actions + Stats -->
        <div class="grid-2" style="margin-bottom:16px;">
          <div class="card">
            <div class="card-header"><span class="card-title">Quick Response Actions</span></div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
              <button class="btn btn-danger" style="justify-content:flex-start;gap:10px;padding:12px;border-radius:8px;"><span>ðŸ”’</span><span>Isolate Host</span></button>
              <button class="btn btn-danger" style="justify-content:flex-start;gap:10px;padding:12px;border-radius:8px;"><span>ðŸš«</span><span>Block Hash</span></button>
              <button class="btn btn-amber" style="justify-content:flex-start;gap:10px;padding:12px;border-radius:8px;"><span>ðŸ‘¤</span><span>Disable Account</span></button>
              <button class="btn btn-amber" style="justify-content:flex-start;gap:10px;padding:12px;border-radius:8px;"><span>ðŸŒ</span><span>Block IP/Domain</span></button>
              <button class="btn btn-secondary" style="justify-content:flex-start;gap:10px;padding:12px;border-radius:8px;"><span>ðŸ“¸</span><span>Take Memory Snapshot</span></button>
              <button class="btn btn-secondary" style="justify-content:flex-start;gap:10px;padding:12px;border-radius:8px;"><span>ðŸ“‹</span><span>Run Forensic Script</span></button>
            </div>
          </div>
          <div class="card">
            <div class="card-header"><span class="card-title">Response Stats â€” Today</span></div>
            <div class="metrics-row" style="grid-template-columns:repeat(2,1fr);">
              <div class="metric-card green"><div class="metric-label">Automated</div><div class="metric-value">14</div><div class="metric-sub">actions taken</div></div>
              <div class="metric-card amber"><div class="metric-label">Manual</div><div class="metric-value">3</div><div class="metric-sub">analyst triggered</div></div>
              <div class="metric-card cyan"><div class="metric-label">Avg Duration</div><div class="metric-value">4.2<span style="font-size:14px;">m</span></div><div class="metric-sub">to contain</div></div>
              <div class="metric-card red"><div class="metric-label">Pending</div><div class="metric-value">2</div><div class="metric-sub">awaiting approval</div></div>
            </div>
          </div>
        </div>

        <!-- Response History -->
        <!-- Playbook Execution Panel -->
        <div class="resp-playbook">
          <div class="resp-playbook-header">
            <div>
              <div class="resp-pb-title">Active Playbook â€” Ransomware: Data Encrypted for Impact</div>
              <div class="resp-pb-sub">DAC-18158 Â· Auto-triggered by AI Â· 6 phases</div>
            </div>
            <span class="resp-pb-badge">â–¶ Running</span>
          </div>

          <div class="resp-phases">

            <!-- Phase 1: Triage - Complete -->
            <div class="resp-phase">
              <div class="resp-phase-dot done"></div>
              <div class="resp-phase-body">
                <div class="resp-phase-header">
                  <span class="resp-phase-num">Phase 1</span>
                  <span class="resp-phase-name">Triage</span>
                  <span class="resp-phase-status done">âœ“ Complete</span>
                  <span class="resp-phase-status dur" style="margin-left:8px;">0.8s</span>
                </div>
                <ul class="resp-phase-detail">
                  <li>Verified not backup encryption process</li>
                  <li>Confirmed file encryption rate &gt;10 files/min</li>
                </ul>
              </div>
            </div>

            <!-- Phase 2: Contain - Complete -->
            <div class="resp-phase">
              <div class="resp-phase-dot done"></div>
              <div class="resp-phase-body">
                <div class="resp-phase-header">
                  <span class="resp-phase-num">Phase 2</span>
                  <span class="resp-phase-name">Contain</span>
                  <span class="resp-phase-status done">âœ“ Complete</span>
                  <span class="resp-phase-status dur" style="margin-left:8px;">4.2s</span>
                </div>
                <ul class="resp-phase-detail">
                  <li>Host DACTASG-WS-047 isolated via Elastic Agent</li>
                  <li>Account john.santos disabled in Azure AD</li>
                </ul>
              </div>
            </div>

            <!-- Phase 3: Identify - In Progress -->
            <div class="resp-phase">
              <div class="resp-phase-dot active"></div>
              <div class="resp-phase-body">
                <div class="resp-phase-header">
                  <span class="resp-phase-num">Phase 3</span>
                  <span class="resp-phase-name">Identify</span>
                  <span class="resp-phase-status active">â— In Progress</span>
                </div>
                <ul class="resp-phase-detail" style="margin-bottom:8px;">
                  <li>Checking if svchost_update.exe exists on other hosts...</li>
                  <li>Sweeping ADMIN$ share access logs...</li>
                </ul>
                <div style="display:flex;align-items:center;gap:8px;">
                  <div class="progress-bar" style="flex:1;height:5px;"><div class="progress-fill" style="width:65%;background:var(--amber);"></div></div>
                  <span style="font-size:10px;color:var(--amber);font-family:var(--font-mono);">65%</span>
                </div>
              </div>
            </div>

            <!-- Phase 4: Eradicate - Pending -->
            <div class="resp-phase">
              <div class="resp-phase-dot pending"></div>
              <div class="resp-phase-body">
                <div class="resp-phase-header">
                  <span class="resp-phase-num">Phase 4</span>
                  <span class="resp-phase-name">Eradicate</span>
                  <span class="resp-phase-status pending">â€” Pending</span>
                </div>
              </div>
            </div>

            <!-- Phase 5: Recover - Pending -->
            <div class="resp-phase">
              <div class="resp-phase-dot pending"></div>
              <div class="resp-phase-body">
                <div class="resp-phase-header">
                  <span class="resp-phase-num">Phase 5</span>
                  <span class="resp-phase-name">Recover</span>
                  <span class="resp-phase-status pending">â€” Pending</span>
                </div>
              </div>
            </div>

            <!-- Phase 6: Notify - Pending -->
            <div class="resp-phase">
              <div class="resp-phase-dot pending"></div>
              <div class="resp-phase-body">
                <div class="resp-phase-header">
                  <span class="resp-phase-num">Phase 6</span>
                  <span class="resp-phase-name">Notify</span>
                  <span class="resp-phase-status pending">â€” Pending</span>
                </div>
                <ul class="resp-phase-detail">
                  <li>Client escalation draft ready</li>
                </ul>
              </div>
            </div>

          </div><!-- end phases -->
        </div><!-- end playbook -->

        <!-- Response History -->
        <div class="card">
          <div class="card-header">
            <span class="card-title">Response History</span>
            <button class="btn btn-secondary btn-xs">Export</button>
            <div style="margin-left:auto;">
              <div class="resp-ai-overlay">
                <span class="resp-ai-overlay-label">ðŸ¤– AI Recommendation:</span>
                <span class="resp-ai-overlay-rec">Contain + Isolate immediately</span>
                <span class="resp-ai-overlay-conf">94% confidence</span>
              </div>
            </div>
          </div>
          <div class="table-wrap">
            <table>
              <thead><tr><th>Timestamp</th><th>Action</th><th>Target</th><th>Ticket</th><th>Trigger</th><th>Result</th><th>Duration</th></tr></thead>
              <tbody>
                <tr><td class="mono">13:28:05</td><td>Hash Block</td><td class="mono">a3f4b8c2...</td><td class="mono" style="color:var(--cyan);">DAC-18158</td><td>AI Auto</td><td><span class="badge badge-green">SUCCESS</span></td><td class="mono">1.2s</td></tr>
                <tr><td class="mono">12:55:18</td><td>Host Isolation</td><td>SPMT-DC-02</td><td class="mono" style="color:var(--cyan);">DAC-18145</td><td>Analyst</td><td><span class="badge badge-green">SUCCESS</span></td><td class="mono">3.7s</td></tr>
                <tr><td class="mono">12:30:44</td><td>Account Disable</td><td>k.lim@spmt.sg</td><td class="mono" style="color:var(--cyan);">DAC-18141</td><td>Playbook</td><td><span class="badge badge-green">SUCCESS</span></td><td class="mono">0.8s</td></tr>
                <tr><td class="mono">11:48:32</td><td>IP Block</td><td>185.220.101.42</td><td class="mono" style="color:var(--cyan);">DAC-18132</td><td>AI Auto</td><td><span class="badge badge-green">SUCCESS</span></td><td class="mono">2.1s</td></tr>
                <tr><td class="mono">10:12:09</td><td>Forensic Script</td><td>NW-WS-019</td><td class="mono" style="color:var(--cyan);">DAC-18109</td><td>Analyst</td><td><span class="badge badge-amber">PARTIAL</span></td><td class="mono">47s</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div><!-- end response -->


      <!-- =====================================================
           PAGE 5: SHIFT HANDOVER
           ===================================================== -->
      <div class="page" id="page-handover">
        <div class="page-header">
          <div>
            <div class="page-title">Shift Handover</div>
            <div class="page-subtitle">Shift B â†’ Shift C Â· 22:00 SGT</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm">ðŸ“„ Generate Report</button>
            <button class="btn btn-primary btn-sm">âœ“ Complete Handover</button>
          </div>
        </div>

        <div class="shift-header-bar">
          <div class="metric-card cyan"><div class="metric-label">Current Shift</div><div class="metric-value" style="font-size:18px;">Shift B</div><div class="metric-sub">14:00â€“22:00 SGT</div></div>
          <div class="metric-card green"><div class="metric-label">Tickets Closed</div><div class="metric-value">8</div><div class="metric-sub">this shift</div></div>
          <div class="metric-card amber"><div class="metric-label">Open Tickets</div><div class="metric-value">6</div><div class="metric-sub">carrying over</div></div>
          <div class="metric-card red"><div class="metric-label">Escalated</div><div class="metric-value">2</div><div class="metric-sub">active escalations</div></div>
        </div>

        <!-- ===== JSM OPS COMMAND CENTER ===== -->
        <style>
          .ops-cmd-section { margin-bottom:16px; }
          .ops-cmd-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:12px; }
          .ops-cmd-title { font-size:14px; font-weight:700; color:var(--text-primary); display:flex; align-items:center; gap:8px; }
          .ops-cmd-title svg { width:16px; height:16px; stroke:var(--cyan); }
          .ops-cmd-live { display:flex; align-items:center; gap:6px; font-size:10px; color:var(--green); font-weight:600; text-transform:uppercase; letter-spacing:0.06em; }
          .ops-cmd-live .live-dot { width:6px; height:6px; border-radius:50%; background:var(--green); animation:pulse-live 2s ease infinite; }
          @keyframes pulse-live { 0%,100%{opacity:1;} 50%{opacity:0.3;} }
          .ops-cmd-grid { display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px; }
          @media(max-width:1100px) { .ops-cmd-grid { grid-template-columns:1fr; } }
          .ops-card { background:rgba(15,23,42,0.5); border:1px solid var(--border-card); border-radius:10px; overflow:hidden; }
          .ops-card-head { display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-bottom:1px solid var(--border-subtle); }
          .ops-card-head-title { font-size:11px; font-weight:700; text-transform:uppercase; letter-spacing:0.06em; color:var(--text-secondary); display:flex; align-items:center; gap:6px; }
          .ops-card-head-title svg { width:14px; height:14px; }
          .ops-card-body { padding:12px 14px; }
          .ops-card-count { font-size:10px; font-weight:600; padding:2px 8px; border-radius:10px; font-family:var(--font-mono); }
          .ops-schedule-item { padding:10px; background:var(--bg-elevated); border-radius:8px; margin-bottom:8px; }
          .ops-schedule-item:last-child { margin-bottom:0; }
          .ops-schedule-name { font-size:11px; font-weight:700; color:var(--text-primary); margin-bottom:4px; display:flex; align-items:center; gap:6px; }
          .ops-schedule-name .ops-enabled { width:6px; height:6px; border-radius:50%; }
          .ops-schedule-name .ops-enabled.on { background:var(--green); }
          .ops-schedule-name .ops-enabled.off { background:var(--text-muted); }
          .ops-rotation { padding:6px 8px; background:rgba(0,0,0,0.15); border-radius:6px; margin-top:6px; }
          .ops-rotation-name { font-size:10px; font-weight:600; color:var(--cyan); margin-bottom:3px; }
          .ops-rotation-detail { font-size:9px; color:var(--text-muted); line-height:1.5; }
          .ops-rotation-detail strong { color:var(--text-secondary); }
          .ops-oncall-badge { display:inline-flex; align-items:center; gap:4px; padding:3px 8px; border-radius:6px; font-size:10px; font-weight:600; background:rgba(16,185,129,0.1); border:1px solid rgba(16,185,129,0.25); color:var(--green); margin-top:6px; }
          .ops-oncall-badge svg { width:10px; height:10px; }
          .ops-rule-item { padding:10px; background:var(--bg-elevated); border-radius:8px; margin-bottom:8px; }
          .ops-rule-item:last-child { margin-bottom:0; }
          .ops-rule-name { font-size:11px; font-weight:700; color:var(--text-primary); margin-bottom:4px; }
          .ops-rule-condition { font-size:9px; color:var(--text-muted); padding:4px 8px; background:rgba(0,0,0,0.15); border-radius:4px; margin-bottom:4px; font-family:var(--font-mono); }
          .ops-rule-time { font-size:9px; color:var(--amber); display:flex; align-items:center; gap:4px; }
          .ops-rule-time svg { width:10px; height:10px; stroke:var(--amber); }
          .ops-rule-notify { font-size:9px; color:var(--text-secondary); display:flex; align-items:center; gap:4px; margin-top:4px; }
          .ops-rule-notify svg { width:10px; height:10px; stroke:var(--cyan); }
          .ops-esc-item { padding:10px; background:var(--bg-elevated); border-radius:8px; margin-bottom:8px; }
          .ops-esc-item:last-child { margin-bottom:0; }
          .ops-esc-name { font-size:11px; font-weight:700; color:var(--text-primary); margin-bottom:6px; display:flex; align-items:center; gap:6px; }
          .ops-esc-step { display:flex; align-items:flex-start; gap:8px; padding:6px 0; border-bottom:1px solid rgba(255,255,255,0.04); }
          .ops-esc-step:last-child { border-bottom:none; }
          .ops-esc-timer { min-width:36px; text-align:center; font-size:10px; font-weight:700; font-family:var(--font-mono); color:var(--amber); padding:3px 6px; background:rgba(245,158,11,0.08); border:1px solid rgba(245,158,11,0.15); border-radius:4px; }
          .ops-esc-action { font-size:10px; color:var(--text-secondary); line-height:1.4; }
          .ops-esc-action strong { color:var(--text-primary); }
          .ops-esc-repeat { font-size:9px; color:var(--purple); display:flex; align-items:center; gap:4px; margin-top:6px; padding:4px 8px; background:rgba(139,92,246,0.06); border:1px solid rgba(139,92,246,0.15); border-radius:4px; }
          .ops-skeleton { animation:shimmer 1.5s ease infinite; background:linear-gradient(90deg,rgba(255,255,255,0.02) 25%,rgba(255,255,255,0.06) 50%,rgba(255,255,255,0.02) 75%); background-size:200% 100%; border-radius:6px; height:60px; margin-bottom:8px; }
          .ops-default-badge { font-size:8px; padding:1px 5px; border-radius:3px; background:rgba(100,116,139,0.15); color:var(--text-muted); font-weight:700; text-transform:uppercase; letter-spacing:0.05em; }
          .ops-none-badge { font-size:9px; color:var(--text-muted); font-style:italic; }
        </style>

        <div class="ops-cmd-section" id="opsCommandSection">
          <div class="ops-cmd-header">
            <div class="ops-cmd-title">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
              Operations Command â€” JSM Ops
            </div>
            <div class="ops-cmd-live" id="opsLiveIndicator" style="display:none;">
              <span class="live-dot"></span> LIVE
            </div>
          </div>
          <div class="ops-cmd-grid">
            <!-- On-Call Schedules -->
            <div class="ops-card">
              <div class="ops-card-head">
                <div class="ops-card-head-title">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="1.5"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
                  On-Call Schedules
                </div>
                <span class="ops-card-count" id="opsScheduleCount" style="background:rgba(0,212,255,0.1);color:var(--cyan);">â€”</span>
              </div>
              <div class="ops-card-body" id="opsScheduleBody">
                <div class="ops-skeleton"></div><div class="ops-skeleton"></div>
              </div>
            </div>
            <!-- Routing Rules -->
            <div class="ops-card">
              <div class="ops-card-head">
                <div class="ops-card-head-title">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--amber)" stroke-width="1.5"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                  Routing Rules
                </div>
                <span class="ops-card-count" id="opsRoutingCount" style="background:rgba(245,158,11,0.1);color:var(--amber);">â€”</span>
              </div>
              <div class="ops-card-body" id="opsRoutingBody">
                <div class="ops-skeleton"></div><div class="ops-skeleton"></div>
              </div>
            </div>
            <!-- Escalation Policies -->
            <div class="ops-card">
              <div class="ops-card-head">
                <div class="ops-card-head-title">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--red-bright)" stroke-width="1.5"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
                  Escalation Policies
                </div>
                <span class="ops-card-count" id="opsEscCount" style="background:rgba(239,68,68,0.1);color:var(--red-bright);">â€”</span>
              </div>
              <div class="ops-card-body" id="opsEscBody">
                <div class="ops-skeleton"></div>
              </div>
            </div>
          </div>
        </div>
        <!-- ===== END JSM OPS COMMAND CENTER ===== -->

        <div class="grid-2" style="margin-bottom:16px;">
          <div class="card">
            <div class="card-header"><span class="card-title">Shift B Team On Duty</span></div>
            <div style="display:flex;flex-direction:column;gap:8px;">
              <div style="display:flex;align-items:center;gap:10px;padding:8px;background:var(--bg-elevated);border-radius:7px;">
                <div class="user-avatar">JL</div>
                <div><div style="font-size:12px;font-weight:600;color:var(--text-primary);">John Lim</div><div style="font-size:10px;color:var(--cyan);">Lead Analyst â€” SOC L2</div></div>
                <div class="status-dot green" style="margin-left:auto;"></div>
              </div>
              <div style="display:flex;align-items:center;gap:10px;padding:8px;background:var(--bg-elevated);border-radius:7px;">
                <div class="user-avatar" style="background:linear-gradient(135deg,#f59e0b,#ef4444);">ST</div>
                <div><div style="font-size:12px;font-weight:600;color:var(--text-primary);">Sarah Tan</div><div style="font-size:10px;color:var(--text-muted);">SOC Analyst L1</div></div>
                <div class="status-dot green" style="margin-left:auto;"></div>
              </div>
              <div style="display:flex;align-items:center;gap:10px;padding:8px;background:var(--bg-elevated);border-radius:7px;">
                <div class="user-avatar" style="background:linear-gradient(135deg,#10b981,#3b82f6);">MW</div>
                <div><div style="font-size:12px;font-weight:600;color:var(--text-primary);">Marcus Wong</div><div style="font-size:10px;color:var(--text-muted);">SOC Analyst L1</div></div>
                <div class="status-dot amber" style="margin-left:auto;"></div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header"><span class="card-title">Shift C â€” Incoming</span><span class="badge badge-blue">Starts 22:00</span></div>
            <div style="display:flex;flex-direction:column;gap:8px;">
              <div style="display:flex;align-items:center;gap:10px;padding:8px;background:var(--bg-elevated);border-radius:7px;">
                <div class="user-avatar" style="background:linear-gradient(135deg,#8b5cf6,#06b6d4);">RL</div>
                <div><div style="font-size:12px;font-weight:600;color:var(--text-primary);">Raj Lingam</div><div style="font-size:10px;color:var(--text-muted);">Lead Analyst â€” SOC L2</div></div>
                <span class="badge badge-blue" style="margin-left:auto;font-size:9px;">Incoming</span>
              </div>
              <div style="display:flex;align-items:center;gap:10px;padding:8px;background:var(--bg-elevated);border-radius:7px;">
                <div class="user-avatar" style="background:linear-gradient(135deg,#f97316,#8b5cf6);">AH</div>
                <div><div style="font-size:12px;font-weight:600;color:var(--text-primary);">Aisha Hassan</div><div style="font-size:10px;color:var(--text-muted);">SOC Analyst L1</div></div>
                <span class="badge badge-blue" style="margin-left:auto;font-size:9px;">Incoming</span>
              </div>
            </div>
          </div>
        </div>

        <div class="card" style="margin-bottom:16px;">
          <div class="card-header"><span class="card-title">Handover Notes from Shift A</span><span style="font-size:11px;color:var(--text-muted);">From: Wei Chen Â· 14:03 SGT</span></div>
          <div class="handover-note">
            âš  <strong>CRITICAL â€” DAC-18158 (P1 Ransomware)</strong> is ACTIVE. Host DACTASG-WS-047 isolation in progress. Await confirmation from Elastic agent. john.santos account disable pending CISO approval (ETA 10 min). Do NOT close until full forensics complete.<br><br>
            DAC-18157 (P2 Lateral Movement) â€” relates to DAC-18158. Same user. Keep correlated.<br><br>
            Elastic alerts DAC-18135 to DAC-18140 â€” all benign patch deployment false positives. Rule tuning ticket TKT-RUL-089 raised. Expected FP for next 2 shifts during patching window.<br><br>
            Application control request DAC-18120 â€” awaiting Business Approval from Naga World IT Manager (Kenneth Ng). Follow up by 18:00.
          </div>
        </div>

        <div class="card">
          <div class="card-header"><span class="card-title">Open Items â€” Carrying to Shift C</span></div>
          <div class="table-wrap">
            <table>
              <thead><tr><th>ID</th><th>Priority</th><th>Title</th><th>Action Required</th><th>Owner</th><th>Deadline</th></tr></thead>
              <tbody>
                <tr><td class="mono" style="color:var(--cyan);">DAC-18158</td><td><span class="badge badge-p1">P1</span></td><td>Ransomware Activity â€” DACTASG-WS-047</td><td>Complete isolation, await forensics</td><td>John Lim â†’ Raj Lingam</td><td style="color:var(--red-bright);font-family:var(--font-mono);">URGENT</td></tr>
                <tr><td class="mono" style="color:var(--cyan);">DAC-18157</td><td><span class="badge badge-p2">P2</span></td><td>Unusual Host Communication</td><td>Monitor correlated to DAC-18158</td><td>Sarah Tan â†’ Aisha Hassan</td><td class="mono">22:00</td></tr>
                <tr><td class="mono" style="color:var(--cyan);">DAC-18120</td><td><span class="badge badge-p3">P3</span></td><td>Application Control â€” Unauthorized Execution</td><td>Follow up with Kenneth Ng (NW IT)</td><td>Marcus Wong â†’ Aisha Hassan</td><td class="mono">18:00</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ===== UPLOAD ARTIFACTS (Task 6) ===== -->
        <div class="grid-2" style="margin-top:16px;">
          <div class="card">
            <div class="card-header"><span class="card-title">Upload Artifacts</span><span class="badge badge-blue">Attachments</span></div>
            <div class="handover-artifact-zone" id="artifactDropZone"
              ondragover="event.preventDefault();this.classList.add('drag-over');"
              ondragleave="this.classList.remove('drag-over');"
              ondrop="handleArtifactDrop(event);"
              onclick="document.getElementById('artifactFileInput').click();">
              <div class="handover-artifact-icon">&#x1F4C2;</div>
              <div class="handover-artifact-text">Drag &amp; drop artifacts or <span style="color:var(--cyan);cursor:pointer;">click to browse</span></div>
              <div class="handover-artifact-sub">PDF, PNG, DOCX, CSV, PCAP accepted Â· Max 50MB per file</div>
            </div>
            <input type="file" id="artifactFileInput" multiple style="display:none;" onchange="handleArtifactSelect(event)">
            <div class="handover-file-list" id="artifactFileList">
              <!-- Sample pre-loaded files -->
              <div class="handover-file-item">
                <div class="handover-file-icon">ðŸ“„</div>
                <div class="handover-file-name">DAC-18158_memory_dump.pdf</div>
                <div style="font-size:10px;color:var(--text-muted);">2.4 MB</div>
                <div class="handover-file-remove" onclick="this.parentElement.remove()">&#x2715;</div>
              </div>
              <div class="handover-file-item">
                <div class="handover-file-icon">ðŸ“ˆ</div>
                <div class="handover-file-name">timeline_export_2026-02-27.csv</div>
                <div style="font-size:10px;color:var(--text-muted);">84 KB</div>
                <div class="handover-file-remove" onclick="this.parentElement.remove()">&#x2715;</div>
              </div>
              <div class="handover-file-item">
                <div class="handover-file-icon">ðŸ–¼ï¸</div>
                <div class="handover-file-name">process_tree_screenshot.png</div>
                <div style="font-size:10px;color:var(--text-muted);">148 KB</div>
                <div class="handover-file-remove" onclick="this.parentElement.remove()">&#x2715;</div>
              </div>
            </div>
          </div>

          <!-- ===== SEND TO CLIENT (Task 6) ===== -->
          <div class="card send-to-client-section">
            <div class="card-header"><span class="card-title">Send to Client</span></div>
            <div class="client-send-toggle-row">
              <span class="wr2-toggle off" id="clientSendToggle" onclick="toggleClientSend()" style="cursor:pointer;"></span>
              <div>
                <div style="font-size:12px;font-weight:600;color:var(--text-primary);">Send handover copy to client</div>
                <div style="font-size:10px;color:var(--text-muted);">Sends a sanitized version excluding internal notes</div>
              </div>
            </div>
            <div class="client-send-fields" id="clientSendFields">
              <div>
                <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);margin-bottom:5px;">To</div>
                <input type="email" class="esc-input" value="it-security@spmt.com" placeholder="Client email...">
              </div>
              <div>
                <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);margin-bottom:5px;">CC</div>
                <input type="email" class="esc-input" placeholder="CC email (optional)...">
              </div>
              <div style="padding:8px 10px;background:rgba(245,158,11,0.06);border:1px solid rgba(245,158,11,0.2);border-radius:6px;font-size:10px;color:var(--amber);display:flex;gap:6px;align-items:flex-start;">
                <span>&#x2139;&#xFE0F;</span>
                <span>This will send a sanitized version excluding all internal analyst notes, raw IOC details, and source references marked INTERNAL.</span>
              </div>
              <button class="btn btn-primary" style="width:100%;justify-content:center;" onclick="showToast('Handover report sent to client â€” it-security@spmt.com')">
                &#x1F4E4; Send Handover Report
              </button>
            </div>
          </div>
        </div>
      </div><!-- end handover -->



      <!-- =====================================================
           PAGE 6: DETECTION RULES  (Full Overhaul)
           ===================================================== -->
      <div class="page" id="page-rules">

        <style>
          /* â”€â”€ Detection Rules Page Styles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          .dr-tab-nav { display:flex; align-items:center; gap:0; border-bottom:1px solid rgba(255,255,255,0.07); margin-bottom:20px; background:transparent; }
          .dr-tab-btn { display:flex; align-items:center; gap:7px; padding:11px 18px; font-family:'IBM Plex Sans',sans-serif; font-size:13px; font-weight:500; color:#64748b; background:transparent; border:none; border-bottom:2px solid transparent; cursor:pointer; white-space:nowrap; transition:color .15s,border-color .15s; outline:none; position:relative; bottom:-1px; }
          .dr-tab-btn:hover { color:#94a3b8; }
          .dr-tab-btn.active { color:#00d4ff; border-bottom-color:#00d4ff; font-weight:600; }
          .dr-tab-btn .tab-count { background:rgba(0,212,255,0.12); color:var(--cyan); font-size:10px; font-weight:700; padding:2px 7px; border-radius:10px; font-family:var(--font-mono); }
          .dr-panel { display:none; }
          .dr-panel.active { display:block; }

          /* Rule Repository styles */
          .dr-filter-bar { display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-bottom:16px; padding:12px 16px; background:rgba(15,23,42,0.5); border:1px solid var(--border-subtle); border-radius:10px; }
          .dr-filter-bar .filter-select, .dr-filter-bar .filter-input { font-size:11px; }
          .dr-repo-stats { display:grid; grid-template-columns:repeat(6,1fr); gap:10px; margin-bottom:16px; }
          @media(max-width:900px) { .dr-repo-stats { grid-template-columns:repeat(3,1fr); } }
          .dr-stat-card { padding:14px 16px; background:rgba(15,23,42,0.5); border:1px solid var(--border-card); border-radius:10px; text-align:center; }
          .dr-stat-card .val { font-size:22px; font-weight:800; font-family:var(--font-display); }
          .dr-stat-card .lbl { font-size:10px; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.06em; margin-top:2px; }
          .dr-stat-card.cyan .val { color:var(--cyan); }
          .dr-stat-card.green .val { color:var(--green); }
          .dr-stat-card.amber .val { color:var(--amber); }
          .dr-stat-card.purple .val { color:var(--purple); }
          .dr-stat-card.red .val { color:var(--red-bright); }
          .dr-stat-card.blue .val { color:#60a5fa; }

          /* Log source tags */
          .logsrc-tag { display:inline-flex; align-items:center; gap:3px; padding:2px 8px; font-size:9px; font-weight:600; border-radius:4px; background:rgba(255,255,255,0.04); border:1px solid var(--border-subtle); color:var(--text-secondary); white-space:nowrap; }
          .logsrc-tag.windows { background:rgba(96,165,250,0.08); border-color:rgba(96,165,250,0.2); color:#60a5fa; }
          .logsrc-tag.linux { background:rgba(251,191,36,0.08); border-color:rgba(251,191,36,0.2); color:#fbbf24; }
          .logsrc-tag.firewall { background:rgba(244,114,182,0.08); border-color:rgba(244,114,182,0.2); color:#f472b6; }
          .logsrc-tag.cloud { background:rgba(96,165,250,0.08); border-color:rgba(96,165,250,0.2); color:#60a5fa; }
          .logsrc-tag.edr { background:rgba(167,139,250,0.08); border-color:rgba(167,139,250,0.2); color:#a78bfa; }
          .logsrc-tag.m365 { background:rgba(251,146,60,0.08); border-color:rgba(251,146,60,0.2); color:#fb923c; }
          .logsrc-tag.network { background:rgba(52,211,153,0.08); border-color:rgba(52,211,153,0.2); color:#34d399; }
          .logsrc-tag.ot { background:rgba(249,115,22,0.08); border-color:rgba(249,115,22,0.2); color:#f97316; }

          /* Rule type badges */
          .rule-type-badge { padding:2px 8px; font-size:9px; font-weight:700; border-radius:4px; text-transform:uppercase; letter-spacing:0.05em; }
          .rule-type-badge.sigma { background:rgba(0,212,255,0.12); color:var(--cyan); }
          .rule-type-badge.yara { background:rgba(167,139,250,0.12); color:#a78bfa; }
          .rule-type-badge.correlation { background:rgba(251,146,60,0.12); color:#fb923c; }
          .rule-type-badge.threshold { background:rgba(244,114,182,0.12); color:#f472b6; }
          .rule-type-badge.ml { background:rgba(52,211,153,0.12); color:#34d399; }
          .rule-type-badge.eql { background:rgba(251,191,36,0.12); color:#fbbf24; }

          /* Author badges */
          .author-badge { display:inline-flex; align-items:center; gap:4px; padding:2px 7px; font-size:9px; font-weight:600; border-radius:4px; }
          .author-badge.dacta { background:rgba(0,212,255,0.08); border:1px solid rgba(0,212,255,0.2); color:var(--cyan); }
          .author-badge.community { background:rgba(167,139,250,0.08); border:1px solid rgba(167,139,250,0.2); color:#a78bfa; }
          .author-badge.custom { background:rgba(52,211,153,0.08); border:1px solid rgba(52,211,153,0.2); color:#34d399; }

          /* IDE Editor styles */
          .dr-ide { background:#0b1120; border:1px solid var(--border-card); border-radius:10px; overflow:hidden; }
          .dr-ide-toolbar { display:flex; align-items:center; justify-content:space-between; padding:8px 14px; background:rgba(15,23,42,0.8); border-bottom:1px solid var(--border-subtle); }
          .dr-ide-tabs { display:flex; gap:0; }
          .dr-ide-tab { padding:6px 14px; font-size:11px; font-weight:500; color:var(--text-muted); background:transparent; border:none; border-bottom:2px solid transparent; cursor:pointer; transition:all .15s; font-family:'IBM Plex Sans',sans-serif; }
          .dr-ide-tab.active { color:var(--cyan); border-bottom-color:var(--cyan); background:rgba(0,212,255,0.04); }
          .dr-ide-tab:hover { color:var(--text-secondary); }
          .dr-ide-body { display:flex; min-height:380px; max-height:500px; }
          .dr-ide-lines { width:42px; background:rgba(15,23,42,0.5); padding:14px 8px; text-align:right; border-right:1px solid var(--border-subtle); font-family:var(--font-mono); font-size:12px; line-height:1.7; color:rgba(100,116,139,0.4); user-select:none; overflow:hidden; }
          .dr-ide-code { flex:1; padding:14px 16px; font-family:var(--font-mono); font-size:12px; line-height:1.7; color:var(--text-secondary); overflow:auto; white-space:pre; tab-size:2; }
          .dr-ide-code .kw { color:#c084fc; } /* purple keywords */
          .dr-ide-code .str { color:#34d399; } /* green strings */
          .dr-ide-code .num { color:#fbbf24; } /* amber numbers */
          .dr-ide-code .cmt { color:rgba(100,116,139,0.6); font-style:italic; } /* comments */
          .dr-ide-code .fn { color:#60a5fa; } /* function names */
          .dr-ide-code .op { color:#f472b6; } /* operators */
          .dr-ide-code .field { color:var(--cyan); } /* field names */
          .dr-ide-code .tag { color:#fb923c; } /* tags */
          .dr-ide-status { display:flex; align-items:center; justify-content:space-between; padding:4px 14px; background:rgba(15,23,42,0.5); border-top:1px solid var(--border-subtle); font-size:10px; color:var(--text-muted); }

          /* Translation output panel */
          .dr-translate-panel { margin-top:12px; background:rgba(15,23,42,0.4); border:1px solid var(--border-card); border-radius:10px; overflow:hidden; }
          .dr-translate-header { display:flex; align-items:center; justify-content:space-between; padding:10px 14px; background:rgba(15,23,42,0.6); border-bottom:1px solid var(--border-subtle); }
          .dr-translate-body { padding:14px; font-family:var(--font-mono); font-size:11px; line-height:1.7; color:var(--text-secondary); max-height:180px; overflow:auto; white-space:pre; }

          /* Pipeline stages */
          .dr-pipeline { display:flex; align-items:center; gap:0; margin:16px 0; padding:0 10px; overflow-x:auto; }
          .dr-pipe-stage { display:flex; flex-direction:column; align-items:center; gap:6px; min-width:140px; padding:16px 12px; position:relative; }
          .dr-pipe-stage:not(:last-child)::after { content:''; position:absolute; right:-12px; top:32px; width:24px; height:2px; background:linear-gradient(90deg,rgba(0,212,255,0.4),rgba(0,212,255,0.1)); }
          .dr-pipe-icon { width:48px; height:48px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:20px; }
          .dr-pipe-icon.draft { background:rgba(100,116,139,0.15); border:1px solid rgba(100,116,139,0.3); }
          .dr-pipe-icon.test { background:rgba(0,212,255,0.1); border:1px solid rgba(0,212,255,0.25); }
          .dr-pipe-icon.review { background:rgba(167,139,250,0.1); border:1px solid rgba(167,139,250,0.25); }
          .dr-pipe-icon.staging { background:rgba(251,191,36,0.1); border:1px solid rgba(251,191,36,0.25); }
          .dr-pipe-icon.prod { background:rgba(16,185,129,0.1); border:1px solid rgba(16,185,129,0.25); }
          .dr-pipe-label { font-size:11px; font-weight:600; color:var(--text-primary); text-align:center; }
          .dr-pipe-sub { font-size:9px; color:var(--text-muted); text-align:center; }
          .dr-pipe-count { font-size:18px; font-weight:800; font-family:var(--font-mono); }
          .dr-pipe-count.draft-c { color:#64748b; }
          .dr-pipe-count.test-c { color:var(--cyan); }
          .dr-pipe-count.review-c { color:#a78bfa; }
          .dr-pipe-count.staging-c { color:#fbbf24; }
          .dr-pipe-count.prod-c { color:var(--green); }

          /* Coverage Analytics */
          .dr-coverage-grid { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
          @media(max-width:900px) { .dr-coverage-grid { grid-template-columns:1fr; } }
          .dr-gap-item { padding:10px 14px; background:rgba(239,68,68,0.04); border:1px solid rgba(239,68,68,0.15); border-radius:8px; display:flex; align-items:center; gap:12px; margin-bottom:8px; }
          .dr-gap-item .technique { font-size:12px; font-weight:600; color:var(--text-primary); }
          .dr-gap-item .desc { font-size:10px; color:var(--text-muted); }
          .dr-gap-item .action-btn { margin-left:auto; white-space:nowrap; }

          /* Version history */
          .dr-version-row { display:flex; align-items:center; gap:12px; padding:8px 12px; border-bottom:1px solid var(--border-subtle); font-size:11px; }
          .dr-version-row:last-child { border-bottom:none; }
          .dr-version-hash { font-family:var(--font-mono); color:var(--cyan); font-size:11px; font-weight:600; }
          .dr-version-msg { color:var(--text-primary); flex:1; }
          .dr-version-author { color:var(--text-muted); }
          .dr-version-time { color:var(--text-muted); font-family:var(--font-mono); }

          /* Create rule modal */
          .dr-create-sidebar { background:rgba(15,23,42,0.6); border:1px solid var(--border-card); border-radius:10px; padding:16px; }
          .dr-field-group { margin-bottom:14px; }
          .dr-field-label { font-size:10px; font-weight:700; text-transform:uppercase; letter-spacing:0.07em; color:var(--text-muted); margin-bottom:5px; }
          .dr-siem-target { display:flex; align-items:center; gap:8px; padding:8px 12px; background:rgba(255,255,255,0.03); border:1px solid var(--border-subtle); border-radius:7px; margin-bottom:6px; cursor:pointer; transition:all .15s; }
          .dr-siem-target:hover { border-color:rgba(0,212,255,0.3); }
          .dr-siem-target.selected { border-color:var(--cyan); background:rgba(0,212,255,0.04); }
          .dr-siem-target .siem-name { font-size:12px; font-weight:500; color:var(--text-primary); }
          .dr-siem-target .siem-ver { font-size:10px; color:var(--text-muted); }
          .dr-siem-check { width:16px; height:16px; border-radius:4px; border:1px solid var(--border-subtle); display:flex; align-items:center; justify-content:center; font-size:10px; color:var(--cyan); margin-left:auto; }
          .dr-siem-target.selected .dr-siem-check { background:rgba(0,212,255,0.15); border-color:var(--cyan); }

          /* â”€â”€ Bulk Deploy + Create Rule Modal Styles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          .bd-modal-overlay { position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.65); backdrop-filter:blur(6px); z-index:9999; display:flex; align-items:center; justify-content:center; padding:20px; }
          .bd-modal { background:#0d1424; border:1px solid var(--border-card); border-radius:14px; width:100%; max-width:720px; max-height:88vh; display:flex; flex-direction:column; box-shadow:0 24px 80px rgba(0,0,0,0.5); }
          .bd-modal-header { display:flex; align-items:center; justify-content:space-between; padding:18px 22px; border-bottom:1px solid var(--border-subtle); }
          .bd-modal-close { background:none; border:none; color:var(--text-muted); font-size:22px; cursor:pointer; padding:4px 8px; border-radius:6px; transition:all .15s; }
          .bd-modal-close:hover { color:var(--text-primary); background:rgba(255,255,255,0.06); }
          .bd-modal-footer { display:flex; align-items:center; gap:8px; padding:14px 22px; border-top:1px solid var(--border-subtle); }

          /* Step indicator */
          .bd-steps { display:flex; align-items:center; justify-content:center; gap:0; padding:16px 22px 12px; }
          .bd-step { display:flex; align-items:center; gap:6px; }
          .bd-step-num { width:24px; height:24px; border-radius:50%; background:rgba(255,255,255,0.06); border:1px solid var(--border-subtle); display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:700; color:var(--text-muted); font-family:var(--font-mono); transition:all .2s; }
          .bd-step.active .bd-step-num { background:rgba(0,212,255,0.15); border-color:var(--cyan); color:var(--cyan); }
          .bd-step.done .bd-step-num { background:rgba(16,185,129,0.15); border-color:var(--green); color:var(--green); }
          .bd-step-label { font-size:11px; font-weight:500; color:var(--text-muted); transition:color .2s; }
          .bd-step.active .bd-step-label { color:var(--cyan); font-weight:600; }
          .bd-step.done .bd-step-label { color:var(--green); }
          .bd-step-line { width:30px; height:1px; background:var(--border-subtle); margin:0 6px; }

          /* Step panels */
          .bd-step-panel { display:none; padding:16px 22px; overflow-y:auto; max-height:calc(88vh - 220px); }
          .bd-step-panel.active { display:block; }

          /* Log source grid */
          .bd-logsrc-grid { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; }
          @media(max-width:700px) { .bd-logsrc-grid { grid-template-columns:repeat(2,1fr); } }
          .bd-logsrc-card { display:flex; flex-direction:column; align-items:center; gap:8px; padding:14px 10px; background:rgba(255,255,255,0.02); border:1px solid var(--border-subtle); border-radius:10px; cursor:pointer; transition:all .2s; text-align:center; }
          .bd-logsrc-card:hover { border-color:rgba(0,212,255,0.3); background:rgba(0,212,255,0.02); }
          .bd-logsrc-card.selected { border-color:var(--cyan); background:rgba(0,212,255,0.05); box-shadow:0 0 0 1px rgba(0,212,255,0.2); }
          .bd-logsrc-icon { width:44px; height:44px; border-radius:10px; display:flex; align-items:center; justify-content:center; border:1px solid; }
          .bd-logsrc-name { font-size:11px; font-weight:600; color:var(--text-primary); line-height:1.3; }
          .bd-logsrc-count { font-size:10px; color:var(--text-muted); font-family:var(--font-mono); }

          /* Rule selection list */
          .bd-rule-list { display:flex; flex-direction:column; gap:4px; max-height:300px; overflow-y:auto; }
          .bd-rule-item { display:flex; align-items:center; gap:10px; padding:8px 12px; background:rgba(255,255,255,0.02); border:1px solid var(--border-subtle); border-radius:7px; cursor:pointer; transition:all .15s; }
          .bd-rule-item:hover { border-color:rgba(0,212,255,0.25); }
          .bd-rule-item.checked { border-color:rgba(0,212,255,0.35); background:rgba(0,212,255,0.03); }
          .bd-rule-item input[type="checkbox"] { accent-color:var(--cyan); flex-shrink:0; }
          .bd-rule-item .rule-info { flex:1; min-width:0; }
          .bd-rule-item .rule-name { font-size:12px; font-weight:500; color:var(--text-primary); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
          .bd-rule-item .rule-meta { font-size:10px; color:var(--text-muted); display:flex; gap:8px; margin-top:2px; }

          /* Client selection list */
          .bd-client-list { display:flex; flex-direction:column; gap:8px; }
          .bd-client-card { display:flex; align-items:center; gap:12px; padding:14px 16px; background:rgba(255,255,255,0.02); border:1px solid var(--border-subtle); border-radius:10px; cursor:pointer; transition:all .2s; }
          .bd-client-card:hover { border-color:rgba(0,212,255,0.25); }
          .bd-client-card.selected { border-color:var(--cyan); background:rgba(0,212,255,0.04); }
          .bd-client-check { width:20px; height:20px; border-radius:5px; border:1px solid var(--border-subtle); display:flex; align-items:center; justify-content:center; font-size:12px; color:transparent; transition:all .15s; flex-shrink:0; }
          .bd-client-card.selected .bd-client-check { background:rgba(0,212,255,0.15); border-color:var(--cyan); color:var(--cyan); }

          /* Summary card */
          .bd-summary-card { padding:14px 16px; background:rgba(15,23,42,0.5); border:1px solid var(--border-card); border-radius:10px; }
          .bd-summary-row { display:flex; align-items:center; justify-content:space-between; padding:6px 0; border-bottom:1px solid var(--border-subtle); }
          .bd-summary-row:last-child { border-bottom:none; }
          .bd-summary-label { font-size:11px; color:var(--text-muted); }
          .bd-summary-val { font-size:12px; font-weight:600; color:var(--cyan); }

          /* Create Rule modal â€” client options */
          .cr-client-options { display:flex; flex-direction:column; gap:4px; margin-top:8px; }
          .cr-client-opt { padding:10px 14px; background:rgba(255,255,255,0.02); border:1px solid var(--border-subtle); border-radius:8px; cursor:pointer; transition:all .15s; }
          .cr-client-opt:hover { border-color:rgba(0,212,255,0.3); background:rgba(0,212,255,0.03); }
          .cr-client-opt.selected { border-color:var(--cyan); background:rgba(0,212,255,0.06); }

          /* Threat actor cards */
          .cr-actor-card { display:flex; align-items:center; gap:10px; padding:10px 14px; background:rgba(239,68,68,0.03); border:1px solid rgba(239,68,68,0.12); border-radius:8px; }
          .cr-actor-card .actor-icon { width:32px; height:32px; border-radius:8px; background:rgba(239,68,68,0.1); border:1px solid rgba(239,68,68,0.2); display:flex; align-items:center; justify-content:center; font-size:14px; flex-shrink:0; }
          .cr-actor-card .actor-name { font-size:12px; font-weight:600; color:var(--text-primary); }
          .cr-actor-card .actor-desc { font-size:10px; color:var(--text-muted); line-height:1.4; }
          .cr-risk-tag { padding:5px 10px; font-size:10px; font-weight:600; border-radius:6px; background:rgba(245,158,11,0.08); border:1px solid rgba(245,158,11,0.2); color:var(--amber); }

          /* â”€â”€ Emerging Threats Tab â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          .et-feed-status { display:flex; align-items:center; gap:12px; padding:12px 16px; background:rgba(0,212,255,0.04); border:1px solid rgba(0,212,255,0.12); border-radius:10px; margin-bottom:16px; }
          .et-feed-dot { width:8px; height:8px; border-radius:50%; background:#22c55e; animation: etPulse 2s infinite; flex-shrink:0; }
          @keyframes etPulse { 0%,100%{opacity:1;box-shadow:0 0 0 0 rgba(34,197,94,0.4)} 50%{opacity:.7;box-shadow:0 0 0 6px rgba(34,197,94,0)} }
          .et-feed-label { font-size:12px; font-weight:600; color:var(--text-primary); }
          .et-feed-meta { font-size:10px; color:var(--text-muted); }
          .et-sources-row { display:flex; gap:8px; flex-wrap:wrap; margin-top:6px; }
          .et-src-tag { font-size:9px; font-weight:600; padding:3px 8px; border-radius:6px; font-family:var(--font-mono); letter-spacing:0.3px; }
          .et-src-tag.tip { background:rgba(139,92,246,0.1); border:1px solid rgba(139,92,246,0.2); color:#a78bfa; }
          .et-src-tag.osint { background:rgba(0,212,255,0.08); border:1px solid rgba(0,212,255,0.15); color:var(--cyan); }
          .et-src-tag.vendor { background:rgba(245,158,11,0.08); border:1px solid rgba(245,158,11,0.15); color:var(--amber); }
          .et-src-tag.client { background:rgba(34,197,94,0.08); border:1px solid rgba(34,197,94,0.15); color:#22c55e; }

          .et-pipeline-flow { display:flex; align-items:center; gap:0; margin-bottom:20px; }
          .et-pipe-step { flex:1; text-align:center; padding:14px 8px; position:relative; }
          .et-pipe-step .pipe-icon { width:40px; height:40px; border-radius:10px; margin:0 auto 8px; display:flex; align-items:center; justify-content:center; font-size:18px; }
          .et-pipe-step .pipe-label { font-size:11px; font-weight:600; color:var(--text-primary); }
          .et-pipe-step .pipe-sub { font-size:9px; color:var(--text-muted); margin-top:2px; }
          .et-pipe-step::after { content:''; position:absolute; top:28px; right:-12px; width:24px; height:2px; background:rgba(255,255,255,0.08); }
          .et-pipe-step:last-child::after { display:none; }
          .et-pipe-step.step-tip .pipe-icon { background:rgba(139,92,246,0.1); border:1px solid rgba(139,92,246,0.2); }
          .et-pipe-step.step-ctx .pipe-icon { background:rgba(0,212,255,0.08); border:1px solid rgba(0,212,255,0.15); }
          .et-pipe-step.step-ai .pipe-icon { background:rgba(245,158,11,0.08); border:1px solid rgba(245,158,11,0.15); }
          .et-pipe-step.step-test .pipe-icon { background:rgba(34,197,94,0.08); border:1px solid rgba(34,197,94,0.15); }
          .et-pipe-step.step-repo .pipe-icon { background:rgba(0,212,255,0.04); border:1px solid rgba(0,212,255,0.1); }

          .et-threat-card { background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.06); border-radius:10px; padding:16px; margin-bottom:10px; transition:border-color .18s ease; }
          .et-threat-card:hover { border-color:rgba(0,212,255,0.2); }
          .et-threat-card .et-tc-header { display:flex; align-items:flex-start; justify-content:space-between; gap:12px; margin-bottom:10px; }
          .et-threat-card .et-tc-title { font-size:13px; font-weight:600; color:var(--text-primary); }
          .et-threat-card .et-tc-cve { font-family:var(--font-mono); font-size:10px; color:var(--red-bright); font-weight:700; background:rgba(239,68,68,0.08); padding:2px 8px; border-radius:4px; }
          .et-threat-card .et-tc-date { font-size:10px; color:var(--text-muted); font-family:var(--font-mono); }
          .et-threat-card .et-tc-desc { font-size:11px; color:var(--text-secondary); line-height:1.6; margin-bottom:10px; }
          .et-tc-context { display:flex; flex-wrap:wrap; gap:6px; margin-bottom:12px; }
          .et-ctx-chip { font-size:9px; font-weight:600; padding:3px 8px; border-radius:5px; display:flex; align-items:center; gap:4px; }
          .et-ctx-chip.match { background:rgba(34,197,94,0.08); border:1px solid rgba(34,197,94,0.15); color:#22c55e; }
          .et-ctx-chip.partial { background:rgba(245,158,11,0.08); border:1px solid rgba(245,158,11,0.15); color:var(--amber); }
          .et-ctx-chip.nodata { background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.08); color:var(--text-muted); }
          .et-tc-rules { background:rgba(0,0,0,0.2); border-radius:8px; padding:10px 14px; margin-bottom:12px; }
          .et-tc-rules .rule-row { display:flex; align-items:center; gap:10px; padding:6px 0; border-bottom:1px solid rgba(255,255,255,0.04); }
          .et-tc-rules .rule-row:last-child { border-bottom:none; }
          .et-tc-actions { display:flex; align-items:center; gap:8px; justify-content:flex-end; }
          .et-status-badge { font-size:9px; font-weight:700; padding:3px 10px; border-radius:6px; text-transform:uppercase; letter-spacing:0.5px; }
          .et-status-badge.new { background:rgba(139,92,246,0.12); color:#a78bfa; border:1px solid rgba(139,92,246,0.2); }
          .et-status-badge.testing { background:rgba(245,158,11,0.12); color:var(--amber); border:1px solid rgba(245,158,11,0.2); }
          .et-status-badge.validated { background:rgba(34,197,94,0.12); color:#22c55e; border:1px solid rgba(34,197,94,0.2); }
          .et-status-badge.rejected { background:rgba(239,68,68,0.08); color:var(--red-bright); border:1px solid rgba(239,68,68,0.15); }

          .et-filter-bar { display:flex; gap:8px; align-items:center; margin-bottom:16px; flex-wrap:wrap; }
          .et-filter-bar .filter-chip { font-size:11px; font-weight:500; padding:6px 14px; border-radius:8px; border:1px solid rgba(255,255,255,0.08); background:transparent; color:var(--text-secondary); cursor:pointer; transition:all .15s; }
          .et-filter-bar .filter-chip:hover { border-color:rgba(0,212,255,0.3); color:var(--text-primary); }
          .et-filter-bar .filter-chip.active { background:rgba(0,212,255,0.08); border-color:rgba(0,212,255,0.3); color:var(--cyan); font-weight:600; }
        </style>

        <div class="page-header">
          <div>
            <div class="page-title">Detection Rules</div>
            <div class="page-subtitle">2,847 rules across 48 log sources Â· Sigma-first, cross-platform detection-as-code</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm" onclick="showToast('Syncing rule repository from upstream...')">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg>
              Sync Repository
            </button>
            <button class="btn btn-secondary btn-sm" onclick="openBulkDeployModal()">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
              Bulk Deploy
            </button>
            <button class="btn btn-primary btn-sm" onclick="openCreateRuleModal()">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Create Rule
            </button>
          </div>
        </div>

        <!-- TAB NAVIGATION -->
        <div class="dr-tab-nav">
          <button class="dr-tab-btn active" data-drtab="repo" onclick="switchDrTab('repo')">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
            Rule Repository <span class="tab-count">2,847</span>
          </button>
          <button class="dr-tab-btn" data-drtab="builder" onclick="switchDrTab('builder')">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
            Rule Builder
          </button>
          <button class="dr-tab-btn" data-drtab="pipeline" onclick="switchDrTab('pipeline')">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="18" cy="18" r="3"/><circle cx="6" cy="6" r="3"/><path d="M13 6h3a2 2 0 012 2v7"/><path d="M6 9v12"/></svg>
            Deployment Pipeline
          </button>
          <button class="dr-tab-btn" data-drtab="coverage" onclick="switchDrTab('coverage')">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            Coverage Analytics
          </button>
          <button class="dr-tab-btn" data-drtab="emerging" onclick="switchDrTab('emerging')">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
            Emerging Threats <span class="tab-count" style="background:rgba(239,68,68,0.15);color:var(--red-bright);">Live</span>
          </button>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 1: RULE REPOSITORY
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="dr-panel active" id="dr-panel-repo">

          <!-- Stats Row -->
          <div class="dr-repo-stats">
            <div class="dr-stat-card cyan"><div class="val">2,847</div><div class="lbl">Total Rules</div></div>
            <div class="dr-stat-card green"><div class="val">1,923</div><div class="lbl">Sigma Rules</div></div>
            <div class="dr-stat-card purple"><div class="val">412</div><div class="lbl">Correlation</div></div>
            <div class="dr-stat-card amber"><div class="val">186</div><div class="lbl">Threshold</div></div>
            <div class="dr-stat-card red"><div class="val">98</div><div class="lbl">YARA Rules</div></div>
            <div class="dr-stat-card blue"><div class="val">228</div><div class="lbl">EQL/ML</div></div>
          </div>

          <!-- Filter Bar -->
          <div class="dr-filter-bar">
            <input class="filter-input" placeholder="Search rules by name, MITRE ID, log source..." style="flex:1;min-width:200px;" id="drRuleSearch">
            <select class="filter-select" id="drTypeFilter">
              <option value="">All Types</option>
              <option>Sigma</option>
              <option>YARA</option>
              <option>Correlation</option>
              <option>Threshold</option>
              <option>EQL</option>
              <option>ML Anomaly</option>
            </select>
            <select class="filter-select" id="drSeverityFilter">
              <option value="">All Severities</option>
              <option>Critical</option>
              <option>High</option>
              <option>Medium</option>
              <option>Low</option>
              <option>Informational</option>
            </select>
            <select class="filter-select" id="drLogSourceFilter">
              <option value="">All Log Sources</option>
              <option>Windows Security</option>
              <option>Windows Sysmon</option>
              <option>Linux Auditd</option>
              <option>Microsoft 365</option>
              <option>Azure AD</option>
              <option>FortiGate</option>
              <option>Cisco ASA</option>
              <option>AWS CloudTrail</option>
              <option>GCP Audit</option>
              <option>CrowdStrike</option>
              <option>Trend Vision One</option>
              <option>DNS Logs</option>
              <option>Proxy/Web</option>
              <option>Modbus/OPC UA</option>
            </select>
            <select class="filter-select" id="drAuthorFilter">
              <option value="">All Authors</option>
              <option>Dacta SOC</option>
              <option>Community (Sigma HQ)</option>
              <option>Custom / Client</option>
            </select>
            <select class="filter-select" id="drStatusFilter">
              <option value="">All Statuses</option>
              <option>Production</option>
              <option>Testing</option>
              <option>Draft</option>
              <option>Deprecated</option>
            </select>
          </div>

          <!-- Rule Table -->
          <div class="card" style="margin-bottom:16px;">
            <div class="card-header">
              <span class="card-title">Detection Rule Repository</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <span class="badge badge-cyan">2,847 rules</span>
                <span class="badge badge-green">48 log sources</span>
                <button class="btn btn-xs btn-secondary" onclick="showToast('Exporting rule pack as Sigma YAML bundle...')">Export Pack</button>
              </div>
            </div>
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th style="width:90px;">Rule ID</th>
                    <th>Name</th>
                    <th style="width:80px;">Type</th>
                    <th style="width:100px;">MITRE</th>
                    <th style="width:70px;">Severity</th>
                    <th>Log Sources</th>
                    <th style="width:70px;">Author</th>
                    <th style="width:50px;">Ver</th>
                    <th style="width:70px;">Status</th>
                    <th style="width:55px;">FP Rate</th>
                    <th style="width:60px;">Hits 7d</th>
                    <th style="width:90px;">Actions</th>
                  </tr>
                </thead>
                <tbody id="drRepoTableBody"></tbody>
              </table>
              <div id="drRepoPagination" style="display:flex;align-items:center;justify-content:space-between;padding:10px 14px;background:rgba(15,23,42,0.5);border:1px solid rgba(0,212,255,0.08);border-top:none;border-radius:0 0 8px 8px;flex-wrap:wrap;gap:8px;"></div>
            </div>
          </div>

          <!-- Rules with Updated Syntax -->
          <div class="card">
            <div class="card-header">
              <span class="card-title">Rules with Updated Syntax</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <span class="badge badge-amber" style="font-size:9px;">7 RULES OUTDATED</span>
                <span style="font-size:10px;color:var(--text-muted);">AI scans global vendor log schema changes daily Â· Last scan: 2 hrs ago</span>
              </div>
            </div>
            <div style="margin-bottom:10px;padding:10px 14px;background:rgba(0,212,255,0.03);border:1px solid rgba(0,212,255,0.08);border-radius:8px;">
              <div style="font-size:10px;color:var(--text-secondary);line-height:1.7;">
                DACTA AI continuously monitors log schema documentation, changelogs, and release notes from <strong style="color:var(--text-primary);">all major vendors worldwide</strong> â€” including Microsoft, CrowdStrike, Palo Alto, Fortinet, Cisco, AWS, GCP, Azure, SentinelOne, Trend Micro, Elastic, Splunk, and 200+ others. When a vendor updates field names, event IDs, log formats, or deprecates syntax, any affected rules in the repository are flagged here for testing and update.
              </div>
            </div>
            <div style="display:flex;flex-direction:column;gap:6px;" id="syntaxUpdateList">

              <!-- Syntax Update 1: Critical - Windows Event ID change -->
              <div style="padding:12px 14px;background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.12);border-radius:8px;">
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                  <div style="width:7px;height:7px;border-radius:50%;background:var(--red-bright);flex-shrink:0;"></div>
                  <div style="flex:1;">
                    <div style="font-size:12px;font-weight:600;color:var(--text-primary);">23 Sigma Rules â€” Windows Security Event ID Schema Change</div>
                    <div style="font-size:10px;color:var(--text-muted);">Microsoft updated Event ID 4688 field mapping in Windows Server 2026 CU3 Â· Detected 6 hrs ago</div>
                  </div>
                  <span class="badge badge-red" style="font-size:9px;">23 Rules</span>
                </div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px;">
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:4px;color:var(--text-muted);">Vendor: <strong style="color:var(--text-primary);">Microsoft</strong></span>
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:4px;color:var(--text-muted);">Log: <strong style="color:var(--text-primary);">Windows Security</strong></span>
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(239,68,68,0.06);border:1px solid rgba(239,68,68,0.12);border-radius:4px;color:var(--red-bright);">Field Changed: <strong>NewProcessName â†’ ProcessName</strong></span>
                </div>
                <div style="background:rgba(0,0,0,0.2);border-radius:6px;padding:8px 12px;margin-bottom:10px;font-family:var(--font-mono);font-size:10px;line-height:1.7;">
                  <div style="color:var(--red-bright);text-decoration:line-through;opacity:0.6;">- selection.NewProcessName|endswith: '\\cmd.exe'</div>
                  <div style="color:#22c55e;">+ selection.ProcessName|endswith: '\\cmd.exe'</div>
                  <div style="color:var(--text-muted);margin-top:4px;font-style:italic;">... and 22 more rules with similar field reference updates</div>
                </div>
                <div style="display:flex;gap:8px;justify-content:flex-end;">
                  <button class="btn btn-xs btn-secondary" onclick="showToast('Viewing all 23 affected rules with diff preview...')">View All Changes</button>
                  <button class="btn btn-xs btn-primary" onclick="showToast('Sending 23 updated rules to Rule Testing Lab...')">Send to Testing</button>
                </div>
              </div>

              <!-- Syntax Update 2: FortiGate log format -->
              <div style="padding:12px 14px;background:rgba(245,158,11,0.04);border:1px solid rgba(245,158,11,0.12);border-radius:8px;">
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                  <div style="width:7px;height:7px;border-radius:50%;background:var(--amber);flex-shrink:0;"></div>
                  <div style="flex:1;">
                    <div style="font-size:12px;font-weight:600;color:var(--text-primary);">8 Sigma Rules â€” FortiGate Log Format v7.6 Update</div>
                    <div style="font-size:10px;color:var(--text-muted);">Fortinet restructured UTM log fields in FortiOS 7.6.1 release Â· Detected 14 hrs ago</div>
                  </div>
                  <span class="badge badge-amber" style="font-size:9px;">8 Rules</span>
                </div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px;">
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:4px;color:var(--text-muted);">Vendor: <strong style="color:var(--text-primary);">Fortinet</strong></span>
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:4px;color:var(--text-muted);">Log: <strong style="color:var(--text-primary);">FortiGate UTM / Traffic</strong></span>
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(245,158,11,0.06);border:1px solid rgba(245,158,11,0.12);border-radius:4px;color:var(--amber);">Fields Changed: <strong>srcip/dstip â†’ src_ip/dst_ip + 3 more</strong></span>
                </div>
                <div style="background:rgba(0,0,0,0.2);border-radius:6px;padding:8px 12px;margin-bottom:10px;font-family:var(--font-mono);font-size:10px;line-height:1.7;">
                  <div style="color:var(--red-bright);text-decoration:line-through;opacity:0.6;">- selection.srcip: '10.0.0.0/8'</div>
                  <div style="color:#22c55e;">+ selection.src_ip: '10.0.0.0/8'</div>
                  <div style="color:var(--red-bright);text-decoration:line-through;opacity:0.6;">- selection.action: 'blocked'</div>
                  <div style="color:#22c55e;">+ selection.utm_action: 'deny'</div>
                </div>
                <div style="display:flex;gap:8px;justify-content:flex-end;">
                  <button class="btn btn-xs btn-secondary" onclick="showToast('Viewing all 8 affected rules with diff preview...')">View All Changes</button>
                  <button class="btn btn-xs btn-primary" onclick="showToast('Sending 8 updated rules to Rule Testing Lab...')">Send to Testing</button>
                </div>
              </div>

              <!-- Syntax Update 3: CrowdStrike Falcon -->
              <div style="padding:12px 14px;background:rgba(245,158,11,0.04);border:1px solid rgba(245,158,11,0.12);border-radius:8px;">
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                  <div style="width:7px;height:7px;border-radius:50%;background:var(--amber);flex-shrink:0;"></div>
                  <div style="flex:1;">
                    <div style="font-size:12px;font-weight:600;color:var(--text-primary);">5 Sigma Rules â€” CrowdStrike Falcon Event Stream v3 API Migration</div>
                    <div style="font-size:10px;color:var(--text-muted);">CrowdStrike deprecated Event Stream v2 fields in Falcon 7.x Â· Detected 1 day ago</div>
                  </div>
                  <span class="badge badge-amber" style="font-size:9px;">5 Rules</span>
                </div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px;">
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:4px;color:var(--text-muted);">Vendor: <strong style="color:var(--text-primary);">CrowdStrike</strong></span>
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:4px;color:var(--text-muted);">Log: <strong style="color:var(--text-primary);">Falcon Event Stream</strong></span>
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(245,158,11,0.06);border:1px solid rgba(245,158,11,0.12);border-radius:4px;color:var(--amber);">API: <strong>v2 â†’ v3 (deprecated fields)</strong></span>
                </div>
                <div style="background:rgba(0,0,0,0.2);border-radius:6px;padding:8px 12px;margin-bottom:10px;font-family:var(--font-mono);font-size:10px;line-height:1.7;">
                  <div style="color:var(--red-bright);text-decoration:line-through;opacity:0.6;">- detection_name: 'ProcessRollup2'</div>
                  <div style="color:#22c55e;">+ event_type: 'ProcessActivity' (v3 schema)</div>
                  <div style="color:var(--text-muted);margin-top:4px;font-style:italic;">... and 4 more rules affected by v2 â†’ v3 field migration</div>
                </div>
                <div style="display:flex;gap:8px;justify-content:flex-end;">
                  <button class="btn btn-xs btn-secondary" onclick="showToast('Viewing all 5 affected rules with diff preview...')">View All Changes</button>
                  <button class="btn btn-xs btn-primary" onclick="showToast('Sending 5 updated rules to Rule Testing Lab...')">Send to Testing</button>
                </div>
              </div>

              <!-- Syntax Update 4: AWS CloudTrail - Already tested & updated -->
              <div style="padding:12px 14px;background:rgba(34,197,94,0.03);border:1px solid rgba(34,197,94,0.1);border-radius:8px;opacity:0.7;">
                <div style="display:flex;align-items:center;gap:10px;">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg>
                  <div style="flex:1;">
                    <div style="font-size:12px;font-weight:600;color:var(--text-primary);">12 Rules â€” AWS CloudTrail eventVersion 2.0 Field Updates</div>
                    <div style="font-size:10px;color:var(--text-muted);">Tested and updated into repo 3 days ago Â· All 12 rules passed validation</div>
                  </div>
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(34,197,94,0.08);border:1px solid rgba(34,197,94,0.15);border-radius:4px;color:#22c55e;">Vendor: <strong>AWS</strong></span>
                  <span class="badge badge-green" style="font-size:9px;">Updated</span>
                </div>
              </div>

              <!-- Syntax Update 5: Trend Micro - Already tested & updated -->
              <div style="padding:12px 14px;background:rgba(34,197,94,0.03);border:1px solid rgba(34,197,94,0.1);border-radius:8px;opacity:0.7;">
                <div style="display:flex;align-items:center;gap:10px;">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg>
                  <div style="flex:1;">
                    <div style="font-size:12px;font-weight:600;color:var(--text-primary);">3 Rules â€” Trend Vision One XDR Workbench Schema v4</div>
                    <div style="font-size:10px;color:var(--text-muted);">Tested and updated into repo 5 days ago Â· All 3 rules passed validation</div>
                  </div>
                  <span style="font-size:9px;font-family:var(--font-mono);padding:2px 7px;background:rgba(34,197,94,0.08);border:1px solid rgba(34,197,94,0.15);border-radius:4px;color:#22c55e;">Vendor: <strong>Trend Micro</strong></span>
                  <span class="badge badge-green" style="font-size:9px;">Updated</span>
                </div>
              </div>

            </div>
          </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 2: RULE BUILDER  (IDE-like creation)
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="dr-panel" id="dr-panel-builder">
          <div style="display:grid;grid-template-columns:1fr 320px;gap:16px;">
            <!-- Left: IDE Editor -->
            <div>
              <div class="dr-ide">
                <div class="dr-ide-toolbar">
                  <div class="dr-ide-tabs">
                    <button class="dr-ide-tab active" onclick="switchIdeTab(this,'sigma')">Sigma YAML</button>
                    <button class="dr-ide-tab" onclick="switchIdeTab(this,'eql')">Elastic EQL</button>
                    <button class="dr-ide-tab" onclick="switchIdeTab(this,'kql')">Splunk SPL</button>
                    <button class="dr-ide-tab" onclick="switchIdeTab(this,'chronicle')">Chronicle YARA-L</button>
                  </div>
                  <div style="display:flex;gap:6px;align-items:center;">
                    <button class="btn btn-xs btn-secondary" onclick="showToast('Syntax validated â€” no errors')">
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                      Validate
                    </button>
                    <button class="btn btn-xs btn-secondary" onclick="showToast('AI auto-completing rule logic...')">
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a4 4 0 014 4c0 1.95-2 3-2 8h-4c0-5-2-6.05-2-8a4 4 0 014-4z"/><line x1="10" y1="22" x2="14" y2="22"/><line x1="10" y1="18" x2="14" y2="18"/></svg>
                      AI Assist
                    </button>
                  </div>
                </div>
                <div class="dr-ide-body">
                  <div class="dr-ide-lines" id="drIdeLines">1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>32<br>33<br>34<br>35</div>
                  <div class="dr-ide-code" id="drIdeCode" contenteditable="true" spellcheck="false" style="opacity:0.45;transition:opacity 0.2s;" onfocus="this.style.opacity='1';this.dataset.edited='1';" onblur="if(!this.dataset.edited||this.dataset.edited==='0')this.style.opacity='0.45';"><span class="field">title:</span> <span class="str">Suspicious LSASS Memory Access via Non-Standard Process</span>
<span class="field">id:</span> <span class="str">d8c9b2a1-4e7f-4a3b-8c1d-9f2e6b4a7d3c</span>
<span class="field">status:</span> <span class="str">experimental</span>
<span class="field">description:</span> <span class="str">|</span>
  <span class="cmt">Detects access to LSASS process memory from non-standard</span>
  <span class="cmt">processes that typically don't need credential access.</span>
  <span class="cmt">Excludes known legitimate tools (AV, EDR agents).</span>
<span class="field">references:</span>
  - <span class="str">https://attack.mitre.org/techniques/T1003/001/</span>
  - <span class="str">https://docs.microsoft.com/en-us/sysinternals/</span>
<span class="field">author:</span> <span class="str">Dacta SOC Team</span>
<span class="field">date:</span> <span class="num">2026/02/28</span>
<span class="field">modified:</span> <span class="num">2026/02/28</span>
<span class="field">tags:</span>
  - <span class="tag">attack.credential_access</span>
  - <span class="tag">attack.t1003.001</span>
  - <span class="tag">detection.emerging_threats</span>
<span class="field">logsource:</span>
  <span class="field">category:</span> <span class="str">process_access</span>
  <span class="field">product:</span> <span class="str">windows</span>
<span class="field">detection:</span>
  <span class="field">selection:</span>
    <span class="field">TargetImage|endswith:</span> <span class="str">'\lsass.exe'</span>
    <span class="field">GrantedAccess|contains:</span>
      - <span class="str">'0x1010'</span>  <span class="cmt"># PROCESS_QUERY_LIMITED + VM_READ</span>
      - <span class="str">'0x1410'</span>  <span class="cmt"># + PROCESS_QUERY_INFORMATION</span>
      - <span class="str">'0x1F0FFF'</span> <span class="cmt"># FULL_ACCESS</span>
  <span class="field">filter_main:</span>
    <span class="field">SourceImage|endswith:</span>
      - <span class="str">'\MsMpEng.exe'</span>
      - <span class="str">'\SentinelAgent.exe'</span>
      - <span class="str">'\CylanceSvc.exe'</span>
  <span class="field">condition:</span> <span class="kw">selection</span> <span class="op">and not</span> <span class="kw">filter_main</span>
<span class="field">falsepositives:</span>
  - <span class="str">Legitimate admin tools accessing LSASS</span>
<span class="field">level:</span> <span class="str">high</span></div>
                </div>
                <div class="dr-ide-status">
                  <div style="display:flex;gap:12px;">
                    <span>Sigma YAML</span>
                    <span>Lines: 35</span>
                    <span>UTF-8</span>
                  </div>
                  <div style="display:flex;gap:12px;">
                    <span style="color:var(--green);">&#10003; Valid syntax</span>
                    <span>Confidence: <span style="color:var(--green);font-weight:700;">92%</span></span>
                  </div>
                </div>
              </div>

              <!-- Auto-Translate Output -->
              <div class="dr-translate-panel">
                <div class="dr-translate-header">
                  <div style="display:flex;align-items:center;gap:10px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"/></svg>
                    <span style="font-size:12px;font-weight:600;color:var(--text-primary);">Auto-Translate (Uncoder Engine)</span>
                  </div>
                  <div style="display:flex;gap:6px;">
                    <select class="filter-select" style="font-size:10px;" id="drTranslateTarget">
                      <option>Elastic EQL</option>
                      <option>Elastic KQL</option>
                      <option>Splunk SPL</option>
                      <option>Microsoft Sentinel KQL</option>
                      <option>Chronicle YARA-L</option>
                      <option>QRadar AQL</option>
                      <option>CrowdStrike Logscale</option>
                      <option>Sumo Logic</option>
                      <option>Palo Alto Cortex XDR</option>
                    </select>
                    <button class="btn btn-xs btn-primary" onclick="showToast('Translated to Elastic EQL â€” ready for deployment')">Translate</button>
                  </div>
                </div>
                <div class="dr-translate-body"><span class="kw">process</span> <span class="kw">where</span> <span class="field">event.category</span> <span class="op">==</span> <span class="str">"process_access"</span>
  <span class="op">and</span> <span class="field">TargetImage</span> <span class="op">like~</span> <span class="str">"*\\lsass.exe"</span>
  <span class="op">and</span> <span class="field">GrantedAccess</span> <span class="kw">in</span> (<span class="str">"0x1010"</span>, <span class="str">"0x1410"</span>, <span class="str">"0x1F0FFF"</span>)
  <span class="op">and not</span> <span class="field">SourceImage</span> <span class="kw">in</span> (
    <span class="str">"*\\MsMpEng.exe"</span>,
    <span class="str">"*\\SentinelAgent.exe"</span>,
    <span class="str">"*\\CylanceSvc.exe"</span>
  )</div>
              </div>
            </div>

            <!-- Right: Rule Metadata Sidebar -->
            <div class="dr-create-sidebar">
              <div style="font-size:14px;font-weight:700;color:var(--text-primary);margin-bottom:14px;">Rule Properties</div>

              <div class="dr-field-group">
                <div class="dr-field-label">Rule Type</div>
                <select class="filter-select" style="width:100%;">
                  <option>Sigma (Recommended)</option>
                  <option>YARA</option>
                  <option>Correlation Rule</option>
                  <option>Threshold Rule</option>
                  <option>EQL Native</option>
                  <option>ML Anomaly Baseline</option>
                </select>
              </div>

              <div class="dr-field-group">
                <div class="dr-field-label">Severity</div>
                <div style="display:flex;gap:6px;">
                  <button class="btn btn-xs" style="background:rgba(239,68,68,0.15);color:var(--red-bright);border:1px solid rgba(239,68,68,0.3);">Critical</button>
                  <button class="btn btn-xs" style="background:rgba(245,158,11,0.15);color:var(--amber);border:1px solid rgba(245,158,11,0.3);">High</button>
                  <button class="btn btn-xs" style="background:rgba(96,165,250,0.15);color:#60a5fa;border:1px solid rgba(96,165,250,0.3);">Medium</button>
                  <button class="btn btn-xs" style="background:rgba(100,116,139,0.15);color:#94a3b8;border:1px solid rgba(100,116,139,0.3);">Low</button>
                </div>
              </div>

              <div class="dr-field-group">
                <div class="dr-field-label">MITRE ATT&amp;CK Mapping</div>
                <div style="display:flex;flex-wrap:wrap;gap:4px;margin-bottom:6px;">
                  <span class="mitre-tag">T1003.001</span>
                  <button class="btn btn-xs btn-secondary" style="font-size:9px;">+ Add</button>
                </div>
              </div>

              <div class="dr-field-group">
                <div class="dr-field-label">Compatible Log Sources</div>
                <div style="display:flex;flex-wrap:wrap;gap:4px;">
                  <span class="logsrc-tag windows">Windows Sysmon</span>
                  <span class="logsrc-tag windows">Windows Security</span>
                  <span class="logsrc-tag edr">CrowdStrike</span>
                  <button class="btn btn-xs btn-secondary" style="font-size:9px;">+ Add</button>
                </div>
              </div>

              <div class="dr-field-group">
                <div class="dr-field-label">Confidence Score</div>
                <div style="display:flex;align-items:center;gap:8px;">
                  <div style="flex:1;height:6px;background:rgba(255,255,255,0.06);border-radius:3px;overflow:hidden;">
                    <div style="width:92%;height:100%;background:linear-gradient(90deg,var(--green),var(--cyan));border-radius:3px;"></div>
                  </div>
                  <span style="font-family:var(--font-mono);font-size:13px;font-weight:700;color:var(--green);">92%</span>
                </div>
              </div>

              <div class="dr-field-group">
                <div class="dr-field-label">Deploy to Client SIEMs</div>
                <div class="dr-siem-target selected" onclick="this.classList.toggle('selected')">
                  <div><div class="siem-name">Elastic SIEM (Dacta Global)</div><div class="siem-ver">v8.12.1</div></div>
                  <div class="dr-siem-check">&#10003;</div>
                </div>
                <div class="dr-siem-target selected" onclick="this.classList.toggle('selected')">
                  <div><div class="siem-name">Elastic SIEM (SPMT)</div><div class="siem-ver">v8.12.1</div></div>
                  <div class="dr-siem-check">&#10003;</div>
                </div>
                <div class="dr-siem-target" onclick="this.classList.toggle('selected')">
                  <div><div class="siem-name">Elastic SIEM (Global Advisor)</div><div class="siem-ver">v8.12.1</div></div>
                  <div class="dr-siem-check"></div>
                </div>
              </div>

              <div class="dr-field-group">
                <div class="dr-field-label">False Positive Exclusions</div>
                <textarea class="esc-input" rows="2" style="width:100%;resize:vertical;font-family:var(--font-mono);font-size:10px;" placeholder="Add known false positive patterns...">MsMpEng.exe, SentinelAgent.exe, CylanceSvc.exe</textarea>
              </div>

              <div style="display:flex;gap:8px;margin-top:16px;">
                <button class="btn btn-primary" style="flex:1;justify-content:center;" onclick="saveAndTestRule()">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/></svg>
                  Save &amp; Test
                </button>
                <button class="btn btn-secondary" onclick="showToast('Rule saved as draft')">Draft</button>
              </div>
            </div>
          </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 3: DEPLOYMENT PIPELINE
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="dr-panel" id="dr-panel-pipeline">

          <!-- Pipeline Visualization -->
          <div class="card" style="margin-bottom:16px;">
            <div class="card-header"><span class="card-title">CI/CD Detection Pipeline</span><span class="badge badge-cyan">Detection-as-Code</span></div>
            <div class="dr-pipeline">
              <div class="dr-pipe-stage">
                <div class="dr-pipe-icon draft">
                  <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#64748b" stroke-width="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                </div>
                <div class="dr-pipe-count draft-c" id="drPipeCountDraft">â€”</div>
                <div class="dr-pipe-label">Draft</div>
                <div class="dr-pipe-sub">Authored / AI-generated</div>
              </div>
              <div class="dr-pipe-stage">
                <div class="dr-pipe-icon test">
                  <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><path d="M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a6 6 0 01-7.94 7.94l-6.91 6.91a2.12 2.12 0 01-3-3l6.91-6.91a6 6 0 017.94-7.94l-3.76 3.76z"/></svg>
                </div>
                <div class="dr-pipe-count test-c" id="drPipeCountTest">â€”</div>
                <div class="dr-pipe-label">Testing</div>
                <div class="dr-pipe-sub">Backtested against logs</div>
              </div>
              <div class="dr-pipe-stage">
                <div class="dr-pipe-icon review">
                  <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#a78bfa" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                </div>
                <div class="dr-pipe-count review-c">5</div>
                <div class="dr-pipe-label">Peer Review</div>
                <div class="dr-pipe-sub">SOC lead approval</div>
              </div>
              <div class="dr-pipe-stage">
                <div class="dr-pipe-icon staging">
                  <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fbbf24" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                </div>
                <div class="dr-pipe-count staging-c">3</div>
                <div class="dr-pipe-label">Staging</div>
                <div class="dr-pipe-sub">Shadow mode (alert only)</div>
              </div>
              <div class="dr-pipe-stage">
                <div class="dr-pipe-icon prod">
                  <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--green)" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                </div>
                <div class="dr-pipe-count prod-c" id="drPipeCountProd">â€”</div>
                <div class="dr-pipe-label">Production</div>
                <div class="dr-pipe-sub">Active in client SIEMs</div>
              </div>
            </div>
          </div>

          <!-- Rules in Pipeline -->
          <div class="card" style="margin-bottom:16px;">
            <div class="card-header"><span class="card-title">Rules in Pipeline</span><span class="badge badge-amber" id="drPipelineBadge">Loading...</span></div>
            <div class="table-wrap">
              <table>
                <thead><tr><th>Rule ID</th><th>Name</th><th>Author</th><th>Stage</th><th>FP Rate</th><th>Log Sources</th><th>Actions</th></tr></thead>
                <tbody id="drPipelineTableBody"></tbody>
              </table>
            </div>
          </div>

          <!-- Deployment History / Version Control -->
          <div class="card">
            <div class="card-header"><span class="card-title">Deployment History (Git-like Version Control)</span><span class="badge badge-green">Last deploy: 2h ago</span></div>
            <div style="display:flex;flex-direction:column;">
              <div class="dr-version-row">
                <div class="dr-version-hash">a3f8c2d</div>
                <div class="dr-version-msg">Deploy: CVE-2026-21412 Kernel EoP rule to all SOCaaS SIEMs</div>
                <div class="dr-version-author">John Lim</div>
                <div class="dr-version-time">2h ago</div>
                <button class="btn btn-xs btn-secondary">Rollback</button>
              </div>
              <div class="dr-version-row">
                <div class="dr-version-hash">b7e4d1a</div>
                <div class="dr-version-msg">Update: Black Basta correlation rules â€” FP exclusion added</div>
                <div class="dr-version-author">Sarah Tan</div>
                <div class="dr-version-time">6h ago</div>
                <button class="btn btn-xs btn-secondary">Rollback</button>
              </div>
              <div class="dr-version-row">
                <div class="dr-version-hash">c9a2f3b</div>
                <div class="dr-version-msg">Deploy: 3 new M365 Sigma rules to Dacta Global + SPMT</div>
                <div class="dr-version-author">Kevin Toh</div>
                <div class="dr-version-time">1d ago</div>
                <button class="btn btn-xs btn-secondary">Rollback</button>
              </div>
              <div class="dr-version-row">
                <div class="dr-version-hash">d1c8e5f</div>
                <div class="dr-version-msg">Tune: RUL-0147 ransomware threshold 50â†’100, process exclusion</div>
                <div class="dr-version-author">Kevin Toh</div>
                <div class="dr-version-time">2d ago</div>
                <button class="btn btn-xs btn-secondary">Rollback</button>
              </div>
              <div class="dr-version-row">
                <div class="dr-version-hash">e4b7a9c</div>
                <div class="dr-version-msg">Bulk import: 47 SigmaHQ community rules (weekly sync)</div>
                <div class="dr-version-author">Auto-Sync</div>
                <div class="dr-version-time">3d ago</div>
                <button class="btn btn-xs btn-secondary">Rollback</button>
              </div>
            </div>
          </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 4: COVERAGE ANALYTICS
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="dr-panel" id="dr-panel-coverage">

          <!-- Coverage Stats -->
          <div class="dr-repo-stats" style="grid-template-columns:repeat(4,1fr);margin-bottom:16px;">
            <div class="dr-stat-card green"><div class="val" id="covStatTotal">â€”</div><div class="lbl">Total Rules</div></div>
            <div class="dr-stat-card amber"><div class="val" id="covStatLogSources">â€”</div><div class="lbl">Log Source Types</div></div>
            <div class="dr-stat-card cyan"><div class="val" id="covStatProduction">â€”</div><div class="lbl">Production Rules</div></div>
            <div class="dr-stat-card red"><div class="val" id="covStatCritical">â€”</div><div class="lbl">Critical Severity</div></div>
          </div>

          <!-- MITRE Heatmap -->
          <div class="card" style="margin-bottom:16px;">
            <div class="card-header"><span class="card-title">MITRE ATT&amp;CK Coverage Heatmap</span><div style="display:flex;gap:10px;font-size:10px;align-items:center;"><span style="display:flex;align-items:center;gap:4px;"><span style="width:10px;height:10px;display:inline-block;background:rgba(0,212,255,0.3);border-radius:2px;"></span>Covered</span><span style="display:flex;align-items:center;gap:4px;"><span style="width:10px;height:10px;display:inline-block;background:rgba(245,158,11,0.2);border-radius:2px;"></span>Partial</span><span style="display:flex;align-items:center;gap:4px;"><span style="width:10px;height:10px;display:inline-block;background:rgba(255,255,255,0.03);border-radius:2px;"></span>None</span></div></div>
            <div class="mitre-grid" id="mitreGrid"></div>
          </div>

          <!-- MITRE ATT&CK for ICS (below IT MITRE, same visual format) -->
          <div class="card" style="margin-bottom:16px;">
            <div class="card-header"><span class="card-title">MITRE ATT&amp;CK for ICS / OT</span><div style="display:flex;gap:10px;font-size:10px;align-items:center;"><span class="badge badge-orange" style="margin-right:8px;">OT Coverage &middot; 29%</span><span style="display:flex;align-items:center;gap:4px;"><span style="width:10px;height:10px;display:inline-block;background:rgba(249,115,22,0.3);border-radius:2px;"></span>Covered</span><span style="display:flex;align-items:center;gap:4px;"><span style="width:10px;height:10px;display:inline-block;background:rgba(245,158,11,0.2);border-radius:2px;"></span>Partial</span><span style="display:flex;align-items:center;gap:4px;"><span style="width:10px;height:10px;display:inline-block;background:rgba(255,255,255,0.03);border-radius:2px;"></span>None</span></div></div>
            <div class="mitre-grid" id="mitreIcsGrid"></div>
            <div style="display:flex;align-items:center;justify-content:space-between;padding:12px 0 0;border-top:1px solid var(--border-subtle);margin-top:12px;">
              <div style="display:flex;align-items:center;gap:10px;"><span style="font-size:18px;font-weight:800;color:var(--orange);font-family:var(--font-mono);">29%</span><div><div style="font-size:11px;color:var(--text-secondary);">23 / 78 ICS techniques covered</div><div style="font-size:10px;color:var(--text-muted);">OT monitoring requires specialized log sources (Modbus, DNP3, OPC UA)</div></div></div>
              <button class="btn btn-sm btn-secondary" style="white-space:nowrap;">Configure OT Log Sources</button>
            </div>
          </div>

          <!-- Kill Chain -->
          <div class="card" style="margin-bottom:16px;">
            <div class="card-header"><span class="card-title">Lockheed Martin Cyber Kill Chain</span><span class="badge badge-cyan">108 rules mapped</span></div>
            <div class="kc-pipeline">
              <div class="kc-phase"><div class="kc-card coverage-med"><div class="kc-number">Phase 1</div><div class="kc-name">Reconnaissance</div><div class="kc-rules" style="color:var(--amber);">12</div><div class="kc-rules-label">Detection Rules</div><div class="kc-progress"><div class="kc-progress-fill med" style="width:65%;"></div></div><div class="kc-coverage med">65%</div></div></div>
              <div class="kc-phase"><div class="kc-card coverage-med"><div class="kc-number">Phase 2</div><div class="kc-name">Weaponization</div><div class="kc-rules" style="color:var(--amber);">8</div><div class="kc-rules-label">Detection Rules</div><div class="kc-progress"><div class="kc-progress-fill med" style="width:45%;"></div></div><div class="kc-coverage med">45%</div></div></div>
              <div class="kc-phase"><div class="kc-card coverage-high"><div class="kc-number">Phase 3</div><div class="kc-name">Delivery</div><div class="kc-rules" style="color:var(--green);">22</div><div class="kc-rules-label">Detection Rules</div><div class="kc-progress"><div class="kc-progress-fill high" style="width:82%;"></div></div><div class="kc-coverage high">82%</div></div></div>
              <div class="kc-phase"><div class="kc-card coverage-high"><div class="kc-number">Phase 4</div><div class="kc-name">Exploitation</div><div class="kc-rules" style="color:var(--green);">18</div><div class="kc-rules-label">Detection Rules</div><div class="kc-progress"><div class="kc-progress-fill high" style="width:71%;"></div></div><div class="kc-coverage high">71%</div></div></div>
              <div class="kc-phase"><div class="kc-card coverage-med"><div class="kc-number">Phase 5</div><div class="kc-name">Installation</div><div class="kc-rules" style="color:var(--amber);">15</div><div class="kc-rules-label">Detection Rules</div><div class="kc-progress"><div class="kc-progress-fill med" style="width:58%;"></div></div><div class="kc-coverage med">58%</div></div></div>
              <div class="kc-phase"><div class="kc-card coverage-high"><div class="kc-number">Phase 6</div><div class="kc-name">Command &amp; Control</div><div class="kc-rules" style="color:var(--green);">24</div><div class="kc-rules-label">Detection Rules</div><div class="kc-progress"><div class="kc-progress-fill high" style="width:89%;"></div></div><div class="kc-coverage high">89%</div></div></div>
              <div class="kc-phase"><div class="kc-card coverage-med"><div class="kc-number">Phase 7</div><div class="kc-name">Actions on Objectives</div><div class="kc-rules" style="color:var(--amber);">9</div><div class="kc-rules-label">Detection Rules</div><div class="kc-progress"><div class="kc-progress-fill med" style="width:42%;"></div></div><div class="kc-coverage med">42%</div></div></div>
            </div>
          </div>

          <!-- Blind Spot Analysis -->
          <div class="dr-coverage-grid">
            <div class="card">
              <div class="card-header"><span class="card-title">Detection Blind Spots</span><span class="badge badge-red">34 gaps</span></div>
              <div style="display:flex;flex-direction:column;gap:6px;max-height:320px;overflow-y:auto;">
                <div class="dr-gap-item">
                  <div style="flex:1;"><div class="technique">T1134 â€” Access Token Manipulation</div><div class="desc">No rules covering token theft/impersonation via Windows APIs</div></div>
                  <button class="btn btn-xs btn-primary action-btn" onclick="showToast('AI generating Sigma rule for T1134...')">Generate Rule</button>
                </div>
                <div class="dr-gap-item">
                  <div style="flex:1;"><div class="technique">T1037 â€” Boot/Logon Init Scripts</div><div class="desc">Missing startup folder monitoring and registry run key detection</div></div>
                  <button class="btn btn-xs btn-primary action-btn" onclick="showToast('AI generating Sigma rule for T1037...')">Generate Rule</button>
                </div>
                <div class="dr-gap-item">
                  <div style="flex:1;"><div class="technique">T1534 â€” Internal Spearphishing</div><div class="desc">No correlation rule for internal email-based lateral movement</div></div>
                  <button class="btn btn-xs btn-primary action-btn" onclick="showToast('AI generating correlation rule...')">Generate Rule</button>
                </div>
                <div class="dr-gap-item">
                  <div style="flex:1;"><div class="technique">T1491 â€” Defacement</div><div class="desc">Web defacement detection requires HTTP response monitoring</div></div>
                  <button class="btn btn-xs btn-primary action-btn" onclick="showToast('AI generating detection rule...')">Generate Rule</button>
                </div>
                <div class="dr-gap-item">
                  <div style="flex:1;"><div class="technique">T0800 â€” Activate Firmware Update Mode (ICS)</div><div class="desc">OT firmware manipulation â€” requires Modbus/OPC UA log source</div></div>
                  <button class="btn btn-xs btn-secondary action-btn" onclick="showToast('Log source not available â€” configure OT sources first')">Needs Log Source</button>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header"><span class="card-title">Log Source Coverage Matrix</span></div>
              <div id="drLogSourceMatrix" style="display:flex;flex-direction:column;gap:6px;">
                <div style="display:flex;align-items:center;gap:10px;padding:6px 0;">
                  <span class="logsrc-tag windows" style="width:130px;">Windows Security</span>
                  <div style="flex:1;height:8px;background:rgba(255,255,255,0.06);border-radius:4px;overflow:hidden;"><div style="width:94%;height:100%;background:var(--green);border-radius:4px;"></div></div>
                  <span style="font-family:var(--font-mono);font-size:11px;color:var(--green);font-weight:700;width:40px;text-align:right;">94%</span>
                </div>
                <div style="display:flex;align-items:center;gap:10px;padding:6px 0;">
                  <span class="logsrc-tag m365" style="width:130px;">Microsoft 365</span>
                  <div style="flex:1;height:8px;background:rgba(255,255,255,0.06);border-radius:4px;overflow:hidden;"><div style="width:87%;height:100%;background:var(--green);border-radius:4px;"></div></div>
                  <span style="font-family:var(--font-mono);font-size:11px;color:var(--green);font-weight:700;width:40px;text-align:right;">87%</span>
                </div>
                <div style="display:flex;align-items:center;gap:10px;padding:6px 0;">
                  <span class="logsrc-tag cloud" style="width:130px;">Azure AD</span>
                  <div style="flex:1;height:8px;background:rgba(255,255,255,0.06);border-radius:4px;overflow:hidden;"><div style="width:82%;height:100%;background:var(--green);border-radius:4px;"></div></div>
                  <span style="font-family:var(--font-mono);font-size:11px;color:var(--green);font-weight:700;width:40px;text-align:right;">82%</span>
                </div>
                <div style="display:flex;align-items:center;gap:10px;padding:6px 0;">
                  <span class="logsrc-tag firewall" style="width:130px;">Fortinet</span>
                  <div style="flex:1;height:8px;background:rgba(255,255,255,0.06);border-radius:4px;overflow:hidden;"><div style="width:71%;height:100%;background:var(--amber);border-radius:4px;"></div></div>
                  <span style="font-family:var(--font-mono);font-size:11px;color:var(--amber);font-weight:700;width:40px;text-align:right;">71%</span>
                </div>
                <div style="display:flex;align-items:center;gap:10px;padding:6px 0;">
                  <span class="logsrc-tag edr" style="width:130px;">EDR (Various)</span>
                  <div style="flex:1;height:8px;background:rgba(255,255,255,0.06);border-radius:4px;overflow:hidden;"><div style="width:68%;height:100%;background:var(--amber);border-radius:4px;"></div></div>
                  <span style="font-family:var(--font-mono);font-size:11px;color:var(--amber);font-weight:700;width:40px;text-align:right;">68%</span>
                </div>
                <div style="display:flex;align-items:center;gap:10px;padding:6px 0;">
                  <span class="logsrc-tag linux" style="width:130px;">Linux Auditd</span>
                  <div style="flex:1;height:8px;background:rgba(255,255,255,0.06);border-radius:4px;overflow:hidden;"><div style="width:52%;height:100%;background:var(--amber);border-radius:4px;"></div></div>
                  <span style="font-family:var(--font-mono);font-size:11px;color:var(--amber);font-weight:700;width:40px;text-align:right;">52%</span>
                </div>
                <div style="display:flex;align-items:center;gap:10px;padding:6px 0;">
                  <span class="logsrc-tag network" style="width:130px;">DNS / Proxy</span>
                  <div style="flex:1;height:8px;background:rgba(255,255,255,0.06);border-radius:4px;overflow:hidden;"><div style="width:45%;height:100%;background:var(--red-bright);border-radius:4px;"></div></div>
                  <span style="font-family:var(--font-mono);font-size:11px;color:var(--red-bright);font-weight:700;width:40px;text-align:right;">45%</span>
                </div>
                <div style="display:flex;align-items:center;gap:10px;padding:6px 0;">
                  <span class="logsrc-tag ot" style="width:130px;">OT / ICS</span>
                  <div style="flex:1;height:8px;background:rgba(255,255,255,0.06);border-radius:4px;overflow:hidden;"><div style="width:29%;height:100%;background:var(--red-bright);border-radius:4px;"></div></div>
                  <span style="font-family:var(--font-mono);font-size:11px;color:var(--red-bright);font-weight:700;width:40px;text-align:right;">29%</span>
                </div>
              </div>
            </div>
          </div>
        </div>


        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 5: EMERGING THREATS (TIP-Driven Rule Generation)
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="dr-panel" id="dr-panel-emerging">

          <!-- Feed Status Banner -->
          <div class="et-feed-status">
            <div class="et-feed-dot"></div>
            <div style="flex:1;">
              <div class="et-feed-label">Threat Intelligence Pipeline â€” Active</div>
              <div class="et-feed-meta">Last feed sync: 4 min ago Â· Next scheduled: 12 min Â· 14 new indicators in last 24h</div>
              <div class="et-sources-row">
                <span class="et-src-tag tip">DACTA TIP</span>
                <span class="et-src-tag osint">MITRE ATT&amp;CK</span>
                <span class="et-src-tag osint">AlienVault OTX</span>
                <span class="et-src-tag vendor">CrowdStrike Intel</span>
                <span class="et-src-tag vendor">Mandiant</span>
                <span class="et-src-tag vendor">Recorded Future</span>
                <span class="et-src-tag vendor">VirusTotal</span>
                <span class="et-src-tag client">Client Telemetry</span>
              </div>
            </div>
            <div style="text-align:right;">
              <div style="font-family:var(--font-mono);font-size:20px;font-weight:700;color:var(--cyan);">47</div>
              <div style="font-size:9px;color:var(--text-muted);margin-top:2px;">Rules Generated<br>This Month</div>
            </div>
          </div>

          <!-- Pipeline Flow Visualization -->
          <div class="card" style="margin-bottom:16px;padding:20px;">
            <div style="font-size:12px;font-weight:600;color:var(--text-primary);margin-bottom:14px;">Emerging Threat Rule Generation Pipeline</div>
            <div class="et-pipeline-flow">
              <div class="et-pipe-step step-tip">
                <div class="pipe-icon">ðŸ“¡</div>
                <div class="pipe-label">TIP Feed Ingest</div>
                <div class="pipe-sub">DACTA TIP + Global Vendors</div>
              </div>
              <div class="et-pipe-step step-ctx">
                <div class="pipe-icon">ðŸ”</div>
                <div class="pipe-label">Context Correlation</div>
                <div class="pipe-sub">Client Environment + Assets</div>
              </div>
              <div class="et-pipe-step step-ai">
                <div class="pipe-icon">ðŸ§ </div>
                <div class="pipe-label">AI Rule Generation</div>
                <div class="pipe-sub">Sigma / Correlation / ML</div>
              </div>
              <div class="et-pipe-step step-test">
                <div class="pipe-icon">ðŸ§ª</div>
                <div class="pipe-label">Testing &amp; Validation</div>
                <div class="pipe-sub">Rule Lab + Peer Review</div>
              </div>
              <div class="et-pipe-step step-repo">
                <div class="pipe-icon">ðŸ“</div>
                <div class="pipe-label">Rule Repository</div>
                <div class="pipe-sub">Saved &amp; Versioned</div>
              </div>
            </div>
          </div>

          <!-- Stats Row -->
          <div class="dr-repo-stats" style="grid-template-columns:repeat(5,1fr);margin-bottom:16px;">
            <div class="dr-stat-card" style="border-left:3px solid #a78bfa;"><div class="val" id="etStatNew" style="color:#a78bfa;">â€”</div><div class="lbl">New (Pending Review)</div></div>
            <div class="dr-stat-card" style="border-left:3px solid var(--amber);"><div class="val" id="etStatTesting" style="color:var(--amber);">â€”</div><div class="lbl">In Testing</div></div>
            <div class="dr-stat-card" style="border-left:3px solid #22c55e;"><div class="val" id="etStatValidated" style="color:#22c55e;">â€”</div><div class="lbl">Production</div></div>
            <div class="dr-stat-card" style="border-left:3px solid var(--red-bright);"><div class="val" id="etStatDraft" style="color:var(--red-bright);">â€”</div><div class="lbl">Draft</div></div>
            <div class="dr-stat-card" style="border-left:3px solid var(--cyan);"><div class="val" id="etStatTotal" style="color:var(--cyan);">â€”</div><div class="lbl">Total Rules</div></div>
          </div>

          <!-- Filter -->
          <div class="et-filter-bar">
            <span style="font-size:11px;color:var(--text-muted);margin-right:4px;">Status:</span>
            <button class="filter-chip active" onclick="etFilter(this,'all')">All</button>
            <button class="filter-chip" onclick="etFilter(this,'new')">New</button>
            <button class="filter-chip" onclick="etFilter(this,'testing')">In Testing</button>
            <button class="filter-chip" onclick="etFilter(this,'validated')">Validated</button>
            <button class="filter-chip" onclick="etFilter(this,'rejected')">Rejected</button>
            <div style="flex:1;"></div>
            <input class="filter-input" placeholder="Search emerging threats..." style="width:240px;font-size:11px;">
          </div>

          <!-- Emerging Threat Cards -->
                    <div id="etThreatList"><div style="text-align:center;padding:20px;color:var(--text-muted);font-size:12px;">Loading emerging threats...</div></div>
        </div>
        <script>
          function switchDrTab(tabId) {
            document.querySelectorAll('.dr-tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.dr-panel').forEach(p => p.classList.remove('active'));
            document.getElementById('dr-panel-' + tabId).classList.add('active');
            document.querySelector('[data-drtab="' + tabId + '"]').classList.add('active');
          }
          function switchIdeTab(btn, lang) {
            btn.parentElement.querySelectorAll('.dr-ide-tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            showToast('Switched to ' + lang.toUpperCase() + ' view');
          }
          function saveAndTestRule() {
            var overlay = document.getElementById('saveTestModalOverlay');
            if (overlay) overlay.style.display = 'flex';
          }
          function closeSaveTestModal() {
            var overlay = document.getElementById('saveTestModalOverlay');
            if (overlay) overlay.style.display = 'none';
          }
          function goToTestingLab() {
            closeSaveTestModal();
            switchDrTab('pipeline');
            showToast('Rule queued in testing pipeline');
          }
        </script>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             MODAL: SAVE & TEST CONFIRMATION
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div id="saveTestModalOverlay" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);z-index:9999;align-items:center;justify-content:center;" onclick="if(event.target===this)closeSaveTestModal()">
          <div style="background:rgba(15,23,42,0.97);border:1px solid rgba(0,212,255,0.18);border-radius:14px;padding:28px 32px;max-width:420px;width:90%;box-shadow:0 8px 40px rgba(0,0,0,0.6);">
            <div style="display:flex;align-items:center;gap:10px;margin-bottom:16px;">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/></svg>
              <span style="font-size:15px;font-weight:700;color:var(--text-primary);">Rule Saved</span>
            </div>
            <div style="font-size:13px;color:var(--text-secondary);margin-bottom:22px;line-height:1.6;">Rule saved to testing pipeline. Would you like to go to the <strong style="color:var(--cyan);">Rule Testing Lab</strong> now?</div>
            <div style="display:flex;gap:10px;">
              <button class="btn btn-primary" style="flex:1;justify-content:center;" onclick="goToTestingLab()">
                <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a6 6 0 01-7.94 7.94l-6.91 6.91a2.12 2.12 0 01-3-3l6.91-6.91a6 6 0 017.94-7.94l-3.76 3.76z"/></svg>
                Go to Testing Lab
              </button>
              <button class="btn btn-secondary" style="flex:1;justify-content:center;" onclick="closeSaveTestModal()">Continue Editing</button>
            </div>
          </div>
        </div>


        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             MODAL: BULK DEPLOY RULES TO CLIENT SIEMs
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="bd-modal-overlay" id="bulkDeployModal" style="display:none;" onclick="if(event.target===this)closeBulkDeployModal()">
          <div class="bd-modal">
            <div class="bd-modal-header">
              <div>
                <div style="font-size:16px;font-weight:700;color:var(--text-primary);display:flex;align-items:center;gap:8px;">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                  Bulk Deploy Detection Rules
                </div>
                <div style="font-size:11px;color:var(--text-muted);margin-top:2px;">Select rules by log source and deploy to client SIEMs in batch</div>
              </div>
              <button class="bd-modal-close" onclick="closeBulkDeployModal()">&times;</button>
            </div>

            <!-- Step indicators -->
            <div class="bd-steps">
              <div class="bd-step active" id="bdStep1Ind"><span class="bd-step-num">1</span><span class="bd-step-label">Log Sources</span></div>
              <div class="bd-step-line"></div>
              <div class="bd-step" id="bdStep2Ind"><span class="bd-step-num">2</span><span class="bd-step-label">Select Rules</span></div>
              <div class="bd-step-line"></div>
              <div class="bd-step" id="bdStep3Ind"><span class="bd-step-num">3</span><span class="bd-step-label">Target Clients</span></div>
              <div class="bd-step-line"></div>
              <div class="bd-step" id="bdStep4Ind"><span class="bd-step-num">4</span><span class="bd-step-label">Deploy</span></div>
            </div>

            <!-- STEP 1: Select Log Sources -->
            <div class="bd-step-panel active" id="bdPanel1">
              <div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:12px;">Select Log Source Categories</div>
              <div style="font-size:11px;color:var(--text-muted);margin-bottom:16px;">Choose which log sources to pull detection rules from. Rules will be filtered based on your selection.</div>

              <div class="bd-logsrc-grid">
                <label class="bd-logsrc-card" onclick="this.classList.toggle('selected');bdUpdateCount()">
                  <input type="checkbox" class="bd-ls-check" data-ls="windows" style="display:none;">
                  <div class="bd-logsrc-icon" style="background:rgba(96,165,250,0.1);border-color:rgba(96,165,250,0.25);">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#60a5fa" stroke-width="2"><rect x="3" y="3" width="8" height="8" rx="1"/><rect x="13" y="3" width="8" height="8" rx="1"/><rect x="3" y="13" width="8" height="8" rx="1"/><rect x="13" y="13" width="8" height="8" rx="1"/></svg>
                  </div>
                  <div class="bd-logsrc-name">Windows Security &amp; Sysmon</div>
                  <div class="bd-logsrc-count">842 rules</div>
                </label>
                <label class="bd-logsrc-card" onclick="this.classList.toggle('selected');bdUpdateCount()">
                  <input type="checkbox" class="bd-ls-check" data-ls="m365" style="display:none;">
                  <div class="bd-logsrc-icon" style="background:rgba(251,146,60,0.1);border-color:rgba(251,146,60,0.25);">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fb923c" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22 6 12 13 2 6"/></svg>
                  </div>
                  <div class="bd-logsrc-name">Microsoft 365 / Azure AD</div>
                  <div class="bd-logsrc-count">394 rules</div>
                </label>
                <label class="bd-logsrc-card" onclick="this.classList.toggle('selected');bdUpdateCount()">
                  <input type="checkbox" class="bd-ls-check" data-ls="firewall" style="display:none;">
                  <div class="bd-logsrc-icon" style="background:rgba(244,114,182,0.1);border-color:rgba(244,114,182,0.25);">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#f472b6" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                  </div>
                  <div class="bd-logsrc-name">Firewall (FortiGate, Cisco, PAN)</div>
                  <div class="bd-logsrc-count">312 rules</div>
                </label>
                <label class="bd-logsrc-card" onclick="this.classList.toggle('selected');bdUpdateCount()">
                  <input type="checkbox" class="bd-ls-check" data-ls="edr" style="display:none;">
                  <div class="bd-logsrc-icon" style="background:rgba(167,139,250,0.1);border-color:rgba(167,139,250,0.25);">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#a78bfa" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
                  </div>
                  <div class="bd-logsrc-name">EDR (CrowdStrike, Trend, Sentinel)</div>
                  <div class="bd-logsrc-count">287 rules</div>
                </label>
                <label class="bd-logsrc-card" onclick="this.classList.toggle('selected');bdUpdateCount()">
                  <input type="checkbox" class="bd-ls-check" data-ls="linux" style="display:none;">
                  <div class="bd-logsrc-icon" style="background:rgba(251,191,36,0.1);border-color:rgba(251,191,36,0.25);">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fbbf24" stroke-width="2"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>
                  </div>
                  <div class="bd-logsrc-name">Linux Auditd / Syslog</div>
                  <div class="bd-logsrc-count">268 rules</div>
                </label>
                <label class="bd-logsrc-card" onclick="this.classList.toggle('selected');bdUpdateCount()">
                  <input type="checkbox" class="bd-ls-check" data-ls="cloud" style="display:none;">
                  <div class="bd-logsrc-icon" style="background:rgba(96,165,250,0.1);border-color:rgba(96,165,250,0.25);">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#60a5fa" stroke-width="2"><path d="M18 10h-1.26A8 8 0 109 20h9a5 5 0 000-10z"/></svg>
                  </div>
                  <div class="bd-logsrc-name">Cloud (AWS, GCP, Azure)</div>
                  <div class="bd-logsrc-count">356 rules</div>
                </label>
                <label class="bd-logsrc-card" onclick="this.classList.toggle('selected');bdUpdateCount()">
                  <input type="checkbox" class="bd-ls-check" data-ls="network" style="display:none;">
                  <div class="bd-logsrc-icon" style="background:rgba(52,211,153,0.1);border-color:rgba(52,211,153,0.25);">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#34d399" stroke-width="2"><circle cx="12" cy="12" r="2"/><path d="M16.24 7.76a6 6 0 010 8.49m-8.48-.01a6 6 0 010-8.49m11.31-2.82a10 10 0 010 14.14m-14.14 0a10 10 0 010-14.14"/></svg>
                  </div>
                  <div class="bd-logsrc-name">Network / DNS / Proxy</div>
                  <div class="bd-logsrc-count">218 rules</div>
                </label>
                <label class="bd-logsrc-card" onclick="this.classList.toggle('selected');bdUpdateCount()">
                  <input type="checkbox" class="bd-ls-check" data-ls="ot" style="display:none;">
                  <div class="bd-logsrc-icon" style="background:rgba(249,115,22,0.1);border-color:rgba(249,115,22,0.25);">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#f97316" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/></svg>
                  </div>
                  <div class="bd-logsrc-name">ICS / OT (Modbus, OPC UA)</div>
                  <div class="bd-logsrc-count">170 rules</div>
                </label>
              </div>
              <div style="margin-top:12px;padding:10px 14px;background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.15);border-radius:8px;display:flex;align-items:center;justify-content:space-between;">
                <span style="font-size:12px;color:var(--text-secondary);"><span style="font-weight:700;color:var(--cyan);" id="bdSelectedCount">0</span> log sources selected &middot; <span id="bdRulePoolCount" style="font-weight:700;color:var(--text-primary);">0</span> rules in pool</span>
              </div>
            </div>

            <!-- STEP 2: Select Rules -->
            <div class="bd-step-panel" id="bdPanel2">
              <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;">
                <div>
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Select Detection Rules</div>
                  <div style="font-size:11px;color:var(--text-muted);">Filter by type, severity, or search. Check the rules you want to deploy.</div>
                </div>
                <div style="display:flex;gap:6px;align-items:center;">
                  <label style="display:flex;align-items:center;gap:5px;font-size:11px;color:var(--text-secondary);cursor:pointer;"><input type="checkbox" id="bdSelectAll" onchange="bdToggleAll(this.checked)" style="accent-color:var(--cyan);"> Select All</label>
                </div>
              </div>

              <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap;">
                <input class="filter-input" placeholder="Search rules..." style="flex:1;min-width:180px;" id="bdRuleSearch">
                <select class="filter-select" id="bdTypeFilter" style="font-size:11px;">
                  <option value="">All Types</option>
                  <option value="Sigma">Signature (Sigma)</option>
                  <option value="Correlation">Correlation</option>
                  <option value="Threshold">Threshold</option>
                  <option value="YARA">YARA</option>
                  <option value="EQL">EQL</option>
                  <option value="ML">ML Anomaly</option>
                </select>
                <select class="filter-select" id="bdSevFilter" style="font-size:11px;">
                  <option value="">All Severities</option>
                  <option>Critical</option>
                  <option>High</option>
                  <option>Medium</option>
                  <option>Low</option>
                </select>
              </div>

              <div class="bd-rule-list" id="bdRuleList">
                <!-- Populated by JS -->
              </div>
              <div style="margin-top:10px;padding:8px 14px;background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.15);border-radius:8px;font-size:12px;color:var(--text-secondary);">
                <span style="font-weight:700;color:var(--cyan);" id="bdCheckedCount">0</span> rules selected for deployment
              </div>
            </div>

            <!-- STEP 3: Target Clients -->
            <div class="bd-step-panel" id="bdPanel3">
              <div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:4px;">Deploy to Client SIEMs</div>
              <div style="font-size:11px;color:var(--text-muted);margin-bottom:16px;">Select which client environments should receive the selected rules.</div>

              <div class="bd-client-list">
                <label class="bd-client-card" onclick="this.classList.toggle('selected')">
                  <div class="bd-client-check"><span>&#10003;</span></div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Dacta Global</div>
                    <div style="font-size:10px;color:var(--text-muted);">SOCaaS &middot; Elastic SIEM v8.12.1</div>
                  </div>
                  <div style="text-align:right;">
                    <div style="font-size:11px;color:var(--green);">247 active rules</div>
                    <div style="font-size:10px;color:var(--text-muted);">Last deploy: 2h ago</div>
                  </div>
                </label>
                <label class="bd-client-card" onclick="this.classList.toggle('selected')">
                  <div class="bd-client-check"><span>&#10003;</span></div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">SPMT</div>
                    <div style="font-size:10px;color:var(--text-muted);">SOCaaS &middot; Elastic SIEM v8.12.1</div>
                  </div>
                  <div style="text-align:right;">
                    <div style="font-size:11px;color:var(--green);">198 active rules</div>
                    <div style="font-size:10px;color:var(--text-muted);">Last deploy: 6h ago</div>
                  </div>
                </label>
                <label class="bd-client-card" onclick="this.classList.toggle('selected')">
                  <div class="bd-client-check"><span>&#10003;</span></div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Global Advisor Co</div>
                    <div style="font-size:10px;color:var(--text-muted);">SOCaaS &middot; Elastic SIEM v8.12.1</div>
                  </div>
                  <div style="text-align:right;">
                    <div style="font-size:11px;color:var(--green);">134 active rules</div>
                    <div style="font-size:10px;color:var(--text-muted);">Last deploy: 1d ago</div>
                  </div>
                </label>
                <label class="bd-client-card" onclick="this.classList.toggle('selected')">
                  <div class="bd-client-check"><span>&#10003;</span></div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Naga World</div>
                    <div style="font-size:10px;color:var(--text-muted);">MDR-only &middot; No SIEM (rules pushed via Jira)</div>
                  </div>
                  <div style="text-align:right;">
                    <div style="font-size:11px;color:var(--amber);">MDR rules only</div>
                    <div style="font-size:10px;color:var(--text-muted);">Last deploy: 3d ago</div>
                  </div>
                </label>
                <label class="bd-client-card" onclick="this.classList.toggle('selected')">
                  <div class="bd-client-check"><span>&#10003;</span></div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">ADV Partners</div>
                    <div style="font-size:10px;color:var(--text-muted);">MDR-only &middot; No SIEM (rules pushed via Jira)</div>
                  </div>
                  <div style="text-align:right;">
                    <div style="font-size:11px;color:var(--amber);">MDR rules only</div>
                    <div style="font-size:10px;color:var(--text-muted);">Last deploy: 5d ago</div>
                  </div>
                </label>
              </div>

              <div style="margin-top:12px;display:flex;gap:10px;">
                <div style="flex:1;padding:10px 14px;background:rgba(245,158,11,0.06);border:1px solid rgba(245,158,11,0.2);border-radius:8px;">
                  <div style="font-size:10px;font-weight:700;color:var(--amber);margin-bottom:3px;">&#9888; MDR-Only Clients</div>
                  <div style="font-size:10px;color:var(--text-muted);">MDR-only clients (Naga World, ADV Partners) don't have a Dacta-managed SIEM. Rules will be pushed as Jira detection specifications for the client's own security team to implement.</div>
                </div>
              </div>
            </div>

            <!-- STEP 4: Review & Deploy -->
            <div class="bd-step-panel" id="bdPanel4">
              <div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:12px;">Review &amp; Deploy</div>
              <div class="bd-summary-card">
                <div class="bd-summary-row"><span class="bd-summary-label">Log Sources</span><span class="bd-summary-val" id="bdSumSources">â€”</span></div>
                <div class="bd-summary-row"><span class="bd-summary-label">Rules Selected</span><span class="bd-summary-val" id="bdSumRules">â€”</span></div>
                <div class="bd-summary-row"><span class="bd-summary-label">Target Clients</span><span class="bd-summary-val" id="bdSumClients">â€”</span></div>
                <div class="bd-summary-row"><span class="bd-summary-label">Deployment Mode</span><span class="bd-summary-val" style="color:var(--text-primary);">Production (immediate activation)</span></div>
              </div>

              <div style="margin-top:14px;">
                <div class="dr-field-label" style="margin-bottom:8px;">Deployment Options</div>
                <div style="display:flex;flex-direction:column;gap:6px;">
                  <label style="display:flex;align-items:center;gap:8px;padding:8px 12px;background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.2);border-radius:7px;cursor:pointer;font-size:11px;color:var(--text-primary);">
                    <input type="radio" name="bd-mode" checked style="accent-color:var(--cyan);"> Deploy to Production (rules immediately active)
                  </label>
                  <label style="display:flex;align-items:center;gap:8px;padding:8px 12px;background:rgba(255,255,255,0.02);border:1px solid var(--border-subtle);border-radius:7px;cursor:pointer;font-size:11px;color:var(--text-primary);">
                    <input type="radio" name="bd-mode" style="accent-color:var(--cyan);"> Shadow Mode (alert-only, no blocking)
                  </label>
                  <label style="display:flex;align-items:center;gap:8px;padding:8px 12px;background:rgba(255,255,255,0.02);border:1px solid var(--border-subtle);border-radius:7px;cursor:pointer;font-size:11px;color:var(--text-primary);">
                    <input type="radio" name="bd-mode" style="accent-color:var(--cyan);"> Stage for Peer Review first
                  </label>
                </div>
              </div>

              <div style="margin-top:14px;">
                <div class="dr-field-label" style="margin-bottom:8px;">Post-Deploy Actions</div>
                <div style="display:flex;flex-direction:column;gap:4px;">
                  <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);cursor:pointer;"><input type="checkbox" checked style="accent-color:var(--cyan);"> Run backtest against 7-day historical logs</label>
                  <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);cursor:pointer;"><input type="checkbox" checked style="accent-color:var(--cyan);"> Notify SOC team via Slack</label>
                  <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);cursor:pointer;"><input type="checkbox" style="accent-color:var(--cyan);"> Auto-create Jira ticket for MDR clients</label>
                  <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);cursor:pointer;"><input type="checkbox" checked style="accent-color:var(--cyan);"> Log to deployment audit trail</label>
                </div>
              </div>
            </div>

            <!-- Footer -->
            <div class="bd-modal-footer">
              <button class="btn btn-secondary btn-sm" id="bdBackBtn" onclick="bdPrev()" style="display:none;">Back</button>
              <div style="flex:1;"></div>
              <button class="btn btn-secondary btn-sm" onclick="closeBulkDeployModal()">Cancel</button>
              <button class="btn btn-primary btn-sm" id="bdNextBtn" onclick="bdNext()">
                Next &rarr;
              </button>
            </div>
          </div>
        </div>


        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             MODAL: AI-POWERED CREATE RULE
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="bd-modal-overlay" id="createRuleModal" style="display:none;" onclick="if(event.target===this)closeCreateRuleModal()">
          <div class="bd-modal" style="max-width:780px;">
            <div class="bd-modal-header">
              <div>
                <div style="font-size:16px;font-weight:700;color:var(--text-primary);display:flex;align-items:center;gap:8px;">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                  Create Detection Rule
                </div>
                <div style="font-size:11px;color:var(--text-muted);margin-top:2px;">AI-assisted rule creation â€” select a client and let AI profile the threat landscape</div>
              </div>
              <button class="bd-modal-close" onclick="closeCreateRuleModal()">&times;</button>
            </div>

            <!-- Step indicators -->
            <div class="bd-steps">
              <div class="bd-step active" id="crStep1Ind"><span class="bd-step-num">1</span><span class="bd-step-label">Client &amp; Context</span></div>
              <div class="bd-step-line"></div>
              <div class="bd-step" id="crStep2Ind"><span class="bd-step-num">2</span><span class="bd-step-label">Threat Landscape</span></div>
              <div class="bd-step-line"></div>
              <div class="bd-step" id="crStep3Ind"><span class="bd-step-num">3</span><span class="bd-step-label">TTPs &amp; Rules</span></div>
              <div class="bd-step-line"></div>
              <div class="bd-step" id="crStep4Ind"><span class="bd-step-num">4</span><span class="bd-step-label">Generate</span></div>
            </div>

            <!-- STEP 1: Client Selection & Context -->
            <div class="bd-step-panel active" id="crPanel1">
              <div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:4px;">Select Client or Enter Name</div>
              <div style="font-size:11px;color:var(--text-muted);margin-bottom:14px;">Choose an existing client or type a new client name. AI will profile their threat landscape based on industry, region, and infrastructure.</div>

              <div class="dr-field-group" style="margin-bottom:16px;">
                <div class="dr-field-label">Client</div>
                <div style="position:relative;">
                  <input class="filter-input" id="crClientInput" placeholder="Type client name or select below..." style="width:100%;font-size:13px;padding:10px 14px;" oninput="crFilterClients(this.value)">
                </div>
                <div class="cr-client-options" id="crClientOptions">
                  <div class="cr-client-opt" onclick="crSelectClient('Dacta Global','Technology / IT Services','Singapore','SOCaaS')">
                    <div style="font-size:12px;font-weight:600;color:var(--text-primary);">Dacta Global</div>
                    <div style="font-size:10px;color:var(--text-muted);">Technology / IT Services &middot; Singapore &middot; SOCaaS</div>
                  </div>
                  <div class="cr-client-opt" onclick="crSelectClient('SPMT','Maritime & Logistics','Singapore','SOCaaS')">
                    <div style="font-size:12px;font-weight:600;color:var(--text-primary);">SPMT</div>
                    <div style="font-size:10px;color:var(--text-muted);">Maritime &amp; Logistics &middot; Singapore &middot; SOCaaS</div>
                  </div>
                  <div class="cr-client-opt" onclick="crSelectClient('Global Advisor Co','Financial Advisory','Hong Kong','SOCaaS')">
                    <div style="font-size:12px;font-weight:600;color:var(--text-primary);">Global Advisor Co</div>
                    <div style="font-size:10px;color:var(--text-muted);">Financial Advisory &middot; Hong Kong &middot; SOCaaS</div>
                  </div>
                  <div class="cr-client-opt" onclick="crSelectClient('Naga World','Hospitality / Gaming','Cambodia','MDR-only')">
                    <div style="font-size:12px;font-weight:600;color:var(--text-primary);">Naga World</div>
                    <div style="font-size:10px;color:var(--text-muted);">Hospitality / Gaming &middot; Cambodia &middot; MDR-only</div>
                  </div>
                  <div class="cr-client-opt" onclick="crSelectClient('ADV Partners','Legal & Advisory','Singapore','MDR-only')">
                    <div style="font-size:12px;font-weight:600;color:var(--text-primary);">ADV Partners</div>
                    <div style="font-size:10px;color:var(--text-muted);">Legal &amp; Advisory &middot; Singapore &middot; MDR-only</div>
                  </div>
                </div>
              </div>

              <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                <div class="dr-field-group">
                  <div class="dr-field-label">Industry Vertical</div>
                  <select class="filter-select" style="width:100%;" id="crIndustry">
                    <option value="">Auto-detect from client</option>
                    <option>Technology / IT Services</option>
                    <option>Financial Services / Banking</option>
                    <option>Financial Advisory</option>
                    <option>Maritime & Logistics</option>
                    <option>Hospitality / Gaming</option>
                    <option>Legal & Advisory</option>
                    <option>Healthcare / Pharma</option>
                    <option>Government / Defense</option>
                    <option>Energy / Utilities</option>
                    <option>Manufacturing</option>
                    <option>Retail / E-commerce</option>
                    <option>Education</option>
                    <option>Telecommunications</option>
                    <option>Critical Infrastructure</option>
                  </select>
                </div>
                <div class="dr-field-group">
                  <div class="dr-field-label">Region</div>
                  <select class="filter-select" style="width:100%;" id="crRegion">
                    <option value="">Auto-detect from client</option>
                    <option>Southeast Asia</option>
                    <option>East Asia (China, Japan, Korea)</option>
                    <option>South Asia</option>
                    <option>Middle East</option>
                    <option>Europe</option>
                    <option>North America</option>
                    <option>Africa</option>
                    <option>Oceania</option>
                    <option>Latin America</option>
                  </select>
                </div>
              </div>

              <div class="dr-field-group" style="margin-top:4px;">
                <div class="dr-field-label">Additional Context (optional)</div>
                <textarea class="esc-input" rows="2" style="width:100%;resize:vertical;font-size:11px;" id="crContext" placeholder="E.g. 'Client handles PII data, recently migrated to Azure, uses FortiGate firewalls, has OT environment...'"></textarea>
              </div>
            </div>

            <!-- STEP 2: AI Threat Landscape (shown after "Analyze") -->
            <div class="bd-step-panel" id="crPanel2">
              <div style="display:flex;align-items:center;gap:8px;margin-bottom:14px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><path d="M12 2a4 4 0 014 4c0 1.95-2 3-2 8h-4c0-5-2-6.05-2-8a4 4 0 014-4z"/><line x1="10" y1="22" x2="14" y2="22"/><line x1="10" y1="18" x2="14" y2="18"/></svg>
                <div style="font-size:13px;font-weight:600;color:var(--text-primary);">AI Threat Landscape Profile</div>
                <span class="badge badge-cyan" style="font-size:9px;">AI-Generated</span>
              </div>

              <!-- Client profile card -->
              <div style="padding:14px;background:rgba(0,212,255,0.03);border:1px solid rgba(0,212,255,0.12);border-radius:10px;margin-bottom:14px;" id="crProfileCard">
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
                  <div style="width:36px;height:36px;border-radius:8px;background:rgba(0,212,255,0.1);border:1px solid rgba(0,212,255,0.25);display:flex;align-items:center;justify-content:center;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                  </div>
                  <div>
                    <div style="font-size:14px;font-weight:700;color:var(--text-primary);" id="crProfileName">â€”</div>
                    <div style="font-size:11px;color:var(--text-muted);" id="crProfileMeta">â€”</div>
                  </div>
                </div>
                <div style="font-size:11px;color:var(--text-secondary);line-height:1.6;" id="crProfileSummary">
                  Analyzing client threat landscape...
                </div>
              </div>

              <!-- Threat Actors -->
              <div style="font-size:12px;font-weight:700;color:var(--text-primary);margin-bottom:8px;">Relevant Threat Actors</div>
              <div style="display:flex;flex-direction:column;gap:6px;margin-bottom:16px;" id="crActorsList">
                <!-- Populated by JS -->
              </div>

              <!-- Key Risks -->
              <div style="font-size:12px;font-weight:700;color:var(--text-primary);margin-bottom:8px;">Key Risk Areas</div>
              <div style="display:flex;flex-wrap:wrap;gap:6px;" id="crRiskTags">
                <!-- Populated by JS -->
              </div>
            </div>

            <!-- STEP 3: TTPs & Rule Recommendations -->
            <div class="bd-step-panel" id="crPanel3">
              <div style="display:flex;align-items:center;gap:8px;margin-bottom:14px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Recommended TTPs &amp; Detection Rules</div>
                <span class="badge badge-cyan" style="font-size:9px;">AI-Recommended</span>
              </div>
              <div style="font-size:11px;color:var(--text-muted);margin-bottom:14px;">Based on the threat landscape analysis, AI recommends these MITRE ATT&amp;CK techniques and detection rules. Select which to generate.</div>

              <div class="bd-rule-list" style="max-height:360px;" id="crTTPList">
                <!-- Populated by JS -->
              </div>

              <div style="margin-top:10px;padding:8px 14px;background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.15);border-radius:8px;font-size:12px;color:var(--text-secondary);">
                <span style="font-weight:700;color:var(--cyan);" id="crTTPChecked">0</span> rules selected for generation
              </div>
            </div>

            <!-- STEP 4: Generate & Open in Builder -->
            <div class="bd-step-panel" id="crPanel4">
              <div style="text-align:center;padding:20px 0;">
                <div style="width:64px;height:64px;border-radius:16px;background:rgba(0,212,255,0.1);border:1px solid rgba(0,212,255,0.25);display:flex;align-items:center;justify-content:center;margin:0 auto 16px;">
                  <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><path d="M12 2a4 4 0 014 4c0 1.95-2 3-2 8h-4c0-5-2-6.05-2-8a4 4 0 014-4z"/><line x1="10" y1="22" x2="14" y2="22"/><line x1="10" y1="18" x2="14" y2="18"/></svg>
                </div>
                <div style="font-size:16px;font-weight:700;color:var(--text-primary);margin-bottom:6px;">Ready to Generate Rules</div>
                <div style="font-size:12px;color:var(--text-muted);max-width:400px;margin:0 auto 20px;">AI will generate Sigma YAML detection rules based on the selected TTPs. Rules will open in the Rule Builder for review and editing before deployment.</div>

                <div class="bd-summary-card" style="text-align:left;max-width:450px;margin:0 auto;">
                  <div class="bd-summary-row"><span class="bd-summary-label">Client</span><span class="bd-summary-val" id="crSumClient">â€”</span></div>
                  <div class="bd-summary-row"><span class="bd-summary-label">Industry</span><span class="bd-summary-val" id="crSumIndustry">â€”</span></div>
                  <div class="bd-summary-row"><span class="bd-summary-label">Threat Actors</span><span class="bd-summary-val" id="crSumActors">â€”</span></div>
                  <div class="bd-summary-row"><span class="bd-summary-label">Rules to Generate</span><span class="bd-summary-val" id="crSumRules">â€”</span></div>
                </div>

                <div style="margin-top:16px;display:flex;flex-direction:column;gap:6px;max-width:450px;margin-left:auto;margin-right:auto;">
                  <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);cursor:pointer;"><input type="checkbox" checked style="accent-color:var(--cyan);"> Auto-translate to client's SIEM format</label>
                  <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);cursor:pointer;"><input type="checkbox" checked style="accent-color:var(--cyan);"> Add to deployment pipeline as Draft</label>
                  <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);cursor:pointer;"><input type="checkbox" style="accent-color:var(--cyan);"> Auto-run backtest after generation</label>
                </div>
              </div>
            </div>

            <!-- Footer -->
            <div class="bd-modal-footer">
              <button class="btn btn-secondary btn-sm" id="crBackBtn" onclick="crPrev()" style="display:none;">Back</button>
              <div style="flex:1;"></div>
              <button class="btn btn-secondary btn-sm" onclick="closeCreateRuleModal()">Cancel</button>
              <button class="btn btn-primary btn-sm" id="crNextBtn" onclick="crNext()">
                Analyze Threat Landscape &rarr;
              </button>
            </div>
          </div>
        </div>


        <script>
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           BULK DEPLOY MODAL LOGIC
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        var bdCurrentStep = 1;
        var bdRuleCounts = { windows:842, m365:394, firewall:312, edr:287, linux:268, cloud:356, network:218, ot:170 };

        function openBulkDeployModal() {
          bdCurrentStep = 1;
          document.getElementById('bulkDeployModal').style.display = 'flex';
          bdShowStep(1);
          // Reset selections
          document.querySelectorAll('.bd-logsrc-card').forEach(c => c.classList.remove('selected'));
          document.querySelectorAll('.bd-client-card').forEach(c => c.classList.remove('selected'));
          bdUpdateCount();
        }
        function closeBulkDeployModal() { document.getElementById('bulkDeployModal').style.display = 'none'; }

        function bdShowStep(n) {
          bdCurrentStep = n;
          document.querySelectorAll('#bulkDeployModal .bd-step-panel').forEach((p,i) => p.classList.toggle('active', i===n-1));
          document.querySelectorAll('#bulkDeployModal .bd-step').forEach((s,i) => {
            s.classList.remove('active','done');
            if (i < n-1) s.classList.add('done');
            if (i === n-1) s.classList.add('active');
          });
          document.getElementById('bdBackBtn').style.display = n > 1 ? '' : 'none';
          var btn = document.getElementById('bdNextBtn');
          if (n === 4) { btn.textContent = 'ðŸš€ Deploy Rules'; btn.onclick = function(){ closeBulkDeployModal(); showToast('Deploying rules to selected client SIEMs...'); }; }
          else if (n === 1) { btn.innerHTML = 'Next &rarr;'; btn.onclick = function(){ bdPopulateRules(); bdNext2(); }; }
          else { btn.innerHTML = 'Next &rarr;'; btn.onclick = function(){ bdNext2(); }; }
        }
        function bdNext() { bdPopulateRules(); bdNext2(); }
        function bdNext2() {
          if (bdCurrentStep === 3) bdPopulateSummary();
          bdShowStep(Math.min(bdCurrentStep + 1, 4));
        }
        function bdPrev() { bdShowStep(Math.max(bdCurrentStep - 1, 1)); }

        function bdUpdateCount() {
          var selected = document.querySelectorAll('.bd-logsrc-card.selected');
          var count = selected.length;
          var total = 0;
          selected.forEach(function(card) {
            var cb = card.querySelector('.bd-ls-check');
            if (cb) { var ls = cb.getAttribute('data-ls'); total += (bdRuleCounts[ls] || 0); }
          });
          document.getElementById('bdSelectedCount').textContent = count;
          document.getElementById('bdRulePoolCount').textContent = total.toLocaleString();
        }

        function bdPopulateRules() {
          var list = document.getElementById('bdRuleList');
          var selectedLS = [];
          document.querySelectorAll('.bd-logsrc-card.selected .bd-ls-check').forEach(function(cb) { selectedLS.push(cb.getAttribute('data-ls')); });
          var rules = (typeof rulesData !== 'undefined' ? rulesData : []).filter(function(r) {
            if (selectedLS.length === 0) return true;
            return (r.logSources || []).some(function(ls) { return selectedLS.indexOf(ls) >= 0; });
          });
          // Add more sample rules to make it look fuller
          var extras = [
            { id:'RUL-2700', name:'Suspicious WMI Remote Execution', type:'Sigma', mitre:'T1047', severity:'High', logSources:['windows'] },
            { id:'RUL-2695', name:'DNS Beaconing â€” High Frequency Queries', type:'ML', mitre:'T1071.004', severity:'Medium', logSources:['network'] },
            { id:'RUL-2688', name:'M365 Consent Grant to Malicious App', type:'Sigma', mitre:'T1550.001', severity:'Critical', logSources:['m365','cloud'] },
            { id:'RUL-2680', name:'FortiGate â€” Exploit Attempt Blocked (IPS)', type:'Sigma', mitre:'T1190', severity:'High', logSources:['firewall'] },
            { id:'RUL-2672', name:'Linux Reverse Shell via Bash', type:'Sigma', mitre:'T1059.004', severity:'Critical', logSources:['linux'] },
            { id:'RUL-2665', name:'AWS IAM Policy Change â€” Privilege Escalation', type:'Sigma', mitre:'T1078.004', severity:'High', logSources:['cloud'] },
            { id:'RUL-2658', name:'OPC UA Session Hijack Attempt', type:'Correlation', mitre:'T0859', severity:'Critical', logSources:['ot'] },
            { id:'RUL-2650', name:'EDR Agent Tampering Detected', type:'Sigma', mitre:'T1562.001', severity:'Critical', logSources:['edr'] },
          ];
          extras.forEach(function(e) {
            if (selectedLS.length === 0 || (e.logSources || []).some(function(ls) { return selectedLS.indexOf(ls) >= 0; })) {
              rules.push(e);
            }
          });
          var sevColor = { Critical:'red', High:'amber', Medium:'blue', Low:'gray' };
          var typeClass = { Sigma:'sigma', YARA:'yara', Correlation:'correlation', Threshold:'threshold', ML:'ml', EQL:'eql' };
          list.innerHTML = rules.map(function(r) {
            return '<div class="bd-rule-item" onclick="this.classList.toggle(&apos;checked&apos;);this.querySelector(&apos;input&apos;).checked=!this.querySelector(&apos;input&apos;).checked;bdUpdateChecked();">' +
              '<input type="checkbox" onclick="event.stopPropagation();var p=this.parentElement;p.classList.toggle(&apos;checked&apos;,this.checked);bdUpdateChecked();">' +
              '<div class="rule-info"><div class="rule-name">' + r.name + '</div>' +
              '<div class="rule-meta"><span class="rule-type-badge ' + (typeClass[r.type]||'sigma') + '">' + r.type + '</span>' +
              '<span class="mitre-tag" style="font-size:9px;">' + r.mitre + '</span>' +
              '<span class="badge badge-' + (sevColor[r.severity]||'blue') + '" style="font-size:9px;">' + r.severity + '</span>' +
              '</div></div></div>';
          }).join('');
          document.getElementById('bdCheckedCount').textContent = '0';
        }

        function bdToggleAll(checked) {
          document.querySelectorAll('#bdRuleList .bd-rule-item').forEach(function(item) {
            item.classList.toggle('checked', checked);
            item.querySelector('input').checked = checked;
          });
          bdUpdateChecked();
        }
        function bdUpdateChecked() {
          var c = document.querySelectorAll('#bdRuleList .bd-rule-item.checked').length;
          document.getElementById('bdCheckedCount').textContent = c;
        }

        function bdPopulateSummary() {
          var sources = [];
          document.querySelectorAll('.bd-logsrc-card.selected .bd-logsrc-name').forEach(function(n) { sources.push(n.textContent.trim().split('/')[0].split('(')[0].trim()); });
          var ruleCount = document.querySelectorAll('#bdRuleList .bd-rule-item.checked').length;
          var clients = [];
          document.querySelectorAll('.bd-client-card.selected').forEach(function(c) {
            var name = c.querySelector('div[style*="font-size:13px"]');
            if (name) clients.push(name.textContent.trim());
          });
          document.getElementById('bdSumSources').textContent = sources.join(', ') || 'â€”';
          document.getElementById('bdSumRules').textContent = ruleCount + ' rules';
          document.getElementById('bdSumClients').textContent = clients.join(', ') || 'â€”';
        }


        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           CREATE RULE MODAL LOGIC
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        var crCurrentStep = 1;
        var crSelectedClient = { name:'', industry:'', region:'', model:'' };

        // Threat landscape data per industry
        var crThreatProfiles = {
          'Technology / IT Services': {
            summary: 'Technology companies face sophisticated supply-chain attacks, insider threats, and nation-state actors targeting intellectual property. Key risks include code repository compromise, CI/CD pipeline attacks, cloud misconfiguration exploitation, and credential theft targeting privileged developer accounts.',
            actors: [
              { name:'Lazarus Group (APT38)', origin:'ðŸ‡°ðŸ‡µ', desc:'Targets tech companies for cryptocurrency theft and IP exfiltration. Known for supply-chain compromises.' },
              { name:'APT41 (Winnti)', origin:'ðŸ‡¨ðŸ‡³', desc:'Dual espionage/financial group. Targets software companies for source code theft and supply-chain insertion.' },
              { name:'Scattered Spider (UNC3944)', origin:'ðŸŒ', desc:'Social engineering specialists targeting IT helpdesks, SIM swapping, and MFA fatigue attacks.' },
            ],
            risks: ['Supply Chain Compromise','Cloud Misconfiguration','CI/CD Pipeline Attacks','Credential Theft','Insider Threats','API Key Exposure'],
            ttps: [
              { technique:'T1195.002', name:'Supply Chain â€” Compromise Software Supply Chain', type:'Correlation', sev:'Critical' },
              { technique:'T1078.004', name:'Valid Accounts â€” Cloud Accounts', type:'Sigma', sev:'High' },
              { technique:'T1059.001', name:'PowerShell Execution â€” Encoded Commands', type:'Sigma', sev:'High' },
              { technique:'T1552.001', name:'Credentials in Files â€” API Keys in Repos', type:'Sigma', sev:'Critical' },
              { technique:'T1621', name:'MFA Request Generation (Fatigue Attack)', type:'Correlation', sev:'High' },
              { technique:'T1110.003', name:'Brute Force â€” Password Spraying', type:'Threshold', sev:'Medium' },
            ]
          },
          'Maritime & Logistics': {
            summary: 'Maritime and logistics firms face threats from nation-state actors seeking to disrupt supply chains, ransomware groups targeting OT systems, and criminal organizations exploiting cargo tracking systems. GPS spoofing, vessel tracking manipulation, and port infrastructure attacks are key concerns.',
            actors: [
              { name:'APT40 (Leviathan)', origin:'ðŸ‡¨ðŸ‡³', desc:'Chinese state-sponsored group specifically targeting maritime, shipping, and naval technology organizations.' },
              { name:'SandWorm (Unit 74455)', origin:'ðŸ‡·ðŸ‡º', desc:'Russian military intelligence targeting critical infrastructure including port systems and logistics networks.' },
              { name:'LockBit 3.0', origin:'ðŸŒ', desc:'Ransomware-as-a-Service targeting logistics companies for high-value extortion. Known for OT impact.' },
            ],
            risks: ['OT/ICS Compromise','Ransomware','GPS Spoofing','Cargo System Manipulation','Supply Chain Disruption','Port Infrastructure Attacks'],
            ttps: [
              { technique:'T0819', name:'ICS Initial Access â€” Exploit Public-Facing Application', type:'Sigma', sev:'Critical' },
              { technique:'T1486', name:'Data Encrypted for Impact (Ransomware)', type:'Correlation', sev:'Critical' },
              { technique:'T1021.002', name:'Lateral Movement â€” SMB/Windows Admin Shares', type:'Sigma', sev:'High' },
              { technique:'T1071.001', name:'C2 â€” Application Layer Protocol (HTTPS)', type:'ML', sev:'High' },
              { technique:'T0886', name:'ICS â€” Remote Services', type:'Sigma', sev:'High' },
              { technique:'T1190', name:'Exploit Public-Facing Application', type:'Sigma', sev:'Critical' },
            ]
          },
          'Financial Advisory': {
            summary: 'Financial advisory firms are prime targets for Business Email Compromise (BEC), wire fraud, client data exfiltration, and regulatory-focused attacks. Threat actors target high-net-worth client information, M&A deal data, and privileged financial communications.',
            actors: [
              { name:'Silence APT', origin:'ðŸ‡·ðŸ‡º', desc:'Financial sector specialist. Targets banking and advisory firms for wire fraud and financial data theft.' },
              { name:'FIN7 (Carbanak)', origin:'ðŸ‡·ðŸ‡º', desc:'Sophisticated financial crime group targeting payment systems and financial data for monetization.' },
              { name:'BEC Operators (Multiple)', origin:'ðŸ‡³ðŸ‡¬ðŸŒ', desc:'Business Email Compromise networks targeting executives and finance teams for wire transfer fraud.' },
            ],
            risks: ['Business Email Compromise','Wire Fraud','Client Data Exfiltration','Insider Trading Data Theft','M&A Deal Leaks','Regulatory Compliance Breach'],
            ttps: [
              { technique:'T1566.001', name:'Spearphishing Attachment â€” Executive Targeting', type:'Sigma', sev:'Critical' },
              { technique:'T1098.002', name:'Account Manipulation â€” Email Delegation', type:'Sigma', sev:'High' },
              { technique:'T1114.003', name:'Email Collection â€” Email Forwarding Rule', type:'Sigma', sev:'Critical' },
              { technique:'T1567.002', name:'Exfiltration to Cloud Storage (OneDrive/GDrive)', type:'Correlation', sev:'High' },
              { technique:'T1078.004', name:'Compromised Cloud Accounts', type:'Threshold', sev:'High' },
              { technique:'T1110.001', name:'Brute Force â€” Password Guessing', type:'Threshold', sev:'Medium' },
            ]
          },
          'Hospitality / Gaming': {
            summary: 'Hospitality and gaming companies face attacks targeting POS systems, customer PII databases, loyalty program fraud, and high-value guest data. Casino operations include OT systems (CCTV, access control) that are increasingly targeted. Ransomware is a top threat due to operational uptime pressure.',
            actors: [
              { name:'Scattered Spider (UNC3944)', origin:'ðŸŒ', desc:'Targeted MGM, Caesars in 2023. Social engineering, SIM swapping, and ransomware deployment against hospitality.' },
              { name:'APT41 (Winnti)', origin:'ðŸ‡¨ðŸ‡³', desc:'Known to target gaming companies for source code theft and in-game currency manipulation.' },
              { name:'ALPHV/BlackCat', origin:'ðŸŒ', desc:'Ransomware-as-a-Service that specifically targets hospitality for high-pressure extortion.' },
            ],
            risks: ['POS System Compromise','Guest PII Theft','Ransomware','CCTV/Access Control Attacks','Loyalty Program Fraud','Regulatory Non-Compliance'],
            ttps: [
              { technique:'T1486', name:'Ransomware â€” Data Encrypted for Impact', type:'Correlation', sev:'Critical' },
              { technique:'T1621', name:'MFA Request Generation (Fatigue)', type:'Correlation', sev:'High' },
              { technique:'T1003.001', name:'Credential Dumping â€” LSASS Memory', type:'Sigma', sev:'Critical' },
              { technique:'T1059.001', name:'PowerShell Encoded Command Execution', type:'Sigma', sev:'High' },
              { technique:'T0819', name:'ICS â€” Exploit Public Application (CCTV/OT)', type:'Sigma', sev:'High' },
              { technique:'T1071.004', name:'DNS Tunneling C2 Communication', type:'ML', sev:'Medium' },
            ]
          },
          'Legal & Advisory': {
            summary: 'Law firms and advisory practices hold extremely sensitive client data including litigation strategies, M&A details, and privileged communications. Nation-state actors target legal firms for intelligence, while criminal groups seek client data for extortion.',
            actors: [
              { name:'APT29 (Cozy Bear)', origin:'ðŸ‡·ðŸ‡º', desc:'Targets legal firms handling government and defense-related matters for intelligence gathering.' },
              { name:'FIN7 (Carbanak)', origin:'ðŸ‡·ðŸ‡º', desc:'Targets professional services for financial data and client billing information.' },
              { name:'BEC Operators', origin:'ðŸŒ', desc:'Executive impersonation targeting partners and finance teams for wire fraud.' },
            ],
            risks: ['Client Privilege Data Theft','BEC / Wire Fraud','Document Exfiltration','Insider Threats','Regulatory Breach','Ransomware'],
            ttps: [
              { technique:'T1566.001', name:'Spearphishing Attachment â€” Partner Targeting', type:'Sigma', sev:'Critical' },
              { technique:'T1114.002', name:'Remote Email Collection â€” Mailbox Access', type:'Sigma', sev:'High' },
              { technique:'T1567', name:'Exfiltration Over Web Service', type:'Correlation', sev:'High' },
              { technique:'T1098', name:'Account Manipulation â€” Persistence', type:'Sigma', sev:'Medium' },
              { technique:'T1070.001', name:'Indicator Removal â€” Clear Windows Event Logs', type:'Sigma', sev:'High' },
              { technique:'T1486', name:'Ransomware Encryption', type:'Correlation', sev:'Critical' },
            ]
          }
        };
        // Default for unknown industries
        var crDefaultProfile = crThreatProfiles['Technology / IT Services'];

        function openCreateRuleModal() {
          crCurrentStep = 1;
          document.getElementById('createRuleModal').style.display = 'flex';
          crShowStep(1);
          document.getElementById('crClientInput').value = '';
          document.querySelectorAll('.cr-client-opt').forEach(function(o){ o.classList.remove('selected'); o.style.display=''; });
          crSelectedClient = { name:'', industry:'', region:'', model:'' };
          document.getElementById('crIndustry').value = '';
          document.getElementById('crRegion').value = '';
          document.getElementById('crContext').value = '';
        }
        function closeCreateRuleModal() { document.getElementById('createRuleModal').style.display = 'none'; }

        function crShowStep(n) {
          crCurrentStep = n;
          document.querySelectorAll('#createRuleModal .bd-step-panel').forEach(function(p,i){ p.classList.toggle('active', i===n-1); });
          document.querySelectorAll('#createRuleModal .bd-step').forEach(function(s,i){
            s.classList.remove('active','done');
            if (i < n-1) s.classList.add('done');
            if (i === n-1) s.classList.add('active');
          });
          document.getElementById('crBackBtn').style.display = n > 1 ? '' : 'none';
          var btn = document.getElementById('crNextBtn');
          if (n === 1) { btn.innerHTML = 'Analyze Threat Landscape &rarr;'; btn.onclick = function(){ crAnalyze(); }; }
          else if (n === 2) { btn.innerHTML = 'Identify TTPs &rarr;'; btn.onclick = function(){ crBuildTTPs(); }; }
          else if (n === 3) { btn.innerHTML = 'Review &amp; Generate &rarr;'; btn.onclick = function(){ crBuildSummary(); crShowStep(4); }; }
          else if (n === 4) { btn.innerHTML = 'âœ¨ Generate Rules &amp; Open in Builder'; btn.onclick = function(){ closeCreateRuleModal(); switchDrTab('builder'); showToast('AI generating ' + (document.getElementById('crTTPChecked').textContent||'0') + ' detection rules for ' + crSelectedClient.name + '...'); }; }
        }
        function crPrev() { crShowStep(Math.max(crCurrentStep - 1, 1)); }
        function crNext() { /* handled by crShowStep onclick */ }

        function crSelectClient(name, industry, region, model) {
          crSelectedClient = { name:name, industry:industry, region:region, model:model };
          document.getElementById('crClientInput').value = name;
          document.querySelectorAll('.cr-client-opt').forEach(function(o){ o.classList.remove('selected'); });
          event.currentTarget.classList.add('selected');
          // Auto-fill industry/region
          var indSel = document.getElementById('crIndustry');
          for (var i=0; i<indSel.options.length; i++) { if (indSel.options[i].text === industry) { indSel.selectedIndex = i; break; } }
          var regSel = document.getElementById('crRegion');
          var regionMap = { 'Singapore':'Southeast Asia', 'Hong Kong':'East Asia (China, Japan, Korea)', 'Cambodia':'Southeast Asia' };
          var mappedRegion = regionMap[region] || '';
          for (var j=0; j<regSel.options.length; j++) { if (regSel.options[j].text === mappedRegion) { regSel.selectedIndex = j; break; } }
        }

        function crFilterClients(val) {
          val = val.toLowerCase();
          document.querySelectorAll('.cr-client-opt').forEach(function(o) {
            var text = o.textContent.toLowerCase();
            o.style.display = (val === '' || text.indexOf(val) >= 0) ? '' : 'none';
          });
        }

        function crAnalyze() {
          // Get or infer industry
          var industry = document.getElementById('crIndustry').value || crSelectedClient.industry || 'Technology / IT Services';
          var clientName = document.getElementById('crClientInput').value || crSelectedClient.name || 'Unknown Client';
          var region = document.getElementById('crRegion').value || 'Southeast Asia';
          var model = crSelectedClient.model || 'SOCaaS';

          crSelectedClient.name = clientName;
          crSelectedClient.industry = industry;

          var profile = crThreatProfiles[industry] || crDefaultProfile;

          // Populate profile card
          document.getElementById('crProfileName').textContent = clientName;
          document.getElementById('crProfileMeta').textContent = industry + ' Â· ' + region + ' Â· ' + model;
          document.getElementById('crProfileSummary').textContent = profile.summary;

          // Populate actors
          var actorHTML = profile.actors.map(function(a) {
            return '<div class="cr-actor-card">' +
              '<div class="actor-icon">' + a.origin + '</div>' +
              '<div style="flex:1;"><div class="actor-name">' + a.name + '</div><div class="actor-desc">' + a.desc + '</div></div></div>';
          }).join('');
          document.getElementById('crActorsList').innerHTML = actorHTML;

          // Populate risks
          var riskHTML = profile.risks.map(function(r) { return '<span class="cr-risk-tag">' + r + '</span>'; }).join('');
          document.getElementById('crRiskTags').innerHTML = riskHTML;

          crShowStep(2);
        }

        function crBuildTTPs() {
          var industry = crSelectedClient.industry || 'Technology / IT Services';
          var profile = crThreatProfiles[industry] || crDefaultProfile;
          var sevColor = { Critical:'red', High:'amber', Medium:'blue', Low:'gray' };
          var typeClass = { Sigma:'sigma', Correlation:'correlation', Threshold:'threshold', ML:'ml', YARA:'yara', EQL:'eql' };

          var html = profile.ttps.map(function(t) {
            return '<div class="bd-rule-item checked" onclick="this.classList.toggle(&apos;checked&apos;);this.querySelector(&apos;input&apos;).checked=!this.querySelector(&apos;input&apos;).checked;crUpdateTTPCount();">' +
              '<input type="checkbox" checked onclick="event.stopPropagation();var p=this.parentElement;p.classList.toggle(&apos;checked&apos;,this.checked);crUpdateTTPCount();">' +
              '<div class="rule-info"><div class="rule-name">' + t.technique + ' â€” ' + t.name + '</div>' +
              '<div class="rule-meta"><span class="rule-type-badge ' + (typeClass[t.type]||'sigma') + '">' + t.type + '</span>' +
              '<span class="badge badge-' + (sevColor[t.sev]||'blue') + '" style="font-size:9px;">' + t.sev + '</span>' +
              '<span style="font-size:9px;color:var(--text-muted);">AI-recommended</span></div></div></div>';
          }).join('');
          document.getElementById('crTTPList').innerHTML = html;
          crUpdateTTPCount();
          crShowStep(3);
        }

        function crUpdateTTPCount() {
          var c = document.querySelectorAll('#crTTPList .bd-rule-item.checked').length;
          document.getElementById('crTTPChecked').textContent = c;
        }

        function crBuildSummary() {
          document.getElementById('crSumClient').textContent = crSelectedClient.name || 'â€”';
          document.getElementById('crSumIndustry').textContent = crSelectedClient.industry || 'â€”';
          // Count actors
          var industry = crSelectedClient.industry || 'Technology / IT Services';
          var profile = crThreatProfiles[industry] || crDefaultProfile;
          document.getElementById('crSumActors').textContent = profile.actors.map(function(a){ return a.name.split('(')[0].trim(); }).join(', ');
          document.getElementById('crSumRules').textContent = document.getElementById('crTTPChecked').textContent + ' rules';
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           EMERGING THREATS FILTER LOGIC
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        function etFilter(btn, status) {
          btn.parentElement.querySelectorAll('.filter-chip').forEach(function(c){ c.classList.remove('active'); });
          btn.classList.add('active');
          document.querySelectorAll('#etThreatList .et-threat-card').forEach(function(card) {
            if (status === 'all') { card.style.display = ''; }
            else { card.style.display = card.getAttribute('data-et-status') === status ? '' : 'none'; }
          });
        }
        </script>

      </div><!-- end rules -->





      <!-- =====================================================
           PAGE 7: RULE TESTING LAB  (Full Overhaul â€” BAS-style)
           ===================================================== -->
      <div class="page" id="page-rulelab">

        <style>
          /* â”€â”€ Rule Testing Lab Styles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          .rl-tab-nav { display:flex; align-items:center; gap:0; border-bottom:1px solid rgba(255,255,255,0.07); margin-bottom:20px; background:transparent; }
          .rl-tab-btn { display:flex; align-items:center; gap:7px; padding:11px 18px; font-family:'IBM Plex Sans',sans-serif; font-size:13px; font-weight:500; color:#64748b; background:transparent; border:none; border-bottom:2px solid transparent; cursor:pointer; white-space:nowrap; transition:color .15s,border-color .15s; outline:none; position:relative; bottom:-1px; }
          .rl-tab-btn:hover { color:#94a3b8; }
          .rl-tab-btn.active { color:#00d4ff; border-bottom-color:#00d4ff; font-weight:600; }
          .rl-tab-btn .tab-count { background:rgba(0,212,255,0.12); color:var(--cyan); font-size:10px; font-weight:700; padding:2px 7px; border-radius:10px; font-family:var(--font-mono); }
          .rl-panel { display:none; }
          .rl-panel.active { display:block; }

          /* Simulation cards */
          .rl-sim-card { padding:16px; background:rgba(15,23,42,0.5); border:1px solid var(--border-card); border-radius:10px; margin-bottom:12px; transition:border-color .2s; cursor:pointer; }
          .rl-sim-card:hover { border-color:rgba(0,212,255,0.25); }
          .rl-sim-card.running { border-color:rgba(0,212,255,0.4); background:rgba(0,212,255,0.02); }
          .rl-sim-header { display:flex; align-items:center; gap:12px; margin-bottom:10px; }
          .rl-sim-icon { width:40px; height:40px; border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:18px; }
          .rl-sim-icon.malware { background:rgba(239,68,68,0.12); border:1px solid rgba(239,68,68,0.25); }
          .rl-sim-icon.lateral { background:rgba(167,139,250,0.12); border:1px solid rgba(167,139,250,0.25); }
          .rl-sim-icon.exfil { background:rgba(251,191,36,0.12); border:1px solid rgba(251,191,36,0.25); }
          .rl-sim-icon.persistence { background:rgba(244,114,182,0.12); border:1px solid rgba(244,114,182,0.25); }
          .rl-sim-icon.credential { background:rgba(96,165,250,0.12); border:1px solid rgba(96,165,250,0.25); }
          .rl-sim-icon.c2 { background:rgba(52,211,153,0.12); border:1px solid rgba(52,211,153,0.25); }

          /* Score rings */
          .rl-score-ring { position:relative; width:100px; height:100px; }
          .rl-score-ring svg { transform:rotate(-90deg); }
          .rl-score-ring .score-text { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-family:var(--font-display); font-size:24px; font-weight:800; }
          .rl-score-ring .score-label { position:absolute; bottom:-4px; left:50%; transform:translateX(-50%); font-size:9px; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.06em; white-space:nowrap; }

          /* Validation result bars */
          .rl-result-bar { display:flex; align-items:center; gap:10px; padding:8px 12px; border-bottom:1px solid var(--border-subtle); }
          .rl-result-bar:last-child { border-bottom:none; }
          .rl-result-status { width:22px; height:22px; border-radius:6px; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:700; }
          .rl-result-status.detected { background:rgba(16,185,129,0.15); color:var(--green); }
          .rl-result-status.blocked { background:rgba(0,212,255,0.15); color:var(--cyan); }
          .rl-result-status.missed { background:rgba(239,68,68,0.15); color:var(--red-bright); }
          .rl-result-status.partial { background:rgba(245,158,11,0.15); color:var(--amber); }

          /* Test builder chain */
          .rl-chain { display:flex; align-items:center; gap:0; padding:10px 0; overflow-x:auto; }
          .rl-chain-step { display:flex; flex-direction:column; align-items:center; gap:6px; min-width:120px; padding:12px 10px; background:rgba(15,23,42,0.4); border:1px solid var(--border-card); border-radius:10px; position:relative; }
          .rl-chain-step:not(:last-child)::after { content:'â†’'; position:absolute; right:-14px; top:50%; transform:translateY(-50%); color:rgba(0,212,255,0.4); font-size:16px; font-weight:700; z-index:2; }
          .rl-chain-step .step-num { font-size:9px; font-weight:700; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.08em; }
          .rl-chain-step .step-name { font-size:11px; font-weight:600; color:var(--text-primary); text-align:center; }
          .rl-chain-step .step-technique { font-size:9px; color:var(--cyan); font-family:var(--font-mono); }



          /* â”€â”€ RVQ Flow Diagram â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          .rvq-flow-diagram { display:flex; align-items:center; gap:0; overflow-x:auto; padding:4px 0; }
          .rvq-flow-node { flex:1; min-width:120px; display:flex; flex-direction:column; align-items:center; gap:6px; padding:16px 8px 12px; background:rgba(var(--node-color),0.03); border:1px solid rgba(var(--node-color),0.12); border-radius:10px; position:relative; transition:all .2s; }
          .rvq-flow-node:hover { background:rgba(var(--node-color),0.06); border-color:rgba(var(--node-color),0.25); transform:translateY(-2px); }
          .rvq-fn-icon { width:36px; height:36px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:rgba(var(--node-color),0.08); border:1px solid rgba(var(--node-color),0.2); }
          .rvq-fn-num { font-size:8px; font-weight:700; text-transform:uppercase; letter-spacing:1.5px; color:rgba(var(--node-color),0.6); font-family:var(--font-mono); }
          .rvq-fn-title { font-size:11px; font-weight:700; color:var(--text-primary); text-align:center; }
          .rvq-fn-desc { font-size:9px; color:var(--text-muted); text-align:center; line-height:1.4; max-width:130px; }
          .rvq-fn-time { font-size:9px; font-family:var(--font-mono); color:rgba(var(--node-color),0.7); background:rgba(var(--node-color),0.06); padding:2px 8px; border-radius:4px; }
          .rvq-flow-arrow { flex-shrink:0; display:flex; align-items:center; padding:0 2px; }

          /* â”€â”€ Rule Validation Queue â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          .rvq-card { background:rgba(15,23,42,0.5); border:1px solid var(--border-card); border-radius:10px; padding:16px; margin-bottom:10px; transition:border-color .18s; }
          .rvq-card:hover { border-color:rgba(0,212,255,0.2); }
          .rvq-card .rvq-header { display:flex; align-items:flex-start; gap:12px; margin-bottom:12px; }
          .rvq-card .rvq-origin { font-size:9px; font-weight:700; padding:3px 8px; border-radius:5px; letter-spacing:0.3px; text-transform:uppercase; flex-shrink:0; }
          .rvq-card .rvq-origin.emerging { background:rgba(139,92,246,0.12); color:#a78bfa; border:1px solid rgba(139,92,246,0.2); }
          .rvq-card .rvq-origin.syntax { background:rgba(0,212,255,0.08); color:var(--cyan); border:1px solid rgba(0,212,255,0.15); }
          .rvq-card .rvq-origin.bulk { background:rgba(245,158,11,0.08); color:var(--amber); border:1px solid rgba(245,158,11,0.15); }
          .rvq-card .rvq-origin.manual { background:rgba(34,197,94,0.08); color:#22c55e; border:1px solid rgba(34,197,94,0.15); }
          .rvq-card .rvq-origin.ai-create { background:rgba(244,114,182,0.08); color:#f472b6; border:1px solid rgba(244,114,182,0.15); }

          .rvq-test-pipeline { display:flex; align-items:center; gap:0; margin:12px 0; }
          .rvq-test-step { flex:1; padding:10px 8px; text-align:center; position:relative; border:1px solid rgba(255,255,255,0.06); background:rgba(255,255,255,0.01); }
          .rvq-test-step:first-child { border-radius:8px 0 0 8px; }
          .rvq-test-step:last-child { border-radius:0 8px 8px 0; }
          .rvq-test-step .ts-label { font-size:9px; font-weight:600; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.5px; }
          .rvq-test-step .ts-status { font-size:10px; font-weight:700; margin-top:3px; }
          .rvq-test-step.passed { background:rgba(34,197,94,0.04); border-color:rgba(34,197,94,0.15); }
          .rvq-test-step.passed .ts-status { color:#22c55e; }
          .rvq-test-step.failed { background:rgba(239,68,68,0.04); border-color:rgba(239,68,68,0.15); }
          .rvq-test-step.failed .ts-status { color:var(--red-bright); }
          .rvq-test-step.running { background:rgba(0,212,255,0.04); border-color:rgba(0,212,255,0.2); }
          .rvq-test-step.running .ts-status { color:var(--cyan); }
          .rvq-test-step.pending { }
          .rvq-test-step.pending .ts-status { color:var(--text-muted); }

          .rvq-rules-list { background:rgba(0,0,0,0.2); border-radius:8px; padding:8px 12px; margin-bottom:12px; }
          .rvq-rule-row { display:flex; align-items:center; gap:8px; padding:6px 0; border-bottom:1px solid rgba(255,255,255,0.04); }
          .rvq-rule-row:last-child { border-bottom:none; }
          .rvq-actions { display:flex; gap:8px; justify-content:flex-end; align-items:center; }
          /* â”€â”€ RVQ Filter Chips (darker) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          #rl-panel-queue .filter-chip { font-size:11px; font-weight:500; padding:6px 14px; border-radius:8px; border:1px solid rgba(255,255,255,0.05); background:rgba(255,255,255,0.02); color:var(--text-muted); cursor:pointer; transition:all .15s; }
          #rl-panel-queue .filter-chip:hover { border-color:rgba(0,212,255,0.15); color:var(--text-secondary); background:rgba(0,212,255,0.03); }
          #rl-panel-queue .filter-chip.active { background:rgba(0,212,255,0.06); border-color:rgba(0,212,255,0.18); color:var(--cyan); font-weight:600; }

          /* Schedule modal mini */
          .rl-sched-row { display:flex; align-items:center; gap:10px; padding:8px 12px; background:rgba(255,255,255,0.02); border:1px solid var(--border-subtle); border-radius:8px; margin-bottom:8px; }
        </style>

        <div class="page-header">
          <div>
            <div class="page-title">Rule Testing Lab</div>
            <div class="page-subtitle">Breach &amp; Attack Simulation Â· Security Control Validation Â· Purple Teaming</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm" onclick="showToast('Loading last test results...')">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
              Test Reports
            </button>
            <button class="btn btn-primary btn-sm" onclick="switchRlTab('simulations'); showToast('Select a simulation to run')">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>
              New Simulation
            </button>
          </div>
        </div>

        <!-- TAB NAVIGATION -->
        <div class="rl-tab-nav">
          <button class="rl-tab-btn active" data-rltab="simulations" onclick="switchRlTab('simulations')">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
            Attack Simulations
          </button>
          <button class="rl-tab-btn" data-rltab="queue" onclick="switchRlTab('queue')">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg>
            Rule Validation Queue <span class="tab-count" style="background:rgba(245,158,11,0.15);color:var(--amber);">9</span>
          </button>
          <button class="rl-tab-btn" data-rltab="results" onclick="switchRlTab('results')">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
            Validation Results <span class="tab-count">24</span>
          </button>
          <button class="rl-tab-btn" data-rltab="gaps" onclick="switchRlTab('gaps')">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
            Gap Analysis
          </button>
          <button class="rl-tab-btn" data-rltab="builder" onclick="switchRlTab('builder')">
            <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>
            Test Builder
          </button>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 1: ATTACK SIMULATIONS
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="rl-panel active" id="rl-panel-simulations">

          <!-- Quick Stats -->
          <div class="dr-repo-stats" style="grid-template-columns:repeat(5,1fr);margin-bottom:16px;">
            <div class="dr-stat-card cyan"><div class="val">26,400</div><div class="lbl">Attack Actions</div></div>
            <div class="dr-stat-card green"><div class="val">89%</div><div class="lbl">Prevention Score</div></div>
            <div class="dr-stat-card amber"><div class="val">74%</div><div class="lbl">Detection Score</div></div>
            <div class="dr-stat-card purple"><div class="val">156</div><div class="lbl">Tests This Month</div></div>
            <div class="dr-stat-card red"><div class="val">12</div><div class="lbl">Critical Gaps</div></div>
          </div>

          <!-- Simulation Library -->
          <div class="card" style="margin-bottom:16px;">
            <div class="card-header">
              <span class="card-title">Simulation Library</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <input class="filter-input" placeholder="Search simulations..." style="width:200px;">
                <select class="filter-select" style="font-size:11px;">
                  <option>All Categories</option>
                  <option>Ransomware</option>
                  <option>APT Emulation</option>
                  <option>Credential Theft</option>
                  <option>Lateral Movement</option>
                  <option>Data Exfiltration</option>
                  <option>C2 Communication</option>
                  <option>Persistence</option>
                  <option>Defense Evasion</option>
                </select>
              </div>
            </div>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
              <!-- Simulation 1 -->
              <div class="rl-sim-card" onclick="showToast('Launching ransomware simulation against Dacta Global sandbox...')">
                <div class="rl-sim-header">
                  <div class="rl-sim-icon malware">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                  </div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">LockBit 3.0 Full Kill Chain</div>
                    <div style="font-size:10px;color:var(--text-muted);">14 attack steps Â· 8 MITRE techniques Â· ~12 min</div>
                  </div>
                  <span class="badge badge-red">Critical</span>
                </div>
                <div style="display:flex;gap:4px;flex-wrap:wrap;">
                  <span class="mitre-tag">T1566</span><span class="mitre-tag">T1059</span><span class="mitre-tag">T1003</span><span class="mitre-tag">T1486</span>
                  <span class="mitre-tag">T1021</span><span class="mitre-tag">T1070</span><span class="mitre-tag">T1547</span><span class="mitre-tag">T1489</span>
                </div>
                <div style="display:flex;gap:12px;margin-top:10px;font-size:10px;">
                  <span style="color:var(--green);">Last run: 89% detected</span>
                  <span style="color:var(--text-muted);">3 days ago</span>
                  <span style="color:var(--text-muted);">Dacta Global</span>
                </div>
              </div>

              <!-- Simulation 2 -->
              <div class="rl-sim-card" onclick="showToast('Launching APT29 simulation...')">
                <div class="rl-sim-header">
                  <div class="rl-sim-icon lateral">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#a78bfa" stroke-width="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/></svg>
                  </div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">APT29 (Cozy Bear) Emulation</div>
                    <div style="font-size:10px;color:var(--text-muted);">22 attack steps Â· 12 MITRE techniques Â· ~25 min</div>
                  </div>
                  <span class="badge badge-red">Critical</span>
                </div>
                <div style="display:flex;gap:4px;flex-wrap:wrap;">
                  <span class="mitre-tag">T1566</span><span class="mitre-tag">T1204</span><span class="mitre-tag">T1059</span><span class="mitre-tag">T1053</span>
                  <span class="mitre-tag">T1098</span><span class="mitre-tag">T1003</span>
                </div>
                <div style="display:flex;gap:12px;margin-top:10px;font-size:10px;">
                  <span style="color:var(--amber);">Last run: 72% detected</span>
                  <span style="color:var(--text-muted);">5 days ago</span>
                  <span style="color:var(--text-muted);">All Clients</span>
                </div>
              </div>

              <!-- Simulation 3 -->
              <div class="rl-sim-card" onclick="showToast('Launching credential theft simulation...')">
                <div class="rl-sim-header">
                  <div class="rl-sim-icon credential">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#60a5fa" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
                  </div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Credential Harvesting &amp; Kerberoasting</div>
                    <div style="font-size:10px;color:var(--text-muted);">8 attack steps Â· 5 MITRE techniques Â· ~8 min</div>
                  </div>
                  <span class="badge badge-amber">High</span>
                </div>
                <div style="display:flex;gap:4px;flex-wrap:wrap;">
                  <span class="mitre-tag">T1003</span><span class="mitre-tag">T1558</span><span class="mitre-tag">T1110</span>
                  <span class="mitre-tag">T1555</span><span class="mitre-tag">T1552</span>
                </div>
                <div style="display:flex;gap:12px;margin-top:10px;font-size:10px;">
                  <span style="color:var(--green);">Last run: 95% detected</span>
                  <span style="color:var(--text-muted);">1 day ago</span>
                  <span style="color:var(--text-muted);">SPMT</span>
                </div>
              </div>

              <!-- Simulation 4 -->
              <div class="rl-sim-card" onclick="showToast('Launching data exfiltration simulation...')">
                <div class="rl-sim-header">
                  <div class="rl-sim-icon exfil">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fbbf24" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                  </div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Data Exfiltration via DNS Tunneling</div>
                    <div style="font-size:10px;color:var(--text-muted);">6 attack steps Â· 4 MITRE techniques Â· ~6 min</div>
                  </div>
                  <span class="badge badge-amber">High</span>
                </div>
                <div style="display:flex;gap:4px;flex-wrap:wrap;">
                  <span class="mitre-tag">T1048</span><span class="mitre-tag">T1071</span><span class="mitre-tag">T1041</span><span class="mitre-tag">T1567</span>
                </div>
                <div style="display:flex;gap:12px;margin-top:10px;font-size:10px;">
                  <span style="color:var(--red-bright);">Last run: 48% detected</span>
                  <span style="color:var(--text-muted);">7 days ago</span>
                  <span style="color:var(--text-muted);">Naga World</span>
                </div>
              </div>

              <!-- Simulation 5 -->
              <div class="rl-sim-card" onclick="showToast('Launching C2 beaconing simulation...')">
                <div class="rl-sim-header">
                  <div class="rl-sim-icon c2">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#34d399" stroke-width="2"><circle cx="12" cy="12" r="2"/><path d="M16.24 7.76a6 6 0 010 8.49m-8.48-.01a6 6 0 010-8.49m11.31-2.82a10 10 0 010 14.14m-14.14 0a10 10 0 010-14.14"/></svg>
                  </div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Cobalt Strike C2 Beaconing</div>
                    <div style="font-size:10px;color:var(--text-muted);">10 attack steps Â· 6 MITRE techniques Â· ~10 min</div>
                  </div>
                  <span class="badge badge-red">Critical</span>
                </div>
                <div style="display:flex;gap:4px;flex-wrap:wrap;">
                  <span class="mitre-tag">T1071</span><span class="mitre-tag">T1573</span><span class="mitre-tag">T1105</span>
                  <span class="mitre-tag">T1095</span><span class="mitre-tag">T1572</span><span class="mitre-tag">T1090</span>
                </div>
                <div style="display:flex;gap:12px;margin-top:10px;font-size:10px;">
                  <span style="color:var(--green);">Last run: 91% detected</span>
                  <span style="color:var(--text-muted);">2 days ago</span>
                  <span style="color:var(--text-muted);">All Clients</span>
                </div>
              </div>

              <!-- Simulation 6 -->
              <div class="rl-sim-card" onclick="showToast('Launching persistence simulation...')">
                <div class="rl-sim-header">
                  <div class="rl-sim-icon persistence">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f472b6" stroke-width="2"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M12 6v6l4 2"/></svg>
                  </div>
                  <div style="flex:1;">
                    <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Persistence &amp; Defense Evasion Suite</div>
                    <div style="font-size:10px;color:var(--text-muted);">18 attack steps Â· 10 MITRE techniques Â· ~15 min</div>
                  </div>
                  <span class="badge badge-amber">High</span>
                </div>
                <div style="display:flex;gap:4px;flex-wrap:wrap;">
                  <span class="mitre-tag">T1547</span><span class="mitre-tag">T1053</span><span class="mitre-tag">T1098</span>
                  <span class="mitre-tag">T1562</span><span class="mitre-tag">T1070</span><span class="mitre-tag">T1036</span>
                </div>
                <div style="display:flex;gap:12px;margin-top:10px;font-size:10px;">
                  <span style="color:var(--amber);">Last run: 67% detected</span>
                  <span style="color:var(--text-muted);">4 days ago</span>
                  <span style="color:var(--text-muted);">Dacta Global</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Scheduled Tests -->
          <div class="card">
            <div class="card-header"><span class="card-title">Scheduled Simulations</span><button class="btn btn-xs btn-primary" onclick="showToast('Opening scheduler...')">+ Schedule Test</button></div>
            <div style="display:flex;flex-direction:column;gap:6px;">
              <div class="rl-sched-row">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">Weekly Ransomware Validation</div><div style="font-size:10px;color:var(--text-muted);">Every Monday 02:00 UTC Â· All SOCaaS clients</div></div>
                <span class="badge badge-green">Active</span>
                <button class="btn btn-xs btn-secondary">Edit</button>
              </div>
              <div class="rl-sched-row">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">Monthly Full ATT&amp;CK Sweep</div><div style="font-size:10px;color:var(--text-muted);">1st of every month 03:00 UTC Â· All clients</div></div>
                <span class="badge badge-green">Active</span>
                <button class="btn btn-xs btn-secondary">Edit</button>
              </div>
              <div class="rl-sched-row">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--amber)" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">Daily C2 Detection Check</div><div style="font-size:10px;color:var(--text-muted);">Every day 06:00 UTC Â· Naga World, Dacta Global</div></div>
                <span class="badge badge-green">Active</span>
                <button class="btn btn-xs btn-secondary">Edit</button>
              </div>
            </div>
          </div>
        </div>


        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB: RULE VALIDATION QUEUE
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="rl-panel" id="rl-panel-queue">

          <!-- Queue Explainer -->
          <div style="padding:12px 16px;background:rgba(0,212,255,0.03);border:1px solid rgba(0,212,255,0.08);border-radius:10px;margin-bottom:16px;">
            <div style="font-size:11px;color:var(--text-secondary);line-height:1.7;">
              Rules sent from <strong style="color:var(--text-primary);">Detection Rules</strong> (Emerging Threats, Updated Syntax, Bulk Deploy, AI Rule Creation) land here for structured validation. Every rule must pass <strong style="color:var(--text-primary);">5 automated tests</strong> before it can be saved to the Rule Repository or deployed to production.
            </div>
          </div>

          <!-- Queue Stats -->
          <div class="dr-repo-stats" style="grid-template-columns:repeat(5,1fr);margin-bottom:16px;">
            <div class="dr-stat-card" style="border-left:3px solid var(--amber);"><div class="val" style="color:var(--amber);">9</div><div class="lbl">In Queue</div></div>
            <div class="dr-stat-card" style="border-left:3px solid var(--cyan);"><div class="val" style="color:var(--cyan);">4</div><div class="lbl">Testing Now</div></div>
            <div class="dr-stat-card" style="border-left:3px solid #22c55e;"><div class="val" style="color:#22c55e;">31</div><div class="lbl">Passed (This Month)</div></div>
            <div class="dr-stat-card" style="border-left:3px solid var(--red-bright);"><div class="val" style="color:var(--red-bright);">6</div><div class="lbl">Failed (This Month)</div></div>
            <div class="dr-stat-card" style="border-left:3px solid #a78bfa;"><div class="val" style="color:#a78bfa;">2m 14s</div><div class="lbl">Avg Test Duration</div></div>
          </div>

          <!-- 5-Stage Validation Pipeline â€” SVG Flow Diagram -->
          <div class="card" style="margin-bottom:16px;padding:20px 16px 16px;">
            <div style="font-size:12px;font-weight:600;color:var(--text-primary);margin-bottom:14px;display:flex;align-items:center;gap:8px;">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
              Automated Validation Pipeline
            </div>
            <div class="rvq-flow-diagram">
              <!-- Step 1 -->
              <div class="rvq-flow-node" style="--node-color:139,92,246;">
                <div class="rvq-fn-icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="rgba(167,139,250,1)" stroke-width="1.8"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                </div>
                <div class="rvq-fn-num">STAGE 1</div>
                <div class="rvq-fn-title">Syntax Check</div>
                <div class="rvq-fn-desc">Sigma YAML schema &amp; field validation</div>
                <div class="rvq-fn-time">~5s</div>
              </div>
              <div class="rvq-flow-arrow"><svg width="24" height="12" viewBox="0 0 24 12"><path d="M0 6h18" stroke="rgba(0,212,255,0.3)" stroke-width="1.5"/><path d="M16 2l5 4-5 4" stroke="rgba(0,212,255,0.4)" stroke-width="1.5" fill="none"/></svg></div>
              <!-- Step 2 -->
              <div class="rvq-flow-node" style="--node-color:0,212,255;">
                <div class="rvq-fn-icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="rgba(0,212,255,1)" stroke-width="1.8"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>
                </div>
                <div class="rvq-fn-num">STAGE 2</div>
                <div class="rvq-fn-title">Log Source Match</div>
                <div class="rvq-fn-desc">Verify log sources &amp; field schema in SIEM</div>
                <div class="rvq-fn-time">~8s</div>
              </div>
              <div class="rvq-flow-arrow"><svg width="24" height="12" viewBox="0 0 24 12"><path d="M0 6h18" stroke="rgba(0,212,255,0.3)" stroke-width="1.5"/><path d="M16 2l5 4-5 4" stroke="rgba(0,212,255,0.4)" stroke-width="1.5" fill="none"/></svg></div>
              <!-- Step 3 -->
              <div class="rvq-flow-node" style="--node-color:245,158,11;">
                <div class="rvq-fn-icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="rgba(245,158,11,1)" stroke-width="1.8"><path d="M3 3h18v18H3z"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>
                </div>
                <div class="rvq-fn-num">STAGE 3</div>
                <div class="rvq-fn-title">Historical Replay</div>
                <div class="rvq-fn-desc">30-day log replay &amp; FP rate analysis</div>
                <div class="rvq-fn-time">~45s</div>
              </div>
              <div class="rvq-flow-arrow"><svg width="24" height="12" viewBox="0 0 24 12"><path d="M0 6h18" stroke="rgba(0,212,255,0.3)" stroke-width="1.5"/><path d="M16 2l5 4-5 4" stroke="rgba(0,212,255,0.4)" stroke-width="1.5" fill="none"/></svg></div>
              <!-- Step 4 -->
              <div class="rvq-flow-node" style="--node-color:244,114,182;">
                <div class="rvq-fn-icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="rgba(244,114,182,1)" stroke-width="1.8"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
                </div>
                <div class="rvq-fn-num">STAGE 4</div>
                <div class="rvq-fn-title">Performance</div>
                <div class="rvq-fn-desc">Query speed &amp; resource benchmarks</div>
                <div class="rvq-fn-time">~20s</div>
              </div>
              <div class="rvq-flow-arrow"><svg width="24" height="12" viewBox="0 0 24 12"><path d="M0 6h18" stroke="rgba(0,212,255,0.3)" stroke-width="1.5"/><path d="M16 2l5 4-5 4" stroke="rgba(0,212,255,0.4)" stroke-width="1.5" fill="none"/></svg></div>
              <!-- Step 5 -->
              <div class="rvq-flow-node" style="--node-color:34,197,94;">
                <div class="rvq-fn-icon">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="rgba(34,197,94,1)" stroke-width="1.8"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="M9 12l2 2 4-4"/></svg>
                </div>
                <div class="rvq-fn-num">STAGE 5</div>
                <div class="rvq-fn-title">Peer Review</div>
                <div class="rvq-fn-desc">AI logic &amp; MITRE mapping validation</div>
                <div class="rvq-fn-time">~15s</div>
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:8px;margin-top:12px;padding:8px 12px;background:rgba(0,212,255,0.02);border:1px solid rgba(0,212,255,0.06);border-radius:6px;">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
              <span style="font-size:10px;color:var(--text-muted);line-height:1.5;">Avg total pipeline: <strong style="color:var(--text-primary);">2m 14s</strong> &middot; Rules must pass all 5 stages before entering the Rule Repository or deploying to production</span>
            </div>
          </div>

          <!-- Filter Bar -->
          <div style="display:flex;gap:8px;align-items:center;margin-bottom:14px;flex-wrap:wrap;">
            <span style="font-size:11px;color:var(--text-muted);margin-right:4px;">Source:</span>
            <button class="filter-chip active" onclick="rvqFilter(this,'all')">All</button>
            <button class="filter-chip" onclick="rvqFilter(this,'emerging')">Emerging Threats</button>
            <button class="filter-chip" onclick="rvqFilter(this,'syntax')">Updated Syntax</button>
            <button class="filter-chip" onclick="rvqFilter(this,'bulk')">Bulk Deploy</button>
            <button class="filter-chip" onclick="rvqFilter(this,'ai-create')">AI Rule Creation</button>
            <div style="flex:1;"></div>
            <button class="btn btn-xs btn-primary" onclick="showToast('Running all queued tests in parallel...')">Run All Tests</button>
          </div>

          <!-- QUEUE ITEMS -->
          <div id="rvqList">

            <!-- â•â•â• ITEM 1: Emerging Threats â€” FortiOS CVE (3 rules, testing now) â•â•â• -->
            <div class="rvq-card" data-rvq-source="emerging">
              <div class="rvq-header">
                <span class="rvq-origin emerging">Emerging Threats</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);">FortiOS SSL-VPN Heap Overflow â€” CVE-2026-1847</div>
                  <div style="font-size:10px;color:var(--text-muted);">Sent to testing 32 min ago &middot; 3 rules &middot; Targets: SPMT, Naga World</div>
                </div>
                <span class="badge badge-cyan" style="font-size:9px;">Testing</span>
              </div>

              <div class="rvq-test-pipeline">
                <div class="rvq-test-step passed">
                  <div class="ts-label">Syntax</div>
                  <div class="ts-status">&#10003; Passed</div>
                </div>
                <div class="rvq-test-step passed">
                  <div class="ts-label">Log Source</div>
                  <div class="ts-status">&#10003; Matched</div>
                </div>
                <div class="rvq-test-step running">
                  <div class="ts-label">Historical</div>
                  <div class="ts-status">&#9881; Replaying...</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Performance</div>
                  <div class="ts-status">&mdash; Pending</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Peer Review</div>
                  <div class="ts-status">&mdash; Pending</div>
                </div>
              </div>

              <div class="rvq-rules-list">
                <div class="rvq-rule-row">
                  <span class="rule-type-badge sigma" style="font-size:9px;">Sigma</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">FortiOS SSL-VPN Heap Overflow Exploitation Attempt</span>
                  <span class="mitre-tag" style="font-size:9px;">T1190</span>
                  <span style="font-size:9px;color:var(--cyan);font-weight:600;">2/5 tests</span>
                </div>
                <div class="rvq-rule-row">
                  <span class="rule-type-badge correlation" style="font-size:9px;">Correlation</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">SSL-VPN Auth Anomaly + Suspicious Process Spawn</span>
                  <span class="mitre-tag" style="font-size:9px;">T1190&rarr;T1059</span>
                  <span style="font-size:9px;color:var(--cyan);font-weight:600;">2/5 tests</span>
                </div>
                <div class="rvq-rule-row">
                  <span class="rule-type-badge sigma" style="font-size:9px;">Sigma</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">UNC3886 Known IOC â€” C2 Callback Pattern</span>
                  <span class="mitre-tag" style="font-size:9px;">T1071.001</span>
                  <span style="font-size:9px;color:var(--cyan);font-weight:600;">2/5 tests</span>
                </div>
              </div>

              <div class="rvq-actions">
                <span style="font-size:10px;color:var(--text-muted);">Historical replay: 47% complete â€” scanning 30d of FortiGate logs</span>
                <button class="btn btn-xs btn-secondary" onclick="showToast('Opening live test progress...')">View Live</button>
              </div>
            </div>

            <!-- â•â•â• ITEM 2: Updated Syntax â€” Windows 23 rules (testing now) â•â•â• -->
            <div class="rvq-card" data-rvq-source="syntax">
              <div class="rvq-header">
                <span class="rvq-origin syntax">Updated Syntax</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Windows Security Event ID Schema Change â€” 23 Rules</div>
                  <div style="font-size:10px;color:var(--text-muted);">Sent to testing 2 hrs ago &middot; 23 rules &middot; Field: NewProcessName &rarr; ProcessName</div>
                </div>
                <span class="badge badge-cyan" style="font-size:9px;">Testing</span>
              </div>

              <div class="rvq-test-pipeline">
                <div class="rvq-test-step passed">
                  <div class="ts-label">Syntax</div>
                  <div class="ts-status">&#10003; Passed</div>
                </div>
                <div class="rvq-test-step passed">
                  <div class="ts-label">Log Source</div>
                  <div class="ts-status">&#10003; Matched</div>
                </div>
                <div class="rvq-test-step passed">
                  <div class="ts-label">Historical</div>
                  <div class="ts-status">&#10003; 0 FP</div>
                </div>
                <div class="rvq-test-step running">
                  <div class="ts-label">Performance</div>
                  <div class="ts-status">&#9881; Benchmarking</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Peer Review</div>
                  <div class="ts-status">&mdash; Pending</div>
                </div>
              </div>

              <div class="rvq-rules-list">
                <div class="rvq-rule-row">
                  <span style="font-size:10px;color:var(--text-primary);flex:1;">23 Sigma rules with updated Windows Security Event ID 4688 field references</span>
                  <span style="font-size:9px;color:#22c55e;font-weight:600;">21/23 passed so far</span>
                  <span style="font-size:9px;color:var(--amber);font-weight:600;">2 tuning needed</span>
                </div>
              </div>

              <div class="rvq-actions">
                <span style="font-size:10px;color:var(--text-muted);">Performance benchmark: 18/23 rules within latency threshold</span>
                <button class="btn btn-xs btn-secondary" onclick="showToast('Opening detailed results for 23 rules...')">View Details</button>
              </div>
            </div>

            <!-- â•â•â• ITEM 3: Emerging Threats â€” Scattered Spider (queued) â•â•â• -->
            <div class="rvq-card" data-rvq-source="emerging">
              <div class="rvq-header">
                <span class="rvq-origin emerging">Emerging Threats</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Scattered Spider â€” MFA Token Relay Detection</div>
                  <div style="font-size:10px;color:var(--text-muted);">Sent to testing 1 hr ago &middot; 2 rules &middot; Target: Naga World (primary)</div>
                </div>
                <span class="badge badge-amber" style="font-size:9px;">Queued</span>
              </div>

              <div class="rvq-test-pipeline">
                <div class="rvq-test-step pending">
                  <div class="ts-label">Syntax</div>
                  <div class="ts-status">&mdash; Queued</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Log Source</div>
                  <div class="ts-status">&mdash; Queued</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Historical</div>
                  <div class="ts-status">&mdash; Queued</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Performance</div>
                  <div class="ts-status">&mdash; Queued</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Peer Review</div>
                  <div class="ts-status">&mdash; Queued</div>
                </div>
              </div>

              <div class="rvq-rules-list">
                <div class="rvq-rule-row">
                  <span class="rule-type-badge correlation" style="font-size:9px;">Correlation</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">MFA Token Relay â€” Real-Time Phishing Proxy Detection</span>
                  <span class="mitre-tag" style="font-size:9px;">T1621</span>
                </div>
                <div class="rvq-rule-row">
                  <span class="rule-type-badge sigma" style="font-size:9px;">Sigma</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">Scattered Spider IOC â€” New Phishing Domain + C2 Infra</span>
                  <span class="mitre-tag" style="font-size:9px;">T1566.001</span>
                </div>
              </div>

              <div class="rvq-actions">
                <span style="font-size:10px;color:var(--text-muted);">Waiting â€” 2 test slots in use</span>
                <button class="btn btn-xs btn-primary" onclick="showToast('Prioritizing â€” moving to front of queue...')">Prioritize</button>
              </div>
            </div>

            <!-- â•â•â• ITEM 4: Updated Syntax â€” FortiGate 8 rules (testing now) â•â•â• -->
            <div class="rvq-card" data-rvq-source="syntax">
              <div class="rvq-header">
                <span class="rvq-origin syntax">Updated Syntax</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);">FortiGate Log Format v7.6 Update â€” 8 Rules</div>
                  <div style="font-size:10px;color:var(--text-muted);">Sent to testing 5 hrs ago &middot; 8 rules &middot; Fields: srcip/dstip &rarr; src_ip/dst_ip</div>
                </div>
                <span class="badge badge-cyan" style="font-size:9px;">Testing</span>
              </div>

              <div class="rvq-test-pipeline">
                <div class="rvq-test-step passed">
                  <div class="ts-label">Syntax</div>
                  <div class="ts-status">&#10003; Passed</div>
                </div>
                <div class="rvq-test-step passed">
                  <div class="ts-label">Log Source</div>
                  <div class="ts-status">&#10003; Matched</div>
                </div>
                <div class="rvq-test-step running">
                  <div class="ts-label">Historical</div>
                  <div class="ts-status">&#9881; Replaying...</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Performance</div>
                  <div class="ts-status">&mdash; Pending</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Peer Review</div>
                  <div class="ts-status">&mdash; Pending</div>
                </div>
              </div>

              <div class="rvq-rules-list">
                <div class="rvq-rule-row">
                  <span style="font-size:10px;color:var(--text-primary);flex:1;">8 Sigma rules updated for FortiOS 7.6.1 UTM log field restructure</span>
                  <span style="font-size:9px;color:#22c55e;font-weight:600;">8/8 syntax passed</span>
                </div>
              </div>

              <div class="rvq-actions">
                <span style="font-size:10px;color:var(--text-muted);">Historical replay: 62% â€” scanning SPMT and Naga World FortiGate logs</span>
                <button class="btn btn-xs btn-secondary" onclick="showToast('Opening live test progress...')">View Live</button>
              </div>
            </div>

            <!-- â•â•â• ITEM 5: AI Rule Creation â€” Naga World hospitality rules (all passed) â•â•â• -->
            <div class="rvq-card" data-rvq-source="ai-create">
              <div class="rvq-header">
                <span class="rvq-origin ai-create">AI Rule Creation</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Naga World â€” Hospitality Threat Landscape Rules</div>
                  <div style="font-size:10px;color:var(--text-muted);">Sent to testing 1 day ago &middot; 6 rules &middot; Generated by Create Rule wizard</div>
                </div>
                <span class="badge badge-green" style="font-size:9px;">All Passed</span>
              </div>

              <div class="rvq-test-pipeline">
                <div class="rvq-test-step passed">
                  <div class="ts-label">Syntax</div>
                  <div class="ts-status">&#10003; Passed</div>
                </div>
                <div class="rvq-test-step passed">
                  <div class="ts-label">Log Source</div>
                  <div class="ts-status">&#10003; Matched</div>
                </div>
                <div class="rvq-test-step passed">
                  <div class="ts-label">Historical</div>
                  <div class="ts-status">&#10003; 2 FP</div>
                </div>
                <div class="rvq-test-step passed">
                  <div class="ts-label">Performance</div>
                  <div class="ts-status">&#10003; &lt;200ms</div>
                </div>
                <div class="rvq-test-step passed">
                  <div class="ts-label">Peer Review</div>
                  <div class="ts-status">&#10003; Approved</div>
                </div>
              </div>

              <div class="rvq-rules-list">
                <div class="rvq-rule-row">
                  <span class="rule-type-badge correlation" style="font-size:9px;">Correlation</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">Ransomware â€” Data Encrypted for Impact</span>
                  <span class="mitre-tag" style="font-size:9px;">T1486</span>
                  <span style="font-size:9px;color:#22c55e;font-weight:600;">&#10003;</span>
                </div>
                <div class="rvq-rule-row">
                  <span class="rule-type-badge correlation" style="font-size:9px;">Correlation</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">MFA Fatigue Attack Detection</span>
                  <span class="mitre-tag" style="font-size:9px;">T1621</span>
                  <span style="font-size:9px;color:#22c55e;font-weight:600;">&#10003;</span>
                </div>
                <div class="rvq-rule-row">
                  <span class="rule-type-badge sigma" style="font-size:9px;">Sigma</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">LSASS Memory Credential Dumping</span>
                  <span class="mitre-tag" style="font-size:9px;">T1003.001</span>
                  <span style="font-size:9px;color:#22c55e;font-weight:600;">&#10003;</span>
                </div>
                <div style="font-size:10px;color:var(--text-muted);padding:4px 0;">+ 3 more rules (all passed)</div>
              </div>

              <div class="rvq-actions">
                <span style="font-size:10px;color:#22c55e;font-weight:600;">All 5 tests passed â€” ready to save</span>
                <button class="btn btn-xs btn-primary" onclick="showToast('6 rules saved to Rule Repository and ready for deployment...')">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
                  Save to Rule Repository
                </button>
              </div>
            </div>

            <!-- â•â•â• ITEM 6: Bulk Deploy pre-check â€” SPMT rules (failed) â•â•â• -->
            <div class="rvq-card" data-rvq-source="bulk">
              <div class="rvq-header">
                <span class="rvq-origin bulk">Bulk Deploy</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);">SPMT â€” 12 EDR + Windows Rules Pre-Deployment Validation</div>
                  <div style="font-size:10px;color:var(--text-muted);">Sent to testing 3 hrs ago &middot; 12 rules &middot; Pre-deploy check before pushing to SPMT SIEM</div>
                </div>
                <span class="badge badge-red" style="font-size:9px;">2 Failed</span>
              </div>

              <div class="rvq-test-pipeline">
                <div class="rvq-test-step passed">
                  <div class="ts-label">Syntax</div>
                  <div class="ts-status">&#10003; 12/12</div>
                </div>
                <div class="rvq-test-step passed">
                  <div class="ts-label">Log Source</div>
                  <div class="ts-status">&#10003; 12/12</div>
                </div>
                <div class="rvq-test-step failed">
                  <div class="ts-label">Historical</div>
                  <div class="ts-status">&#x2718; 2 High FP</div>
                </div>
                <div class="rvq-test-step passed">
                  <div class="ts-label">Performance</div>
                  <div class="ts-status">&#10003; 12/12</div>
                </div>
                <div class="rvq-test-step failed">
                  <div class="ts-label">Peer Review</div>
                  <div class="ts-status">&#x2718; 2 Flagged</div>
                </div>
              </div>

              <div class="rvq-rules-list">
                <div class="rvq-rule-row">
                  <span style="font-size:10px;color:#22c55e;flex:1;">10 rules passed all tests &#10003;</span>
                </div>
                <div class="rvq-rule-row" style="background:rgba(239,68,68,0.04);margin:2px -12px;padding:6px 12px;">
                  <span class="rule-type-badge sigma" style="font-size:9px;">Sigma</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">Suspicious WMI Remote Execution</span>
                  <span style="font-size:9px;color:var(--red-bright);font-weight:600;">FP Rate: 34% (threshold: &lt;5%)</span>
                </div>
                <div class="rvq-rule-row" style="background:rgba(239,68,68,0.04);margin:2px -12px;padding:6px 12px;">
                  <span class="rule-type-badge sigma" style="font-size:9px;">Sigma</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">Encoded PowerShell Download Cradle</span>
                  <span style="font-size:9px;color:var(--red-bright);font-weight:600;">Peer Review: Overly broad regex pattern</span>
                </div>
              </div>

              <div class="rvq-actions">
                <button class="btn btn-xs btn-secondary" onclick="showToast('Opening failed rules for tuning in Rule Builder...')">Tune Failed Rules</button>
                <button class="btn btn-xs btn-secondary" onclick="showToast('Re-running tests on 2 failed rules...')">Retest Failed</button>
                <button class="btn btn-xs btn-primary" onclick="showToast('Deploying 10 passed rules to SPMT SIEM. 2 failed rules held back for tuning.')">Deploy 10 Passed</button>
              </div>
            </div>

            <!-- â•â•â• ITEM 7: Emerging Threats â€” Schneider PLC (queued) â•â•â• -->
            <div class="rvq-card" data-rvq-source="emerging">
              <div class="rvq-header">
                <span class="rvq-origin emerging">Emerging Threats</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Schneider Modicon M580 PLC Logic Manipulation â€” CVE-2026-2103</div>
                  <div style="font-size:10px;color:var(--text-muted);">Sent to testing 18 min ago &middot; 3 rules &middot; Target: SPMT (OT network)</div>
                </div>
                <span class="badge badge-amber" style="font-size:9px;">Queued</span>
              </div>

              <div class="rvq-test-pipeline">
                <div class="rvq-test-step passed">
                  <div class="ts-label">Syntax</div>
                  <div class="ts-status">&#10003; Passed</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Log Source</div>
                  <div class="ts-status">&mdash; Queued</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Historical</div>
                  <div class="ts-status">&mdash; Queued</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Performance</div>
                  <div class="ts-status">&mdash; Queued</div>
                </div>
                <div class="rvq-test-step pending">
                  <div class="ts-label">Peer Review</div>
                  <div class="ts-status">&mdash; Queued</div>
                </div>
              </div>

              <div class="rvq-rules-list">
                <div class="rvq-rule-row">
                  <span class="rule-type-badge sigma" style="font-size:9px;">Sigma</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">Modbus TCP â€” Unauthorized Write to PLC Holding Registers</span>
                  <span class="mitre-tag" style="font-size:9px;">T0839</span>
                </div>
                <div class="rvq-rule-row">
                  <span class="rule-type-badge correlation" style="font-size:9px;">Correlation</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">OT Anomaly â€” PLC Logic Change + Unusual Source IP</span>
                  <span class="mitre-tag" style="font-size:9px;">T0839&rarr;T0831</span>
                </div>
                <div class="rvq-rule-row">
                  <span class="rule-type-badge sigma" style="font-size:9px;">Sigma</span>
                  <span style="font-size:11px;color:var(--text-primary);flex:1;">CHERNOVITE IOC â€” Known Recon Scanner IP Ranges</span>
                  <span class="mitre-tag" style="font-size:9px;">T0846</span>
                </div>
              </div>

              <div class="rvq-actions">
                <span style="font-size:10px;color:var(--text-muted);">Syntax validated â€” awaiting OT log source verification</span>
                <button class="btn btn-xs btn-primary" onclick="showToast('Prioritizing â€” moving to front of queue...')">Prioritize</button>
              </div>
            </div>

          </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 2: VALIDATION RESULTS
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="rl-panel" id="rl-panel-results">

          <!-- Score Rings -->
          <div style="display:flex;gap:30px;justify-content:center;margin-bottom:24px;padding:20px;background:rgba(15,23,42,0.4);border:1px solid var(--border-card);border-radius:12px;">
            <div style="text-align:center;">
              <div class="rl-score-ring">
                <svg width="100" height="100" viewBox="0 0 100 100">
                  <circle cx="50" cy="50" r="42" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="8"/>
                  <circle cx="50" cy="50" r="42" fill="none" stroke="var(--green)" stroke-width="8" stroke-dasharray="235.6 264" stroke-linecap="round"/>
                </svg>
                <div class="score-text" style="color:var(--green);">89%</div>
                <div class="score-label">Prevention</div>
              </div>
            </div>
            <div style="text-align:center;">
              <div class="rl-score-ring">
                <svg width="100" height="100" viewBox="0 0 100 100">
                  <circle cx="50" cy="50" r="42" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="8"/>
                  <circle cx="50" cy="50" r="42" fill="none" stroke="var(--amber)" stroke-width="8" stroke-dasharray="195.3 264" stroke-linecap="round"/>
                </svg>
                <div class="score-text" style="color:var(--amber);">74%</div>
                <div class="score-label">Detection</div>
              </div>
            </div>
            <div style="text-align:center;">
              <div class="rl-score-ring">
                <svg width="100" height="100" viewBox="0 0 100 100">
                  <circle cx="50" cy="50" r="42" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="8"/>
                  <circle cx="50" cy="50" r="42" fill="none" stroke="var(--cyan)" stroke-width="8" stroke-dasharray="214.4 264" stroke-linecap="round"/>
                </svg>
                <div class="score-text" style="color:var(--cyan);">81%</div>
                <div class="score-label">Overall</div>
              </div>
            </div>
            <div style="text-align:center;">
              <div class="rl-score-ring">
                <svg width="100" height="100" viewBox="0 0 100 100">
                  <circle cx="50" cy="50" r="42" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="8"/>
                  <circle cx="50" cy="50" r="42" fill="none" stroke="#a78bfa" stroke-width="8" stroke-dasharray="172 264" stroke-linecap="round"/>
                </svg>
                <div class="score-text" style="color:#a78bfa;">65%</div>
                <div class="score-label">Logging</div>
              </div>
            </div>
          </div>

          <!-- Latest Test Run Details -->
          <div class="card" style="margin-bottom:16px;">
            <div class="card-header">
              <span class="card-title">Latest Test Run: LockBit 3.0 Full Kill Chain</span>
              <div style="display:flex;gap:8px;align-items:center;">
                <span class="badge badge-green">Completed</span>
                <span style="font-size:10px;color:var(--text-muted);">Feb 28, 2026 â€” 02:14 UTC Â· Duration: 11m 42s</span>
              </div>
            </div>
            <div style="display:flex;flex-direction:column;">
              <div class="rl-result-bar">
                <div class="rl-result-status blocked">&#x2716;</div>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">1. Initial Access â€” Phishing attachment (T1566.001)</div></div>
                <span class="badge badge-cyan" style="font-size:9px;">Blocked by EDR</span>
                <span style="font-size:10px;color:var(--text-muted);">0.3s</span>
              </div>
              <div class="rl-result-bar">
                <div class="rl-result-status detected">&#10003;</div>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">2. Execution â€” PowerShell encoded command (T1059.001)</div></div>
                <span class="badge badge-green" style="font-size:9px;">Detected</span>
                <span style="font-size:10px;color:var(--text-muted);">1.2s</span>
              </div>
              <div class="rl-result-bar">
                <div class="rl-result-status detected">&#10003;</div>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">3. Defense Evasion â€” Disable Windows Defender (T1562.001)</div></div>
                <span class="badge badge-green" style="font-size:9px;">Detected</span>
                <span style="font-size:10px;color:var(--text-muted);">0.8s</span>
              </div>
              <div class="rl-result-bar">
                <div class="rl-result-status detected">&#10003;</div>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">4. Credential Access â€” LSASS memory dump (T1003.001)</div></div>
                <span class="badge badge-green" style="font-size:9px;">Detected</span>
                <span style="font-size:10px;color:var(--text-muted);">0.5s</span>
              </div>
              <div class="rl-result-bar">
                <div class="rl-result-status partial">~</div>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">5. Discovery â€” Network share enumeration (T1135)</div></div>
                <span class="badge badge-amber" style="font-size:9px;">Partial â€” Logged, no alert</span>
                <span style="font-size:10px;color:var(--text-muted);">2.1s</span>
              </div>
              <div class="rl-result-bar">
                <div class="rl-result-status detected">&#10003;</div>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">6. Lateral Movement â€” SMB admin share (T1021.002)</div></div>
                <span class="badge badge-green" style="font-size:9px;">Detected</span>
                <span style="font-size:10px;color:var(--text-muted);">1.8s</span>
              </div>
              <div class="rl-result-bar">
                <div class="rl-result-status missed">&#x2718;</div>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">7. Persistence â€” Scheduled task creation (T1053.005)</div></div>
                <span class="badge badge-red" style="font-size:9px;">Missed â€” No rule</span>
                <span style="font-size:10px;color:var(--text-muted);">â€”</span>
              </div>
              <div class="rl-result-bar">
                <div class="rl-result-status detected">&#10003;</div>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">8. Collection â€” Data staged locally (T1074.001)</div></div>
                <span class="badge badge-green" style="font-size:9px;">Detected</span>
                <span style="font-size:10px;color:var(--text-muted);">0.9s</span>
              </div>
              <div class="rl-result-bar">
                <div class="rl-result-status missed">&#x2718;</div>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">9. Exfiltration â€” HTTPS exfil to C2 (T1041)</div></div>
                <span class="badge badge-red" style="font-size:9px;">Missed â€” Log source gap</span>
                <span style="font-size:10px;color:var(--text-muted);">â€”</span>
              </div>
              <div class="rl-result-bar">
                <div class="rl-result-status blocked">&#x2716;</div>
                <div style="flex:1;"><div style="font-size:12px;font-weight:500;color:var(--text-primary);">10. Impact â€” Volume shadow copy deletion (T1490)</div></div>
                <span class="badge badge-cyan" style="font-size:9px;">Blocked by EDR</span>
                <span style="font-size:10px;color:var(--text-muted);">0.1s</span>
              </div>
            </div>
          </div>

          <!-- Vendor Remediation Suggestions -->
          <div class="card">
            <div class="card-header"><span class="card-title">Vendor-Specific Remediation</span><span class="badge badge-cyan">AI-Recommended</span></div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
              <div style="padding:12px;background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.15);border-radius:8px;">
                <div style="font-size:11px;font-weight:600;color:var(--text-primary);margin-bottom:4px;">T1053.005 â€” Scheduled Task (MISSED)</div>
                <div style="font-size:10px;color:var(--text-muted);margin-bottom:6px;">Enable Sysmon EventID 1 + Windows Security EventID 4698. Deploy Sigma rule <span style="color:var(--cyan);">proc_creation_win_schtasks_creation</span>.</div>
                <button class="btn btn-xs btn-primary" onclick="switchDrTab('builder'); showToast('Loading rule template for T1053.005...')">Create Rule</button>
              </div>
              <div style="padding:12px;background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.15);border-radius:8px;">
                <div style="font-size:11px;font-weight:600;color:var(--text-primary);margin-bottom:4px;">T1041 â€” Exfiltration Over C2 (MISSED)</div>
                <div style="font-size:10px;color:var(--text-muted);margin-bottom:6px;">Enable TLS inspection on FortiGate. Configure proxy log ingestion to SIEM. Deploy network anomaly baseline rule.</div>
                <button class="btn btn-xs btn-primary" onclick="showToast('Generating network detection rule for T1041...')">Create Rule</button>
              </div>
              <div style="padding:12px;background:rgba(245,158,11,0.04);border:1px solid rgba(245,158,11,0.15);border-radius:8px;">
                <div style="font-size:11px;font-weight:600;color:var(--text-primary);margin-bottom:4px;">T1135 â€” Network Share Discovery (PARTIAL)</div>
                <div style="font-size:10px;color:var(--text-muted);margin-bottom:6px;">Event logged but no alert rule configured. Deploy correlation rule: 5+ share enumerations from single host within 60s window.</div>
                <button class="btn btn-xs btn-primary" onclick="showToast('Generating correlation rule for T1135...')">Create Rule</button>
              </div>
              <div style="padding:12px;background:rgba(16,185,129,0.04);border:1px solid rgba(16,185,129,0.15);border-radius:8px;">
                <div style="font-size:11px;font-weight:600;color:var(--text-primary);margin-bottom:4px;">T1566.001 â€” Phishing Attachment (BLOCKED)</div>
                <div style="font-size:10px;color:var(--text-muted);margin-bottom:6px;">ThreatLocker blocked execution. Detection rule also triggered 0.3s later. Dual-layer protection confirmed.</div>
                <span class="badge badge-green" style="font-size:9px;">No action needed</span>
              </div>
            </div>
          </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 3: GAP ANALYSIS
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="rl-panel" id="rl-panel-gaps">

          <!-- Gap Summary -->
          <div class="dr-repo-stats" style="grid-template-columns:repeat(4,1fr);margin-bottom:16px;">
            <div class="dr-stat-card red"><div class="val">12</div><div class="lbl">Critical Gaps</div></div>
            <div class="dr-stat-card amber"><div class="val">22</div><div class="lbl">Medium Gaps</div></div>
            <div class="dr-stat-card green"><div class="val">187</div><div class="lbl">Covered Techniques</div></div>
            <div class="dr-stat-card cyan"><div class="val">+14</div><div class="lbl">Improved This Month</div></div>
          </div>

          <!-- Gap Table -->
          <div class="card" style="margin-bottom:16px;">
            <div class="card-header">
              <span class="card-title">Detection Gap Inventory</span>
              <div style="display:flex;gap:8px;">
                <select class="filter-select" style="font-size:11px;">
                  <option>All Priorities</option>
                  <option>Critical</option>
                  <option>High</option>
                  <option>Medium</option>
                </select>
                <select class="filter-select" style="font-size:11px;">
                  <option>All Clients</option>
                  <option>Dacta Global</option>
                  <option>SPMT</option>
                  <option>Naga World</option>
                  <option>ADV Partners</option>
                  <option>Global Advisor Co</option>
                </select>
              </div>
            </div>
            <div class="table-wrap">
              <table>
                <thead><tr><th>MITRE ID</th><th>Technique</th><th>Tactic</th><th>Gap Type</th><th>Affected Clients</th><th>Remediation</th><th>Actions</th></tr></thead>
                <tbody>
                  <tr>
                    <td class="mono" style="color:var(--cyan);">T1053.005</td>
                    <td style="color:var(--text-primary);font-weight:500;">Scheduled Task/Job</td>
                    <td>Persistence</td>
                    <td><span class="badge badge-red">No Rule</span></td>
                    <td style="font-size:10px;">All Clients</td>
                    <td style="font-size:10px;color:var(--text-muted);">Deploy Sigma rule for schtasks.exe creation + EventID 4698</td>
                    <td><button class="btn btn-xs btn-primary" onclick="showToast('AI generating rule for T1053.005...')">Fix</button></td>
                  </tr>
                  <tr>
                    <td class="mono" style="color:var(--cyan);">T1041</td>
                    <td style="color:var(--text-primary);font-weight:500;">Exfil Over C2 Channel</td>
                    <td>Exfiltration</td>
                    <td><span class="badge badge-red">No Log Source</span></td>
                    <td style="font-size:10px;">Naga World, ADV</td>
                    <td style="font-size:10px;color:var(--text-muted);">Enable proxy/TLS inspection logs. Network anomaly baseline needed.</td>
                    <td><button class="btn btn-xs btn-secondary">Config</button></td>
                  </tr>
                  <tr>
                    <td class="mono" style="color:var(--cyan);">T1134</td>
                    <td style="color:var(--text-primary);font-weight:500;">Access Token Manipulation</td>
                    <td>Privilege Escalation</td>
                    <td><span class="badge badge-red">No Rule</span></td>
                    <td style="font-size:10px;">All Clients</td>
                    <td style="font-size:10px;color:var(--text-muted);">Deploy Sysmon-based token impersonation detection</td>
                    <td><button class="btn btn-xs btn-primary" onclick="showToast('AI generating rule...')">Fix</button></td>
                  </tr>
                  <tr>
                    <td class="mono" style="color:var(--cyan);">T1135</td>
                    <td style="color:var(--text-primary);font-weight:500;">Network Share Discovery</td>
                    <td>Discovery</td>
                    <td><span class="badge badge-amber">No Alert</span></td>
                    <td style="font-size:10px;">Dacta Global</td>
                    <td style="font-size:10px;color:var(--text-muted);">Logged but no correlation rule. Add threshold rule for bulk enumeration.</td>
                    <td><button class="btn btn-xs btn-primary" onclick="showToast('Creating correlation rule...')">Fix</button></td>
                  </tr>
                  <tr>
                    <td class="mono" style="color:var(--cyan);">T1037</td>
                    <td style="color:var(--text-primary);font-weight:500;">Boot/Logon Init Scripts</td>
                    <td>Persistence</td>
                    <td><span class="badge badge-red">No Rule</span></td>
                    <td style="font-size:10px;">All Clients</td>
                    <td style="font-size:10px;color:var(--text-muted);">Monitor startup folder + registry run keys via Sysmon</td>
                    <td><button class="btn btn-xs btn-primary" onclick="showToast('AI generating rule...')">Fix</button></td>
                  </tr>
                  <tr>
                    <td class="mono" style="color:var(--cyan);">T0800</td>
                    <td style="color:var(--text-primary);font-weight:500;">Activate FW Update Mode (ICS)</td>
                    <td>Inhibit Response</td>
                    <td><span class="badge badge-red">No Log Source</span></td>
                    <td style="font-size:10px;">Naga World (OT)</td>
                    <td style="font-size:10px;color:var(--text-muted);">Requires Modbus/DNP3 protocol logging. Configure OT sensors.</td>
                    <td><button class="btn btn-xs btn-secondary">Config</button></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Purple Team Improvement Tracker -->
          <div class="card">
            <div class="card-header"><span class="card-title">Purple Team Improvement Cycle</span><span class="badge badge-cyan">Test â†’ Detect â†’ Tune â†’ Retest</span></div>
            <div style="display:flex;flex-direction:column;gap:8px;">
              <div style="padding:12px 14px;background:rgba(16,185,129,0.04);border:1px solid rgba(16,185,129,0.15);border-radius:8px;display:flex;align-items:center;gap:12px;">
                <span class="badge badge-green">Resolved</span>
                <div style="flex:1;">
                  <div style="font-size:12px;font-weight:500;color:var(--text-primary);">T1003.001 â€” LSASS Memory Dump</div>
                  <div style="font-size:10px;color:var(--text-muted);">Gap found Feb 14 â†’ Rule created Feb 15 â†’ Validated Feb 18 â†’ 100% detection</div>
                </div>
                <span style="font-size:10px;color:var(--green);font-weight:600;">4 day resolution</span>
              </div>
              <div style="padding:12px 14px;background:rgba(16,185,129,0.04);border:1px solid rgba(16,185,129,0.15);border-radius:8px;display:flex;align-items:center;gap:12px;">
                <span class="badge badge-green">Resolved</span>
                <div style="flex:1;">
                  <div style="font-size:12px;font-weight:500;color:var(--text-primary);">T1059.001 â€” PowerShell Encoded Command</div>
                  <div style="font-size:10px;color:var(--text-muted);">FP rate 35% â†’ Tuned exclusions â†’ Retested â†’ FP rate now 4%</div>
                </div>
                <span style="font-size:10px;color:var(--green);font-weight:600;">2 day resolution</span>
              </div>
              <div style="padding:12px 14px;background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.15);border-radius:8px;display:flex;align-items:center;gap:12px;">
                <span class="badge badge-cyan">In Progress</span>
                <div style="flex:1;">
                  <div style="font-size:12px;font-weight:500;color:var(--text-primary);">T1048 â€” DNS Tunneling Exfiltration</div>
                  <div style="font-size:10px;color:var(--text-muted);">Gap found Feb 22 â†’ ML baseline rule in testing â†’ Pending validation</div>
                </div>
                <span style="font-size:10px;color:var(--cyan);font-weight:600;">6 days elapsed</span>
              </div>
              <div style="padding:12px 14px;background:rgba(245,158,11,0.04);border:1px solid rgba(245,158,11,0.15);border-radius:8px;display:flex;align-items:center;gap:12px;">
                <span class="badge badge-amber">Pending</span>
                <div style="flex:1;">
                  <div style="font-size:12px;font-weight:500;color:var(--text-primary);">T1053.005 â€” Scheduled Task Persistence</div>
                  <div style="font-size:10px;color:var(--text-muted);">Gap found Feb 27 â†’ Rule creation pending â†’ Waiting for SOC lead assignment</div>
                </div>
                <span style="font-size:10px;color:var(--amber);font-weight:600;">1 day elapsed</span>
              </div>
            </div>
          </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 4: TEST BUILDER
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="rl-panel" id="rl-panel-builder">

          <div style="display:grid;grid-template-columns:1fr 300px;gap:16px;">
            <!-- Left: Attack Chain Builder -->
            <div>
              <div class="card" style="margin-bottom:16px;">
                <div class="card-header">
                  <span class="card-title">Custom Attack Chain Builder</span>
                  <div style="display:flex;gap:6px;">
                    <button class="btn btn-xs btn-secondary" onclick="showToast('Chain cleared')">Clear</button>
                    <button class="btn btn-xs btn-primary" onclick="showToast('Simulation queued for Dacta Global sandbox environment')">
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                      Run Chain
                    </button>
                  </div>
                </div>

                <!-- Visual Chain -->
                <div class="rl-chain">
                  <div class="rl-chain-step">
                    <div class="step-num">Step 1</div>
                    <div class="rl-sim-icon malware" style="width:32px;height:32px;font-size:14px;">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22 6 12 13 2 6"/></svg>
                    </div>
                    <div class="step-name">Phishing Email</div>
                    <div class="step-technique">T1566.001</div>
                  </div>
                  <div class="rl-chain-step">
                    <div class="step-num">Step 2</div>
                    <div class="rl-sim-icon credential" style="width:32px;height:32px;font-size:14px;">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#60a5fa" stroke-width="2"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>
                    </div>
                    <div class="step-name">PowerShell Exec</div>
                    <div class="step-technique">T1059.001</div>
                  </div>
                  <div class="rl-chain-step">
                    <div class="step-num">Step 3</div>
                    <div class="rl-sim-icon credential" style="width:32px;height:32px;font-size:14px;">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#60a5fa" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
                    </div>
                    <div class="step-name">LSASS Dump</div>
                    <div class="step-technique">T1003.001</div>
                  </div>
                  <div class="rl-chain-step">
                    <div class="step-num">Step 4</div>
                    <div class="rl-sim-icon lateral" style="width:32px;height:32px;font-size:14px;">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#a78bfa" stroke-width="2"><path d="M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/></svg>
                    </div>
                    <div class="step-name">Lateral via SMB</div>
                    <div class="step-technique">T1021.002</div>
                  </div>
                  <div class="rl-chain-step" style="border-style:dashed;cursor:pointer;opacity:0.5;" onclick="showToast('Add attack step â€” select from MITRE technique library')">
                    <div class="step-num">&nbsp;</div>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                    <div class="step-name" style="color:var(--text-muted);">Add Step</div>
                    <div class="step-technique">&nbsp;</div>
                  </div>
                </div>
              </div>

              <!-- Atomic Red Team Library -->
              <div class="card">
                <div class="card-header">
                  <span class="card-title">Atomic Red Team Test Library</span>
                  <div style="display:flex;gap:8px;align-items:center;">
                    <input class="filter-input" placeholder="Search atomic tests..." style="width:200px;">
                    <span class="badge badge-cyan">1,347 tests</span>
                  </div>
                </div>
                <div class="table-wrap" style="max-height:280px;overflow-y:auto;">
                  <table>
                    <thead><tr><th>Test ID</th><th>Name</th><th>MITRE</th><th>Platform</th><th>Actions</th></tr></thead>
                    <tbody>
                      <tr>
                        <td class="mono" style="color:var(--cyan);">ART-T1003-01</td>
                        <td style="color:var(--text-primary);font-weight:500;">Dump LSASS.exe Memory using ProcDump</td>
                        <td><span class="mitre-tag">T1003.001</span></td>
                        <td><span class="logsrc-tag windows">Windows</span></td>
                        <td><button class="btn btn-xs btn-secondary" onclick="showToast('Added to attack chain as Step 5')">+ Add</button></td>
                      </tr>
                      <tr>
                        <td class="mono" style="color:var(--cyan);">ART-T1059-01</td>
                        <td style="color:var(--text-primary);font-weight:500;">PowerShell Download Cradle</td>
                        <td><span class="mitre-tag">T1059.001</span></td>
                        <td><span class="logsrc-tag windows">Windows</span></td>
                        <td><button class="btn btn-xs btn-secondary" onclick="showToast('Added to attack chain')">+ Add</button></td>
                      </tr>
                      <tr>
                        <td class="mono" style="color:var(--cyan);">ART-T1053-01</td>
                        <td style="color:var(--text-primary);font-weight:500;">Scheduled Task via schtasks.exe</td>
                        <td><span class="mitre-tag">T1053.005</span></td>
                        <td><span class="logsrc-tag windows">Windows</span></td>
                        <td><button class="btn btn-xs btn-secondary" onclick="showToast('Added to attack chain')">+ Add</button></td>
                      </tr>
                      <tr>
                        <td class="mono" style="color:var(--cyan);">ART-T1048-01</td>
                        <td style="color:var(--text-primary);font-weight:500;">DNS Tunneling via iodine</td>
                        <td><span class="mitre-tag">T1048.001</span></td>
                        <td><span class="logsrc-tag linux">Linux</span></td>
                        <td><button class="btn btn-xs btn-secondary" onclick="showToast('Added to attack chain')">+ Add</button></td>
                      </tr>
                      <tr>
                        <td class="mono" style="color:var(--cyan);">ART-T1547-01</td>
                        <td style="color:var(--text-primary);font-weight:500;">Registry Run Keys Persistence</td>
                        <td><span class="mitre-tag">T1547.001</span></td>
                        <td><span class="logsrc-tag windows">Windows</span></td>
                        <td><button class="btn btn-xs btn-secondary" onclick="showToast('Added to attack chain')">+ Add</button></td>
                      </tr>
                      <tr>
                        <td class="mono" style="color:var(--cyan);">ART-T1071-01</td>
                        <td style="color:var(--text-primary);font-weight:500;">HTTPS C2 Beacon Simulation</td>
                        <td><span class="mitre-tag">T1071.001</span></td>
                        <td><span class="logsrc-tag network">Network</span></td>
                        <td><button class="btn btn-xs btn-secondary" onclick="showToast('Added to attack chain')">+ Add</button></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- Right: Test Configuration -->
            <div class="dr-create-sidebar">
              <div style="font-size:14px;font-weight:700;color:var(--text-primary);margin-bottom:14px;">Test Configuration</div>

              <div class="dr-field-group">
                <div class="dr-field-label">Target Environment</div>
                <select class="filter-select" style="width:100%;">
                  <option>Dacta Global (Sandbox)</option>
                  <option>SPMT (Sandbox)</option>
                  <option>Naga World (Sandbox)</option>
                  <option>ADV Partners (Sandbox)</option>
                  <option>Global Advisor Co (Sandbox)</option>
                </select>
              </div>

              <div class="dr-field-group">
                <div class="dr-field-label">Execution Mode</div>
                <div style="display:flex;flex-direction:column;gap:6px;">
                  <label style="display:flex;align-items:center;gap:8px;padding:8px 10px;background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.2);border-radius:7px;cursor:pointer;font-size:11px;color:var(--text-primary);">
                    <input type="radio" name="rl-exec" checked style="accent-color:var(--cyan);"> Dry Run (log only, no disruption)
                  </label>
                  <label style="display:flex;align-items:center;gap:8px;padding:8px 10px;background:rgba(255,255,255,0.02);border:1px solid var(--border-subtle);border-radius:7px;cursor:pointer;font-size:11px;color:var(--text-primary);">
                    <input type="radio" name="rl-exec" style="accent-color:var(--cyan);"> Full Simulation (with detonation)
                  </label>
                  <label style="display:flex;align-items:center;gap:8px;padding:8px 10px;background:rgba(255,255,255,0.02);border:1px solid var(--border-subtle);border-radius:7px;cursor:pointer;font-size:11px;color:var(--text-primary);">
                    <input type="radio" name="rl-exec" style="accent-color:var(--cyan);"> Purple Team (pause between steps)
                  </label>
                </div>
              </div>

              <div class="dr-field-group">
                <div class="dr-field-label">Schedule</div>
                <select class="filter-select" style="width:100%;">
                  <option>Run Now</option>
                  <option>Schedule for Off-Hours (02:00 UTC)</option>
                  <option>Add to Weekly Rotation</option>
                  <option>Custom Schedule...</option>
                </select>
              </div>

              <div class="dr-field-group">
                <div class="dr-field-label">Notify On Completion</div>
                <div style="display:flex;flex-direction:column;gap:4px;">
                  <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);cursor:pointer;">
                    <input type="checkbox" checked style="accent-color:var(--cyan);"> Email report to SOC lead
                  </label>
                  <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);cursor:pointer;">
                    <input type="checkbox" checked style="accent-color:var(--cyan);"> Post results to Slack #soc-testing
                  </label>
                  <label style="display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);cursor:pointer;">
                    <input type="checkbox" style="accent-color:var(--cyan);"> Auto-create rules for gaps
                  </label>
                </div>
              </div>

              <div style="padding:10px;background:rgba(245,158,11,0.06);border:1px solid rgba(245,158,11,0.2);border-radius:7px;font-size:10px;color:var(--amber);margin-top:8px;">
                <div style="font-weight:700;margin-bottom:3px;">&#9888; Safety Notice</div>
                All simulations run in isolated sandbox environments. No production systems are affected. Atomic tests use safe payloads with automatic cleanup.
              </div>

              <button class="btn btn-primary" style="width:100%;justify-content:center;margin-top:14px;" onclick="showToast('Attack simulation queued â€” estimated completion: 8 minutes')">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                Execute Simulation
              </button>
            </div>
          </div>
        </div>

        <script>
          function switchRlTab(tabId) {
            document.querySelectorAll('.rl-tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.rl-panel').forEach(p => p.classList.remove('active'));
            document.getElementById('rl-panel-' + tabId).classList.add('active');
            document.querySelector('[data-rltab="' + tabId + '"]').classList.add('active');
          }
          function rvqFilter(btn, source) {
            btn.parentElement.querySelectorAll('.filter-chip').forEach(function(c){ c.classList.remove('active'); });
            btn.classList.add('active');
            document.querySelectorAll('#rvqList .rvq-card').forEach(function(card) {
              if (source === 'all') { card.style.display = ''; }
              else { card.style.display = card.getAttribute('data-rvq-source') === source ? '' : 'none'; }
            });
          }
        </script>

      </div><!-- end rulelab -->



      <!-- =====================================================
           PAGE 8: LOG SOURCE CATALOG
           ===================================================== -->
      <div class="page" id="page-logsources">
        <div class="page-header">
          <div>
            <div class="page-title">Log Source Catalog</div>
            <div class="page-subtitle">All monitored log sources across client environments</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm">â†“ Health Report</button>
            <button class="btn btn-primary btn-sm">+ Add Source</button>
          </div>
        </div>

        <div class="metrics-row" style="margin-bottom:16px;">
          <div class="metric-card green"><div class="metric-label">Healthy</div><div class="metric-value">24</div><div class="metric-sub">sources</div></div>
          <div class="metric-card amber"><div class="metric-label">Degraded</div><div class="metric-value">3</div><div class="metric-sub">sources</div></div>
          <div class="metric-card red"><div class="metric-label">Silent</div><div class="metric-value">1</div><div class="metric-sub">source</div></div>
          <div class="metric-card cyan"><div class="metric-label">Events/Day</div><div class="metric-value">2.4<span style="font-size:14px;">M</span></div><div class="metric-sub">total ingestion</div></div>
        </div>

        <div class="card">
          <div class="table-wrap">
            <table>
              <thead><tr><th>Status</th><th>Source Name</th><th>Vendor / Type</th><th>SIEM</th><th>Index Pattern</th><th>Organization</th><th>Events/Day</th><th>Volume</th><th>Parse Rate</th><th>Last Event</th></tr></thead>
              <tbody id="logSourcesBody"></tbody>
            </table>
          </div>
        </div>
      </div><!-- end logsources -->


      <!-- =====================================================
           PAGE 9: PARSER GENERATOR
           ===================================================== -->
      <div class="page" id="page-parsers">
        <style>
          /* â”€â”€ Log Parser Module â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          .lp-tab-nav { display:flex; align-items:center; gap:0; border-bottom:1px solid rgba(255,255,255,0.07); margin-bottom:20px; }
          .lp-tab-btn { display:flex; align-items:center; gap:7px; padding:11px 18px; font-family:'IBM Plex Sans',sans-serif; font-size:13px; font-weight:500; color:#64748b; background:transparent; border:none; border-bottom:2px solid transparent; cursor:pointer; white-space:nowrap; transition:color .15s,border-color .15s; outline:none; position:relative; bottom:-1px; }
          .lp-tab-btn:hover { color:#94a3b8; }
          .lp-tab-btn.active { color:#00d4ff; border-bottom-color:#00d4ff; font-weight:600; }
          .lp-panel { display:none; }
          .lp-panel.active { display:block; }

          /* Unknown Patterns Queue */
          .upq-card { background:rgba(15,23,42,0.5); border:1px solid var(--border-card); border-radius:10px; padding:16px; margin-bottom:10px; transition:border-color .18s; }
          .upq-card:hover { border-color:rgba(0,212,255,0.2); }
          .upq-priority { font-size:9px; font-weight:700; padding:3px 8px; border-radius:5px; letter-spacing:0.3px; text-transform:uppercase; flex-shrink:0; }
          .upq-priority.critical { background:rgba(239,68,68,0.12); color:var(--red-bright); border:1px solid rgba(239,68,68,0.25); }
          .upq-priority.high { background:rgba(245,158,11,0.1); color:var(--amber); border:1px solid rgba(245,158,11,0.2); }
          .upq-priority.medium { background:rgba(0,212,255,0.08); color:var(--cyan); border:1px solid rgba(0,212,255,0.15); }
          .upq-priority.low { background:rgba(100,116,139,0.1); color:#94a3b8; border:1px solid rgba(100,116,139,0.2); }
          .upq-template { font-family:var(--font-mono); font-size:10px; color:var(--cyan); background:rgba(0,0,0,0.3); border-radius:6px; padding:8px 12px; margin:10px 0; overflow-x:auto; white-space:nowrap; border:1px solid rgba(0,212,255,0.06); }
          .upq-raw { font-family:var(--font-mono); font-size:10px; color:#94a3b8; background:rgba(0,0,0,0.2); border-radius:6px; padding:8px 12px; margin-bottom:10px; overflow-x:auto; white-space:nowrap; }
          .upq-meta { display:flex; gap:16px; align-items:center; flex-wrap:wrap; font-size:10px; color:var(--text-muted); }
          .upq-meta strong { color:var(--text-secondary); }

          /* Active Parsers */
          .ap-health { display:inline-flex; align-items:center; gap:4px; font-size:10px; font-weight:600; padding:3px 8px; border-radius:5px; }
          .ap-health.live { background:rgba(34,197,94,0.1); color:#22c55e; border:1px solid rgba(34,197,94,0.2); }
          .ap-health.draft { background:rgba(59,130,246,0.1); color:#3b82f6; border:1px solid rgba(59,130,246,0.2); }
          .ap-health.stale { background:rgba(245,158,11,0.1); color:var(--amber); border:1px solid rgba(245,158,11,0.2); }
          .ap-health.partial { background:rgba(251,146,60,0.1); color:#fb923c; border:1px solid rgba(251,146,60,0.2); }
          .ap-health.failed { background:rgba(239,68,68,0.1); color:var(--red-bright); border:1px solid rgba(239,68,68,0.2); }
          .ap-match-bar { width:60px; height:5px; background:rgba(255,255,255,0.06); border-radius:99px; overflow:hidden; }
          .ap-match-fill { height:100%; border-radius:99px; }

          /* Wizard Modal */
          .lp-wizard-overlay { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.7); backdrop-filter:blur(8px); z-index:9000; align-items:center; justify-content:center; }
          .lp-wizard-overlay.active { display:flex; }
          .lp-wizard-modal { background:var(--bg-card); border:1px solid var(--border-card); border-radius:14px; width:95%; max-width:880px; max-height:88vh; overflow-y:auto; position:relative; }
          .lp-wizard-header { display:flex; align-items:center; justify-content:space-between; padding:16px 20px; border-bottom:1px solid var(--border-subtle); position:sticky; top:0; background:var(--bg-card); z-index:2; border-radius:14px 14px 0 0; }
          .lp-wizard-body { padding:20px; }
          .lp-wizard-steps { display:flex; align-items:center; gap:0; padding:14px 20px; border-bottom:1px solid var(--border-subtle); background:rgba(0,0,0,0.15); }
          .lp-wiz-step { display:flex; align-items:center; gap:8px; }
          .lp-wiz-dot { width:26px; height:26px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:700; font-family:var(--font-mono); border:2px solid rgba(0,212,255,0.15); color:var(--text-muted); background:transparent; }
          .lp-wiz-dot.active { border-color:var(--cyan); color:var(--cyan); background:rgba(0,212,255,0.08); }
          .lp-wiz-dot.done { border-color:#22c55e; color:#22c55e; background:rgba(34,197,94,0.08); }
          .lp-wiz-label { font-size:11px; font-family:var(--font-mono); color:var(--text-muted); white-space:nowrap; }
          .lp-wiz-label.active { color:var(--cyan); }
          .lp-wiz-label.done { color:#22c55e; }
          .lp-wiz-line { flex:1; height:2px; background:rgba(0,212,255,0.08); margin:0 12px; border-radius:99px; min-width:20px; }
          .lp-wiz-line.done { background:rgba(34,197,94,0.25); }

          /* Wizard form elements */
          .lp-field { margin-bottom:14px; }
          .lp-field-label { font-size:10px; font-weight:600; text-transform:uppercase; letter-spacing:1px; color:var(--text-muted); font-family:var(--font-mono); margin-bottom:6px; }
          .lp-input { background:rgba(0,0,0,0.3); border:1px solid rgba(0,212,255,0.12); color:var(--text-primary); font-size:12px; padding:8px 12px; border-radius:6px; outline:none; width:100%; box-sizing:border-box; font-family:var(--font-mono); transition:border-color .15s; }
          .lp-input:focus { border-color:rgba(0,212,255,0.35); }
          .lp-input::placeholder { color:var(--text-muted); }
          select.lp-input { cursor:pointer; -webkit-appearance:none; }
          textarea.lp-input { resize:vertical; min-height:80px; }

          /* Path cards */
          .lp-path-card { border:1px solid rgba(0,212,255,0.08); background:rgba(0,0,0,0.2); border-radius:8px; padding:12px 16px; cursor:pointer; display:flex; align-items:center; gap:14px; transition:all .15s; margin-bottom:8px; }
          .lp-path-card:hover { border-color:rgba(0,212,255,0.2); background:rgba(0,212,255,0.02); }
          .lp-path-card.selected { border-color:rgba(0,212,255,0.5); background:rgba(0,212,255,0.05); }
          .lp-path-icon { width:36px; height:36px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:rgba(0,212,255,0.06); font-size:18px; flex-shrink:0; }
          .lp-path-card.selected .lp-path-icon { background:rgba(0,212,255,0.12); }
          .lp-path-radio { width:18px; height:18px; border-radius:50%; border:2px solid rgba(0,212,255,0.2); display:flex; align-items:center; justify-content:center; flex-shrink:0; }
          .lp-path-card.selected .lp-path-radio { border-color:var(--cyan); }
          .lp-path-radio-inner { width:8px; height:8px; border-radius:50%; background:var(--cyan); display:none; }
          .lp-path-card.selected .lp-path-radio-inner { display:block; }

          /* Interview */
          .lp-int-opt { display:flex; align-items:center; gap:10px; cursor:pointer; padding:8px 12px; border-radius:6px; background:transparent; border:1px solid rgba(0,212,255,0.06); margin-bottom:6px; transition:all .15s; }
          .lp-int-opt:hover { border-color:rgba(0,212,255,0.15); }
          .lp-int-opt.selected { border-color:rgba(0,212,255,0.35); background:rgba(0,212,255,0.06); }
          .lp-int-radio { width:14px; height:14px; border-radius:50%; border:2px solid rgba(0,212,255,0.2); flex-shrink:0; display:flex; align-items:center; justify-content:center; }
          .lp-int-opt.selected .lp-int-radio { border-color:var(--cyan); }
          .lp-int-radio-dot { width:6px; height:6px; border-radius:50%; background:var(--cyan); display:none; }
          .lp-int-opt.selected .lp-int-radio-dot { display:block; }

          /* Checklist items */
          .lp-check-item { display:flex; align-items:center; justify-content:space-between; padding:8px 12px; border-radius:6px; background:rgba(0,212,255,0.02); border:1px solid rgba(0,212,255,0.06); margin-bottom:6px; transition:all .15s; }
          .lp-check-item.captured { background:rgba(34,197,94,0.04); border-color:rgba(34,197,94,0.15); }
          .lp-check-dot { width:18px; height:18px; border-radius:50%; border:2px solid var(--text-muted); display:flex; align-items:center; justify-content:center; font-size:10px; flex-shrink:0; }
          .lp-check-item.captured .lp-check-dot { border-color:#22c55e; color:#22c55e; background:rgba(34,197,94,0.15); }

          /* Schema table */
          .lp-schema-tbl { width:100%; border-collapse:collapse; font-size:11px; }
          .lp-schema-tbl th { text-align:left; padding:6px 10px; background:rgba(0,212,255,0.06); color:var(--text-secondary); font-family:var(--font-mono); font-size:10px; font-weight:600; border-bottom:1px solid var(--border-subtle); }
          .lp-schema-tbl td { padding:6px 10px; border-bottom:1px solid rgba(255,255,255,0.03); }
          .lp-schema-tbl tr:hover td { background:rgba(0,212,255,0.02); }

          /* Catcher health strip */
          .lp-catcher-strip { display:flex; gap:12px; padding:10px 14px; background:rgba(0,0,0,0.2); border:1px solid var(--border-card); border-radius:8px; margin-bottom:16px; }
          .lp-catcher-stat { display:flex; flex-direction:column; gap:2px; }
          .lp-catcher-stat .val { font-size:14px; font-weight:700; font-family:var(--font-mono); color:var(--text-primary); }
          .lp-catcher-stat .lbl { font-size:9px; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.5px; }
        </style>

        <div class="page-header">
          <div>
            <div class="page-title">Log Parser</div>
            <div class="page-subtitle">Novelty Catcher &middot; Unknown Pattern Detection &middot; Log Source Onboarding Wizard</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm" onclick="showToast('Refreshing catcher status...')">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
              Catcher Status
            </button>
            <button class="btn btn-primary btn-sm" onclick="openLpWizard()">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Add New Log Source
            </button>
          </div>
        </div>

        <!-- Novelty Catcher Health Strip -->
        <div class="lp-catcher-strip">
          <div class="lp-catcher-stat"><div class="val" style="color:var(--cyan);">5</div><div class="lbl">Active Catchers</div></div>
          <div style="width:1px;background:var(--border-card);"></div>
          <div class="lp-catcher-stat"><div class="val" style="color:var(--amber);">12</div><div class="lbl">Unknown Patterns</div></div>
          <div style="width:1px;background:var(--border-card);"></div>
          <div class="lp-catcher-stat"><div class="val" style="color:#22c55e;">38</div><div class="lbl">Active Parsers</div></div>
          <div style="width:1px;background:var(--border-card);"></div>
          <div class="lp-catcher-stat"><div class="val" style="color:var(--text-primary);">96.2%</div><div class="lbl">Avg Match Rate</div></div>
          <div style="width:1px;background:var(--border-card);"></div>
          <div class="lp-catcher-stat"><div class="val" style="color:var(--text-secondary);">2m ago</div><div class="lbl">Last Event</div></div>
          <div style="flex:1;"></div>
          <div style="display:flex;align-items:center;gap:6px;">
            <div style="width:7px;height:7px;border-radius:50%;background:#22c55e;box-shadow:0 0 6px rgba(34,197,94,0.5);"></div>
            <span style="font-size:10px;color:#22c55e;font-weight:600;">All Catchers Online</span>
          </div>
        </div>

        <!-- Tab Navigation -->
        <div class="lp-tab-nav">
          <button class="lp-tab-btn active" data-lptab="patterns" onclick="switchLpTab('patterns')">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
            Unknown Patterns Queue
            <span style="background:rgba(245,158,11,0.15);color:var(--amber);font-size:10px;padding:2px 7px;border-radius:4px;font-weight:700;">12</span>
          </button>
          <button class="lp-tab-btn" data-lptab="library" onclick="switchLpTab('library')">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 016.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"/></svg>
            Active Parsers Library
          </button>
          <button class="lp-tab-btn" data-lptab="generator" onclick="switchLpTab('generator')">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
            Parser Generator
          </button>
        </div>

        <!-- â•â•â• TAB 1: Unknown Patterns Queue â•â•â• -->
        <div class="lp-panel active" id="lp-panel-patterns">

          <!-- Filter -->
          <div style="display:flex;gap:8px;align-items:center;margin-bottom:14px;flex-wrap:wrap;">
            <span style="font-size:11px;color:var(--text-muted);margin-right:4px;">Client:</span>
            <button class="filter-chip active" onclick="lpqFilter(this,'all')" style="font-size:11px;padding:5px 12px;border-radius:7px;border:1px solid rgba(255,255,255,0.05);background:rgba(0,212,255,0.06);color:var(--cyan);cursor:pointer;font-weight:600;">All</button>
            <button class="filter-chip" onclick="lpqFilter(this,'spmt')" style="font-size:11px;padding:5px 12px;border-radius:7px;border:1px solid rgba(255,255,255,0.05);background:rgba(255,255,255,0.02);color:var(--text-muted);cursor:pointer;">SPMT</button>
            <button class="filter-chip" onclick="lpqFilter(this,'naga')" style="font-size:11px;padding:5px 12px;border-radius:7px;border:1px solid rgba(255,255,255,0.05);background:rgba(255,255,255,0.02);color:var(--text-muted);cursor:pointer;">Naga World</button>
            <button class="filter-chip" onclick="lpqFilter(this,'dacta')" style="font-size:11px;padding:5px 12px;border-radius:7px;border:1px solid rgba(255,255,255,0.05);background:rgba(255,255,255,0.02);color:var(--text-muted);cursor:pointer;">Dacta Global</button>
            <button class="filter-chip" onclick="lpqFilter(this,'adv')" style="font-size:11px;padding:5px 12px;border-radius:7px;border:1px solid rgba(255,255,255,0.05);background:rgba(255,255,255,0.02);color:var(--text-muted);cursor:pointer;">ADV Partners</button>
            <div style="flex:1;"></div>
            <span style="font-size:10px;color:var(--text-muted);">Sorted by priority then occurrence count</span>
          </div>

          <!-- Queue Items -->
          <div id="lpqList">

            <!-- CRITICAL: Burst alert -->
            <div class="upq-card" data-lpq-client="naga">
              <div style="display:flex;align-items:flex-start;gap:12px;margin-bottom:8px;">
                <span class="upq-priority critical">Critical</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:3px;">Burst Alert â€” 14 New Patterns in 3 min</div>
                  <div class="upq-meta"><strong>Naga World</strong> &middot; Source: firewall-gw01 &middot; First seen 4 min ago &middot; <span style="color:var(--red-bright);">14,891 occurrences/hr</span></div>
                </div>
                <div style="display:flex;gap:6px;">
                  <button class="btn btn-primary btn-xs" onclick="openLpWizard()">Generate Parser</button>
                  <button class="btn btn-secondary btn-xs" onclick="showToast('Pattern dismissed for 30 days')">Dismiss</button>
                </div>
              </div>
              <div class="upq-template">&lt;TS&gt; &lt;IP&gt; CEF:0 vendor=&lt;STR&gt; product=&lt;STR&gt; version=&lt;STR&gt; sig=&lt;NUM&gt; name=&lt;STR&gt; sev=&lt;NUM&gt; src=&lt;IP&gt; dst=&lt;IP&gt; dpt=&lt;NUM&gt; act=&lt;STR&gt;</div>
              <div class="upq-raw">2026-02-28T23:14:07Z 10.0.4.1 CEF:0|FortiGate|FortiOS|7.4.2|0419|forward traffic|3|src=192.168.88.14 dst=203.0.113.45 dpt=443 act=accept</div>
              <div style="padding:8px 12px;background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.1);border-radius:6px;margin-top:8px;">
                <div style="font-size:10px;color:var(--red-bright);font-weight:600;margin-bottom:3px;">Burst Alert: Possible log format change or attack</div>
                <div style="font-size:10px;color:var(--text-muted);">14 distinct new patterns detected from firewall-gw01 within 3 minutes. May indicate a firmware update, misconfigured forwarder, or log injection attack. Verify with client before treating as security event.</div>
              </div>
            </div>

            <!-- HIGH -->
            <div class="upq-card" data-lpq-client="spmt">
              <div style="display:flex;align-items:flex-start;gap:12px;margin-bottom:8px;">
                <span class="upq-priority high">High</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:3px;">Unknown OT Controller Event â€” Allen-Bradley PLC</div>
                  <div class="upq-meta"><strong>SPMT</strong> &middot; Source: plc-controller-07 &middot; First seen 2 hours ago &middot; <span style="color:var(--amber);">847 occurrences/hr</span></div>
                </div>
                <div style="display:flex;gap:6px;">
                  <button class="btn btn-primary btn-xs" onclick="openLpWizard()">Generate Parser</button>
                  <button class="btn btn-secondary btn-xs" onclick="showToast('Pattern dismissed for 30 days')">Dismiss</button>
                </div>
              </div>
              <div class="upq-template">&lt;TS&gt; &lt;NUM&gt; PLC &lt;STR&gt; tag=&lt;STR&gt; val=&lt;NUM&gt; unit=&lt;STR&gt; status=&lt;STR&gt;</div>
              <div class="upq-raw">2026-02-28T21:07:14Z 1740 PLC AB/1756 tag=TempReactor01 val=387.2 unit=degC status=ALARM_HIGH</div>
            </div>

            <!-- HIGH -->
            <div class="upq-card" data-lpq-client="naga">
              <div style="display:flex;align-items:flex-start;gap:12px;margin-bottom:8px;">
                <span class="upq-priority high">High</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:3px;">Custom CCTV NVR System â€” Unstructured Syslog</div>
                  <div class="upq-meta"><strong>Naga World</strong> &middot; Source: nvr-cctv-main &middot; First seen 5 hours ago &middot; <span style="color:var(--amber);">312 occurrences/hr</span></div>
                </div>
                <div style="display:flex;gap:6px;">
                  <button class="btn btn-primary btn-xs" onclick="openLpWizard()">Generate Parser</button>
                  <button class="btn btn-secondary btn-xs" onclick="showToast('Pattern dismissed for 30 days')">Dismiss</button>
                </div>
              </div>
              <div class="upq-template">&lt;TS&gt; &lt;STR&gt; &lt;STR&gt;[&lt;NUM&gt;]: camera=&lt;NUM&gt; event=&lt;STR&gt; zone=&lt;STR&gt; confidence=&lt;NUM&gt;</div>
              <div class="upq-raw">Feb 28 21:45:03 nvr-main motion_detect[4281]: camera=14 event=motion_start zone=parking_east confidence=92</div>
            </div>

            <!-- MEDIUM -->
            <div class="upq-card" data-lpq-client="dacta">
              <div style="display:flex;align-items:flex-start;gap:12px;margin-bottom:8px;">
                <span class="upq-priority medium">Medium</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:3px;">Internal ERP Application â€” JSON Audit Trail</div>
                  <div class="upq-meta"><strong>Dacta Global</strong> &middot; Source: erp-app-01 &middot; First seen 1 day ago &middot; <span>128 occurrences/hr</span></div>
                </div>
                <div style="display:flex;gap:6px;">
                  <button class="btn btn-primary btn-xs" onclick="openLpWizard()">Generate Parser</button>
                  <button class="btn btn-secondary btn-xs" onclick="showToast('Pattern dismissed for 30 days')">Dismiss</button>
                </div>
              </div>
              <div class="upq-template">{"timestamp":"&lt;TS&gt;","level":"&lt;STR&gt;","module":"&lt;STR&gt;","user":"&lt;STR&gt;","action":"&lt;STR&gt;","resource":"&lt;STR&gt;","ip":"&lt;IP&gt;"}</div>
              <div class="upq-raw">{"timestamp":"2026-02-27T14:22:08Z","level":"INFO","module":"audit","user":"admin@dacta.sg","action":"export_report","resource":"/reports/q4-financial","ip":"172.16.0.55"}</div>
            </div>

            <!-- MEDIUM -->
            <div class="upq-card" data-lpq-client="spmt">
              <div style="display:flex;align-items:flex-start;gap:12px;margin-bottom:8px;">
                <span class="upq-priority medium">Medium</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:3px;">SCADA HMI Operator Console â€” Setpoint Changes</div>
                  <div class="upq-meta"><strong>SPMT</strong> &middot; Source: hmi-console-02 &middot; First seen 6 hours ago &middot; <span>67 occurrences/hr</span></div>
                </div>
                <div style="display:flex;gap:6px;">
                  <button class="btn btn-primary btn-xs" onclick="openLpWizard()">Generate Parser</button>
                  <button class="btn btn-secondary btn-xs" onclick="showToast('Pattern dismissed for 30 days')">Dismiss</button>
                </div>
              </div>
              <div class="upq-template">&lt;TS&gt; SCADA &lt;STR&gt; operator=&lt;STR&gt; setpoint=&lt;STR&gt; old=&lt;NUM&gt; new=&lt;NUM&gt; unit=&lt;STR&gt;</div>
              <div class="upq-raw">2026-02-28T18:33:21Z SCADA SETPOINT_CHANGE operator=eng_tanaka setpoint=PressureValve03 old=45.0 new=52.5 unit=PSI</div>
            </div>

            <!-- LOW -->
            <div class="upq-card" data-lpq-client="adv">
              <div style="display:flex;align-items:flex-start;gap:12px;margin-bottom:8px;">
                <span class="upq-priority low">Low</span>
                <div style="flex:1;">
                  <div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:3px;">VPN Concentrator â€” Session Heartbeat</div>
                  <div class="upq-meta"><strong>ADV Partners</strong> &middot; Source: vpn-concentrator &middot; First seen 3 days ago &middot; <span>18 occurrences/hr</span></div>
                </div>
                <div style="display:flex;gap:6px;">
                  <button class="btn btn-primary btn-xs" onclick="openLpWizard()">Generate Parser</button>
                  <button class="btn btn-secondary btn-xs" onclick="showToast('Pattern dismissed for 30 days')">Dismiss</button>
                </div>
              </div>
              <div class="upq-template">&lt;TS&gt; vpn &lt;STR&gt; session=&lt;HEX&gt; user=&lt;STR&gt; src=&lt;IP&gt; duration=&lt;NUM&gt;s bytes_in=&lt;NUM&gt; bytes_out=&lt;NUM&gt;</div>
              <div class="upq-raw">2026-02-25T09:41:00Z vpn HEARTBEAT session=a3f8c2d1 user=j.chen@adv.com src=203.0.113.88 duration=3600s bytes_in=524288 bytes_out=1048576</div>
            </div>

          </div>
        </div>

        <!-- â•â•â• TAB 2: Active Parsers Library â•â•â• -->
        <div class="lp-panel" id="lp-panel-library">

          <div style="display:flex;gap:8px;align-items:center;margin-bottom:14px;">
            <input class="filter-input" placeholder="Search parsers..." style="width:220px;">
            <select class="filter-select" style="width:160px;">
              <option>All Clients</option>
              <option>Dacta Global</option>
              <option>SPMT</option>
              <option>Naga World</option>
              <option>ADV Partners</option>
              <option>Global Advisor Co</option>
            </select>
            <select class="filter-select" style="width:140px;">
              <option>All Status</option>
              <option>Live</option>
              <option>Draft</option>
              <option>Stale</option>
              <option>Partial</option>
              <option>Failed</option>
            </select>
            <div style="flex:1;"></div>
            <button class="btn btn-primary btn-sm" onclick="openLpWizard()">+ New Parser</button>
          </div>

          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Parser Name</th>
                  <th>Client</th>
                  <th>Vendor</th>
                  <th>Event Types</th>
                  <th>Match Rate</th>
                  <th>Health</th>
                  <th>Last Validated</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="color:var(--text-primary);font-weight:500;">Windows Security Events</td>
                  <td>Dacta Global</td>
                  <td>Microsoft</td>
                  <td><span style="font-family:var(--font-mono);font-size:11px;">12/12</span></td>
                  <td>
                    <div style="display:flex;align-items:center;gap:6px;">
                      <div class="ap-match-bar"><div class="ap-match-fill" style="width:99%;background:#22c55e;"></div></div>
                      <span style="font-size:10px;font-family:var(--font-mono);color:#22c55e;">99.1%</span>
                    </div>
                  </td>
                  <td><span class="ap-health live">Live</span></td>
                  <td style="font-size:10px;color:var(--text-muted);">2 hours ago</td>
                  <td><button class="btn btn-secondary btn-xs">View</button></td>
                </tr>
                <tr>
                  <td style="color:var(--text-primary);font-weight:500;">M365 Unified Audit Log</td>
                  <td>Dacta Global</td>
                  <td>Microsoft</td>
                  <td><span style="font-family:var(--font-mono);font-size:11px;">18/18</span></td>
                  <td>
                    <div style="display:flex;align-items:center;gap:6px;">
                      <div class="ap-match-bar"><div class="ap-match-fill" style="width:98%;background:#22c55e;"></div></div>
                      <span style="font-size:10px;font-family:var(--font-mono);color:#22c55e;">98.4%</span>
                    </div>
                  </td>
                  <td><span class="ap-health live">Live</span></td>
                  <td style="font-size:10px;color:var(--text-muted);">1 hour ago</td>
                  <td><button class="btn btn-secondary btn-xs">View</button></td>
                </tr>
                <tr>
                  <td style="color:var(--text-primary);font-weight:500;">FortiGate Firewall Syslog</td>
                  <td>SPMT</td>
                  <td>Fortinet</td>
                  <td><span style="font-family:var(--font-mono);font-size:11px;">8/11</span></td>
                  <td>
                    <div style="display:flex;align-items:center;gap:6px;">
                      <div class="ap-match-bar"><div class="ap-match-fill" style="width:97%;background:#22c55e;"></div></div>
                      <span style="font-size:10px;font-family:var(--font-mono);color:#22c55e;">97.2%</span>
                    </div>
                  </td>
                  <td><span class="ap-health live">Live</span></td>
                  <td style="font-size:10px;color:var(--text-muted);">3 hours ago</td>
                  <td><button class="btn btn-secondary btn-xs">View</button></td>
                </tr>
                <tr>
                  <td style="color:var(--text-primary);font-weight:500;">CrowdStrike Falcon EDR</td>
                  <td>SPMT</td>
                  <td>CrowdStrike</td>
                  <td><span style="font-family:var(--font-mono);font-size:11px;">15/15</span></td>
                  <td>
                    <div style="display:flex;align-items:center;gap:6px;">
                      <div class="ap-match-bar"><div class="ap-match-fill" style="width:99%;background:#22c55e;"></div></div>
                      <span style="font-size:10px;font-family:var(--font-mono);color:#22c55e;">99.7%</span>
                    </div>
                  </td>
                  <td><span class="ap-health live">Live</span></td>
                  <td style="font-size:10px;color:var(--text-muted);">45 min ago</td>
                  <td><button class="btn btn-secondary btn-xs">View</button></td>
                </tr>
                <tr>
                  <td style="color:var(--text-primary);font-weight:500;">Cisco ASA Firewall</td>
                  <td>Naga World</td>
                  <td>Cisco</td>
                  <td><span style="font-family:var(--font-mono);font-size:11px;">6/9</span></td>
                  <td>
                    <div style="display:flex;align-items:center;gap:6px;">
                      <div class="ap-match-bar"><div class="ap-match-fill" style="width:78%;background:var(--amber);"></div></div>
                      <span style="font-size:10px;font-family:var(--font-mono);color:var(--amber);">78.3%</span>
                    </div>
                  </td>
                  <td><span class="ap-health stale">Stale</span></td>
                  <td style="font-size:10px;color:var(--amber);">18 hours ago</td>
                  <td><button class="btn btn-secondary btn-xs">View</button></td>
                </tr>
                <tr>
                  <td style="color:var(--text-primary);font-weight:500;">Naga POS System</td>
                  <td>Naga World</td>
                  <td>Custom</td>
                  <td><span style="font-family:var(--font-mono);font-size:11px;">4/8</span></td>
                  <td>
                    <div style="display:flex;align-items:center;gap:6px;">
                      <div class="ap-match-bar"><div class="ap-match-fill" style="width:85%;background:#fb923c;"></div></div>
                      <span style="font-size:10px;font-family:var(--font-mono);color:#fb923c;">85.1%</span>
                    </div>
                  </td>
                  <td><span class="ap-health partial">Partial</span></td>
                  <td style="font-size:10px;color:var(--text-muted);">6 hours ago</td>
                  <td><button class="btn btn-secondary btn-xs">View</button></td>
                </tr>
                <tr>
                  <td style="color:var(--text-primary);font-weight:500;">Internal HR Application</td>
                  <td>Dacta Global</td>
                  <td>In-house</td>
                  <td><span style="font-family:var(--font-mono);font-size:11px;">â€”</span></td>
                  <td>
                    <div style="display:flex;align-items:center;gap:6px;">
                      <span style="font-size:10px;color:var(--text-muted);">N/A</span>
                    </div>
                  </td>
                  <td><span class="ap-health draft">Draft</span></td>
                  <td style="font-size:10px;color:var(--text-muted);">Not validated</td>
                  <td><button class="btn btn-secondary btn-xs">View</button></td>
                </tr>
                <tr>
                  <td style="color:var(--text-primary);font-weight:500;">ADV VPN Concentrator</td>
                  <td>ADV Partners</td>
                  <td>Palo Alto</td>
                  <td><span style="font-family:var(--font-mono);font-size:11px;">5/5</span></td>
                  <td>
                    <div style="display:flex;align-items:center;gap:6px;">
                      <div class="ap-match-bar"><div class="ap-match-fill" style="width:42%;background:var(--red-bright);"></div></div>
                      <span style="font-size:10px;font-family:var(--font-mono);color:var(--red-bright);">42.8%</span>
                    </div>
                  </td>
                  <td><span class="ap-health failed">Failed</span></td>
                  <td style="font-size:10px;color:var(--red-bright);">Needs review</td>
                  <td><button class="btn btn-secondary btn-xs">View</button></td>
                </tr>
                <tr>
                  <td style="color:var(--text-primary);font-weight:500;">Allen-Bradley PLC Events</td>
                  <td>SPMT</td>
                  <td>Rockwell</td>
                  <td><span style="font-family:var(--font-mono);font-size:11px;">3/7</span></td>
                  <td>
                    <div style="display:flex;align-items:center;gap:6px;">
                      <div class="ap-match-bar"><div class="ap-match-fill" style="width:91%;background:#22c55e;"></div></div>
                      <span style="font-size:10px;font-family:var(--font-mono);color:#22c55e;">91.4%</span>
                    </div>
                  </td>
                  <td><span class="ap-health partial">Partial</span></td>
                  <td style="font-size:10px;color:var(--text-muted);">4 hours ago</td>
                  <td><button class="btn btn-secondary btn-xs">View</button></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- â•â•â• TAB 3: Parser Generator (Original) â•â•â• -->
        <div class="lp-panel" id="lp-panel-generator">
          <div class="grid-2" style="margin-bottom:16px;">
            <div class="card">
              <div class="card-header"><span class="card-title">Upload Sample Logs</span></div>
              <div style="border:2px dashed rgba(0,212,255,0.2);border-radius:8px;padding:30px;text-align:center;cursor:pointer;transition:all var(--transition);" onmouseover="this.style.borderColor='rgba(0,212,255,0.4)'" onmouseout="this.style.borderColor='rgba(0,212,255,0.2)'">
                <div style="font-size:28px;margin-bottom:8px;">
                  <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="1.5"><path d="M13 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V9z"/><polyline points="13 2 13 9 20 9"/></svg>
                </div>
                <div style="font-size:13px;font-weight:600;color:var(--text-primary);">Drop log files here</div>
                <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">Supports .log, .txt, .json, .csv, .evtx</div>
                <button class="btn btn-secondary btn-sm" style="margin-top:12px;">Browse Files</button>
              </div>
              <div style="margin-top:12px;">
                <div style="font-size:10px;color:var(--text-muted);margin-bottom:8px;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;">Or select client environment</div>
                <div style="display:flex;gap:8px;align-items:center;">
                  <select class="filter-select" style="flex:1;">
                    <option>Select Organization...</option>
                    <option>Dacta Global</option>
                    <option>SPMT</option>
                    <option>Naga World</option>
                    <option>ADV Partners</option>
                    <option>Global Advisor Co</option>
                  </select>
                  <select class="filter-select" style="flex:1;">
                    <option>Select Log Source...</option>
                    <option>Windows Security Events</option>
                    <option>FortiGate Firewall</option>
                    <option>Custom App</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card-header"><span class="card-title">Generated Parsers</span></div>
              <div style="display:flex;flex-direction:column;gap:8px;">
                <div style="padding:10px 12px;background:var(--bg-elevated);border:1px solid var(--border-card);border-radius:7px;display:flex;align-items:center;gap:10px;">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="1.8"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                  <div style="flex:1;"><div style="font-size:12px;font-weight:600;color:var(--text-primary);">FortiGate Syslog Parser v2</div><div style="font-size:10px;color:var(--text-muted);">Generated 2026-02-24 &middot; Naga World</div></div>
                  <span class="badge badge-green">97% validated</span>
                </div>
                <div style="padding:10px 12px;background:var(--bg-elevated);border:1px solid var(--border-card);border-radius:7px;display:flex;align-items:center;gap:10px;">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="1.8"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                  <div style="flex:1;"><div style="font-size:12px;font-weight:600;color:var(--text-primary);">Custom ERP Application Parser</div><div style="font-size:10px;color:var(--text-muted);">Generated 2026-02-20 &middot; SPMT</div></div>
                  <span class="badge badge-green">91% validated</span>
                </div>
                <div style="padding:10px 12px;background:var(--bg-elevated);border:1px solid var(--border-card);border-radius:7px;display:flex;align-items:center;gap:10px;">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="1.8"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                  <div style="flex:1;"><div style="font-size:12px;font-weight:600;color:var(--text-primary);">Cisco ASA Firewall Parser</div><div style="font-size:10px;color:var(--text-muted);">Generated 2026-02-18 &middot; ADV Partners</div></div>
                  <span class="badge badge-amber">78% validated</span>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-header"><span class="card-title">Parser Library Browser</span><input class="filter-input" placeholder="Search parsers..." style="width:200px;"></div>
            <div class="table-wrap">
              <table>
                <thead><tr><th>Parser Name</th><th>Vendor</th><th>Format</th><th>Fields Mapped</th><th>Confidence</th><th>Status</th><th>Actions</th></tr></thead>
                <tbody>
                  <tr><td style="color:var(--text-primary);font-weight:500;">Windows Security Events</td><td>Microsoft</td><td>XML/EVTX</td><td>247 fields</td><td><span class="badge badge-green">99%</span></td><td><span class="badge badge-green">Production</span></td><td><button class="btn btn-secondary btn-xs">View</button></td></tr>
                  <tr><td style="color:var(--text-primary);font-weight:500;">M365 Unified Audit Log</td><td>Microsoft</td><td>JSON</td><td>183 fields</td><td><span class="badge badge-green">98%</span></td><td><span class="badge badge-green">Production</span></td><td><button class="btn btn-secondary btn-xs">View</button></td></tr>
                  <tr><td style="color:var(--text-primary);font-weight:500;">FortiGate Firewall Syslog</td><td>Fortinet</td><td>CEF/Syslog</td><td>94 fields</td><td><span class="badge badge-green">97%</span></td><td><span class="badge badge-green">Production</span></td><td><button class="btn btn-secondary btn-xs">View</button></td></tr>
                  <tr><td style="color:var(--text-primary);font-weight:500;">Cisco ASA</td><td>Cisco</td><td>Syslog</td><td>61 fields</td><td><span class="badge badge-amber">78%</span></td><td><span class="badge badge-amber">Review</span></td><td><button class="btn btn-secondary btn-xs">View</button></td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- â•â•â• LOG SOURCE ONBOARDING WIZARD (Modal) â•â•â• -->
        <div class="lp-wizard-overlay" id="lpWizardOverlay">
          <div class="lp-wizard-modal">
            <div class="lp-wizard-header">
              <div style="display:flex;align-items:center;gap:10px;">
                <div style="width:8px;height:8px;border-radius:50%;background:var(--cyan);box-shadow:0 0 6px var(--cyan);"></div>
                <span style="font-size:11px;font-weight:700;letter-spacing:2px;font-family:var(--font-mono);color:var(--cyan);">LOG SOURCE ONBOARDING WIZARD</span>
              </div>
              <div style="display:flex;align-items:center;gap:12px;">
                <span id="lpWizCtx" style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);"></span>
                <button onclick="closeLpWizard()" style="background:none;border:none;color:var(--text-muted);cursor:pointer;font-size:18px;padding:4px;">&times;</button>
              </div>
            </div>
            <div class="lp-wizard-steps" id="lpWizSteps">
              <!-- Filled by JS -->
            </div>
            <div class="lp-wizard-body" id="lpWizBody">
              <!-- Filled by JS -->
            </div>
          </div>
        </div>

        <script>
          /* â”€â”€ Log Parser Tab Switching â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          function switchLpTab(tabId) {
            document.querySelectorAll('.lp-tab-btn').forEach(function(b){ b.classList.remove('active'); });
            document.querySelectorAll('.lp-panel').forEach(function(p){ p.classList.remove('active'); });
            document.getElementById('lp-panel-' + tabId).classList.add('active');
            document.querySelector('[data-lptab="' + tabId + '"]').classList.add('active');
          }

          /* â”€â”€ Unknown Patterns Queue Filter â”€â”€â”€â”€â”€ */
          function lpqFilter(btn, client) {
            btn.parentElement.querySelectorAll('.filter-chip').forEach(function(c){
              c.style.background = 'rgba(255,255,255,0.02)';
              c.style.color = 'var(--text-muted)';
              c.style.borderColor = 'rgba(255,255,255,0.05)';
              c.style.fontWeight = '500';
              c.classList.remove('active');
            });
            btn.style.background = 'rgba(0,212,255,0.06)';
            btn.style.color = 'var(--cyan)';
            btn.style.borderColor = 'rgba(0,212,255,0.18)';
            btn.style.fontWeight = '600';
            btn.classList.add('active');
            document.querySelectorAll('#lpqList .upq-card').forEach(function(card) {
              if (client === 'all') { card.style.display = ''; }
              else { card.style.display = card.getAttribute('data-lpq-client') === client ? '' : 'none'; }
            });
          }

          /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             LOG SOURCE ONBOARDING WIZARD
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

          var lpWiz = {
            step: 0,  // 0=metadata, 1=path select, 2=path flow, 3=deploy
            meta: { client:'', name:'', type:'', vendor:'', transport:'', volume:'', siems:[] },
            path: '',
            intIdx: 0,
            intAnswers: {},
            checkState: {},
            checkCapturing: {}
          };

          var LP_CLIENTS = ['Dacta Global', 'SPMT', 'Naga World', 'ADV Partners', 'Global Advisor Co'];
          var LP_SOURCE_TYPES = ['Application', 'Network / Firewall', 'Endpoint / EDR', 'OT / SCADA', 'Cloud', 'Custom / In-house'];
          var LP_TRANSPORTS = ['Syslog UDP', 'Syslog TCP', 'Beats / Elastic Agent', 'HTTP / Webhook', 'File / Shared Drive', 'Kafka', 'Other'];
          var LP_VOLUME = ['< 100 EPS', '100-1K EPS', '1K-10K EPS', '> 10K EPS'];
          var LP_SIEMS = ['Microsoft Sentinel', 'Splunk ES', 'Elastic SIEM', 'IBM QRadar'];

          var LP_PATHS = [
            { id:'doc',       icon:'&#128196;', label:'Documentation',        sub:'Vendor spec, README, PDF manual, Confluence page', badge:'HIGHEST CONFIDENCE', badgeColor:'#22c55e' },
            { id:'code',      icon:'&#128187;', label:'Source Code',           sub:'Logging module, code snippet, config file', badge:'', badgeColor:'' },
            { id:'sample',    icon:'&#128203;', label:'Sample Log',            sub:'At least one real log line available', badge:'', badgeColor:'' },
            { id:'interview', icon:'&#127908;', label:'Format Interview',      sub:'No artefacts, but someone can answer questions', badge:'', badgeColor:'' },
            { id:'checklist', icon:'&#9989;',   label:'Trigger Checklist',     sub:'Can fire events in test / staging environment', badge:'', badgeColor:'' },
            { id:'catcher',   icon:'&#128376;', label:'Progressive Catcher',  sub:'Traffic will eventually flow â€” monitor and wait', badge:'FALLBACK', badgeColor:'#fb923c' }
          ];

          var LP_INTERVIEW_QS = [
            { id:'q1', q:'Does each log entry appear on a single line, or can one event span multiple lines?', opts:['Single line only','Multi-line (one event can span several lines)','Not sure'], free:false },
            { id:'q2', q:'How does a typical log line begin?', opts:['Timestamp first','Severity/level word (INFO, ERROR...)','IP address','Fixed keyword (CEF:, LEEF:, <PRI>)','Not sure'], free:true },
            { id:'q3', q:'What separates the fields in a log line?', opts:['Space','Pipe |','Comma ,','Tab','Key=Value pairs','Mixed / complex'], free:true },
            { id:'q4', q:'Is there a timestamp in every log line?', opts:['Yes - ISO-8601','Yes - syslog format','Yes - epoch','Yes - other format','No timestamp'], free:true },
            { id:'q5', q:'Is there a severity or level field?', opts:['INFO/WARN/ERROR/FATAL','DEBUG/INFO/WARNING/ERROR/CRITICAL','Numeric (1-5 or 0-7)','Custom values','No severity field'], free:true },
            { id:'q6', q:'What fields are always present in every log line?', opts:[], free:true, placeholder:'e.g. source IP, username, event ID, action...' },
            { id:'q7', q:'Are there fields that only appear in some log lines?', opts:['Yes','No','Not sure'], free:true, placeholder:'If yes, which fields and when?' },
            { id:'q8', q:'Does the log contain any structured sub-sections?', opts:['Key=Value pairs embedded','JSON blob embedded','XML embedded','No - flat structure'], free:false },
            { id:'q9', q:'Write out what a typical NORMAL log line looks like (approximate is fine)', opts:[], free:true, placeholder:'e.g. 2024-01-15 10:30:00 | INFO | 192.168.1.1 | login | admin | success' },
            { id:'q10', q:'Write out what an ERROR or ALERT log line looks like', opts:[], free:true, placeholder:'e.g. 2024-01-15 10:31:00 | ERROR | auth.module | Connection pool exhausted' }
          ];

          var LP_CHECKLIST_MAP = {
            'Application': ['Successful login','Failed login (wrong password)','Failed login (account locked)','User logout','Password change','Privilege escalation','404 / Not Found error','500 / Server error','Export or download action','Admin configuration change'],
            'Network / Firewall': ['Allowed outbound connection','Blocked inbound connection','Allowed inbound connection','DNS query allowed','DNS query blocked','Interface up event','Interface down event','Policy rule hit','IPS/IDS alert fired','VPN session established'],
            'Endpoint / EDR': ['Process created','Process terminated','File created','File deleted','Registry key modified','Network connection initiated','User logon (interactive)','User logon (network)','Privilege escalation attempt','Suspicious script execution'],
            'Cloud': ['API call (successful)','API call (denied)','Resource created','Resource deleted','IAM role change','S3 / Blob access','Login from new geography','MFA challenge','Service quota alert','Cost anomaly event'],
            'OT / SCADA': ['Setpoint change','Alarm triggered','Alarm acknowledged','Controller mode change','Operator login','Remote session started','Firmware update event','Communication loss','Process value out of range','Emergency stop'],
            'Custom / In-house': ['Normal transaction','Failed transaction','Session start','Session end','Configuration change','Export / download','Admin action','Scheduled job result','Integration call success','Error condition (triggered)']
          };

          var STEP_LABELS = ['Source Metadata', 'Choose Path', 'Acquire Schema', 'Deploy'];

          function openLpWizard() {
            lpWiz = { step:0, meta:{client:'',name:'',type:'',vendor:'',transport:'',volume:'',siems:[]}, path:'', intIdx:0, intAnswers:{}, checkState:{}, checkCapturing:{} };
            document.getElementById('lpWizardOverlay').classList.add('active');
            renderWizard();
          }
          function closeLpWizard() {
            document.getElementById('lpWizardOverlay').classList.remove('active');
          }

          function renderWizSteps() {
            var h = '';
            for (var i = 0; i < STEP_LABELS.length; i++) {
              var cls = lpWiz.step === i ? 'active' : (lpWiz.step > i ? 'done' : '');
              h += '<div class="lp-wiz-step">';
              h += '<div class="lp-wiz-dot ' + cls + '">' + (lpWiz.step > i ? '&#10003;' : (i+1)) + '</div>';
              h += '<span class="lp-wiz-label ' + cls + '">' + STEP_LABELS[i] + '</span>';
              h += '</div>';
              if (i < STEP_LABELS.length - 1) {
                h += '<div class="lp-wiz-line' + (lpWiz.step > i ? ' done' : '') + '"></div>';
              }
            }
            document.getElementById('lpWizSteps').innerHTML = h;
          }

          function renderWizard() {
            renderWizSteps();
            var ctx = '';
            if (lpWiz.meta.client) ctx += lpWiz.meta.client;
            if (lpWiz.meta.name) ctx += ' / ' + lpWiz.meta.name;
            document.getElementById('lpWizCtx').textContent = ctx;

            if (lpWiz.step === 0) renderStep0();
            else if (lpWiz.step === 1) renderStep1();
            else if (lpWiz.step === 2) renderPathFlow();
            else if (lpWiz.step === 3) renderDeploy();
          }

          function renderStep0() {
            var h = '<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;">';
            h += '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>';
            h += '<span style="font-size:11px;font-weight:700;letter-spacing:1.5px;font-family:var(--font-mono);color:var(--cyan);text-transform:uppercase;">Log Source Identification</span>';
            h += '</div>';
            h += '<div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;">';
            // Client
            h += '<div class="lp-field"><div class="lp-field-label">Client *</div><select class="lp-input" id="lpMClient" onchange="lpWiz.meta.client=this.value"><option value="">â€” Select client â€”</option>';
            LP_CLIENTS.forEach(function(c){ h += '<option' + (lpWiz.meta.client===c?' selected':'') + '>' + c + '</option>'; });
            h += '</select></div>';
            // Name
            h += '<div class="lp-field"><div class="lp-field-label">Source Name *</div><input class="lp-input" id="lpMName" placeholder="e.g. Naga World POS System" value="' + (lpWiz.meta.name||'') + '" oninput="lpWiz.meta.name=this.value"></div>';
            // Type
            h += '<div class="lp-field"><div class="lp-field-label">Source Type *</div><select class="lp-input" id="lpMType" onchange="lpWiz.meta.type=this.value"><option value="">â€” Select type â€”</option>';
            LP_SOURCE_TYPES.forEach(function(t){ h += '<option' + (lpWiz.meta.type===t?' selected':'') + '>' + t + '</option>'; });
            h += '</select></div>';
            // Vendor
            h += '<div class="lp-field"><div class="lp-field-label">Vendor / Developer</div><input class="lp-input" placeholder="e.g. Fortinet, Custom / In-house" value="' + (lpWiz.meta.vendor||'') + '" oninput="lpWiz.meta.vendor=this.value"></div>';
            // Transport
            h += '<div class="lp-field"><div class="lp-field-label">Log Transport *</div><select class="lp-input" onchange="lpWiz.meta.transport=this.value"><option value="">â€” Select transport â€”</option>';
            LP_TRANSPORTS.forEach(function(t){ h += '<option' + (lpWiz.meta.transport===t?' selected':'') + '>' + t + '</option>'; });
            h += '</select></div>';
            // Volume
            h += '<div class="lp-field"><div class="lp-field-label">Expected Volume</div><select class="lp-input" onchange="lpWiz.meta.volume=this.value"><option value="">â€” Select volume â€”</option>';
            LP_VOLUME.forEach(function(v){ h += '<option' + (lpWiz.meta.volume===v?' selected':'') + '>' + v + '</option>'; });
            h += '</select></div>';
            // SIEM
            h += '<div style="grid-column:1/-1;" class="lp-field"><div class="lp-field-label">Target SIEM(s)</div><div style="display:flex;gap:12px;flex-wrap:wrap;">';
            LP_SIEMS.forEach(function(s){
              var chk = lpWiz.meta.siems.indexOf(s) >= 0;
              h += '<label style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--text-secondary);cursor:pointer;"><input type="checkbox"' + (chk?' checked':'') + ' onchange="toggleLpSiem(\'' + s.replace(/'/g,'\&apos;') + '\')" style="accent-color:var(--cyan);"> ' + s + '</label>';
            });
            h += '</div></div>';
            h += '</div>';
            // Buttons
            h += '<div style="display:flex;justify-content:flex-end;margin-top:16px;">';
            h += '<button class="btn btn-primary btn-sm" onclick="lpWizNext()">Next &mdash; Choose Acquisition Path &rarr;</button>';
            h += '</div>';
            document.getElementById('lpWizBody').innerHTML = h;
          }

          function toggleLpSiem(s) {
            var idx = lpWiz.meta.siems.indexOf(s);
            if (idx >= 0) lpWiz.meta.siems.splice(idx, 1);
            else lpWiz.meta.siems.push(s);
          }

          function renderStep1() {
            var h = '<div style="display:flex;align-items:center;gap:8px;margin-bottom:6px;">';
            h += '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>';
            h += '<span style="font-size:11px;font-weight:700;letter-spacing:1.5px;font-family:var(--font-mono);color:var(--cyan);text-transform:uppercase;">Schema Acquisition Path</span>';
            h += '</div>';
            h += '<p style="color:var(--text-muted);font-size:12px;margin-bottom:16px;">Select the best path based on what you have available. Paths are ordered from highest to lowest confidence.</p>';

            LP_PATHS.forEach(function(p, i) {
              var sel = lpWiz.path === p.id;
              h += '<div class="lp-path-card' + (sel?' selected':'') + '" onclick="lpWiz.path=\'' + p.id + '\';renderWizard();">';
              h += '<div class="lp-path-icon">' + p.icon + '</div>';
              h += '<div style="flex:1;">';
              h += '<div style="display:flex;align-items:center;gap:8px;margin-bottom:3px;">';
              h += '<span style="font-size:10px;font-family:var(--font-mono);color:var(--text-muted);">PATH ' + (i+1) + '</span>';
              h += '<span style="font-size:13px;font-weight:600;color:' + (sel?'var(--cyan)':'var(--text-secondary)') + ';">' + p.label + '</span>';
              if (p.badge) h += '<span style="font-size:9px;font-weight:700;padding:2px 8px;border-radius:4px;background:' + p.badgeColor + '22;border:1px solid ' + p.badgeColor + '44;color:' + p.badgeColor + ';font-family:var(--font-mono);">' + p.badge + '</span>';
              h += '</div>';
              h += '<div style="font-size:11px;color:var(--text-muted);">' + p.sub + '</div>';
              h += '</div>';
              h += '<div class="lp-path-radio"><div class="lp-path-radio-inner"></div></div>';
              h += '</div>';
            });

            h += '<div style="display:flex;justify-content:space-between;margin-top:18px;">';
            h += '<button class="btn btn-secondary btn-sm" onclick="lpWiz.step=0;renderWizard();">&larr; Back</button>';
            h += '<button class="btn btn-primary btn-sm" onclick="lpWizNext()"' + (lpWiz.path?'':' disabled style="opacity:0.4;"') + '>Continue with ' + (lpWiz.path ? LP_PATHS.find(function(p){return p.id===lpWiz.path}).label : 'selected path') + ' &rarr;</button>';
            h += '</div>';
            document.getElementById('lpWizBody').innerHTML = h;
          }

          function renderPathFlow() {
            switch (lpWiz.path) {
              case 'doc': renderPathDoc(); break;
              case 'code': renderPathCode(); break;
              case 'sample': renderPathSample(); break;
              case 'interview': renderPathInterview(); break;
              case 'checklist': renderPathChecklist(); break;
              case 'catcher': renderPathCatcher(); break;
            }
          }

          /* â”€â”€ Path: Documentation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          function renderPathDoc() {
            var h = '<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;"><span style="font-size:16px;">&#128196;</span><span style="font-size:11px;font-weight:700;letter-spacing:1.5px;font-family:var(--font-mono);color:var(--cyan);text-transform:uppercase;">Documentation Ingestion</span></div>';
            h += '<div style="display:flex;gap:12px;margin-bottom:12px;">';
            h += '<div style="flex:2;"><div class="lp-field"><div class="lp-field-label">Paste Documentation Text</div><textarea class="lp-input" id="lpDocText" rows="6" placeholder="Paste log format specification, README, or any descriptive text about the log format..."></textarea></div></div>';
            h += '<div style="flex:1;"><div class="lp-field"><div class="lp-field-label">Or Fetch from URL</div><input class="lp-input" id="lpDocUrl" placeholder="https://docs.vendor.com/logging" style="margin-bottom:8px;"><div style="font-size:10px;color:var(--text-muted);">Also accepted: PDF, DOCX upload</div>';
            h += '<div style="margin-top:8px;border:2px dashed rgba(0,212,255,0.15);border-radius:8px;padding:16px 12px;text-align:center;color:var(--text-muted);font-size:10px;">Drop PDF / DOCX here</div>';
            h += '</div></div></div>';
            h += '<button class="btn btn-primary btn-sm" id="lpDocAnalyse" onclick="lpSimulateAnalysis(\'' + 'doc' + '\')">Analyse with AI &rarr;</button>';
            h += '<div id="lpDocResult" style="margin-top:16px;"></div>';
            h += '<div style="display:flex;justify-content:space-between;margin-top:16px;">';
            h += '<button class="btn btn-secondary btn-sm" onclick="lpWiz.step=1;renderWizard();">&larr; Back</button>';
            h += '<button class="btn btn-sm" id="lpDocNext" style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.3);color:#22c55e;opacity:0.4;" disabled onclick="lpWiz.step=3;renderWizard();">Confirm Schema &mdash; Generate Parser &rarr;</button>';
            h += '</div>';
            document.getElementById('lpWizBody').innerHTML = h;
          }

          /* â”€â”€ Path: Source Code â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          function renderPathCode() {
            var h = '<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;"><span style="font-size:16px;">&#128187;</span><span style="font-size:11px;font-weight:700;letter-spacing:1.5px;font-family:var(--font-mono);color:var(--cyan);text-transform:uppercase;">Source Code Reading</span></div>';
            h += '<div class="lp-field"><div class="lp-field-label">Paste Code Snippet or Logging Module</div><textarea class="lp-input" id="lpCodeText" rows="8" style="font-size:11px;" placeholder="# Paste Python, Java, JS, Go, C# or any logging code&#10;import logging&#10;logger.info(f&apos;{timestamp} | {severity} | {src_ip} | {event}&apos;)"></textarea></div>';
            h += '<div style="display:flex;gap:10px;align-items:center;margin-bottom:16px;">';
            h += '<button class="btn btn-primary btn-sm" onclick="lpSimulateAnalysis(\'' + 'code' + '\')">Extract Log Format &rarr;</button>';
            h += '<span style="font-size:10px;color:var(--text-muted);">Supported: Python, Java, Node.js, Go, C#, PHP, Ruby</span>';
            h += '</div>';
            h += '<div id="lpCodeResult"></div>';
            h += '<div style="display:flex;justify-content:space-between;margin-top:16px;">';
            h += '<button class="btn btn-secondary btn-sm" onclick="lpWiz.step=1;renderWizard();">&larr; Back</button>';
            h += '<button class="btn btn-sm" id="lpCodeNext" style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.3);color:#22c55e;opacity:0.4;" disabled onclick="lpWiz.step=3;renderWizard();">Deploy Parser &rarr;</button>';
            h += '</div>';
            document.getElementById('lpWizBody').innerHTML = h;
          }

          /* â”€â”€ Path: Sample Log â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          function renderPathSample() {
            var h = '<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;"><span style="font-size:16px;">&#128203;</span><span style="font-size:11px;font-weight:700;letter-spacing:1.5px;font-family:var(--font-mono);color:var(--cyan);text-transform:uppercase;">Sample Log Ingestion</span></div>';
            h += '<div class="lp-field"><div class="lp-field-label">Paste Sample Log Lines (one or more)</div><textarea class="lp-input" id="lpSampleText" rows="6" placeholder="2024-01-15 10:30:00 | INFO | 192.168.1.10 | login | jdoe | Login successful&#10;2024-01-15 10:31:00 | ERROR | auth.module | Connection pool exhausted"></textarea></div>';
            h += '<button class="btn btn-primary btn-sm" onclick="lpSimulateAnalysis(\'' + 'sample' + '\')">Parse Samples &rarr;</button>';
            h += '<div id="lpSampleResult" style="margin-top:16px;"></div>';
            h += '<div style="display:flex;justify-content:space-between;margin-top:16px;">';
            h += '<button class="btn btn-secondary btn-sm" onclick="lpWiz.step=1;renderWizard();">&larr; Back</button>';
            h += '<button class="btn btn-sm" id="lpSampleNext" style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.3);color:#22c55e;opacity:0.4;" disabled onclick="lpWiz.step=3;renderWizard();">Deploy Parser &rarr;</button>';
            h += '</div>';
            document.getElementById('lpWizBody').innerHTML = h;
          }

          /* â”€â”€ Path: Interview â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          function renderPathInterview() {
            var q = LP_INTERVIEW_QS[lpWiz.intIdx];
            if (!q) { lpSimulateIntGenerate(); return; }

            var h = '<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;"><span style="font-size:16px;">&#127908;</span><span style="font-size:11px;font-weight:700;letter-spacing:1.5px;font-family:var(--font-mono);color:var(--cyan);text-transform:uppercase;">Log Format Interview</span></div>';
            // Progress dots
            h += '<div style="display:flex;gap:4px;margin-bottom:20px;flex-wrap:wrap;align-items:center;">';
            for (var i = 0; i < LP_INTERVIEW_QS.length; i++) {
              var dotCls = i < lpWiz.intIdx ? 'done' : (i === lpWiz.intIdx ? 'active' : '');
              h += '<div class="lp-wiz-dot ' + dotCls + '" style="width:22px;height:22px;font-size:9px;">' + (i < lpWiz.intIdx ? '&#10003;' : (i+1)) + '</div>';
            }
            h += '<span style="font-size:10px;color:var(--text-muted);margin-left:8px;">Question ' + (lpWiz.intIdx+1) + ' of ' + LP_INTERVIEW_QS.length + '</span>';
            h += '</div>';
            // Question card
            h += '<div style="border:1px solid rgba(0,212,255,0.15);background:rgba(0,0,0,0.2);border-radius:8px;padding:20px;margin-bottom:14px;">';
            h += '<div style="font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:14px;">' + q.q + '</div>';
            var curAns = lpWiz.intAnswers[q.id] || '';
            if (q.opts && q.opts.length > 0) {
              q.opts.forEach(function(opt) {
                var sel = curAns === opt;
                h += '<div class="lp-int-opt' + (sel?' selected':'') + '" onclick="lpWiz.intAnswers[\'' + q.id + '\']=\'' + opt.replace(/'/g,'\&apos;') + '\';renderPathInterview();">';
                h += '<div class="lp-int-radio"><div class="lp-int-radio-dot"></div></div>';
                h += '<span style="font-size:12px;color:' + (sel?'var(--cyan)':'var(--text-secondary)') + ';">' + opt + '</span>';
                h += '</div>';
              });
            }
            if (q.free) {
              h += '<div style="margin-top:' + (q.opts && q.opts.length > 0 ? '12' : '0') + 'px;">';
              h += '<div class="lp-field-label" style="margin-bottom:5px;">' + (q.opts && q.opts.length > 0 ? 'Or describe in your own words:' : 'Your answer:') + '</div>';
              h += '<textarea class="lp-input" style="min-height:60px;" placeholder="' + (q.placeholder||'Type here...') + '" oninput="lpWiz.intAnswers[\'' + q.id + '\']=this.value">' + (q.opts && q.opts.length > 0 ? '' : (curAns||'')) + '</textarea>';
              h += '</div>';
            }
            h += '</div>';
            // Navigation
            h += '<div style="display:flex;justify-content:space-between;">';
            h += '<div style="display:flex;gap:8px;">';
            h += '<button class="btn btn-secondary btn-sm" onclick="lpWiz.step=1;lpWiz.intIdx=0;renderWizard();">&larr; Back to Path</button>';
            if (lpWiz.intIdx > 0) h += '<button class="btn btn-secondary btn-sm" onclick="lpWiz.intIdx--;renderPathInterview();">&larr; Prev Q</button>';
            h += '</div>';
            var isLast = lpWiz.intIdx === LP_INTERVIEW_QS.length - 1;
            h += '<button class="btn btn-primary btn-sm" onclick="lpWiz.intIdx++;renderPathInterview();">' + (isLast ? 'Complete &mdash; Generate Parser &rarr;' : 'Next Question &rarr;') + '</button>';
            h += '</div>';
            document.getElementById('lpWizBody').innerHTML = h;
          }

          function lpSimulateIntGenerate() {
            var h = '<div style="text-align:center;padding:40px;">';
            h += '<div style="color:var(--cyan);font-size:14px;margin-bottom:12px;font-family:var(--font-mono);">Synthesising schema from interview answers...</div>';
            h += '<div style="color:var(--text-muted);font-size:11px;">Analysing ' + LP_INTERVIEW_QS.length + ' responses and generating parser definition</div>';
            h += '</div>';
            document.getElementById('lpWizBody').innerHTML = h;
            setTimeout(function() {
              var h2 = '<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;"><span style="font-size:16px;">&#127908;</span><span style="font-size:11px;font-weight:700;letter-spacing:1.5px;font-family:var(--font-mono);color:var(--cyan);text-transform:uppercase;">Interview Complete &mdash; Schema Generated</span></div>';
              h2 += '<div style="border:1px solid rgba(251,146,60,0.3);background:rgba(251,146,60,0.04);border-radius:8px;padding:14px;margin-bottom:16px;">';
              h2 += '<div style="color:#fb923c;font-weight:600;margin-bottom:6px;font-size:12px;">Draft Parser &mdash; Requires Validation</div>';
              h2 += '<div style="color:var(--text-muted);font-size:11px;">This parser was generated from a format interview, not from real log samples. Confidence is moderate. It will be deployed with DRAFT status. The Novelty Catcher will automatically capture and flag any lines this parser does not match.</div>';
              h2 += '</div>';
              h2 += '<div style="border:1px solid rgba(0,212,255,0.12);background:rgba(0,0,0,0.2);border-radius:8px;padding:14px;margin-bottom:16px;">';
              h2 += '<div class="lp-field-label" style="margin-bottom:8px;">Generated Parser (Draft)</div>';
              h2 += '<div style="font-family:var(--font-mono);color:#a78bfa;font-size:10px;margin-bottom:8px;">^(?P&lt;timestamp&gt;\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) \| (?P&lt;severity&gt;\w+) \| (?P&lt;src_ip&gt;[\d.]+) \| (?P&lt;event&gt;\w+)</div>';
              h2 += '<div class="lp-field-label">Confidence: <span style="color:var(--amber);">67% (interview-derived)</span></div>';
              h2 += '</div>';
              h2 += '<div style="display:flex;justify-content:space-between;">';
              h2 += '<button class="btn btn-secondary btn-sm" onclick="lpWiz.intIdx=0;renderPathInterview();">&larr; Back</button>';
              h2 += '<button class="btn btn-sm" style="background:rgba(251,146,60,0.15);border:1px solid rgba(251,146,60,0.3);color:#fb923c;" onclick="lpWiz.step=3;renderWizard();">Deploy as Draft &rarr;</button>';
              h2 += '</div>';
              document.getElementById('lpWizBody').innerHTML = h2;
            }, 2000);
          }

          /* â”€â”€ Path: Trigger Checklist â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          function renderPathChecklist() {
            var items = LP_CHECKLIST_MAP[lpWiz.meta.type] || LP_CHECKLIST_MAP['Custom / In-house'];
            var total = items.length;
            var done = 0;
            items.forEach(function(it){ if (lpWiz.checkState[it]) done++; });

            var h = '<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;"><span style="font-size:16px;">&#9989;</span><span style="font-size:11px;font-weight:700;letter-spacing:1.5px;font-family:var(--font-mono);color:var(--cyan);text-transform:uppercase;">Trigger Checklist</span></div>';
            h += '<div style="border:1px solid rgba(0,212,255,0.12);background:rgba(0,0,0,0.2);border-radius:8px;padding:14px;margin-bottom:16px;">';
            h += '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;">';
            h += '<span style="font-size:11px;color:var(--text-secondary);">Share this checklist with the client admin. Trigger each event in the test environment.</span>';
            h += '<span style="font-size:10px;font-weight:700;padding:2px 8px;border-radius:4px;background:' + (done===total?'rgba(34,197,94,0.15)':'rgba(0,212,255,0.1)') + ';color:' + (done===total?'#22c55e':'var(--cyan)') + ';font-family:var(--font-mono);">' + done + '/' + total + ' captured</span>';
            h += '</div>';
            // Progress bar
            h += '<div style="width:100%;height:6px;background:rgba(0,212,255,0.06);border-radius:99px;overflow:hidden;margin-bottom:14px;"><div style="height:100%;width:' + ((done/total)*100) + '%;background:' + (done===total?'#22c55e':'var(--cyan)') + ';border-radius:99px;transition:width 0.4s;"></div></div>';
            // Items
            h += '<div style="max-height:300px;overflow-y:auto;">';
            items.forEach(function(item) {
              var cap = !!lpWiz.checkState[item];
              var capping = !!lpWiz.checkCapturing[item];
              h += '<div class="lp-check-item' + (cap?' captured':'') + '">';
              h += '<div style="display:flex;align-items:center;gap:10px;">';
              h += '<div class="lp-check-dot">' + (cap?'&#10003;':'') + '</div>';
              h += '<span style="font-size:12px;color:' + (cap?'#22c55e':'var(--text-secondary)') + ';' + (cap?'text-decoration:line-through;opacity:0.7;':'') + '">' + item + '</span>';
              h += '</div>';
              if (!cap) {
                h += '<button class="btn btn-secondary btn-xs" onclick="lpSimCapture(this,\'' + item.replace(/'/g,'\&apos;') + '\')"' + (capping?' disabled':'') + '>' + (capping?'Capturing...':'Simulate Capture') + '</button>';
              } else {
                h += '<span style="font-size:10px;font-family:var(--font-mono);color:#22c55e;">&#10003; Parser rule generated</span>';
              }
              h += '</div>';
            });
            h += '</div></div>';
            h += '<div style="display:flex;justify-content:space-between;">';
            h += '<button class="btn btn-secondary btn-sm" onclick="lpWiz.step=1;renderWizard();">&larr; Back</button>';
            h += '<button class="btn btn-sm" style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.3);color:#22c55e;"' + (done===0?' disabled style="opacity:0.4;"':'') + ' onclick="lpWiz.step=3;renderWizard();">' + (done===total ? 'Deploy ' + total + ' Parser Rules &rarr;' : 'Deploy ' + done + ' of ' + total + ' Rules (partial) &rarr;') + '</button>';
            h += '</div>';
            document.getElementById('lpWizBody').innerHTML = h;
          }

          function lpSimCapture(btn, item) {
            lpWiz.checkCapturing[item] = true;
            btn.textContent = 'Capturing...';
            btn.disabled = true;
            setTimeout(function() {
              lpWiz.checkCapturing[item] = false;
              lpWiz.checkState[item] = true;
              renderPathChecklist();
            }, 1500);
          }

          /* â”€â”€ Path: Progressive Catcher â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          function renderPathCatcher() {
            var h = '<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;"><span style="font-size:16px;">&#128376;</span><span style="font-size:11px;font-weight:700;letter-spacing:1.5px;font-family:var(--font-mono);color:var(--cyan);text-transform:uppercase;">Progressive Catcher &mdash; Monitoring Mode</span></div>';
            h += '<div style="border:1px solid rgba(251,146,60,0.3);background:rgba(251,146,60,0.04);border-radius:8px;padding:16px;margin-bottom:16px;">';
            h += '<div style="color:#fb923c;font-weight:600;margin-bottom:8px;font-size:12px;">No parser will be deployed yet</div>';
            h += '<div style="color:var(--text-secondary);font-size:12px;line-height:1.7;">A stub log source record will be created for <strong style="color:var(--cyan);">' + (lpWiz.meta.name||'this source') + '</strong> on <strong style="color:var(--cyan);">' + (lpWiz.meta.client||'the client') + '</strong>. All incoming logs will be held in a 7-day rolling buffer and simultaneously fed to the Novelty Catcher. You will be notified when the first log line arrives.</div>';
            h += '</div>';
            var steps = [
              ['Stub source record created', 'Source name, client, transport, SIEM target saved to DACTA'],
              ['Holding area activated', 'Logs buffered for up to 7 days &mdash; replayed through parser on deployment'],
              ['Novelty Catcher active', 'All incoming traffic monitored for the first log pattern'],
              ['Alert on first sample', 'In-app notification + email when first log line is captured'],
              ['Auto-route to wizard', 'First sample pre-loaded into Path 3 (Sample) on alert click']
            ];
            h += '<div style="display:flex;flex-direction:column;gap:10px;">';
            steps.forEach(function(s) {
              h += '<div style="display:flex;align-items:flex-start;gap:12px;padding:10px 14px;border:1px solid rgba(0,212,255,0.08);background:rgba(0,0,0,0.15);border-radius:7px;">';
              h += '<span style="color:var(--cyan);font-size:16px;margin-top:1px;">&rarr;</span>';
              h += '<div><div style="color:var(--text-secondary);font-weight:600;font-size:12px;margin-bottom:2px;">' + s[0] + '</div>';
              h += '<div style="color:var(--text-muted);font-size:11px;">' + s[1] + '</div></div>';
              h += '</div>';
            });
            h += '</div>';
            h += '<div style="display:flex;justify-content:space-between;margin-top:16px;">';
            h += '<button class="btn btn-secondary btn-sm" onclick="lpWiz.step=1;renderWizard();">&larr; Back</button>';
            h += '<button class="btn btn-sm" style="background:rgba(251,146,60,0.15);border:1px solid rgba(251,146,60,0.3);color:#fb923c;" onclick="lpWiz.step=3;renderWizard();">Activate Monitoring Mode &rarr;</button>';
            h += '</div>';
            document.getElementById('lpWizBody').innerHTML = h;
          }

          /* â”€â”€ Simulate AI Analysis (Doc/Code/Sample) â”€â”€â”€ */
          function lpSimulateAnalysis(type) {
            var resultId = type === 'doc' ? 'lpDocResult' : (type === 'code' ? 'lpCodeResult' : 'lpSampleResult');
            var nextId = type === 'doc' ? 'lpDocNext' : (type === 'code' ? 'lpCodeNext' : 'lpSampleNext');
            document.getElementById(resultId).innerHTML = '<div style="text-align:center;padding:20px;color:var(--cyan);font-size:12px;font-family:var(--font-mono);">Analysing...</div>';

            setTimeout(function() {
              var h = '';
              if (type === 'doc' || type === 'sample') {
                h += '<div style="border:1px solid rgba(34,197,94,0.2);background:rgba(34,197,94,0.03);border-radius:8px;padding:16px;">';
                h += '<div style="display:flex;align-items:center;gap:8px;margin-bottom:12px;"><span style="color:#22c55e;font-size:13px;">&#10003;</span><span style="font-size:12px;font-weight:600;color:#22c55e;">Schema extracted &mdash; please review and confirm</span></div>';
                h += '<div class="lp-field-label" style="margin-bottom:6px;">Reconstructed Example Line</div>';
                h += '<div style="font-family:var(--font-mono);color:#22c55e;font-size:11px;background:rgba(0,0,0,0.3);border-radius:6px;padding:8px 12px;margin-bottom:12px;">2024-01-15 10:30:00 | INFO | 192.168.1.10 | login | jdoe | Login successful</div>';
                h += '<div class="lp-field-label" style="margin-bottom:6px;">Detected Delimiter: <span style="color:var(--cyan);">pipe (|)</span></div>';
                h += '<table class="lp-schema-tbl"><thead><tr><th>Field Name</th><th>Type</th><th>Format / Values</th><th>Confidence</th></tr></thead><tbody>';
                var fields = [
                  ['timestamp','DATETIME','YYYY-MM-DD HH:mm:ss',98],['severity','STRING','INFO|WARN|ERROR|CRITICAL',95],
                  ['source_ip','IPV4','dotted-decimal',92],['event_type','STRING','login|logout|access|modify',88],
                  ['username','STRING','alphanumeric',85],['message','STRING','free text',79]
                ];
                fields.forEach(function(f,i) {
                  var clr = f[3]>90?'#22c55e':(f[3]>75?'#fbbf24':'#f87171');
                  h += '<tr style="background:' + (i%2===0?'transparent':'rgba(0,212,255,0.02)') + ';">';
                  h += '<td style="color:var(--cyan);font-family:var(--font-mono);">' + f[0] + '</td>';
                  h += '<td style="color:#fb923c;font-family:var(--font-mono);">' + f[1] + '</td>';
                  h += '<td style="color:var(--text-muted);font-family:var(--font-mono);font-size:10px;">' + f[2] + '</td>';
                  h += '<td><div style="display:flex;align-items:center;gap:6px;"><div style="width:50px;height:4px;background:rgba(0,212,255,0.1);border-radius:99px;overflow:hidden;"><div style="height:100%;width:' + f[3] + '%;background:' + clr + ';border-radius:99px;"></div></div><span style="color:' + clr + ';font-size:10px;font-family:var(--font-mono);">' + f[3] + '%</span></div></td>';
                  h += '</tr>';
                });
                h += '</tbody></table></div>';
              } else if (type === 'code') {
                h += '<div style="border:1px solid rgba(0,212,255,0.15);background:rgba(0,0,0,0.2);border-radius:8px;padding:16px;">';
                h += '<div style="color:#22c55e;font-weight:600;margin-bottom:10px;font-size:12px;">&#10003; Language detected: Python &mdash; 2 logging call(s) found</div>';
                h += '<div class="lp-field-label" style="margin-bottom:6px;">Extracted Logging Statements</div>';
                h += '<div style="font-family:var(--font-mono);color:var(--amber);font-size:10px;background:rgba(0,0,0,0.3);border-radius:5px;padding:5px 10px;margin-bottom:6px;">logger.info(f&quot;{ts} | INFO | {src_ip} | {event} | {user} | {msg}&quot;)</div>';
                h += '<div style="font-family:var(--font-mono);color:var(--amber);font-size:10px;background:rgba(0,0,0,0.3);border-radius:5px;padding:5px 10px;margin-bottom:12px;">logger.error(f&quot;{ts} | ERROR | {component} | {msg}&quot;)</div>';
                h += '<div class="lp-field-label" style="margin-bottom:8px;">Generated Parser Variants</div>';
                h += '<div style="margin-bottom:8px;"><span style="font-size:10px;font-weight:700;padding:2px 8px;border-radius:4px;background:rgba(0,212,255,0.1);border:1px solid rgba(0,212,255,0.2);color:var(--cyan);font-family:var(--font-mono);">Info format</span>';
                h += '<div style="font-family:var(--font-mono);color:#a78bfa;font-size:10px;background:rgba(0,0,0,0.3);border-radius:5px;padding:5px 10px;margin-top:5px;overflow-x:auto;">^(?P&lt;ts&gt;[\d-]+ [\d:]+) \| INFO \| (?P&lt;src_ip&gt;[\d.]+) \| (?P&lt;event&gt;\w+) \| (?P&lt;user&gt;\w+) \| (?P&lt;msg&gt;.+)$</div></div>';
                h += '<div><span style="font-size:10px;font-weight:700;padding:2px 8px;border-radius:4px;background:rgba(0,212,255,0.1);border:1px solid rgba(0,212,255,0.2);color:var(--cyan);font-family:var(--font-mono);">Error format</span>';
                h += '<div style="font-family:var(--font-mono);color:#a78bfa;font-size:10px;background:rgba(0,0,0,0.3);border-radius:5px;padding:5px 10px;margin-top:5px;overflow-x:auto;">^(?P&lt;ts&gt;[\d-]+ [\d:]+) \| ERROR \| (?P&lt;component&gt;[\w.]+) \| (?P&lt;msg&gt;.+)$</div></div>';
                h += '</div>';
              }
              document.getElementById(resultId).innerHTML = h;
              var nextBtn = document.getElementById(nextId);
              if (nextBtn) { nextBtn.disabled = false; nextBtn.style.opacity = '1'; }
            }, 2200);
          }

          /* â”€â”€ Deploy Step â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          function renderDeploy() {
            var isCatcher = lpWiz.path === 'catcher';
            var isDraft = lpWiz.path === 'interview';
            var pathLabel = '';
            LP_PATHS.forEach(function(p){ if(p.id===lpWiz.path) pathLabel = p.label; });

            var h = '<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;"><span style="font-size:16px;">&#128640;</span><span style="font-size:11px;font-weight:700;letter-spacing:1.5px;font-family:var(--font-mono);color:var(--cyan);text-transform:uppercase;">Deploy Parser</span></div>';
            h += '<div id="lpDeployContent">';
            h += '<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px;">';
            var info = [['Client',lpWiz.meta.client||'â€”'],['Source',lpWiz.meta.name||'â€”'],['Type',lpWiz.meta.type||'â€”'],['Transport',lpWiz.meta.transport||'â€”'],['SIEM(s)',(lpWiz.meta.siems||[]).join(', ')||'â€”'],['Path used',pathLabel]];
            info.forEach(function(kv) {
              h += '<div style="background:rgba(0,0,0,0.2);border:1px solid rgba(0,212,255,0.08);border-radius:7px;padding:10px 14px;">';
              h += '<div class="lp-field-label">' + kv[0] + '</div>';
              h += '<div style="color:var(--text-primary);font-size:12px;margin-top:4px;">' + kv[1] + '</div>';
              h += '</div>';
            });
            h += '</div>';
            if (isDraft) {
              h += '<div style="border:1px solid rgba(251,146,60,0.3);background:rgba(251,146,60,0.04);border-radius:7px;padding:12px;margin-bottom:14px;color:#fb923c;font-size:11px;">Deploying as DRAFT &mdash; parser will be validated against real traffic. Novelty Catcher will flag unmatched lines.</div>';
            }
            if (isCatcher) {
              h += '<div style="border:1px solid rgba(251,146,60,0.3);background:rgba(251,146,60,0.04);border-radius:7px;padding:12px;margin-bottom:14px;color:#fb923c;font-size:11px;">No parser deployed &mdash; stub source record and Novelty Catcher monitoring will be activated.</div>';
            }
            h += '<button class="btn btn-sm" id="lpDeployBtn" style="background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.3);color:#22c55e;font-size:13px;padding:10px 24px;" onclick="lpDoDeploy()">' + (isCatcher ? 'Activate Monitoring &rarr;' : 'Deploy to Collector Pipeline &rarr;') + '</button>';
            h += '</div>';
            document.getElementById('lpWizBody').innerHTML = h;
          }

          function lpDoDeploy() {
            var btn = document.getElementById('lpDeployBtn');
            btn.textContent = 'Deploying...';
            btn.disabled = true;
            btn.style.opacity = '0.6';
            setTimeout(function() {
              var isCatcher = lpWiz.path === 'catcher';
              var isDraft = lpWiz.path === 'interview';
              var h = '<div style="text-align:center;padding:30px;">';
              h += '<div style="font-size:48px;margin-bottom:16px;">&#9989;</div>';
              h += '<div style="color:#22c55e;font-size:18px;font-weight:700;margin-bottom:8px;">' + (isCatcher ? 'Monitoring Activated' : isDraft ? 'Draft Parser Deployed' : 'Parser Deployed Successfully') + '</div>';
              h += '<div style="color:var(--text-secondary);font-size:12px;margin-bottom:20px;">';
              if (isCatcher) h += 'Novelty Catcher is now monitoring all logs from ' + (lpWiz.meta.name||'this source') + ' on ' + (lpWiz.meta.client||'the client') + '. You will be alerted when the first pattern is captured.';
              else if (isDraft) h += 'Draft parser is live on ' + (lpWiz.meta.client||'the client') + '. Novelty Catcher is running behind it to catch any unmatched lines.';
              else h += 'Parser is live on ' + (lpWiz.meta.client||'the client') + '. Rules pushed to ' + ((lpWiz.meta.siems||[]).join(', ')||'SIEM') + '. Novelty Catcher running for gap detection.';
              h += '</div>';
              h += '<div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">';
              h += '<button class="btn btn-primary btn-sm" onclick="closeLpWizard()">Back to Log Parser Module</button>';
              h += '<button class="btn btn-secondary btn-sm" onclick="switchLpTab(\'' + 'library' + '\');closeLpWizard();">View in Active Parsers Library</button>';
              h += '</div></div>';
              document.getElementById('lpDeployContent').innerHTML = h;
            }, 2000);
          }

          function lpWizNext() {
            if (lpWiz.step === 0) {
              if (!lpWiz.meta.client || !lpWiz.meta.name || !lpWiz.meta.type || !lpWiz.meta.transport) {
                showToast('Please fill all required fields');
                return;
              }
            }
            if (lpWiz.step === 1 && !lpWiz.path) return;
            lpWiz.step++;
            renderWizard();
          }
        </script>
      </div><!-- end parsers -->


      <!-- =====================================================
           PAGE 10: THREAT HUNTING
           ===================================================== -->
      <div class="page" id="page-hunting">

        <style>
          /* â”€â”€ Hunting Page Styles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
          .hunt-tab-nav {
            display: flex;
            align-items: center;
            gap: 0;
            border-bottom: 1px solid rgba(255,255,255,0.07);
            margin-bottom: 20px;
            background: transparent;
          }
          .hunt-tab-btn {
            display: flex;
            align-items: center;
            gap: 7px;
            padding: 11px 18px;
            font-family: 'IBM Plex Sans', sans-serif;
            font-size: 13px;
            font-weight: 500;
            color: #64748b;
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            white-space: nowrap;
            transition: color 0.15s, border-color 0.15s;
            outline: none;
            position: relative;
            bottom: -1px;
          }
          .hunt-tab-btn:hover { color: #94a3b8; }
          .hunt-tab-btn.active {
            color: #00d4ff;
            border-bottom-color: #00d4ff;
            font-weight: 600;
          }
          .hunt-tab-panel { display: none; }
          .hunt-tab-panel.active { display: block; }

          /* Hunt Cards */
          .hv2-card {
            background: rgba(15,23,42,0.6);
            border: 1px solid var(--border-card);
            border-radius: 10px;
            padding: 16px 18px;
            margin-bottom: 14px;
            backdrop-filter: blur(8px);
            transition: border-color 0.2s;
          }
          .hv2-card:hover { border-color: rgba(0,212,255,0.18); }
          .hv2-card-head {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 10px;
            flex-wrap: wrap;
          }
          .hv2-card-title {
            font-family: 'Sora', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            flex: 1;
            min-width: 180px;
          }
          .hv2-priority {
            font-size: 10px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.06em;
          }
          .hv2-priority-critical { background: rgba(239,68,68,0.15); color: #ef4444; border: 1px solid rgba(239,68,68,0.3); }
          .hv2-priority-high     { background: rgba(245,158,11,0.15); color: #f59e0b; border: 1px solid rgba(245,158,11,0.3); }
          .hv2-priority-medium   { background: rgba(234,179,8,0.12);  color: #eab308; border: 1px solid rgba(234,179,8,0.25); }
          .hv2-priority-low      { background: rgba(16,185,129,0.12); color: #10b981; border: 1px solid rgba(16,185,129,0.25); }
          .hv2-status {
            font-size: 10px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            display: inline-flex;
            align-items: center;
            gap: 5px;
          }
          .hv2-status-running  { background: rgba(16,185,129,0.12); color: #10b981; border: 1px solid rgba(16,185,129,0.25); }
          .hv2-status-scheduled{ background: rgba(0,212,255,0.1);   color: #00d4ff; border: 1px solid rgba(0,212,255,0.2); }
          .hv2-status-paused   { background: rgba(100,116,139,0.15);color: #94a3b8; border: 1px solid rgba(100,116,139,0.25); }
          .hv2-status-dot {
            width: 6px; height: 6px; border-radius: 50%;
            background: currentColor;
            animation: hv2-pulse 2s ease infinite;
          }
          @keyframes hv2-pulse {
            0%,100% { opacity:1; } 50% { opacity:0.35; }
          }
          .hv2-tags { display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 8px; }
          .hv2-mitre-tag {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10px;
            padding: 2px 7px;
            border-radius: 4px;
            background: rgba(0,212,255,0.08);
            color: #00d4ff;
            border: 1px solid rgba(0,212,255,0.15);
          }
          .hv2-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 10px;
          }
          .hv2-meta-row {
            display: flex;
            gap: 18px;
            flex-wrap: wrap;
            margin-bottom: 10px;
          }
          .hv2-meta-item {
            font-size: 11px;
            color: var(--text-muted);
          }
          .hv2-meta-item b { color: var(--text-secondary); font-weight: 500; }
          .hv2-stats-row {
            display: flex;
            gap: 20px;
            margin-bottom: 12px;
            padding: 10px 14px;
            background: rgba(0,0,0,0.2);
            border-radius: 6px;
            flex-wrap: wrap;
          }
          .hv2-stat { text-align: center; }
          .hv2-stat-val {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 15px;
            font-weight: 700;
            color: var(--text-primary);
          }
          .hv2-stat-lbl { font-size: 10px; color: var(--text-muted); margin-top: 1px; }
          .hv2-query {
            background: rgba(8,13,26,0.9);
            border: 1px solid rgba(255,255,255,0.07);
            border-radius: 6px;
            padding: 10px 14px;
            margin-bottom: 12px;
            position: relative;
          }
          .hv2-query-label {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            margin-bottom: 6px;
          }
          .hv2-query pre {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            color: #94a3b8;
            white-space: pre-wrap;
            word-break: break-all;
            margin: 0;
            line-height: 1.6;
          }
          .hv2-query pre .kw  { color: #00d4ff; }
          .hv2-query pre .str { color: #10b981; }
          .hv2-query pre .op  { color: #f59e0b; }
          .hv2-actions { display: flex; gap: 6px; flex-wrap: wrap; }

          /* Findings Table */
          .hunt-filter-bar {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 14px;
            padding: 10px 14px;
            background: rgba(15,23,42,0.5);
            border: 1px solid var(--border-card);
            border-radius: 8px;
          }
          .hunt-filter-bar select, .hunt-filter-bar input {
            background: rgba(8,13,26,0.8);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 5px;
            color: var(--text-secondary);
            font-family: 'IBM Plex Sans', sans-serif;
            font-size: 11px;
            padding: 5px 9px;
            outline: none;
          }
          .hunt-filter-bar label { font-size: 11px; color: var(--text-muted); }
          .hf-sev-critical { color: #ef4444; font-weight: 600; }
          .hf-sev-high     { color: #f59e0b; font-weight: 600; }
          .hf-sev-medium   { color: #eab308; font-weight: 600; }
          .hf-sev-low      { color: #10b981; font-weight: 600; }
          .hf-status-escalated { color: #00d4ff; }
          .hf-status-review    { color: #f59e0b; }
          .hf-status-graduated { color: #10b981; }
          .hf-status-closed    { color: #64748b; }

          /* Graduation Kanban */
          .grad-criteria-box {
            background: rgba(0,212,255,0.04);
            border: 1px solid rgba(0,212,255,0.15);
            border-radius: 8px;
            padding: 14px 18px;
            margin-bottom: 18px;
          }
          .grad-criteria-box h4 {
            font-family: 'Sora', sans-serif;
            font-size: 13px;
            font-weight: 700;
            color: #00d4ff;
            margin: 0 0 10px 0;
          }
          .grad-criteria-box ol {
            margin: 0;
            padding-left: 18px;
            display: flex;
            flex-direction: column;
            gap: 5px;
          }
          .grad-criteria-box li {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.5;
          }
          .grad-criteria-box li b { color: var(--text-primary); }
          .grad-criteria-note {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid rgba(255,255,255,0.06);
          }
          .kanban-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            align-items: start;
          }
          .kanban-col {
            background: rgba(15,23,42,0.5);
            border: 1px solid var(--border-card);
            border-radius: 8px;
            overflow: hidden;
          }
          .kanban-col-header {
            padding: 10px 12px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            border-bottom: 1px solid rgba(255,255,255,0.06);
            display: flex;
            align-items: center;
            justify-content: space-between;
          }
          .kanban-col-body { padding: 10px; display: flex; flex-direction: column; gap: 8px; }
          .kanban-card {
            background: rgba(8,13,26,0.7);
            border: 1px solid rgba(255,255,255,0.07);
            border-radius: 6px;
            padding: 10px 12px;
            transition: border-color 0.2s;
          }
          .kanban-card:hover { border-color: rgba(0,212,255,0.2); }
          .kanban-card-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 6px;
            line-height: 1.4;
          }
          .kanban-progress-wrap {
            margin: 8px 0 6px;
          }
          .kanban-progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: var(--text-muted);
            margin-bottom: 4px;
          }
          .kanban-progress-bar {
            height: 4px;
            border-radius: 2px;
            background: rgba(255,255,255,0.07);
            overflow: hidden;
          }
          .kanban-progress-fill {
            height: 100%;
            border-radius: 2px;
            background: linear-gradient(90deg, #00d4ff, #0ea5e9);
            transition: width 0.3s;
          }
          .kanban-progress-fill.full { background: linear-gradient(90deg, #10b981, #059669); }
          .kanban-blocker {
            font-size: 10px;
            color: #f59e0b;
            margin-top: 6px;
            padding: 4px 7px;
            background: rgba(245,158,11,0.08);
            border-radius: 4px;
            border-left: 2px solid #f59e0b;
          }
          .kanban-graduated-tag {
            font-size: 10px;
            color: #10b981;
            margin-top: 6px;
            padding: 4px 7px;
            background: rgba(16,185,129,0.08);
            border-radius: 4px;
            border-left: 2px solid #10b981;
          }

          /* Playbooks */
          .playbook-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 14px;
          }
          .playbook-card {
            background: rgba(15,23,42,0.6);
            border: 1px solid var(--border-card);
            border-radius: 10px;
            padding: 16px 18px;
            backdrop-filter: blur(8px);
            transition: border-color 0.2s;
          }
          .playbook-card:hover { border-color: rgba(0,212,255,0.2); }
          .playbook-card-head {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 8px;
          }
          .playbook-title {
            font-family: 'Sora', sans-serif;
            font-size: 13px;
            font-weight: 700;
            color: var(--text-primary);
          }
          .playbook-difficulty {
            font-size: 10px;
            font-weight: 700;
            padding: 2px 7px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            white-space: nowrap;
          }
          .pb-diff-hard   { background: rgba(239,68,68,0.12);  color: #ef4444;  border: 1px solid rgba(239,68,68,0.25); }
          .pb-diff-medium { background: rgba(245,158,11,0.12); color: #f59e0b;  border: 1px solid rgba(245,158,11,0.25); }
          .pb-diff-easy   { background: rgba(16,185,129,0.12); color: #10b981;  border: 1px solid rgba(16,185,129,0.25); }
          .playbook-focus {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 10px;
          }
          .playbook-steps {
            list-style: none;
            padding: 0;
            margin: 0 0 10px;
            display: flex;
            flex-direction: column;
            gap: 4px;
            counter-reset: pb-step;
          }
          .playbook-steps li {
            font-size: 11px;
            color: var(--text-secondary);
            display: flex;
            align-items: baseline;
            gap: 7px;
            counter-increment: pb-step;
          }
          .playbook-steps li::before {
            content: counter(pb-step);
            font-family: 'IBM Plex Mono', monospace;
            font-size: 9px;
            font-weight: 700;
            color: #00d4ff;
            background: rgba(0,212,255,0.1);
            border: 1px solid rgba(0,212,255,0.2);
            border-radius: 3px;
            min-width: 16px;
            height: 16px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
          }
          .playbook-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.06);
            flex-wrap: wrap;
            gap: 8px;
          }
          .playbook-meta-txt { font-size: 10px; color: var(--text-muted); }
          .playbook-actions { display: flex; gap: 6px; }
        </style>

        <!-- Page Header -->
        <div class="page-header">
          <div>
            <div class="page-title">Threat Hunting</div>
            <div class="page-subtitle">Proactive detection beyond alerts â€” hypothesis-driven adversary hunting</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm" onclick="tipToast('ðŸ“Š','Hunt analytics dashboard opening...')">ðŸ“Š Hunt Analytics</button>
            <button class="btn btn-primary btn-sm" onclick="tipToast('âž•','Create Hunt dialog opening...')">+ Create Hunt</button>
          </div>
        </div>

        <!-- Tab Navigation -->
        <div class="hunt-tab-nav">
          <button class="hunt-tab-btn active" data-hunttab="active" onclick="switchHuntTab('active')">ðŸŽ¯ Active Hunts</button>
          <button class="hunt-tab-btn" data-hunttab="findings" onclick="switchHuntTab('findings')">ðŸ” Findings</button>
          <button class="hunt-tab-btn" data-hunttab="graduation" onclick="switchHuntTab('graduation')">ðŸŽ“ Graduation Pipeline</button>
          <button class="hunt-tab-btn" data-hunttab="playbooks" onclick="switchHuntTab('playbooks')">ðŸ“š Playbooks</button>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 1: ACTIVE HUNTS
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="hunt-tab-panel active" id="hunt-panel-active">

          <!-- Metrics Row -->
          <div class="metrics-row" style="margin-bottom:20px;">
            <div class="metric-card red"><div class="metric-label">Active Hunts</div><div class="metric-value">2</div><div class="metric-sub">in progress</div></div>
            <div class="metric-card amber"><div class="metric-label">Scheduled</div><div class="metric-value">5</div><div class="metric-sub">upcoming</div></div>
            <div class="metric-card cyan"><div class="metric-label">Findings (90d)</div><div class="metric-value">8</div><div class="metric-sub">confirmed threats</div></div>
            <div class="metric-card green"><div class="metric-label">Graduated</div><div class="metric-value">12</div><div class="metric-sub">converted to rules</div></div>
          </div>

          <!-- Hunt Card 1: DarkPink ISO Delivery -->
          <div class="hv2-card" style="border-color:rgba(239,68,68,0.25);">
            <div class="hv2-card-head">
              <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;flex:1;">
                <span class="hv2-priority hv2-priority-critical">Critical</span>
                <span class="hv2-status hv2-status-running"><span class="hv2-status-dot"></span>RUNNING</span>
              </div>
              <div style="display:flex;gap:6px;">
                <button class="btn btn-secondary btn-xs" onclick="tipToast('ðŸ““','Opening hunt notebook...')">ðŸ““ Notebook</button>
                <button class="btn btn-xs" style="background:rgba(245,158,11,0.15);color:#f59e0b;border:1px solid rgba(245,158,11,0.3);" onclick="tipToast('â¸','Hunt paused')">â¸ Pause</button>
                <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ“Š','Opening findings view...')">ðŸ“Š View Findings</button>
                <button class="btn btn-xs btn-secondary" onclick="tipToast('âš™','Opening hunt editor...')">âš™ Edit</button>
              </div>
            </div>
            <div class="hv2-card-title">DarkPink ISO Delivery Detection</div>
            <div class="hv2-tags">
              <span class="hv2-mitre-tag">T1566.001</span>
              <span class="hv2-mitre-tag">T1204.002</span>
              <span class="hv2-mitre-tag">T1059.007</span>
            </div>
            <div class="hv2-desc">Detects delivery of ISO/IMG container files via email attachment consistent with DarkPink APT initial access TTPs. Targets finance users with spoofed vendor emails carrying malicious disk images.</div>
            <div class="hv2-meta-row">
              <div class="hv2-meta-item">ðŸŒ Scope: <b>All SOCaaS Clients</b></div>
              <div class="hv2-meta-item">ðŸ‘¤ Hunter: <b>Raj Lingam</b></div>
              <div class="hv2-meta-item">âš™ Platform: <b>SPL (Splunk)</b></div>
            </div>
            <div class="hv2-stats-row">
              <div class="hv2-stat"><div class="hv2-stat-val">1.2M</div><div class="hv2-stat-lbl">Events Scanned</div></div>
              <div class="hv2-stat"><div class="hv2-stat-val" style="color:#f59e0b;">14</div><div class="hv2-stat-lbl">Suspects</div></div>
              <div class="hv2-stat"><div class="hv2-stat-val" style="color:#ef4444;">2</div><div class="hv2-stat-lbl">Confirmed Hits</div></div>
            </div>
            <div class="hv2-query">
              <div class="hv2-query-label">SPL Query Preview</div>
              <pre><span class="kw">index</span>=email <span class="kw">sourcetype</span>=exchange_logs <span class="op">attachment_name</span>=<span class="str">*.iso</span> <span class="op">OR</span> <span class="op">attachment_name</span>=<span class="str">*.img</span>
| <span class="kw">stats</span> count <span class="kw">by</span> src_user, attachment_name
| <span class="kw">where</span> count <span class="op">&gt;</span> <span class="str">3</span></pre>
            </div>
          </div>

          <!-- Hunt Card 2: Cobalt Strike Beacon -->
          <div class="hv2-card" style="border-color:rgba(245,158,11,0.2);">
            <div class="hv2-card-head">
              <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;flex:1;">
                <span class="hv2-priority hv2-priority-high">High</span>
                <span class="hv2-status hv2-status-running"><span class="hv2-status-dot"></span>RUNNING</span>
              </div>
              <div style="display:flex;gap:6px;">
                <button class="btn btn-secondary btn-xs" onclick="tipToast('ðŸ““','Opening hunt notebook...')">ðŸ““ Notebook</button>
                <button class="btn btn-xs" style="background:rgba(245,158,11,0.15);color:#f59e0b;border:1px solid rgba(245,158,11,0.3);" onclick="tipToast('â¸','Hunt paused')">â¸ Pause</button>
                <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ“Š','Opening findings view...')">ðŸ“Š View Findings</button>
                <button class="btn btn-xs btn-secondary" onclick="tipToast('âš™','Opening hunt editor...')">âš™ Edit</button>
              </div>
            </div>
            <div class="hv2-card-title">Cobalt Strike Beacon Pattern Detection</div>
            <div class="hv2-tags">
              <span class="hv2-mitre-tag">T1071.001</span>
              <span class="hv2-mitre-tag">T1573.001</span>
            </div>
            <div class="hv2-desc">Identifies periodic beacon-style C2 communication over HTTP/HTTPS with jittered ~60-second intervals characteristic of Cobalt Strike default malleable profiles. Focuses on consistent connection counts and timing patterns.</div>
            <div class="hv2-meta-row">
              <div class="hv2-meta-item">ðŸŒ Scope: <b>Dacta Global, SPMT</b></div>
              <div class="hv2-meta-item">ðŸ‘¤ Hunter: <b>John Lim</b></div>
              <div class="hv2-meta-item">âš™ Platform: <b>KQL (Sentinel)</b></div>
            </div>
            <div class="hv2-stats-row">
              <div class="hv2-stat"><div class="hv2-stat-val">847K</div><div class="hv2-stat-lbl">Events Scanned</div></div>
              <div class="hv2-stat"><div class="hv2-stat-val" style="color:#f59e0b;">3</div><div class="hv2-stat-lbl">Suspects</div></div>
              <div class="hv2-stat"><div class="hv2-stat-val" style="color:#10b981;">0</div><div class="hv2-stat-lbl">Confirmed Hits</div></div>
            </div>
            <div class="hv2-query">
              <div class="hv2-query-label">KQL Query Preview</div>
              <pre>DeviceNetworkEvents
| <span class="kw">where</span> RemotePort <span class="op">in</span> (<span class="str">80</span>,<span class="str">443</span>)
| <span class="kw">summarize</span> ConnCount=<span class="op">count</span>(), AvgInterval=<span class="op">avg</span>(TimeDelta) <span class="kw">by</span> RemoteIP
| <span class="kw">where</span> AvgInterval <span class="op">between</span> (<span class="str">55</span>..<span class="str">65</span>)</pre>
            </div>
          </div>

          <!-- Hunt Card 3: LOLBin Scheduled -->
          <div class="hv2-card" style="border-color:rgba(0,212,255,0.12);">
            <div class="hv2-card-head">
              <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;flex:1;">
                <span class="hv2-priority hv2-priority-medium">Medium</span>
                <span class="hv2-status hv2-status-scheduled">SCHEDULED</span>
                <span style="font-size:10px;color:var(--text-muted);">Starts 2026-03-03</span>
              </div>
              <div style="display:flex;gap:6px;">
                <button class="btn btn-secondary btn-xs" onclick="tipToast('ðŸ““','Opening hunt notebook...')">ðŸ““ Notebook</button>
                <button class="btn btn-xs btn-primary" onclick="tipToast('â–¶','Hunt queued for immediate execution')">â–¶ Run Now</button>
                <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ“Š','No findings yet â€” hunt not started')">ðŸ“Š View Findings</button>
                <button class="btn btn-xs btn-secondary" onclick="tipToast('âš™','Opening hunt editor...')">âš™ Edit</button>
              </div>
            </div>
            <div class="hv2-card-title">Living-off-the-Land Binary Abuse</div>
            <div class="hv2-tags">
              <span class="hv2-mitre-tag">T1218.011</span>
              <span class="hv2-mitre-tag">T1218.005</span>
            </div>
            <div class="hv2-desc">Hunts for abuse of native Windows binaries (LOLBins) â€” specifically mshta.exe, certutil.exe, and regsvr32.exe â€” used as proxy execution vehicles to evade application whitelisting and deliver payloads without dropping traditional malware.</div>
            <div class="hv2-meta-row">
              <div class="hv2-meta-item">ðŸŒ Scope: <b>All Clients</b></div>
              <div class="hv2-meta-item">ðŸ‘¤ Hunter: <b>Sarah Tan</b></div>
              <div class="hv2-meta-item">âš™ Platform: <b>SPL (Splunk)</b></div>
            </div>
            <div class="hv2-stats-row">
              <div class="hv2-stat"><div class="hv2-stat-val" style="color:var(--text-muted);">â€”</div><div class="hv2-stat-lbl">Events Scanned</div></div>
              <div class="hv2-stat"><div class="hv2-stat-val" style="color:var(--text-muted);">â€”</div><div class="hv2-stat-lbl">Suspects</div></div>
              <div class="hv2-stat"><div class="hv2-stat-val" style="color:var(--text-muted);">â€”</div><div class="hv2-stat-lbl">Confirmed Hits</div></div>
            </div>
            <div class="hv2-query">
              <div class="hv2-query-label">SPL Query Preview</div>
              <pre><span class="kw">index</span>=sysmon EventCode=<span class="str">1</span>
  (<span class="op">process_name</span>=<span class="str">mshta.exe</span> <span class="op">OR</span> <span class="op">process_name</span>=<span class="str">certutil.exe</span> <span class="op">OR</span> <span class="op">process_name</span>=<span class="str">regsvr32.exe</span>)
| <span class="kw">stats</span> count <span class="kw">by</span> dest, process_name, parent_process_name</pre>
            </div>
          </div>

        </div><!-- end hunt-panel-active -->

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 2: FINDINGS
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="hunt-tab-panel" id="hunt-panel-findings">

          <!-- Filter Bar -->
          <div class="hunt-filter-bar">
            <label>Hunt:</label>
            <select>
              <option>All Hunts</option>
              <option>DarkPink ISO Delivery</option>
              <option>Cobalt Strike Beacon</option>
              <option>LOLBin Abuse</option>
              <option>SMB Admin Share</option>
            </select>
            <label>Severity:</label>
            <select>
              <option>All Severities</option>
              <option>Critical</option>
              <option>High</option>
              <option>Medium</option>
              <option>Low</option>
            </select>
            <label>Date Range:</label>
            <input type="text" value="2026-02-01 â†’ 2026-02-28" style="width:170px;">
            <button class="btn btn-secondary btn-xs" onclick="tipToast('ðŸ”','Applying filters...')">Apply</button>
            <button class="btn btn-xs" style="background:transparent;border:1px solid rgba(255,255,255,0.08);color:var(--text-muted);" onclick="tipToast('â†º','Filters cleared')">Clear</button>
            <span style="margin-left:auto;font-size:11px;color:var(--text-muted);">6 findings shown</span>
          </div>

          <!-- Findings Table -->
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Date</th>
                  <th>Hunt Name</th>
                  <th>Finding Summary</th>
                  <th>Severity</th>
                  <th>Client</th>
                  <th>IOCs Found</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><span style="font-family:'IBM Plex Mono',monospace;font-size:11px;color:#00d4ff;">HF-0041</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">2026-02-28</td>
                  <td style="font-size:12px;color:var(--text-secondary);">DarkPink ISO Delivery</td>
                  <td style="font-size:11px;max-width:240px;">Suspicious ISO file delivered to 3 finance users via spoofed vendor email</td>
                  <td><span class="hf-sev-critical">Critical</span></td>
                  <td style="font-size:11px;">Dacta Global</td>
                  <td style="font-size:11px;font-family:'IBM Plex Mono',monospace;">2 IPs + 1 hash</td>
                  <td><span class="hf-status-escalated" style="font-size:11px;">Escalated â†’ DAC-18160</span></td>
                  <td>
                    <div style="display:flex;gap:4px;">
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ”','Opening finding HF-0041 details...')">ðŸ” View</button>
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ“¤','Exporting IOCs for HF-0041...')">ðŸ“¤ IOCs</button>
                    </div>
                  </td>
                </tr>
                <tr style="background:rgba(255,255,255,0.015);">
                  <td><span style="font-family:'IBM Plex Mono',monospace;font-size:11px;color:#00d4ff;">HF-0040</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">2026-02-27</td>
                  <td style="font-size:12px;color:var(--text-secondary);">DarkPink ISO Delivery</td>
                  <td style="font-size:11px;max-width:240px;">ISO dropper matched known DarkPink signature â€” auto-execution via mounted VHD</td>
                  <td><span class="hf-sev-high">High</span></td>
                  <td style="font-size:11px;">SPMT</td>
                  <td style="font-size:11px;font-family:'IBM Plex Mono',monospace;">1 hash + 1 domain</td>
                  <td><span class="hf-status-escalated" style="font-size:11px;">Escalated â†’ DAC-18157</span></td>
                  <td>
                    <div style="display:flex;gap:4px;">
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ”','Opening finding HF-0040 details...')">ðŸ” View</button>
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ“¤','Exporting IOCs for HF-0040...')">ðŸ“¤ IOCs</button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td><span style="font-family:'IBM Plex Mono',monospace;font-size:11px;color:#00d4ff;">HF-0039</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">2026-02-25</td>
                  <td style="font-size:12px;color:var(--text-secondary);">Cobalt Strike Beacon</td>
                  <td style="font-size:11px;max-width:240px;">Periodic C2 beacon at ~60s intervals to 185.220.101.34 from endpoint DGSRV-APP01</td>
                  <td><span class="hf-sev-critical">Critical</span></td>
                  <td style="font-size:11px;">Dacta Global</td>
                  <td style="font-size:11px;font-family:'IBM Plex Mono',monospace;">1 IP + 1 C2 profile</td>
                  <td><span class="hf-status-escalated" style="font-size:11px;">Escalated â†’ DAC-18155</span></td>
                  <td>
                    <div style="display:flex;gap:4px;">
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ”','Opening finding HF-0039 details...')">ðŸ” View</button>
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ“¤','Exporting IOCs for HF-0039...')">ðŸ“¤ IOCs</button>
                    </div>
                  </td>
                </tr>
                <tr style="background:rgba(255,255,255,0.015);">
                  <td><span style="font-family:'IBM Plex Mono',monospace;font-size:11px;color:#00d4ff;">HF-0038</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">2026-02-22</td>
                  <td style="font-size:12px;color:var(--text-secondary);">LOLBin Abuse</td>
                  <td style="font-size:11px;max-width:240px;">certutil.exe used to download encoded payload from external URL on 2 endpoints</td>
                  <td><span class="hf-sev-medium">Medium</span></td>
                  <td style="font-size:11px;">Global Advisor Co</td>
                  <td style="font-size:11px;font-family:'IBM Plex Mono',monospace;">1 URL + 1 hash</td>
                  <td><span class="hf-status-review" style="font-size:11px;">Under Review</span></td>
                  <td>
                    <div style="display:flex;gap:4px;">
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ”','Opening finding HF-0038 details...')">ðŸ” View</button>
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ“¤','Exporting IOCs for HF-0038...')">ðŸ“¤ IOCs</button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td><span style="font-family:'IBM Plex Mono',monospace;font-size:11px;color:#00d4ff;">HF-0037</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">2026-02-20</td>
                  <td style="font-size:12px;color:var(--text-secondary);">SMB Admin Share</td>
                  <td style="font-size:11px;max-width:240px;">Lateral movement via admin$ share from DGSRV-DC01 to 4 endpoints â€” PsExec pattern</td>
                  <td><span class="hf-sev-high">High</span></td>
                  <td style="font-size:11px;">Dacta Global</td>
                  <td style="font-size:11px;font-family:'IBM Plex Mono',monospace;">4 hostnames</td>
                  <td><span class="hf-status-graduated" style="font-size:11px;">Graduated â†’ RUL-0142</span></td>
                  <td>
                    <div style="display:flex;gap:4px;">
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ”','Opening finding HF-0037 details...')">ðŸ” View</button>
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ“¤','Exporting IOCs for HF-0037...')">ðŸ“¤ IOCs</button>
                    </div>
                  </td>
                </tr>
                <tr style="background:rgba(255,255,255,0.015);">
                  <td><span style="font-family:'IBM Plex Mono',monospace;font-size:11px;color:#64748b;">HF-0036</span></td>
                  <td style="font-size:11px;color:var(--text-muted);">2026-02-18</td>
                  <td style="font-size:12px;color:var(--text-secondary);">Beacon Detection</td>
                  <td style="font-size:11px;max-width:240px;">False positive â€” internal monitoring tool mimics beacon interval pattern</td>
                  <td><span class="hf-sev-low">Low</span></td>
                  <td style="font-size:11px;">SPMT</td>
                  <td style="font-size:11px;font-family:'IBM Plex Mono',monospace;color:var(--text-muted);">â€”</td>
                  <td><span class="hf-status-closed" style="font-size:11px;">Closed (FP)</span></td>
                  <td>
                    <div style="display:flex;gap:4px;">
                      <button class="btn btn-xs btn-secondary" onclick="tipToast('ðŸ”','Opening finding HF-0036 details...')">ðŸ” View</button>
                      <button class="btn btn-xs btn-secondary" style="opacity:0.4;cursor:not-allowed;">ðŸ“¤ IOCs</button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

        </div><!-- end hunt-panel-findings -->

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 3: GRADUATION PIPELINE
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="hunt-tab-panel" id="hunt-panel-graduation">

          <!-- Graduation Criteria Info Box -->
          <div class="grad-criteria-box">
            <h4>ðŸŽ“ Hunt-to-Rule Graduation Criteria</h4>
            <p style="font-size:12px;color:var(--text-secondary);margin:0 0 10px;">Active hunt hypotheses are promoted to permanent detection rules when they meet <b style="color:var(--text-primary);">ALL</b> of the following:</p>
            <ol>
              <li><b>Minimum True Positives:</b> â‰¥ 3 confirmed true positives across different client environments</li>
              <li><b>False Positive Rate:</b> &lt; 5% over a 30-day observation window</li>
              <li><b>MITRE Mapping:</b> Technique must be mapped to a validated ATT&amp;CK technique</li>
              <li><b>Query Stability:</b> Hunt query must execute successfully for 14+ consecutive days without modification</li>
              <li><b>Peer Review:</b> Reviewed and approved by a Senior Hunt Lead</li>
              <li><b>Client Coverage:</b> Successfully tested against â‰¥ 2 client environments (SOCaaS)</li>
            </ol>
            <div class="grad-criteria-note">Rules that graduate are auto-deployed to all applicable client SIEMs via the SIEM Push pipeline.</div>
          </div>

          <!-- Kanban Board -->
          <div class="kanban-board">

            <!-- Column 1: Candidate -->
            <div class="kanban-col">
              <div class="kanban-col-header" style="color:#94a3b8;">
                <span>Candidate</span>
                <span style="font-size:10px;background:rgba(100,116,139,0.15);padding:2px 7px;border-radius:10px;">1</span>
              </div>
              <div class="kanban-col-body">
                <div class="kanban-card">
                  <div class="kanban-card-title">LOLBin Abuse Hunt</div>
                  <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:4px;">
                    <span class="hv2-mitre-tag">T1218.011</span>
                    <span class="hv2-mitre-tag">T1218.005</span>
                  </div>
                  <div class="kanban-progress-wrap">
                    <div class="kanban-progress-label">
                      <span>Criteria met</span>
                      <span style="color:var(--text-primary);font-weight:600;">3 / 6</span>
                    </div>
                    <div class="kanban-progress-bar">
                      <div class="kanban-progress-fill" style="width:50%;"></div>
                    </div>
                  </div>
                  <div class="kanban-blocker">âš  Needs more true positives (currently 1 / 3 required)</div>
                  <div style="margin-top:8px;">
                    <button class="btn btn-xs btn-secondary" style="width:100%;" onclick="tipToast('ðŸ”','Opening LOLBin hunt details...')">View Hunt</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Column 2: Under Review -->
            <div class="kanban-col">
              <div class="kanban-col-header" style="color:#f59e0b;">
                <span>Under Review</span>
                <span style="font-size:10px;background:rgba(245,158,11,0.12);padding:2px 7px;border-radius:10px;">1</span>
              </div>
              <div class="kanban-col-body">
                <div class="kanban-card" style="border-color:rgba(245,158,11,0.15);">
                  <div class="kanban-card-title">Cobalt Strike Beacon Pattern</div>
                  <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:4px;">
                    <span class="hv2-mitre-tag">T1071.001</span>
                    <span class="hv2-mitre-tag">T1573.001</span>
                  </div>
                  <div class="kanban-progress-wrap">
                    <div class="kanban-progress-label">
                      <span>Criteria met</span>
                      <span style="color:var(--text-primary);font-weight:600;">5 / 6</span>
                    </div>
                    <div class="kanban-progress-bar">
                      <div class="kanban-progress-fill" style="width:83%;"></div>
                    </div>
                  </div>
                  <div class="kanban-blocker">â³ Peer review pending â€” assigned to John Lim (Senior Hunt Lead)</div>
                  <div style="margin-top:8px;">
                    <button class="btn btn-xs btn-secondary" style="width:100%;" onclick="tipToast('ðŸ“‹','Opening peer review request...')">Review Request</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Column 3: Approved -->
            <div class="kanban-col">
              <div class="kanban-col-header" style="color:#00d4ff;">
                <span>Approved</span>
                <span style="font-size:10px;background:rgba(0,212,255,0.1);padding:2px 7px;border-radius:10px;">1</span>
              </div>
              <div class="kanban-col-body">
                <div class="kanban-card" style="border-color:rgba(0,212,255,0.15);">
                  <div class="kanban-card-title">DarkPink ISO Delivery Detection</div>
                  <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:4px;">
                    <span class="hv2-mitre-tag">T1566.001</span>
                    <span class="hv2-mitre-tag">T1204.002</span>
                  </div>
                  <div class="kanban-progress-wrap">
                    <div class="kanban-progress-label">
                      <span>Criteria met</span>
                      <span style="color:#10b981;font-weight:600;">6 / 6 âœ“</span>
                    </div>
                    <div class="kanban-progress-bar">
                      <div class="kanban-progress-fill full" style="width:100%;"></div>
                    </div>
                  </div>
                  <div class="kanban-graduated-tag">âœ… Graduating to RUL-0148 â€” awaiting SIEM Push</div>
                  <div style="margin-top:8px;">
                    <button class="btn btn-xs btn-primary" style="width:100%;" onclick="tipToast('ðŸš€','SIEM push initiated â€” RUL-0148 deploying to all client SIEMs...')">ðŸš€ Push to SIEM</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Column 4: Graduated -->
            <div class="kanban-col">
              <div class="kanban-col-header" style="color:#10b981;">
                <span>Graduated</span>
                <span style="font-size:10px;background:rgba(16,185,129,0.12);padding:2px 7px;border-radius:10px;">2</span>
              </div>
              <div class="kanban-col-body">
                <div class="kanban-card" style="border-color:rgba(16,185,129,0.15);">
                  <div class="kanban-card-title">SMB Admin Share â†’ RUL-0142</div>
                  <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:4px;">
                    <span class="hv2-mitre-tag">T1021.002</span>
                  </div>
                  <div class="kanban-graduated-tag">âœ… Graduated 2026-01-15 â€” deployed to all SOCaaS SIEMs</div>
                  <div style="margin-top:8px;">
                    <button class="btn btn-xs btn-secondary" style="width:100%;" onclick="tipToast('ðŸ“„','Opening rule RUL-0142...')">View Rule</button>
                  </div>
                </div>
                <div class="kanban-card" style="border-color:rgba(16,185,129,0.15);">
                  <div class="kanban-card-title">LSASS Memory Access â†’ RUL-0138</div>
                  <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:4px;">
                    <span class="hv2-mitre-tag">T1003.001</span>
                  </div>
                  <div class="kanban-graduated-tag">âœ… Graduated 2025-12-08 â€” deployed to all SOCaaS SIEMs</div>
                  <div style="margin-top:8px;">
                    <button class="btn btn-xs btn-secondary" style="width:100%;" onclick="tipToast('ðŸ“„','Opening rule RUL-0138...')">View Rule</button>
                  </div>
                </div>
              </div>
            </div>

          </div><!-- end kanban-board -->

        </div><!-- end hunt-panel-graduation -->

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TAB 4: PLAYBOOKS
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="hunt-tab-panel" id="hunt-panel-playbooks">

          <div style="margin-bottom:14px;display:flex;align-items:center;justify-content:space-between;">
            <div style="font-size:12px;color:var(--text-muted);">Pre-built hunt playbooks with structured methodology and step-by-step guidance.</div>
            <button class="btn btn-secondary btn-sm" onclick="tipToast('âž•','Create Playbook dialog opening...')">+ New Playbook</button>
          </div>

          <div class="playbook-grid">

            <!-- Playbook 1: APT Initial Access -->
            <div class="playbook-card">
              <div class="playbook-card-head">
                <div class="playbook-title">APT Initial Access Hunt</div>
                <span class="playbook-difficulty pb-diff-hard">Advanced</span>
              </div>
              <div class="playbook-focus">Focus: Spearphishing, drive-by compromise, weaponized document delivery</div>
              <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:10px;">
                <span class="hv2-mitre-tag">T1566.001</span>
                <span class="hv2-mitre-tag">T1189</span>
                <span class="hv2-mitre-tag">T1204.002</span>
                <span class="hv2-mitre-tag">T1059.007</span>
              </div>
              <ol class="playbook-steps">
                <li>Email log analysis â€” filter attachment types &amp; sender reputation</li>
                <li>Attachment sandboxing â€” submit to detonation environment</li>
                <li>DNS anomaly correlation â€” NX domains, DGA patterns</li>
                <li>Endpoint process tree review â€” parent/child execution chains</li>
              </ol>
              <div class="playbook-footer">
                <div>
                  <div class="playbook-meta-txt">â± Estimated: 4â€“6 hours</div>
                  <div class="playbook-meta-txt">ðŸ• Last run: 2026-02-15</div>
                </div>
                <div class="playbook-actions">
                  <button class="btn btn-secondary btn-xs" onclick="tipToast('ðŸ“–','Opening full playbook for APT Initial Access...')">View Playbook</button>
                  <button class="btn btn-primary btn-xs" onclick="tipToast('ðŸŽ¯','Launching APT Initial Access Hunt from playbook...')">Launch Hunt</button>
                </div>
              </div>
            </div>

            <!-- Playbook 2: Lateral Movement -->
            <div class="playbook-card">
              <div class="playbook-card-head">
                <div class="playbook-title">Lateral Movement Detection</div>
                <span class="playbook-difficulty pb-diff-hard">Advanced</span>
              </div>
              <div class="playbook-focus">Focus: Pass-the-hash, SMB abuse, RDP pivoting, token impersonation</div>
              <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:10px;">
                <span class="hv2-mitre-tag">T1550.002</span>
                <span class="hv2-mitre-tag">T1021.002</span>
                <span class="hv2-mitre-tag">T1021.001</span>
                <span class="hv2-mitre-tag">T1134</span>
              </div>
              <ol class="playbook-steps">
                <li>Auth log anomaly detection â€” failed logons, NTLM vs Kerberos ratio</li>
                <li>Admin share enumeration â€” net use / admin$ access patterns</li>
                <li>Session correlation â€” source-to-destination hop chains</li>
                <li>Kerberos ticket analysis â€” anomalous TGT/TGS requests</li>
              </ol>
              <div class="playbook-footer">
                <div>
                  <div class="playbook-meta-txt">â± Estimated: 6â€“8 hours</div>
                  <div class="playbook-meta-txt">ðŸ• Last run: 2026-02-20</div>
                </div>
                <div class="playbook-actions">
                  <button class="btn btn-secondary btn-xs" onclick="tipToast('ðŸ“–','Opening full Lateral Movement playbook...')">View Playbook</button>
                  <button class="btn btn-primary btn-xs" onclick="tipToast('ðŸŽ¯','Launching Lateral Movement Hunt from playbook...')">Launch Hunt</button>
                </div>
              </div>
            </div>

            <!-- Playbook 3: C2 Infrastructure -->
            <div class="playbook-card">
              <div class="playbook-card-head">
                <div class="playbook-title">C2 Infrastructure Hunt</div>
                <span class="playbook-difficulty pb-diff-medium">Intermediate</span>
              </div>
              <div class="playbook-focus">Focus: Beacon patterns, DNS tunneling, domain fronting, JA3 fingerprinting</div>
              <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:10px;">
                <span class="hv2-mitre-tag">T1071.001</span>
                <span class="hv2-mitre-tag">T1573.001</span>
                <span class="hv2-mitre-tag">T1071.004</span>
                <span class="hv2-mitre-tag">T1090.004</span>
              </div>
              <ol class="playbook-steps">
                <li>Network traffic baseline â€” establish normal outbound connection patterns</li>
                <li>Beacon interval analysis â€” variance scoring on connection periodicity</li>
                <li>DNS entropy scoring â€” detect algorithmically generated domains</li>
                <li>JA3/JA3S fingerprinting â€” TLS client/server fingerprint matching</li>
              </ol>
              <div class="playbook-footer">
                <div>
                  <div class="playbook-meta-txt">â± Estimated: 3â€“5 hours</div>
                  <div class="playbook-meta-txt">ðŸ• Last run: 2026-02-28</div>
                </div>
                <div class="playbook-actions">
                  <button class="btn btn-secondary btn-xs" onclick="tipToast('ðŸ“–','Opening full C2 Infrastructure playbook...')">View Playbook</button>
                  <button class="btn btn-primary btn-xs" onclick="tipToast('ðŸŽ¯','Launching C2 Infrastructure Hunt from playbook...')">Launch Hunt</button>
                </div>
              </div>
            </div>

            <!-- Playbook 4: Insider Threat -->
            <div class="playbook-card">
              <div class="playbook-card-head">
                <div class="playbook-title">Insider Threat Indicator Hunt</div>
                <span class="playbook-difficulty pb-diff-hard">Advanced</span>
              </div>
              <div class="playbook-focus">Focus: Data exfiltration, privilege abuse, anomalous access, off-hours activity</div>
              <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:10px;">
                <span class="hv2-mitre-tag">T1048</span>
                <span class="hv2-mitre-tag">T1078</span>
                <span class="hv2-mitre-tag">T1052.001</span>
                <span class="hv2-mitre-tag">T1530</span>
              </div>
              <ol class="playbook-steps">
                <li>DLP alert triage â€” high-volume or off-pattern data movement</li>
                <li>Off-hours access patterns â€” login/file access outside business hours</li>
                <li>USB / cloud upload analysis â€” removable media and SaaS upload spikes</li>
                <li>Badge access correlation â€” physical vs logical access timeline mismatch</li>
              </ol>
              <div class="playbook-footer">
                <div>
                  <div class="playbook-meta-txt">â± Estimated: 8â€“10 hours</div>
                  <div class="playbook-meta-txt">ðŸ• Last run: 2026-01-30</div>
                </div>
                <div class="playbook-actions">
                  <button class="btn btn-secondary btn-xs" onclick="tipToast('ðŸ“–','Opening full Insider Threat playbook...')">View Playbook</button>
                  <button class="btn btn-primary btn-xs" onclick="tipToast('ðŸŽ¯','Launching Insider Threat Hunt from playbook...')">Launch Hunt</button>
                </div>
              </div>
            </div>

          </div><!-- end playbook-grid -->

        </div><!-- end hunt-panel-playbooks -->

        <script>
          function switchHuntTab(tabId) {
            document.querySelectorAll('.hunt-tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.hunt-tab-panel').forEach(p => { p.style.display = 'none'; });
            document.getElementById('hunt-panel-' + tabId).style.display = 'block';
            document.querySelector('[data-hunttab="' + tabId + '"]').classList.add('active');
          }
        </script>

      </div><!-- end hunting -->


      <!-- =====================================================
           PAGE 11: THREAT INTELLIGENCE
           ===================================================== -->
<div class="page" id="page-intel">

<!-- ============================================================
     DACTA MCC â€” Threat Intelligence Page (inner content only)
     Everything INSIDE <div class="page" id="page-intel">
     ============================================================ -->

<style>
/* ============================================================
   TIP (Threat Intelligence Page) â€” Scoped Design System
   All classes prefixed with tip- to avoid conflicts
   ============================================================ */

/* ---- Reset & Base ---- */
.tip-root * { box-sizing: border-box; }

.tip-root {
  width: 100%;
  min-height: 100%;
  font-family: 'IBM Plex Sans', sans-serif;
  color: #e8edf5;
  background: transparent;
  line-height: 1.5;
}

/* ---- Scrollbars ---- */
.tip-root ::-webkit-scrollbar { width: 5px; height: 5px; }
.tip-root ::-webkit-scrollbar-track { background: transparent; }
.tip-root ::-webkit-scrollbar-thumb { background: rgba(0,212,255,0.2); border-radius: 3px; }
.tip-root ::-webkit-scrollbar-thumb:hover { background: rgba(0,212,255,0.4); }
* { scrollbar-width: thin; scrollbar-color: rgba(0,212,255,0.2) transparent; }

/* ---- Top Bar ---- */
.tip-topbar {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 12px 20px;
  background: rgba(8,13,26,0.9);
  border-bottom: 1px solid rgba(255,255,255,0.08);
  backdrop-filter: blur(20px);
  flex-wrap: wrap;
  position: sticky;
  top: 0;
  z-index: 100;
}

.tip-brand-badge {
  display: flex;
  align-items: center;
  gap: 8px;
  font-family: 'Sora', sans-serif;
  font-size: 13px;
  font-weight: 700;
  color: #00d4ff;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  white-space: nowrap;
}

.tip-live-dot {
  width: 8px;
  height: 8px;
  background: #10b981;
  border-radius: 50%;
  box-shadow: 0 0 0 0 rgba(16,185,129,0.4);
  animation: tip-pulse-green 2s infinite;
  flex-shrink: 0;
}

.tip-live-dot.amber { background: #f59e0b; box-shadow: 0 0 0 0 rgba(245,158,11,0.4); animation: tip-pulse-amber 2s infinite; }
.tip-live-dot.red { background: #ff6b6b; box-shadow: 0 0 0 0 rgba(255,107,107,0.4); animation: tip-pulse-red 2s infinite; }
.tip-live-dot.orange { background: #f97316; box-shadow: 0 0 0 0 rgba(249,115,22,0.4); animation: tip-pulse-orange 2s infinite; }
.tip-live-dot.yellow { background: #eab308; box-shadow: 0 0 0 0 rgba(234,179,8,0.4); animation: tip-pulse-yellow 2s infinite; }

@keyframes tip-pulse-green {
  0% { box-shadow: 0 0 0 0 rgba(16,185,129,0.5); }
  70% { box-shadow: 0 0 0 6px rgba(16,185,129,0); }
  100% { box-shadow: 0 0 0 0 rgba(16,185,129,0); }
}
@keyframes tip-pulse-amber {
  0% { box-shadow: 0 0 0 0 rgba(245,158,11,0.5); }
  70% { box-shadow: 0 0 0 6px rgba(245,158,11,0); }
  100% { box-shadow: 0 0 0 0 rgba(245,158,11,0); }
}
@keyframes tip-pulse-red {
  0% { box-shadow: 0 0 0 0 rgba(255,107,107,0.5); }
  70% { box-shadow: 0 0 0 6px rgba(255,107,107,0); }
  100% { box-shadow: 0 0 0 0 rgba(255,107,107,0); }
}
@keyframes tip-pulse-orange {
  0% { box-shadow: 0 0 0 0 rgba(249,115,22,0.5); }
  70% { box-shadow: 0 0 0 6px rgba(249,115,22,0); }
  100% { box-shadow: 0 0 0 0 rgba(249,115,22,0); }
}
@keyframes tip-pulse-yellow {
  0% { box-shadow: 0 0 0 0 rgba(234,179,8,0.5); }
  70% { box-shadow: 0 0 0 6px rgba(234,179,8,0); }
  100% { box-shadow: 0 0 0 0 rgba(234,179,8,0); }
}

.tip-divider-v {
  width: 1px;
  height: 28px;
  background: rgba(255,255,255,0.1);
  flex-shrink: 0;
}

/* Client Selector */
.tip-client-select-wrap { position: relative; }
.tip-client-select {
  appearance: none;
  background: rgba(15,23,42,0.8);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: #e8edf5;
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 13px;
  padding: 6px 28px 6px 10px;
  cursor: pointer;
  outline: none;
  transition: border-color 0.15s;
  min-width: 160px;
}
.tip-client-select:hover { border-color: rgba(0,212,255,0.4); }
.tip-client-select:focus { border-color: #00d4ff; box-shadow: 0 0 0 2px rgba(0,212,255,0.1); }
.tip-client-select-icon {
  position: absolute; right: 8px; top: 50%; transform: translateY(-50%);
  color: #64748b; pointer-events: none; font-size: 10px;
}

/* Context Tags */
.tip-ctx-tags { display: flex; gap: 6px; align-items: center; flex-wrap: wrap; }
.tip-tag {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  padding: 3px 8px;
  border-radius: 4px;
  border: 1px solid;
  white-space: nowrap;
}
.tip-tag-sector { background: rgba(0,212,255,0.08); border-color: rgba(0,212,255,0.2); color: #00d4ff; }
.tip-tag-region { background: rgba(148,163,184,0.08); border-color: rgba(148,163,184,0.2); color: #94a3b8; }
.tip-tag-critical { background: rgba(255,107,107,0.12); border-color: rgba(255,107,107,0.3); color: #ff6b6b; }
.tip-tag-high { background: rgba(249,115,22,0.12); border-color: rgba(249,115,22,0.3); color: #f97316; }
.tip-tag-medium { background: rgba(234,179,8,0.12); border-color: rgba(234,179,8,0.3); color: #eab308; }
.tip-tag-low { background: rgba(16,185,129,0.12); border-color: rgba(16,185,129,0.3); color: #10b981; }

/* Live Counters */
.tip-counters { display: flex; gap: 16px; align-items: center; margin-left: auto; }
.tip-counter { display: flex; flex-direction: column; align-items: flex-end; }
.tip-counter-val {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 14px;
  font-weight: 600;
  color: #e8edf5;
  line-height: 1;
}
.tip-counter-label { font-size: 10px; color: #64748b; text-transform: uppercase; letter-spacing: 0.05em; margin-top: 1px; }

/* DACTA TIP Health */
.tip-octi-health {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 5px 10px;
  background: rgba(16,185,129,0.08);
  border: 1px solid rgba(16,185,129,0.2);
  border-radius: 6px;
  font-size: 11px;
  font-weight: 600;
  color: #10b981;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  white-space: nowrap;
}

/* ---- Tab Navigation ---- */
.tip-tabnav {
  display: flex;
  align-items: center;
  gap: 0;
  padding: 0 20px;
  background: rgba(8,13,26,0.7);
  border-bottom: 1px solid rgba(255,255,255,0.06);
  backdrop-filter: blur(20px);
  overflow-x: auto;
  position: sticky;
  top: 57px;
  z-index: 99;
}

.tip-tab-btn {
  display: flex;
  align-items: center;
  gap: 7px;
  padding: 12px 18px;
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 13px;
  font-weight: 500;
  color: #64748b;
  background: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  white-space: nowrap;
  transition: color 0.15s, border-color 0.15s;
  outline: none;
  position: relative;
  bottom: -1px;
}
.tip-tab-btn:hover { color: #94a3b8; }
.tip-tab-btn.active {
  color: #00d4ff;
  border-bottom-color: #00d4ff;
  font-weight: 600;
}
.tip-tab-icon { font-size: 13px; opacity: 0.8; }

.tip-tabnav-search {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 0;
  position: relative;
}
.tip-search-input {
  background: rgba(15,23,42,0.8);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: #e8edf5;
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 12px;
  padding: 6px 32px 6px 12px;
  width: 200px;
  outline: none;
  transition: border-color 0.15s, width 0.2s;
}
.tip-search-input:focus {
  border-color: rgba(0,212,255,0.4);
  width: 280px;
  box-shadow: 0 0 0 2px rgba(0,212,255,0.08);
}
.tip-search-input::placeholder { color: #64748b; }
.tip-search-icon {
  position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
  color: #64748b; font-size: 12px; pointer-events: none;
}

/* Search results overlay */
.tip-search-overlay {
  position: absolute;
  top: calc(100% + 4px);
  right: 0;
  width: 480px;
  max-height: 500px;
  overflow-y: auto;
  background: rgba(10,18,35,0.98);
  border: 1px solid rgba(0,212,255,0.2);
  border-radius: 10px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.6);
  z-index: 200;
  display: none;
  backdrop-filter: blur(20px);
}
.tip-search-overlay.open { display: block; }
.tip-search-overlay-header {
  padding: 10px 14px;
  border-bottom: 1px solid rgba(255,255,255,0.06);
  font-size: 11px;
  color: #64748b;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}
.tip-search-result-card {
  padding: 12px 14px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  transition: background 0.1s;
}
.tip-search-result-card:last-child { border-bottom: none; }
.tip-search-result-card:hover { background: rgba(255,255,255,0.03); }
.tip-src-top { display: flex; align-items: center; gap: 8px; margin-bottom: 4px; }
.tip-src-meta { display: flex; gap: 12px; margin-top: 6px; flex-wrap: wrap; }
.tip-src-meta-item { font-size: 11px; color: #64748b; }
.tip-src-meta-item span { color: #94a3b8; }
.tip-src-actions { display: flex; gap: 6px; margin-top: 8px; }

/* ---- Tab Content Area ---- */
.tip-content { padding: 20px; }
.tip-tab-panel { display: none; }
.tip-tab-panel.active { display: block; }

/* ---- Panel / Card styles ---- */
.tip-panel {
  background: rgba(15,23,42,0.6);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 12px;
  backdrop-filter: blur(20px);
  overflow: hidden;
}
.tip-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 16px;
  border-bottom: 1px solid rgba(255,255,255,0.06);
  flex-wrap: wrap;
  gap: 8px;
}
.tip-panel-title {
  font-family: 'Sora', sans-serif;
  font-size: 13px;
  font-weight: 600;
  color: #e8edf5;
  letter-spacing: 0.02em;
  display: flex;
  align-items: center;
  gap: 8px;
}
.tip-panel-title-icon { color: #00d4ff; }
.tip-panel-body { padding: 14px 16px; }
.tip-panel-scroll { max-height: 520px; overflow-y: auto; padding: 10px 14px; }

/* ---- Grid Layouts ---- */
.tip-ops-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}
@media (max-width: 900px) { .tip-ops-grid { grid-template-columns: 1fr; } }

/* ---- Buttons ---- */
.tip-btn {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 6px 14px;
  border-radius: 6px;
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  border: 1px solid;
  transition: all 0.15s;
  outline: none;
  white-space: nowrap;
  letter-spacing: 0.02em;
}
.tip-btn-primary {
  background: rgba(0,212,255,0.12);
  border-color: rgba(0,212,255,0.3);
  color: #00d4ff;
}
.tip-btn-primary:hover { background: rgba(0,212,255,0.2); border-color: #00d4ff; }

.tip-btn-secondary {
  background: rgba(255,255,255,0.04);
  border-color: rgba(255,255,255,0.1);
  color: #94a3b8;
}
.tip-btn-secondary:hover { background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.2); color: #e8edf5; }

.tip-btn-success {
  background: rgba(16,185,129,0.1);
  border-color: rgba(16,185,129,0.3);
  color: #10b981;
}
.tip-btn-success:hover { background: rgba(16,185,129,0.2); border-color: #10b981; }

.tip-btn-danger {
  background: rgba(255,107,107,0.1);
  border-color: rgba(255,107,107,0.3);
  color: #ff6b6b;
}
.tip-btn-danger:hover { background: rgba(255,107,107,0.2); border-color: #ff6b6b; }

.tip-btn-warning {
  background: rgba(245,158,11,0.1);
  border-color: rgba(245,158,11,0.3);
  color: #f59e0b;
}
.tip-btn-warning:hover { background: rgba(245,158,11,0.2); border-color: #f59e0b; }

.tip-btn-sm { padding: 4px 10px; font-size: 11px; }
.tip-btn-xs { padding: 3px 8px; font-size: 10px; }

/* ---- IOC Type Badges ---- */
.tip-ioc-badge {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 4px;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  white-space: nowrap;
  flex-shrink: 0;
}
.tip-ioc-ip { background: rgba(249,115,22,0.15); border: 1px solid rgba(249,115,22,0.3); color: #f97316; }
.tip-ioc-domain { background: rgba(0,212,255,0.12); border: 1px solid rgba(0,212,255,0.25); color: #00d4ff; }
.tip-ioc-hash { background: rgba(148,163,184,0.1); border: 1px solid rgba(148,163,184,0.2); color: #94a3b8; }
.tip-ioc-url { background: rgba(234,179,8,0.12); border: 1px solid rgba(234,179,8,0.25); color: #eab308; }

/* ---- IOC Cards ---- */
.tip-ioc-card {
  background: rgba(30,41,59,0.5);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  margin-bottom: 8px;
  transition: border-color 0.15s, opacity 0.3s;
  overflow: hidden;
}
.tip-ioc-card:hover { border-color: rgba(255,255,255,0.12); }
.tip-ioc-card.approved { border-color: rgba(16,185,129,0.3); opacity: 0.7; }
.tip-ioc-card.rejected { border-color: rgba(255,107,107,0.2); opacity: 0.4; }
.tip-ioc-card-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  cursor: pointer;
  flex-wrap: wrap;
}
.tip-ioc-value {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 12px;
  color: #e8edf5;
  flex: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.tip-ioc-actor { font-size: 11px; color: #94a3b8; white-space: nowrap; }

.tip-vt-score {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 11px;
  padding: 2px 7px;
  border-radius: 4px;
  white-space: nowrap;
}
.tip-vt-red { background: rgba(255,107,107,0.15); color: #ff6b6b; border: 1px solid rgba(255,107,107,0.25); }
.tip-vt-orange { background: rgba(245,158,11,0.15); color: #f59e0b; border: 1px solid rgba(245,158,11,0.25); }
.tip-vt-green { background: rgba(16,185,129,0.12); color: #10b981; border: 1px solid rgba(16,185,129,0.2); }

.tip-gn-badge {
  font-size: 10px;
  padding: 2px 7px;
  border-radius: 4px;
  white-space: nowrap;
}
.tip-gn-malicious { background: rgba(255,107,107,0.12); color: #ff6b6b; border: 1px solid rgba(255,107,107,0.2); }
.tip-gn-noise { background: rgba(148,163,184,0.1); color: #94a3b8; border: 1px solid rgba(148,163,184,0.15); }
.tip-gn-unknown { background: rgba(100,116,139,0.1); color: #64748b; border: 1px solid rgba(100,116,139,0.15); }
.tip-gn-na { background: rgba(100,116,139,0.08); color: #64748b; border: 1px solid rgba(100,116,139,0.1); }

/* Confidence bar */
.tip-conf-wrap { display: flex; align-items: center; gap: 8px; min-width: 120px; }
.tip-conf-bar-bg {
  flex: 1;
  height: 4px;
  background: rgba(255,255,255,0.06);
  border-radius: 2px;
  overflow: hidden;
}
.tip-conf-bar-fill {
  height: 100%;
  border-radius: 2px;
  transition: width 0.4s;
}
.tip-conf-high { background: linear-gradient(90deg, #10b981, #00d4ff); }
.tip-conf-med { background: linear-gradient(90deg, #f59e0b, #f97316); }
.tip-conf-low { background: #ff6b6b; }
.tip-conf-val { font-family: 'IBM Plex Mono', monospace; font-size: 11px; color: #94a3b8; white-space: nowrap; }

/* IOC card actions */
.tip-ioc-actions { display: flex; gap: 6px; align-items: center; flex-shrink: 0; }

/* Expanded content */
.tip-ioc-expanded {
  padding: 12px;
  border-top: 1px solid rgba(255,255,255,0.05);
  background: rgba(8,13,26,0.4);
  display: none;
}
.tip-ioc-expanded.open { display: block; }
.tip-ioc-meta-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 10px; margin-bottom: 12px; }
.tip-meta-item label { font-size: 10px; color: #64748b; text-transform: uppercase; letter-spacing: 0.06em; display: block; margin-bottom: 2px; }
.tip-meta-item span { font-size: 12px; color: #94a3b8; font-family: 'IBM Plex Mono', monospace; }
.tip-siem-select-label { font-size: 11px; color: #64748b; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em; }
.tip-siem-checkboxes { display: flex; gap: 10px; flex-wrap: wrap; }
.tip-siem-check { display: flex; align-items: center; gap: 5px; font-size: 11px; color: #94a3b8; cursor: pointer; }
.tip-siem-check input[type=checkbox] { accent-color: #00d4ff; }

/* ---- Sightings ---- */
.tip-sighting-form {
  background: rgba(8,13,26,0.5);
  border: 1px solid rgba(0,212,255,0.15);
  border-radius: 8px;
  padding: 14px;
  margin-bottom: 12px;
  display: none;
}
.tip-sighting-form.open { display: block; }
.tip-form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
.tip-form-group { display: flex; flex-direction: column; gap: 4px; }
.tip-form-group label { font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.05em; }
.tip-form-input, .tip-form-select {
  background: rgba(15,23,42,0.8);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: #e8edf5;
  font-family: 'IBM Plex Sans', sans-serif;
  font-size: 12px;
  padding: 7px 10px;
  outline: none;
  transition: border-color 0.15s;
}
.tip-form-input:focus, .tip-form-select:focus { border-color: rgba(0,212,255,0.4); }
.tip-form-input::placeholder { color: #64748b; }

.tip-sighting-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 0;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  flex-wrap: wrap;
}
.tip-sighting-row:last-child { border-bottom: none; }
.tip-sight-ioc { font-family: 'IBM Plex Mono', monospace; font-size: 12px; color: #e8edf5; flex: 1; }
.tip-sight-client { font-size: 11px; color: #64748b; }
.tip-sight-analyst { font-size: 11px; color: #64748b; }
.tip-sight-time { font-size: 10px; color: #64748b; white-space: nowrap; margin-left: auto; }
.tip-sight-tp { background: rgba(16,185,129,0.12); border: 1px solid rgba(16,185,129,0.25); color: #10b981; font-size: 10px; padding: 2px 7px; border-radius: 4px; white-space: nowrap; }
.tip-sight-fp { background: rgba(255,107,107,0.12); border: 1px solid rgba(255,107,107,0.25); color: #ff6b6b; font-size: 10px; padding: 2px 7px; border-radius: 4px; white-space: nowrap; }
.tip-footer-note { font-size: 10px; color: #64748b; margin-top: 10px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.04); }

/* ---- Hunt Hypotheses ---- */
.tip-hunt-card {
  background: rgba(30,41,59,0.4);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  padding: 12px;
  margin-bottom: 8px;
  transition: border-color 0.15s;
}
.tip-hunt-card:hover { border-color: rgba(0,212,255,0.2); }
.tip-hunt-top { display: flex; align-items: flex-start; gap: 10px; margin-bottom: 8px; flex-wrap: wrap; }
.tip-hunt-technique { font-family: 'IBM Plex Mono', monospace; font-size: 11px; color: #00d4ff; }
.tip-hunt-name { font-size: 13px; font-weight: 600; color: #e8edf5; flex: 1; }
.tip-hunt-meta { display: flex; gap: 12px; margin-bottom: 8px; flex-wrap: wrap; }
.tip-hunt-meta-item { font-size: 11px; color: #64748b; }
.tip-hunt-meta-item span { color: #94a3b8; }
.tip-hunt-query {
  background: rgba(8,13,26,0.7);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 6px;
  padding: 10px 12px;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 11px;
  color: #94a3b8;
  overflow-x: auto;
  margin-bottom: 10px;
  white-space: pre;
  line-height: 1.6;
}
.tip-hunt-query .kw { color: #00d4ff; }
.tip-hunt-query .str { color: #10b981; }
.tip-hunt-query .op { color: #f59e0b; }
.tip-hunt-footer { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px; }
.tip-priority-badge { font-size: 10px; font-weight: 700; padding: 3px 8px; border-radius: 4px; letter-spacing: 0.06em; text-transform: uppercase; }
.tip-prio-critical { background: rgba(255,107,107,0.15); border: 1px solid rgba(255,107,107,0.3); color: #ff6b6b; }
.tip-prio-high { background: rgba(249,115,22,0.15); border: 1px solid rgba(249,115,22,0.3); color: #f97316; }
.tip-prio-medium { background: rgba(234,179,8,0.12); border: 1px solid rgba(234,179,8,0.3); color: #eab308; }
.tip-prio-low { background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.2); color: #10b981; }

/* ---- Actor Cards ---- */
.tip-actor-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 14px; }
@media (max-width: 850px) { .tip-actor-grid { grid-template-columns: 1fr; } }

.tip-actor-card {
  background: rgba(15,23,42,0.7);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 10px;
  overflow: hidden;
  transition: border-color 0.15s, box-shadow 0.15s;
  cursor: pointer;
}
.tip-actor-card:hover { border-color: rgba(255,255,255,0.15); box-shadow: 0 4px 20px rgba(0,0,0,0.3); }
.tip-actor-header { display: flex; align-items: center; gap: 12px; padding: 14px; }
.tip-actor-body { padding: 0 14px 14px; display: none; border-top: 1px solid rgba(255,255,255,0.05); }
.tip-actor-body.open { display: block; }
.tip-actor-name-wrap { flex: 1; min-width: 0; }
.tip-actor-name { font-family: 'Sora', sans-serif; font-size: 14px; font-weight: 700; color: #e8edf5; }
.tip-actor-alias { font-size: 11px; color: #64748b; margin-top: 1px; }
.tip-actor-origin { font-size: 11px; color: #94a3b8; display: flex; align-items: center; gap: 4px; }
.tip-actor-stats { display: flex; gap: 16px; margin-top: 10px; flex-wrap: wrap; }
.tip-stat-item { display: flex; flex-direction: column; }
.tip-stat-val { font-family: 'IBM Plex Mono', monospace; font-size: 16px; font-weight: 700; color: #e8edf5; }
.tip-stat-val.cyan { color: #00d4ff; }
.tip-stat-val.orange { color: #f97316; }
.tip-stat-val.red { color: #ff6b6b; }
.tip-stat-label { font-size: 10px; color: #64748b; text-transform: uppercase; letter-spacing: 0.05em; }
.tip-actor-last-update { font-size: 10px; color: #64748b; margin-top: 4px; }
.tip-trending-badge { background: rgba(249,115,22,0.15); border: 1px solid rgba(249,115,22,0.3); color: #f97316; font-size: 9px; font-weight: 700; padding: 2px 7px; border-radius: 4px; letter-spacing: 0.08em; text-transform: uppercase; }

.tip-actor-expand { padding-top: 12px; }
.tip-actor-section-label { font-size: 10px; color: #64748b; text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 6px; margin-top: 12px; }
.tip-sector-tags { display: flex; gap: 6px; flex-wrap: wrap; }
.tip-sector-tag { background: rgba(0,212,255,0.06); border: 1px solid rgba(0,212,255,0.15); color: #64748b; font-size: 10px; padding: 2px 8px; border-radius: 4px; }
.tip-affected-clients { display: flex; gap: 6px; flex-wrap: wrap; }
.tip-client-chip { background: rgba(148,163,184,0.08); border: 1px solid rgba(148,163,184,0.15); color: #94a3b8; font-size: 10px; padding: 2px 8px; border-radius: 4px; }
.tip-actor-quick-actions { display: flex; gap: 8px; margin-top: 12px; flex-wrap: wrap; }
.tip-campaigns-list { margin-top: 8px; }
.tip-campaign-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 0;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  gap: 10px;
  flex-wrap: wrap;
}
.tip-campaign-row:last-child { border-bottom: none; }
.tip-campaign-name { font-size: 12px; color: #e8edf5; }
.tip-campaign-iocs { font-family: 'IBM Plex Mono', monospace; font-size: 11px; color: #00d4ff; }
.tip-campaign-date { font-size: 10px; color: #64748b; white-space: nowrap; }

/* ---- ATT&CK Heatmap ---- */
.tip-attack-container { overflow-x: auto; }
.tip-attack-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; flex-wrap: wrap; gap: 10px; }
.tip-attack-legend { display: flex; align-items: center; gap: 6px; }
.tip-legend-label { font-size: 10px; color: #64748b; }
.tip-legend-scale {
  display: flex;
  width: 140px;
  height: 10px;
  border-radius: 3px;
  background: linear-gradient(90deg, #050c15, #0f2d5e, #0d7377, #b45309, #dc2626);
  border: 1px solid rgba(255,255,255,0.1);
}

.tip-attack-grid { min-width: 900px; }
.tip-tactic-section { margin-bottom: 12px; }
.tip-tactic-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
}
.tip-tactic-name {
  font-size: 10px;
  font-weight: 700;
  color: #64748b;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  min-width: 120px;
  flex-shrink: 0;
}
.tip-tactic-techniques { display: flex; gap: 4px; flex-wrap: wrap; }
.tip-technique-cell {
  position: relative;
  width: 72px;
  height: 48px;
  border-radius: 5px;
  cursor: pointer;
  transition: transform 0.12s, box-shadow 0.12s;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  border: 1px solid rgba(255,255,255,0.04);
}
.tip-technique-cell:hover { transform: scale(1.06); box-shadow: 0 4px 16px rgba(0,0,0,0.5); z-index: 10; border-color: rgba(255,255,255,0.2); }
.tip-technique-id { font-family: 'IBM Plex Mono', monospace; font-size: 9px; color: rgba(255,255,255,0.5); }
.tip-technique-score { font-family: 'IBM Plex Mono', monospace; font-size: 12px; font-weight: 700; color: rgba(255,255,255,0.9); }

/* Heat colors */
.tip-heat-0 { background: #050c15; }
.tip-heat-1 { background: #0a1f3a; }
.tip-heat-2 { background: #0f2d5e; }
.tip-heat-3 { background: #0e3d5c; }
.tip-heat-4 { background: #0d5a64; }
.tip-heat-5 { background: #0d7377; }
.tip-heat-6 { background: #7c5316; }
.tip-heat-7 { background: #b45309; }
.tip-heat-8 { background: #c0392b; }
.tip-heat-9 { background: #dc2626; }
.tip-heat-10 { background: #ef4444; box-shadow: 0 0 8px rgba(239,68,68,0.4); }

/* Tooltip */
.tip-tooltip {
  position: fixed;
  background: rgba(8,13,26,0.98);
  border: 1px solid rgba(0,212,255,0.25);
  border-radius: 8px;
  padding: 10px 14px;
  pointer-events: none;
  z-index: 300;
  min-width: 200px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.6);
  display: none;
}
.tip-tooltip.visible { display: block; }
.tip-tt-tactic { font-size: 10px; color: #64748b; text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 3px; }
.tip-tt-name { font-size: 13px; font-weight: 600; color: #e8edf5; margin-bottom: 4px; }
.tip-tt-score { display: flex; gap: 10px; }
.tip-tt-score-val { font-family: 'IBM Plex Mono', monospace; font-size: 12px; color: #ff6b6b; }
.tip-tt-actor { font-size: 11px; color: #94a3b8; }

/* ATT&CK Technique Detail Modal */
.tip-attack-modal-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.65);
  z-index: 500;
  display: none;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(4px);
}
.tip-attack-modal-overlay.open { display: flex; }
.tip-attack-modal {
  background: rgba(10,18,35,0.98);
  border: 1px solid rgba(0,212,255,0.2);
  border-radius: 12px;
  width: 520px;
  max-width: calc(100vw - 40px);
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 30px 80px rgba(0,0,0,0.7);
  backdrop-filter: blur(20px);
  scrollbar-width: thin;
  scrollbar-color: rgba(0,212,255,0.2) transparent;
}
.tip-attack-modal-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  padding: 20px 20px 0;
  gap: 12px;
}
.tip-attack-modal-body { padding: 16px 20px 20px; }
.tip-sidepanel-section { margin-bottom: 16px; }
.tip-sidepanel-section-title { font-size: 10px; color: #64748b; text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 4px; }
.tip-sp-ioc-list { display: flex; flex-direction: column; gap: 5px; }
.tip-sp-ioc-item { display: flex; align-items: center; gap: 8px; font-size: 11px; }
.tip-sp-ioc-val { font-family: 'IBM Plex Mono', monospace; color: #94a3b8; }
.tip-sp-actor-list { display: flex; flex-direction: column; gap: 4px; }
.tip-sp-actor-item { font-size: 12px; color: #e8edf5; display: flex; align-items: center; gap: 6px; }

/* Hunt Scheduling Modal */
.tip-hunt-sched-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.65);
  z-index: 500;
  display: none;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(4px);
}
.tip-hunt-sched-overlay.open { display: flex; }
.tip-hunt-sched-modal {
  background: rgba(10,18,35,0.98);
  border: 1px solid rgba(0,212,255,0.2);
  border-radius: 12px;
  width: 480px;
  max-width: calc(100vw - 40px);
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 30px 80px rgba(0,0,0,0.7);
  backdrop-filter: blur(20px);
}
.tip-sched-option {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 14px 16px;
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.15s;
  margin-bottom: 8px;
}
.tip-sched-option:hover { border-color: rgba(0,212,255,0.4); background: rgba(0,212,255,0.04); }
.tip-sched-option.selected { border-color: rgba(0,212,255,0.6); background: rgba(0,212,255,0.08); }
.tip-sched-radio {
  width: 18px; height: 18px;
  border-radius: 50%;
  border: 2px solid rgba(255,255,255,0.2);
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s;
}
.tip-sched-option.selected .tip-sched-radio { border-color: #00d4ff; }
.tip-sched-option.selected .tip-sched-radio::after { content: ''; width: 8px; height: 8px; border-radius: 50%; background: #00d4ff; }
.tip-sched-label { font-size: 13px; font-weight: 600; color: #e8edf5; }
.tip-sched-desc { font-size: 11px; color: #64748b; margin-top: 2px; }
.tip-sched-fields {
  padding: 12px 16px;
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  margin-top: 4px;
  display: none;
}
.tip-sched-fields.visible { display: block; }
.tip-sched-field-row {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}
.tip-sched-field-row:last-child { margin-bottom: 0; }
.tip-sched-field-label { font-size: 11px; color: #94a3b8; min-width: 80px; }
.tip-sched-input {
  flex: 1;
  background: rgba(15,23,42,0.6);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 5px;
  padding: 6px 10px;
  font-size: 12px;
  color: #e8edf5;
  outline: none;
  font-family: 'IBM Plex Sans', sans-serif;
}
.tip-sched-input:focus { border-color: rgba(0,212,255,0.5); }

/* ---- SIEM Push Tab ---- */
.tip-siem-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 14px; }

.tip-siem-card {
  background: rgba(15,23,42,0.7);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 10px;
  overflow: hidden;
  transition: border-color 0.15s;
}
.tip-siem-card.live { border-left: 3px solid #10b981; }
.tip-siem-card.stale { border-left: 3px solid #f59e0b; }
.tip-siem-card.failed { border-left: 3px solid #ff6b6b; }
.tip-siem-card.mdr { border-left: 3px solid #64748b; }

.tip-siem-card-header { display: flex; align-items: center; justify-content: space-between; padding: 14px; border-bottom: 1px solid rgba(255,255,255,0.05); }
.tip-siem-client-name { font-family: 'Sora', sans-serif; font-size: 14px; font-weight: 700; color: #e8edf5; }
.tip-siem-platform { font-size: 11px; color: #64748b; margin-top: 2px; display: flex; align-items: center; gap: 5px; }
.tip-status-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.tip-status-live { background: #10b981; box-shadow: 0 0 6px rgba(16,185,129,0.5); animation: tip-pulse-green 2s infinite; }
.tip-status-stale { background: #f59e0b; box-shadow: 0 0 6px rgba(245,158,11,0.5); animation: tip-pulse-amber 2s infinite; }
.tip-status-failed { background: #ff6b6b; box-shadow: 0 0 6px rgba(255,107,107,0.5); animation: tip-pulse-red 2s infinite; }
.tip-status-mdr { background: #64748b; }

.tip-siem-body { padding: 14px; }
.tip-siem-stats { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px; }
.tip-siem-stat { display: flex; flex-direction: column; }
.tip-siem-stat-val { font-family: 'IBM Plex Mono', monospace; font-size: 18px; font-weight: 700; color: #e8edf5; }
.tip-siem-stat-label { font-size: 10px; color: #64748b; text-transform: uppercase; letter-spacing: 0.04em; }
.tip-siem-last-push { font-size: 11px; color: #94a3b8; margin-bottom: 12px; }
.tip-stale-warning {
  display: flex;
  align-items: center;
  gap: 8px;
  background: rgba(245,158,11,0.08);
  border: 1px solid rgba(245,158,11,0.2);
  border-radius: 6px;
  padding: 8px 10px;
  font-size: 11px;
  color: #f59e0b;
  margin-bottom: 12px;
}
.tip-siem-actions { display: flex; gap: 8px; flex-wrap: wrap; }

/* IOC Set Modal */
.tip-modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  z-index: 500;
  display: none;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(4px);
}
.tip-modal-overlay.open { display: flex; }
.tip-modal {
  background: rgba(10,18,35,0.98);
  border: 1px solid rgba(0,212,255,0.2);
  border-radius: 12px;
  width: 640px;
  max-width: calc(100vw - 40px);
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 30px 80px rgba(0,0,0,0.7);
  backdrop-filter: blur(20px);
}
.tip-modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid rgba(255,255,255,0.07);
  position: sticky;
  top: 0;
  background: rgba(10,18,35,0.98);
  z-index: 1;
}
.tip-modal-title { font-family: 'Sora', sans-serif; font-size: 15px; font-weight: 700; color: #e8edf5; }
.tip-modal-close { background: transparent; border: none; color: #64748b; font-size: 18px; cursor: pointer; padding: 2px 6px; border-radius: 4px; transition: color 0.15s; }
.tip-modal-close:hover { color: #e8edf5; }
.tip-modal-body { padding: 20px; }
.tip-ioc-set-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 0;
  border-bottom: 1px solid rgba(255,255,255,0.05);
  gap: 12px;
}
.tip-ioc-set-row:last-child { border-bottom: none; }
.tip-ioc-set-info { flex: 1; }
.tip-ioc-set-name { font-size: 13px; font-weight: 600; color: #e8edf5; margin-bottom: 2px; }
.tip-ioc-set-desc { font-size: 11px; color: #64748b; }
.tip-ioc-set-dest {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 8px;
}
.tip-ioc-set-dest-label {
  font-size: 10px;
  font-weight: 600;
  color: #94a3b8;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  white-space: nowrap;
  min-width: 72px;
}
.tip-ioc-set-dest-input {
  flex: 1;
  background: rgba(15,23,42,0.6);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 5px;
  padding: 5px 10px;
  font-size: 11px;
  font-family: 'IBM Plex Mono', monospace;
  color: #00d4ff;
  outline: none;
  transition: border-color 0.15s;
}
.tip-ioc-set-dest-input:focus {
  border-color: rgba(0,212,255,0.5);
  box-shadow: 0 0 0 2px rgba(0,212,255,0.1);
}
.tip-ioc-set-dest-input::placeholder { color: #475569; }
.tip-toggle-wrap { position: relative; }
.tip-toggle {
  appearance: none;
  width: 38px;
  height: 20px;
  background: rgba(255,255,255,0.1);
  border-radius: 10px;
  cursor: pointer;
  transition: background 0.2s;
  position: relative;
  outline: none;
}
.tip-toggle::after {
  content: '';
  position: absolute;
  width: 14px; height: 14px;
  background: #64748b;
  border-radius: 50%;
  top: 3px; left: 3px;
  transition: all 0.2s;
}
.tip-toggle:checked { background: rgba(0,212,255,0.3); }
.tip-toggle:checked::after { left: 21px; background: #00d4ff; }

/* ---- Reporting Tab ---- */
.tip-report-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
@media (max-width: 900px) { .tip-report-layout { grid-template-columns: 1fr; } }

.tip-checkboxes-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
.tip-checkbox-item { display: flex; align-items: center; gap: 7px; font-size: 12px; color: #94a3b8; cursor: pointer; }
.tip-checkbox-item input[type=checkbox] { accent-color: #00d4ff; }

.tip-report-preview {
  background: rgba(8,13,26,0.6);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  padding: 16px;
  font-size: 12px;
  line-height: 1.7;
  color: #94a3b8;
  margin-top: 14px;
  display: none;
  max-height: 400px;
  overflow-y: auto;
}
.tip-report-preview.visible { display: block; }
.tip-report-preview h3 { font-family: 'Sora', sans-serif; font-size: 16px; color: #00d4ff; margin: 0 0 4px; }
.tip-report-preview h4 { font-size: 13px; color: #e8edf5; font-weight: 600; margin: 14px 0 4px; border-bottom: 1px solid rgba(255,255,255,0.06); padding-bottom: 4px; }
.tip-report-preview p { margin: 0 0 8px; }
.tip-report-preview .tip-rp-meta { color: #64748b; font-size: 11px; margin-bottom: 12px; }
.tip-report-preview ul { margin: 0 0 8px; padding-left: 16px; }
.tip-report-preview ul li { margin-bottom: 2px; }
.tip-report-preview .tip-rp-verdict { background: rgba(0,212,255,0.06); border-left: 3px solid #00d4ff; padding: 8px 12px; border-radius: 0 6px 6px 0; }

.tip-recent-reports { display: flex; flex-direction: column; gap: 6px; }
.tip-report-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  background: rgba(30,41,59,0.4);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  transition: border-color 0.15s;
  flex-wrap: wrap;
}
.tip-report-row:hover { border-color: rgba(255,255,255,0.12); }
.tip-report-type-badge { font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 4px; white-space: nowrap; flex-shrink: 0; }
.tip-rtype-monthly { background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.2); color: #00d4ff; }
.tip-rtype-incident { background: rgba(255,107,107,0.1); border: 1px solid rgba(255,107,107,0.2); color: #ff6b6b; }
.tip-rtype-sector { background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.2); color: #10b981; }
.tip-rtype-exec { background: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.2); color: #f59e0b; }
.tip-report-info { flex: 1; min-width: 0; }
.tip-report-name { font-size: 12px; font-weight: 600; color: #e8edf5; }
.tip-report-meta { font-size: 10px; color: #64748b; }
.tip-status-draft { background: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.2); color: #f59e0b; font-size: 10px; padding: 2px 7px; border-radius: 4px; }
.tip-status-published { background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.2); color: #10b981; font-size: 10px; padding: 2px 7px; border-radius: 4px; }
.tip-report-actions { display: flex; gap: 5px; flex-shrink: 0; }

/* ---- Utility ---- */
.tip-badge-count {
  font-family: 'IBM Plex Mono', monospace;
  font-size: 11px;
  background: rgba(0,212,255,0.12);
  border: 1px solid rgba(0,212,255,0.25);
  color: #00d4ff;
  padding: 1px 8px;
  border-radius: 10px;
  font-weight: 600;
}
.tip-badge-count-red {
  background: rgba(255,107,107,0.12);
  border-color: rgba(255,107,107,0.25);
  color: #ff6b6b;
}
.tip-empty-state { text-align: center; padding: 30px 20px; color: #64748b; font-size: 13px; }
.tip-section-title {
  font-family: 'Sora', sans-serif;
  font-size: 11px;
  font-weight: 700;
  color: #64748b;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-bottom: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.tip-section-title::after { content: ''; flex: 1; height: 1px; background: rgba(255,255,255,0.05); }

.tip-add-actor-modal .tip-actor-search-result {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.1s;
  border: 1px solid transparent;
}
.tip-add-actor-modal .tip-actor-search-result:hover { background: rgba(255,255,255,0.04); border-color: rgba(255,255,255,0.08); }

.tip-push-all-banner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: rgba(0,212,255,0.05);
  border: 1px solid rgba(0,212,255,0.15);
  border-radius: 10px;
  padding: 14px 18px;
  margin-bottom: 18px;
  flex-wrap: wrap;
  gap: 12px;
}
.tip-push-all-info { font-size: 13px; color: #94a3b8; }
.tip-push-all-info strong { color: #e8edf5; }

.tip-toast {
  position: fixed;
  bottom: 24px;
  right: 24px;
  z-index: 1000;
  background: rgba(10,18,35,0.98);
  border: 1px solid rgba(0,212,255,0.3);
  border-radius: 8px;
  padding: 12px 18px;
  font-size: 13px;
  color: #e8edf5;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  display: none;
  max-width: 320px;
  backdrop-filter: blur(20px);
  animation: tip-toast-in 0.2s ease;
}
.tip-toast.visible { display: flex; align-items: center; gap: 10px; }
.tip-toast-icon { font-size: 16px; }
@keyframes tip-toast-in {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Push progress animation */
.tip-push-progress {
  width: 100%;
  height: 2px;
  background: rgba(0,212,255,0.1);
  border-radius: 1px;
  overflow: hidden;
  margin-top: 8px;
  display: none;
}
.tip-push-progress.active { display: block; }
.tip-push-progress-bar {
  height: 100%;
  background: linear-gradient(90deg, #00d4ff, #10b981);
  border-radius: 1px;
  animation: tip-progress 1.5s ease-in-out forwards;
}
@keyframes tip-progress {
  from { width: 0; }
  to { width: 100%; }
}

/* Stat count animation */
.tip-animate-count { transition: color 0.3s; }

/* Approved/Rejected state */
.tip-ioc-card.approved .tip-ioc-card-header { opacity: 0.6; }
.tip-approved-stamp {
  font-size: 10px;
  font-weight: 700;
  background: rgba(16,185,129,0.12);
  border: 1px solid rgba(16,185,129,0.3);
  color: #10b981;
  padding: 2px 8px;
  border-radius: 4px;
  margin-left: auto;
}
.tip-rejected-stamp {
  font-size: 10px;
  font-weight: 700;
  background: rgba(255,107,107,0.1);
  border: 1px solid rgba(255,107,107,0.2);
  color: #ff6b6b;
  padding: 2px 8px;
  border-radius: 4px;
  margin-left: auto;
}

/* ============================================================
   PRODUCTION MODE â€” Zero State  
   ============================================================ */
/* In production mode, toggle switches between PROD/DEMO view */
body.mode-production .demo-toggle-wrap .demo-label-text { display: none; }
body.mode-production .demo-toggle-wrap .prod-label-text { display: inline; }
.prod-label-text { display: none; }

.prod-badge {
  display: none;
  align-items: center;
  gap: 4px;
  padding: 3px 10px;
  border-radius: 4px;
  font-family: var(--font-mono);
  font-size: 9px;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  background: rgba(16, 185, 129, 0.12);
  color: #10b981;
  border: 1px solid rgba(16, 185, 129, 0.25);
}
.prod-badge::before {
  content: '';
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #10b981;
  box-shadow: 0 0 6px rgba(16, 185, 129, 0.5);
  animation: livePulse 2s ease-in-out infinite;
}
body.mode-production .prod-badge { display: flex; }

.prod-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  color: var(--text-muted);
  font-size: 12px;
  font-family: var(--font-mono);
  gap: 8px;
}
.prod-empty-state .prod-empty-icon {
  font-size: 24px;
  opacity: 0.3;
}
.prod-empty-state .prod-empty-text {
  letter-spacing: 0.05em;
}
</style>

<!-- ============================================================
     TOOLTIP (shared across heatmap)
     ============================================================ -->
<div class="tip-tooltip" id="tip-attack-tooltip">
  <div class="tip-tt-tactic" id="tip-tt-tactic"></div>
  <div class="tip-tt-name" id="tip-tt-name"></div>
  <div class="tip-tt-score">
    <div class="tip-tt-score-val" id="tip-tt-score"></div>
    <div class="tip-tt-actor" id="tip-tt-actor"></div>
  </div>
</div>

<!-- ============================================================
     TOAST
     ============================================================ -->
<div class="tip-toast" id="tip-toast">
  <span class="tip-toast-icon" id="tip-toast-icon">âœ“</span>
  <span id="tip-toast-msg">Action completed</span>
</div>

<!-- ============================================================
     ATT&CK TECHNIQUE DETAIL MODAL
     ============================================================ -->
<div class="tip-attack-modal-overlay" id="tip-attack-sidepanel" onclick="if(event.target===this)this.classList.remove('open')">
  <div class="tip-attack-modal">
    <div class="tip-attack-modal-header">
      <div>
        <div style="font-family:'IBM Plex Mono',monospace;font-size:12px;color:#00d4ff;margin-bottom:4px;" id="tip-sp-id"></div>
        <div style="font-family:'Sora',sans-serif;font-size:16px;font-weight:700;color:#e8edf5;" id="tip-sp-name"></div>
        <div style="font-size:11px;color:#64748b;margin-top:3px;" id="tip-sp-tactic"></div>
      </div>
      <button class="tip-modal-close" onclick="document.getElementById('tip-attack-sidepanel').classList.remove('open')">âœ•</button>
    </div>
    <div class="tip-attack-modal-body">
      <div class="tip-sidepanel-section">
        <div class="tip-sidepanel-section-title">Activity Score</div>
        <div id="tip-sp-score-wrap" style="display:flex;align-items:center;gap:12px;">
          <div style="font-family:'IBM Plex Mono',monospace;font-size:28px;font-weight:700;" id="tip-sp-score-val"></div>
          <div style="font-size:11px;color:#64748b;">/ 10</div>
        </div>
      </div>
      <div class="tip-sidepanel-section">
        <div class="tip-sidepanel-section-title">Associated Indicators</div>
        <div class="tip-sp-ioc-list" id="tip-sp-ioc-list"></div>
      </div>
      <div class="tip-sidepanel-section">
        <div class="tip-sidepanel-section-title">Threat Actors</div>
        <div class="tip-sp-actor-list" id="tip-sp-actor-list"></div>
      </div>
      <div class="tip-sidepanel-section">
        <div class="tip-sidepanel-section-title">Linked Campaigns</div>
        <div id="tip-sp-campaigns"></div>
      </div>
      <div style="margin-top:16px;padding-top:14px;border-top:1px solid rgba(255,255,255,0.06);display:flex;gap:8px;">
        <button class="tip-btn tip-btn-primary" onclick="document.getElementById('tip-attack-sidepanel').classList.remove('open');tipOpenHuntScheduler('ATT&CK Technique Hunt')">ðŸŽ¯ Hunt This Technique</button>
        <button class="tip-btn tip-btn-secondary" onclick="document.getElementById('tip-attack-sidepanel').classList.remove('open')">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================
     HUNT SCHEDULING MODAL
     ============================================================ -->
<div class="tip-hunt-sched-overlay" id="tip-hunt-sched-modal" onclick="if(event.target===this)this.classList.remove('open')">
  <div class="tip-hunt-sched-modal">
    <div class="tip-modal-header">
      <div class="tip-modal-title">ðŸŽ¯ Schedule Hunt Job</div>
      <button class="tip-modal-close" onclick="document.getElementById('tip-hunt-sched-modal').classList.remove('open')">âœ•</button>
    </div>
    <div class="tip-modal-body">
      <div style="font-size:12px;color:#94a3b8;margin-bottom:4px;">Hypothesis</div>
      <div style="font-size:14px;font-weight:600;color:#e8edf5;margin-bottom:16px;padding:10px 14px;background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.15);border-radius:8px;" id="tip-sched-hyp-name"></div>

      <!-- Option 1: Hunt Now -->
      <div class="tip-sched-option selected" onclick="tipSelectSchedOption(this, 'now')">
        <div class="tip-sched-radio"></div>
        <div style="flex:1;">
          <div class="tip-sched-label">âš¡ Hunt Now</div>
          <div class="tip-sched-desc">Execute immediately as a one-time hunt job</div>
        </div>
      </div>

      <!-- Option 2: Schedule -->
      <div class="tip-sched-option" onclick="tipSelectSchedOption(this, 'scheduled')">
        <div class="tip-sched-radio"></div>
        <div style="flex:1;">
          <div class="tip-sched-label">ðŸ“… Schedule Hunt</div>
          <div class="tip-sched-desc">Set a specific start date and time</div>
          <div class="tip-sched-fields" id="tip-sched-fields-scheduled">
            <div class="tip-sched-field-row">
              <span class="tip-sched-field-label">Start Date</span>
              <input type="date" class="tip-sched-input" value="2026-03-01">
            </div>
            <div class="tip-sched-field-row">
              <span class="tip-sched-field-label">Start Time</span>
              <input type="time" class="tip-sched-input" value="09:00">
            </div>
          </div>
        </div>
      </div>

      <!-- Option 3: Recurring -->
      <div class="tip-sched-option" onclick="tipSelectSchedOption(this, 'recurring')">
        <div class="tip-sched-radio"></div>
        <div style="flex:1;">
          <div class="tip-sched-label">ðŸ” Recurring Hunt</div>
          <div class="tip-sched-desc">Run this hunt on a repeating schedule</div>
          <div class="tip-sched-fields" id="tip-sched-fields-recurring">
            <div class="tip-sched-field-row">
              <span class="tip-sched-field-label">Frequency</span>
              <select class="tip-sched-input" style="cursor:pointer;">
                <option>Every 6 hours</option>
                <option>Every 12 hours</option>
                <option selected>Daily</option>
                <option>Every 3 days</option>
                <option>Weekly</option>
                <option>Bi-weekly</option>
              </select>
            </div>
            <div class="tip-sched-field-row">
              <span class="tip-sched-field-label">Start Date</span>
              <input type="date" class="tip-sched-input" value="2026-03-01">
            </div>
            <div class="tip-sched-field-row">
              <span class="tip-sched-field-label">End Date</span>
              <input type="date" class="tip-sched-input" value="2026-03-31">
            </div>
          </div>
        </div>
      </div>

      <!-- Assigned Analyst -->
      <div style="margin-top:12px;">
        <div style="font-size:11px;color:#64748b;margin-bottom:6px;">Assigned Analyst</div>
        <select class="tip-sched-input" style="width:100%;cursor:pointer;">
          <option>John Lim (Current User)</option>
          <option>K. Rasmussen â€” Lead Analyst</option>
          <option>P. Tran â€” Malware Analyst</option>
          <option>M. Nguyen â€” Threat Intelligence</option>
          <option>S. Lim â€” Forensics</option>
        </select>
      </div>

      <!-- Priority -->
      <div style="margin-top:12px;">
        <div style="font-size:11px;color:#64748b;margin-bottom:6px;">Priority</div>
        <div style="display:flex;gap:6px;">
          <button class="tip-btn tip-btn-sm" style="border-color:rgba(239,68,68,0.4);color:#ef4444;" onclick="tipSelectPrio(this)">Critical</button>
          <button class="tip-btn tip-btn-sm selected" style="border-color:rgba(249,115,22,0.4);color:#f97316;background:rgba(249,115,22,0.1);" onclick="tipSelectPrio(this)">High</button>
          <button class="tip-btn tip-btn-sm" style="border-color:rgba(245,158,11,0.4);color:#f59e0b;" onclick="tipSelectPrio(this)">Medium</button>
          <button class="tip-btn tip-btn-sm" style="border-color:rgba(34,197,94,0.4);color:#22c55e;" onclick="tipSelectPrio(this)">Low</button>
        </div>
      </div>

      <!-- Action buttons -->
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:20px;border-top:1px solid rgba(255,255,255,0.06);padding-top:14px;">
        <button class="tip-btn tip-btn-secondary" onclick="document.getElementById('tip-hunt-sched-modal').classList.remove('open')">Cancel</button>
        <button class="tip-btn tip-btn-primary" onclick="document.getElementById('tip-hunt-sched-modal').classList.remove('open');tipToast('ðŸŽ¯','Hunt job created and pushed to Hunting module')">Confirm &amp; Push to Hunting</button>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================
     IOC SET MODAL
     ============================================================ -->
<div class="tip-modal-overlay" id="tip-iocset-modal">
  <div class="tip-modal">
    <div class="tip-modal-header">
      <div class="tip-modal-title">Manage IOC Sets â€” <span id="tip-modal-client-name"></span></div>
      <button class="tip-modal-close" onclick="document.getElementById('tip-iocset-modal').classList.remove('open')">âœ•</button>
    </div>
    <div class="tip-modal-body">
      <p style="font-size:12px;color:#64748b;margin-bottom:16px;">Toggle IOC sets active/inactive, configure the destination table/index name, and select the push format for this client's SIEM. Changes take effect on next push cycle (5 min).</p>
      <div id="tip-iocset-rows">
        <div class="tip-ioc-set-row">
          <div class="tip-ioc-set-info">
            <div class="tip-ioc-set-name">C2 IP Blocklist</div>
            <div class="tip-ioc-set-desc">IPv4 indicators labelled command-and-control</div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Destination</span>
              <input type="text" class="tip-ioc-set-dest-input" value="c2_ip_blocklist" placeholder="e.g. lookup table name, index, or watchlist">
            </div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Format</span>
              <select class="tip-ioc-set-dest-input" style="font-family:'IBM Plex Sans',sans-serif;cursor:pointer;">
                <option selected>Elastic Index (threat-intel-*)</option>
                <option>Sentinel Watchlist CSV</option>
                <option>Splunk Lookup Table</option>
                <option>QRadar Reference Set</option>
                <option>STIX 2.1 Bundle</option>
              </select>
            </div>
          </div>
          <label class="tip-toggle-wrap"><input type="checkbox" class="tip-toggle" checked></label>
        </div>
        <div class="tip-ioc-set-row">
          <div class="tip-ioc-set-info">
            <div class="tip-ioc-set-name">Malicious Hash Watchlist</div>
            <div class="tip-ioc-set-desc">StixFile indicators with confidence &gt;70 â€” pushed to EDR endpoint hash blocklist</div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Destination</span>
              <input type="text" class="tip-ioc-set-dest-input" value="malicious_hash_watchlist" placeholder="e.g. lookup table name, index, or watchlist">
            </div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Format</span>
              <select class="tip-ioc-set-dest-input" style="font-family:'IBM Plex Sans',sans-serif;cursor:pointer;">
                <option selected>Elastic Index (threat-intel-*)</option>
                <option>Sentinel Watchlist CSV</option>
                <option>Splunk Lookup Table</option>
                <option>QRadar Reference Set</option>
                <option>STIX 2.1 Bundle</option>
              </select>
            </div>
          </div>
          <label class="tip-toggle-wrap"><input type="checkbox" class="tip-toggle" checked></label>
        </div>
        <div class="tip-ioc-set-row">
          <div class="tip-ioc-set-info">
            <div class="tip-ioc-set-name">Phishing Domain Block</div>
            <div class="tip-ioc-set-desc">Domain indicators labelled phishing â€” pushed to DNS / proxy blocklist</div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Destination</span>
              <input type="text" class="tip-ioc-set-dest-input" value="phishing_domain_blocklist" placeholder="e.g. lookup table name, index, or watchlist">
            </div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Format</span>
              <select class="tip-ioc-set-dest-input" style="font-family:'IBM Plex Sans',sans-serif;cursor:pointer;">
                <option selected>Elastic Index (threat-intel-*)</option>
                <option>Sentinel Watchlist CSV</option>
                <option>Splunk Lookup Table</option>
                <option>QRadar Reference Set</option>
                <option>STIX 2.1 Bundle</option>
              </select>
            </div>
          </div>
          <label class="tip-toggle-wrap"><input type="checkbox" class="tip-toggle" checked></label>
        </div>
        <div class="tip-ioc-set-row">
          <div class="tip-ioc-set-info">
            <div class="tip-ioc-set-name">APT Actor IOCs</div>
            <div class="tip-ioc-set-desc">All indicators linked to actors in the active watchlist</div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Destination</span>
              <input type="text" class="tip-ioc-set-dest-input" value="apt_actor_iocs" placeholder="e.g. lookup table name, index, or watchlist">
            </div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Format</span>
              <select class="tip-ioc-set-dest-input" style="font-family:'IBM Plex Sans',sans-serif;cursor:pointer;">
                <option selected>Elastic Index (threat-intel-*)</option>
                <option>Sentinel Watchlist CSV</option>
                <option>Splunk Lookup Table</option>
                <option>QRadar Reference Set</option>
                <option>STIX 2.1 Bundle</option>
              </select>
            </div>
          </div>
          <label class="tip-toggle-wrap"><input type="checkbox" class="tip-toggle" checked></label>
        </div>
        <div class="tip-ioc-set-row">
          <div class="tip-ioc-set-info">
            <div class="tip-ioc-set-name">Sector-Specific Feed</div>
            <div class="tip-ioc-set-desc">Indicators where victim sector matches client sector â€” pushed to SIEM enrichment watchlist</div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Destination</span>
              <input type="text" class="tip-ioc-set-dest-input" value="sector_enrichment_watchlist" placeholder="e.g. lookup table name, index, or watchlist">
            </div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Format</span>
              <select class="tip-ioc-set-dest-input" style="font-family:'IBM Plex Sans',sans-serif;cursor:pointer;">
                <option selected>Elastic Index (threat-intel-*)</option>
                <option>Sentinel Watchlist CSV</option>
                <option>Splunk Lookup Table</option>
                <option>QRadar Reference Set</option>
                <option>STIX 2.1 Bundle</option>
              </select>
            </div>
          </div>
          <label class="tip-toggle-wrap"><input type="checkbox" class="tip-toggle"></label>
        </div>
        <div class="tip-ioc-set-row">
          <div class="tip-ioc-set-info">
            <div class="tip-ioc-set-name">Ransomware Group IOCs</div>
            <div class="tip-ioc-set-desc">Indicators linked to ransomware-family malware â€” pushed to all detection layers</div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Destination</span>
              <input type="text" class="tip-ioc-set-dest-input" value="ransomware_group_iocs" placeholder="e.g. lookup table name, index, or watchlist">
            </div>
            <div class="tip-ioc-set-dest">
              <span class="tip-ioc-set-dest-label">Format</span>
              <select class="tip-ioc-set-dest-input" style="font-family:'IBM Plex Sans',sans-serif;cursor:pointer;">
                <option selected>Elastic Index (threat-intel-*)</option>
                <option>Sentinel Watchlist CSV</option>
                <option>Splunk Lookup Table</option>
                <option>QRadar Reference Set</option>
                <option>STIX 2.1 Bundle</option>
              </select>
            </div>
          </div>
          <label class="tip-toggle-wrap"><input type="checkbox" class="tip-toggle" checked></label>
        </div>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:20px;border-top:1px solid rgba(255,255,255,0.06);padding-top:14px;">
        <button class="tip-btn tip-btn-secondary" onclick="document.getElementById('tip-iocset-modal').classList.remove('open')">Cancel</button>
        <button class="tip-btn tip-btn-primary" onclick="document.getElementById('tip-iocset-modal').classList.remove('open');tipToast('âœ…','IOC set configuration saved')">Save Changes</button>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================
     ADD ACTOR MODAL
     ============================================================ -->
<div class="tip-modal-overlay tip-add-actor-modal" id="tip-add-actor-modal">
  <div class="tip-modal">
    <div class="tip-modal-header">
      <div class="tip-modal-title">Add Threat Actor to Watchlist</div>
      <button class="tip-modal-close" onclick="document.getElementById('tip-add-actor-modal').classList.remove('open')">âœ•</button>
    </div>
    <div class="tip-modal-body">
      <div style="margin-bottom:14px;">
        <input type="text" class="tip-form-input" style="width:100%" placeholder="Search DACTA TIP for threat actor..." id="tip-actor-search-input" oninput="tipFilterActors(this.value)">
      </div>
      <div id="tip-actor-search-results">
        <div class="tip-actor-search-result" onclick="tipToast('âœ…','UNC2452 added to watchlist')">
          <div class="tip-live-dot red" style="flex-shrink:0"></div>
          <div><div style="font-size:13px;font-weight:600;color:#e8edf5">UNC2452</div><div style="font-size:11px;color:#64748b">Russia Â· Espionage Â· CRITICAL</div></div>
        </div>
        <div class="tip-actor-search-result" onclick="tipToast('âœ…','Turla added to watchlist')">
          <div class="tip-live-dot orange"></div>
          <div><div style="font-size:13px;font-weight:600;color:#e8edf5">Turla</div><div style="font-size:11px;color:#64748b">Russia Â· Espionage Â· HIGH</div></div>
        </div>
        <div class="tip-actor-search-result" onclick="tipToast('âœ…','Volt Typhoon added to watchlist')">
          <div class="tip-live-dot yellow"></div>
          <div><div style="font-size:13px;font-weight:600;color:#e8edf5">Volt Typhoon</div><div style="font-size:11px;color:#64748b">China Â· ICS/OT Â· HIGH</div></div>
        </div>
        <div class="tip-actor-search-result" onclick="tipToast('âœ…','TA505 added to watchlist')">
          <div class="tip-live-dot yellow"></div>
          <div><div style="font-size:13px;font-weight:600;color:#e8edf5">TA505</div><div style="font-size:11px;color:#64748b">Russia Â· Financial Â· MEDIUM</div></div>
        </div>
        <div class="tip-actor-search-result" onclick="tipToast('âœ…','Scattered Spider added to watchlist')">
          <div class="tip-live-dot orange"></div>
          <div><div style="font-size:13px;font-weight:600;color:#e8edf5">Scattered Spider</div><div style="font-size:11px;color:#64748b">Unknown Â· Financial/Telecom Â· HIGH</div></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================
     ROOT WRAPPER
     ============================================================ -->
<div class="tip-root">

  <!-- ============ TOP BAR ============ -->
  <div class="tip-topbar">
    <div class="tip-brand-badge">
      <div class="tip-live-dot" id="tip-octi-dot"></div>
      DACTA // THREAT INTELLIGENCE
    </div>
    <div class="tip-divider-v"></div>

    <!-- Client Selector -->
    <div class="tip-client-select-wrap">
      <select class="tip-client-select" id="tip-client-selector" onchange="tipUpdateClientContext(this.value)">
        <option value="dacta">Dacta Global</option>
        <option value="spmt">SPMT</option>
        <option value="gac">Global Advisor Co</option>
        <option value="naga">Naga World</option>
        <option value="adv">ADV Partners</option>
      </select>
      <span class="tip-client-select-icon">â–¼</span>
    </div>

    <!-- Context Tags -->
    <div class="tip-ctx-tags" id="tip-ctx-tags">
      <span class="tip-tag tip-tag-sector" id="tip-ctx-sector">Financial Services</span>
      <span class="tip-tag tip-tag-region" id="tip-ctx-region">APAC Â· Singapore</span>
      <span class="tip-tag tip-tag-high" id="tip-ctx-risk">HIGH RISK</span>
    </div>

    <!-- Live Feed Counters -->
    <div class="tip-counters">
      <div class="tip-counter">
        <div class="tip-counter-val" id="tip-feed-count">14</div>
        <div class="tip-counter-label">Active Feeds</div>
      </div>
      <div class="tip-divider-v"></div>
      <div class="tip-counter">
        <div class="tip-counter-val" id="tip-ioc-today">3,847</div>
        <div class="tip-counter-label">IOCs Today</div>
      </div>
      <div class="tip-divider-v"></div>
      <div class="tip-counter">
        <div class="tip-counter-val" id="tip-last-sync">2m ago</div>
        <div class="tip-counter-label">Last Sync</div>
      </div>
    </div>

    <!-- DACTA TIP Health -->
    <div class="tip-octi-health" id="tip-octi-health-badge">
      <div class="tip-live-dot"></div>
      DACTA TIP LIVE
    </div>
  </div>

  <!-- ============ TAB NAVIGATION ============ -->
  <div class="tip-tabnav">
    <button class="tip-tab-btn active" id="tip-tab-btn-ops" onclick="switchTiTab('ops')">
      <span class="tip-tab-icon">âš¡</span> Operations
    </button>
    <button class="tip-tab-btn" id="tip-tab-btn-actors" onclick="switchTiTab('actors')">
      <span class="tip-tab-icon">ðŸ‘¤</span> Actors &amp; Campaigns
    </button>
    <button class="tip-tab-btn" id="tip-tab-btn-attack" onclick="switchTiTab('attack')">
      <span class="tip-tab-icon">ðŸŽ¯</span> ATT&amp;CK Coverage
    </button>
    <button class="tip-tab-btn" id="tip-tab-btn-siem" onclick="switchTiTab('siem')">
      <span class="tip-tab-icon">ðŸ“¡</span> SIEM Push
    </button>
    <button class="tip-tab-btn" id="tip-tab-btn-report" onclick="switchTiTab('report')">
      <span class="tip-tab-icon">ðŸ“„</span> Reporting
    </button>

    <!-- Inline Search -->
    <div class="tip-tabnav-search">
      <input type="text" class="tip-search-input" placeholder="Search DACTA TIP..." id="tip-global-search" oninput="tipHandleSearch(this.value)" onfocus="if(this.value.length>1)tipShowSearchOverlay()" onblur="setTimeout(()=>tipHideSearchOverlay(),200)">
      <span class="tip-search-icon">âŒ•</span>
      <div class="tip-search-overlay" id="tip-search-overlay">
        <div class="tip-search-overlay-header">DACTA TIP Search Results</div>
        <div id="tip-search-results-container"></div>
      </div>
    </div>
  </div>

  <!-- ============ CONTENT ============ -->
  <div class="tip-content">

    <!-- ===================================
         TAB 1: OPERATIONS
         =================================== -->
    <div class="tip-tab-panel active" id="tip-panel-ops">
      <div class="tip-ops-grid">

        <!-- IOC Triage Workbench -->
        <div class="tip-panel">
          <div class="tip-panel-header">
            <div class="tip-panel-title">
              <span class="tip-panel-title-icon">ðŸ”</span>
              IOC Triage Workbench
              <span class="tip-badge-count tip-badge-count-red" id="tip-triage-count">8 Pending</span>
            </div>
            <button class="tip-btn tip-btn-warning tip-btn-sm" onclick="tipAutoApprove()">âš¡ Auto-Approve High Confidence</button>
          </div>
          <div class="tip-panel-scroll" id="tip-ioc-queue">

            <!-- IOC 1: APT29 IP -->
            <div class="tip-ioc-card" id="tip-ioc-1">
              <div class="tip-ioc-card-header" onclick="tipToggleIoc('tip-ioc-1')">
                <span class="tip-ioc-badge tip-ioc-ip">IP</span>
                <span class="tip-ioc-value">185.220.101.34</span>
                <span class="tip-ioc-actor">APT29</span>
                <span class="tip-vt-score tip-vt-red">VT 47/70</span>
                <span class="tip-gn-badge tip-gn-malicious">malicious</span>
                <div class="tip-conf-wrap">
                  <div class="tip-conf-bar-bg"><div class="tip-conf-bar-fill tip-conf-high" style="width:92%"></div></div>
                  <span class="tip-conf-val">92%</span>
                </div>
                <div class="tip-ioc-actions">
                  <button class="tip-btn tip-btn-success tip-btn-xs" onclick="event.stopPropagation();tipApproveIoc('tip-ioc-1')">âœ“ Approve</button>
                  <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="event.stopPropagation();tipRejectIoc('tip-ioc-1')">âœ• Reject</button>
                </div>
              </div>
              <div class="tip-ioc-expanded" id="tip-ioc-1-exp">
                <div class="tip-ioc-meta-grid">
                  <div class="tip-meta-item"><label>Campaign</label><span>Operation Midnight Snow</span></div>
                  <div class="tip-meta-item"><label>First Seen</label><span>2026-02-14</span></div>
                  <div class="tip-meta-item"><label>Last Seen</label><span>2026-02-27</span></div>
                  <div class="tip-meta-item"><label>Related IOCs</label><span style="color:#00d4ff;cursor:pointer">43 â†’</span></div>
                </div>
                <div class="tip-siem-select-label">Push to SIEMs on Approval</div>
                <div class="tip-siem-checkboxes">
                  <label class="tip-siem-check"><input type="checkbox" checked> Dacta Global (Elastic)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> SPMT (Sentinel)</label>
                  <label class="tip-siem-check"><input type="checkbox"> Global Advisor Co (Splunk)</label>
                  <label class="tip-siem-check"><input type="checkbox"> Naga World (Jira)</label>
                  <label class="tip-siem-check"><input type="checkbox"> ADV Partners (Jira)</label>
                </div>
              </div>
            </div>

            <!-- IOC 2: FIN7 Domain -->
            <div class="tip-ioc-card" id="tip-ioc-2">
              <div class="tip-ioc-card-header" onclick="tipToggleIoc('tip-ioc-2')">
                <span class="tip-ioc-badge tip-ioc-domain">DOMAIN</span>
                <span class="tip-ioc-value">login-verify.microsoft-365[.]club</span>
                <span class="tip-ioc-actor">FIN7</span>
                <span class="tip-vt-score tip-vt-orange">VT 38/70</span>
                <span class="tip-gn-badge tip-gn-unknown">unknown</span>
                <div class="tip-conf-wrap">
                  <div class="tip-conf-bar-bg"><div class="tip-conf-bar-fill tip-conf-med" style="width:78%"></div></div>
                  <span class="tip-conf-val">78%</span>
                </div>
                <div class="tip-ioc-actions">
                  <button class="tip-btn tip-btn-success tip-btn-xs" onclick="event.stopPropagation();tipApproveIoc('tip-ioc-2')">âœ“ Approve</button>
                  <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="event.stopPropagation();tipRejectIoc('tip-ioc-2')">âœ• Reject</button>
                </div>
              </div>
              <div class="tip-ioc-expanded" id="tip-ioc-2-exp">
                <div class="tip-ioc-meta-grid">
                  <div class="tip-meta-item"><label>Campaign</label><span>PhishKit Carbanak-2026</span></div>
                  <div class="tip-meta-item"><label>First Seen</label><span>2026-02-19</span></div>
                  <div class="tip-meta-item"><label>Last Seen</label><span>2026-02-26</span></div>
                  <div class="tip-meta-item"><label>Related IOCs</label><span style="color:#00d4ff;cursor:pointer">17 â†’</span></div>
                </div>
                <div class="tip-siem-select-label">Push to SIEMs on Approval</div>
                <div class="tip-siem-checkboxes">
                  <label class="tip-siem-check"><input type="checkbox" checked> Dacta Global (Elastic)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> SPMT (Sentinel)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> Global Advisor Co (Splunk)</label>
                  <label class="tip-siem-check"><input type="checkbox"> Naga World (Jira)</label>
                  <label class="tip-siem-check"><input type="checkbox"> ADV Partners (Jira)</label>
                </div>
              </div>
            </div>

            <!-- IOC 3: Lazarus SHA256 -->
            <div class="tip-ioc-card" id="tip-ioc-3">
              <div class="tip-ioc-card-header" onclick="tipToggleIoc('tip-ioc-3')">
                <span class="tip-ioc-badge tip-ioc-hash">HASH</span>
                <span class="tip-ioc-value">a3b9c8d7e6f5a4b3c2d1e0f9â€¦ef12</span>
                <span class="tip-ioc-actor">Lazarus Group</span>
                <span class="tip-vt-score tip-vt-red">VT 52/70</span>
                <span class="tip-gn-badge tip-gn-na">N/A</span>
                <div class="tip-conf-wrap">
                  <div class="tip-conf-bar-bg"><div class="tip-conf-bar-fill tip-conf-high" style="width:95%"></div></div>
                  <span class="tip-conf-val">95%</span>
                </div>
                <div class="tip-ioc-actions">
                  <button class="tip-btn tip-btn-success tip-btn-xs" onclick="event.stopPropagation();tipApproveIoc('tip-ioc-3')">âœ“ Approve</button>
                  <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="event.stopPropagation();tipRejectIoc('tip-ioc-3')">âœ• Reject</button>
                </div>
              </div>
              <div class="tip-ioc-expanded" id="tip-ioc-3-exp">
                <div class="tip-ioc-meta-grid">
                  <div class="tip-meta-item"><label>Campaign</label><span>AppleJeus Variant-Q1</span></div>
                  <div class="tip-meta-item"><label>First Seen</label><span>2026-01-28</span></div>
                  <div class="tip-meta-item"><label>Last Seen</label><span>2026-02-25</span></div>
                  <div class="tip-meta-item"><label>Related IOCs</label><span style="color:#00d4ff;cursor:pointer">62 â†’</span></div>
                </div>
                <div class="tip-siem-select-label">Push to SIEMs on Approval</div>
                <div class="tip-siem-checkboxes">
                  <label class="tip-siem-check"><input type="checkbox" checked> Dacta Global (Elastic)</label>
                  <label class="tip-siem-check"><input type="checkbox"> SPMT (Sentinel)</label>
                  <label class="tip-siem-check"><input type="checkbox"> Global Advisor Co (Splunk)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> Naga World (Jira)</label>
                  <label class="tip-siem-check"><input type="checkbox"> ADV Partners (Jira)</label>
                </div>
              </div>
            </div>

            <!-- IOC 4: ALPHV URL -->
            <div class="tip-ioc-card" id="tip-ioc-4">
              <div class="tip-ioc-card-header" onclick="tipToggleIoc('tip-ioc-4')">
                <span class="tip-ioc-badge tip-ioc-url">URL</span>
                <span class="tip-ioc-value">hxxps://update-service[.]net/payload.exe</span>
                <span class="tip-ioc-actor">ALPHV</span>
                <span class="tip-vt-score tip-vt-red">VT 41/70</span>
                <span class="tip-gn-badge tip-gn-malicious">malicious</span>
                <div class="tip-conf-wrap">
                  <div class="tip-conf-bar-bg"><div class="tip-conf-bar-fill tip-conf-high" style="width:85%"></div></div>
                  <span class="tip-conf-val">85%</span>
                </div>
                <div class="tip-ioc-actions">
                  <button class="tip-btn tip-btn-success tip-btn-xs" onclick="event.stopPropagation();tipApproveIoc('tip-ioc-4')">âœ“ Approve</button>
                  <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="event.stopPropagation();tipRejectIoc('tip-ioc-4')">âœ• Reject</button>
                </div>
              </div>
              <div class="tip-ioc-expanded" id="tip-ioc-4-exp">
                <div class="tip-ioc-meta-grid">
                  <div class="tip-meta-item"><label>Campaign</label><span>BlackCat Ransom Wave 6</span></div>
                  <div class="tip-meta-item"><label>First Seen</label><span>2026-02-21</span></div>
                  <div class="tip-meta-item"><label>Last Seen</label><span>2026-02-28</span></div>
                  <div class="tip-meta-item"><label>Related IOCs</label><span style="color:#00d4ff;cursor:pointer">29 â†’</span></div>
                </div>
                <div class="tip-siem-select-label">Push to SIEMs on Approval</div>
                <div class="tip-siem-checkboxes">
                  <label class="tip-siem-check"><input type="checkbox" checked> Dacta Global (Elastic)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> SPMT (Sentinel)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> Global Advisor Co (Splunk)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> Naga World (Jira)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> ADV Partners (Jira)</label>
                </div>
              </div>
            </div>

            <!-- IOC 5: Sandworm IP -->
            <div class="tip-ioc-card" id="tip-ioc-5">
              <div class="tip-ioc-card-header" onclick="tipToggleIoc('tip-ioc-5')">
                <span class="tip-ioc-badge tip-ioc-ip">IP</span>
                <span class="tip-ioc-value">91.234.99.87</span>
                <span class="tip-ioc-actor">Sandworm</span>
                <span class="tip-vt-score tip-vt-orange">VT 29/70</span>
                <span class="tip-gn-badge tip-gn-noise">noise</span>
                <div class="tip-conf-wrap">
                  <div class="tip-conf-bar-bg"><div class="tip-conf-bar-fill tip-conf-med" style="width:71%"></div></div>
                  <span class="tip-conf-val">71%</span>
                </div>
                <div class="tip-ioc-actions">
                  <button class="tip-btn tip-btn-success tip-btn-xs" onclick="event.stopPropagation();tipApproveIoc('tip-ioc-5')">âœ“ Approve</button>
                  <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="event.stopPropagation();tipRejectIoc('tip-ioc-5')">âœ• Reject</button>
                </div>
              </div>
              <div class="tip-ioc-expanded" id="tip-ioc-5-exp">
                <div class="tip-ioc-meta-grid">
                  <div class="tip-meta-item"><label>Campaign</label><span>Industroyer-3 Probes</span></div>
                  <div class="tip-meta-item"><label>First Seen</label><span>2026-02-10</span></div>
                  <div class="tip-meta-item"><label>Last Seen</label><span>2026-02-24</span></div>
                  <div class="tip-meta-item"><label>Related IOCs</label><span style="color:#00d4ff;cursor:pointer">8 â†’</span></div>
                </div>
                <div class="tip-siem-select-label">Push to SIEMs on Approval</div>
                <div class="tip-siem-checkboxes">
                  <label class="tip-siem-check"><input type="checkbox"> Dacta Global (Elastic)</label>
                  <label class="tip-siem-check"><input type="checkbox"> SPMT (Sentinel)</label>
                  <label class="tip-siem-check"><input type="checkbox"> Global Advisor Co (Splunk)</label>
                  <label class="tip-siem-check"><input type="checkbox"> Naga World (Jira)</label>
                  <label class="tip-siem-check"><input type="checkbox"> ADV Partners (Jira)</label>
                </div>
              </div>
            </div>

            <!-- IOC 6: APT41 Domain -->
            <div class="tip-ioc-card" id="tip-ioc-6">
              <div class="tip-ioc-card-header" onclick="tipToggleIoc('tip-ioc-6')">
                <span class="tip-ioc-badge tip-ioc-domain">DOMAIN</span>
                <span class="tip-ioc-value">cdn-static.azureedge-cdn[.]com</span>
                <span class="tip-ioc-actor">APT41</span>
                <span class="tip-vt-score tip-vt-orange">VT 33/70</span>
                <span class="tip-gn-badge tip-gn-unknown">unknown</span>
                <div class="tip-conf-wrap">
                  <div class="tip-conf-bar-bg"><div class="tip-conf-bar-fill tip-conf-med" style="width:68%"></div></div>
                  <span class="tip-conf-val">68%</span>
                </div>
                <div class="tip-ioc-actions">
                  <button class="tip-btn tip-btn-success tip-btn-xs" onclick="event.stopPropagation();tipApproveIoc('tip-ioc-6')">âœ“ Approve</button>
                  <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="event.stopPropagation();tipRejectIoc('tip-ioc-6')">âœ• Reject</button>
                </div>
              </div>
              <div class="tip-ioc-expanded" id="tip-ioc-6-exp">
                <div class="tip-ioc-meta-grid">
                  <div class="tip-meta-item"><label>Campaign</label><span>Double Dragon CDN Abuse</span></div>
                  <div class="tip-meta-item"><label>First Seen</label><span>2026-02-16</span></div>
                  <div class="tip-meta-item"><label>Last Seen</label><span>2026-02-27</span></div>
                  <div class="tip-meta-item"><label>Related IOCs</label><span style="color:#00d4ff;cursor:pointer">12 â†’</span></div>
                </div>
                <div class="tip-siem-select-label">Push to SIEMs on Approval</div>
                <div class="tip-siem-checkboxes">
                  <label class="tip-siem-check"><input type="checkbox" checked> Dacta Global (Elastic)</label>
                  <label class="tip-siem-check"><input type="checkbox"> SPMT (Sentinel)</label>
                  <label class="tip-siem-check"><input type="checkbox"> Global Advisor Co (Splunk)</label>
                  <label class="tip-siem-check"><input type="checkbox"> Naga World (Jira)</label>
                  <label class="tip-siem-check"><input type="checkbox"> ADV Partners (Jira)</label>
                </div>
              </div>
            </div>

            <!-- IOC 7: FIN7 Hash -->
            <div class="tip-ioc-card" id="tip-ioc-7">
              <div class="tip-ioc-card-header" onclick="tipToggleIoc('tip-ioc-7')">
                <span class="tip-ioc-badge tip-ioc-hash">HASH</span>
                <span class="tip-ioc-value">f7e2a1b8c9d3e4f5a6b7c8d3â€¦c8d3</span>
                <span class="tip-ioc-actor">FIN7</span>
                <span class="tip-vt-score tip-vt-red">VT 44/70</span>
                <span class="tip-gn-badge tip-gn-malicious">malicious</span>
                <div class="tip-conf-wrap">
                  <div class="tip-conf-bar-bg"><div class="tip-conf-bar-fill tip-conf-high" style="width:88%"></div></div>
                  <span class="tip-conf-val">88%</span>
                </div>
                <div class="tip-ioc-actions">
                  <button class="tip-btn tip-btn-success tip-btn-xs" onclick="event.stopPropagation();tipApproveIoc('tip-ioc-7')">âœ“ Approve</button>
                  <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="event.stopPropagation();tipRejectIoc('tip-ioc-7')">âœ• Reject</button>
                </div>
              </div>
              <div class="tip-ioc-expanded" id="tip-ioc-7-exp">
                <div class="tip-ioc-meta-grid">
                  <div class="tip-meta-item"><label>Campaign</label><span>PhishKit Carbanak-2026</span></div>
                  <div class="tip-meta-item"><label>First Seen</label><span>2026-02-22</span></div>
                  <div class="tip-meta-item"><label>Last Seen</label><span>2026-02-28</span></div>
                  <div class="tip-meta-item"><label>Related IOCs</label><span style="color:#00d4ff;cursor:pointer">17 â†’</span></div>
                </div>
                <div class="tip-siem-select-label">Push to SIEMs on Approval</div>
                <div class="tip-siem-checkboxes">
                  <label class="tip-siem-check"><input type="checkbox" checked> Dacta Global (Elastic)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> SPMT (Sentinel)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> Global Advisor Co (Splunk)</label>
                  <label class="tip-siem-check"><input type="checkbox"> Naga World (Jira)</label>
                  <label class="tip-siem-check"><input type="checkbox"> ADV Partners (Jira)</label>
                </div>
              </div>
            </div>

            <!-- IOC 8: Lazarus IP -->
            <div class="tip-ioc-card" id="tip-ioc-8">
              <div class="tip-ioc-card-header" onclick="tipToggleIoc('tip-ioc-8')">
                <span class="tip-ioc-badge tip-ioc-ip">IP</span>
                <span class="tip-ioc-value">203.176.48.112</span>
                <span class="tip-ioc-actor">Lazarus</span>
                <span class="tip-vt-score tip-vt-red">VT 56/70</span>
                <span class="tip-gn-badge tip-gn-malicious">malicious</span>
                <div class="tip-conf-wrap">
                  <div class="tip-conf-bar-bg"><div class="tip-conf-bar-fill tip-conf-high" style="width:96%"></div></div>
                  <span class="tip-conf-val">96%</span>
                </div>
                <div class="tip-ioc-actions">
                  <button class="tip-btn tip-btn-success tip-btn-xs" onclick="event.stopPropagation();tipApproveIoc('tip-ioc-8')">âœ“ Approve</button>
                  <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="event.stopPropagation();tipRejectIoc('tip-ioc-8')">âœ• Reject</button>
                </div>
              </div>
              <div class="tip-ioc-expanded" id="tip-ioc-8-exp">
                <div class="tip-ioc-meta-grid">
                  <div class="tip-meta-item"><label>Campaign</label><span>AppleJeus Variant-Q1</span></div>
                  <div class="tip-meta-item"><label>First Seen</label><span>2026-02-27</span></div>
                  <div class="tip-meta-item"><label>Last Seen</label><span>2026-02-28</span></div>
                  <div class="tip-meta-item"><label>Related IOCs</label><span style="color:#00d4ff;cursor:pointer">62 â†’</span></div>
                </div>
                <div class="tip-siem-select-label">Push to SIEMs on Approval</div>
                <div class="tip-siem-checkboxes">
                  <label class="tip-siem-check"><input type="checkbox" checked> Dacta Global (Elastic)</label>
                  <label class="tip-siem-check"><input type="checkbox"> SPMT (Sentinel)</label>
                  <label class="tip-siem-check"><input type="checkbox"> Global Advisor Co (Splunk)</label>
                  <label class="tip-siem-check"><input type="checkbox" checked> Naga World (Jira)</label>
                  <label class="tip-siem-check"><input type="checkbox"> ADV Partners (Jira)</label>
                </div>
              </div>
            </div>

          </div><!-- end ioc queue -->
        </div><!-- end IOC Triage panel -->

        <!-- Sightings & Feedback Loop -->
        <div class="tip-panel">
          <div class="tip-panel-header">
            <div class="tip-panel-title">
              <span class="tip-panel-title-icon">ðŸ‘</span>
              Sightings &amp; Feedback Loop
              <span class="tip-badge-count">23 logged</span>
            </div>
            <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipToggleSightingForm()">+ Log Sighting</button>
          </div>
          <div class="tip-panel-body">
            <!-- Log Sighting Form -->
            <div class="tip-sighting-form" id="tip-sighting-form">
              <div class="tip-form-row">
                <div class="tip-form-group">
                  <label>IOC Value</label>
                  <input type="text" class="tip-form-input" placeholder="Enter IP, domain, hash, or URL..." id="tip-sight-ioc-val">
                </div>
                <div class="tip-form-group">
                  <label>Type</label>
                  <select class="tip-form-select">
                    <option>TRUE_POSITIVE</option>
                    <option>FALSE_POSITIVE</option>
                  </select>
                </div>
              </div>
              <div class="tip-form-row">
                <div class="tip-form-group">
                  <label>Client</label>
                  <select class="tip-form-select">
                    <option>Dacta Global</option>
                    <option>SPMT</option>
                    <option>Global Advisor Co</option>
                    <option>Naga World</option>
                    <option>ADV Partners</option>
                  </select>
                </div>
                <div class="tip-form-group">
                  <label>Link to Campaign (optional)</label>
                  <input type="text" class="tip-form-input" placeholder="Campaign name or ID...">
                </div>
              </div>
              <div style="display:flex;gap:8px;justify-content:flex-end;">
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToggleSightingForm()">Cancel</button>
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipSubmitSighting()">Submit Sighting</button>
              </div>
            </div>

            <!-- Recent Sightings List -->
            <div class="tip-sighting-row">
              <span class="tip-sight-tp">TRUE_POSITIVE</span>
              <span class="tip-sight-ioc">185.220.101.34</span>
              <span class="tip-sight-client">Dacta Global</span>
              <span class="tip-sight-analyst">analyst.wong</span>
              <span class="tip-sight-time">12m ago</span>
            </div>
            <div class="tip-sighting-row">
              <span class="tip-sight-tp">TRUE_POSITIVE</span>
              <span class="tip-sight-ioc">login-verify.microsoft-365[.]club</span>
              <span class="tip-sight-client">SPMT</span>
              <span class="tip-sight-analyst">analyst.chen</span>
              <span class="tip-sight-time">34m ago</span>
            </div>
            <div class="tip-sighting-row">
              <span class="tip-sight-fp">FALSE_POSITIVE</span>
              <span class="tip-sight-ioc">91.234.99.87</span>
              <span class="tip-sight-client">Global Advisor Co</span>
              <span class="tip-sight-analyst">analyst.lee</span>
              <span class="tip-sight-time">1h 12m ago</span>
            </div>
            <div class="tip-sighting-row">
              <span class="tip-sight-tp">TRUE_POSITIVE</span>
              <span class="tip-sight-ioc">203.176.48.112</span>
              <span class="tip-sight-client">Naga World</span>
              <span class="tip-sight-analyst">analyst.wong</span>
              <span class="tip-sight-time">2h 5m ago</span>
            </div>
            <div class="tip-sighting-row">
              <span class="tip-sight-tp">TRUE_POSITIVE</span>
              <span class="tip-sight-ioc">a3b9c8d7e6f5â€¦ef12</span>
              <span class="tip-sight-client">Dacta Global</span>
              <span class="tip-sight-analyst">analyst.tan</span>
              <span class="tip-sight-time">3h 44m ago</span>
            </div>
            <div class="tip-sighting-row">
              <span class="tip-sight-fp">FALSE_POSITIVE</span>
              <span class="tip-sight-ioc">cdn-static.azureedge-cdn[.]com</span>
              <span class="tip-sight-client">SPMT</span>
              <span class="tip-sight-analyst">analyst.chen</span>
              <span class="tip-sight-time">5h 20m ago</span>
            </div>
            <div class="tip-sighting-row">
              <span class="tip-sight-tp">TRUE_POSITIVE</span>
              <span class="tip-sight-ioc">hxxps://update-service[.]net/payload.exe</span>
              <span class="tip-sight-client">ADV Partners</span>
              <span class="tip-sight-analyst">analyst.lee</span>
              <span class="tip-sight-time">6h 03m ago</span>
            </div>
            <div class="tip-sighting-row">
              <span class="tip-sight-tp">TRUE_POSITIVE</span>
              <span class="tip-sight-ioc">f7e2a1b8c9d3â€¦c8d3</span>
              <span class="tip-sight-client">Dacta Global</span>
              <span class="tip-sight-analyst">analyst.tan</span>
              <span class="tip-sight-time">8h 15m ago</span>
            </div>

            <div class="tip-footer-note">
              â“˜ TRUE_POSITIVE sightings add +8 confidence points Â· FALSE_POSITIVE sightings apply -12 points Â· Synced to DACTA TIP every 60s
            </div>
          </div>
        </div>

        <!-- Hunt Hypothesis Generator -->
        <div class="tip-panel" style="grid-column: 1 / -1;">
          <div class="tip-panel-header">
            <div class="tip-panel-title">
              <span class="tip-panel-title-icon">ðŸŽ¯</span>
              Hunt Hypothesis Generator
              <span style="font-size:11px;color:#64748b;font-weight:400;">â€” Scoped to client sector, region &amp; asset inventory</span>
            </div>
            <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸ”„','Regenerating hypotheses from DACTA TIP...')">â†» Regenerate</button>
          </div>
          <div class="tip-panel-body" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(480px,1fr));gap:12px;">

            <!-- Hypothesis 1 -->
            <div class="tip-hunt-card">
              <div class="tip-hunt-top">
                <span class="tip-priority-badge tip-prio-critical">CRITICAL</span>
                <div>
                  <div class="tip-hunt-technique">T1566.001</div>
                  <div class="tip-hunt-name">Spearphishing Attachment</div>
                </div>
              </div>
              <div class="tip-hunt-meta">
                <div class="tip-hunt-meta-item">Tactic: <span>Initial Access</span></div>
                <div class="tip-hunt-meta-item">Actor: <span>APT29, FIN7</span></div>
              </div>
              <div class="tip-hunt-query"><span class="kw">index</span>=* <span class="kw">sourcetype</span>=email_logs
<span class="op">|</span> <span class="kw">where</span> attachment_type IN (<span class="str">"exe"</span>, <span class="str">"js"</span>, <span class="str">"vbs"</span>, <span class="str">"lnk"</span>)
<span class="op">|</span> <span class="kw">stats</span> count BY sender, recipient, attachment_name
<span class="op">|</span> <span class="kw">where</span> count &gt; 0</div>
              <div class="tip-hunt-footer">
                <span style="font-size:10px;color:#64748b;">Platform: SPL (Splunk)</span>
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipOpenHuntScheduler('Spearphishing Attachment')">ðŸš€ Push to Hunting</button>
              </div>
            </div>

            <!-- Hypothesis 2 -->
            <div class="tip-hunt-card">
              <div class="tip-hunt-top">
                <span class="tip-priority-badge tip-prio-critical">CRITICAL</span>
                <div>
                  <div class="tip-hunt-technique">T1055.001</div>
                  <div class="tip-hunt-name">Process Injection: DLL Injection</div>
                </div>
              </div>
              <div class="tip-hunt-meta">
                <div class="tip-hunt-meta-item">Tactic: <span>Defense Evasion</span></div>
                <div class="tip-hunt-meta-item">Actor: <span>Lazarus Group</span></div>
              </div>
              <div class="tip-hunt-query"><span class="kw">event.type</span>:<span class="str">"process"</span> <span class="op">AND</span>
process.name:<span class="str">"rundll32.exe"</span> <span class="op">AND</span>
<span class="op">NOT</span> process.parent.name:(<span class="str">"explorer.exe"</span> <span class="op">OR</span> <span class="str">"svchost.exe"</span>)
<span class="op">|</span> <span class="kw">stats</span> count, values(host.name) <span class="kw">BY</span> process.parent.name</div>
              <div class="tip-hunt-footer">
                <span style="font-size:10px;color:#64748b;">Platform: KQL (Sentinel)</span>
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipOpenHuntScheduler('Process Injection: DLL Injection')">ðŸš€ Push to Hunting</button>
              </div>
            </div>

            <!-- Hypothesis 3 -->
            <div class="tip-hunt-card">
              <div class="tip-hunt-top">
                <span class="tip-priority-badge tip-prio-high">HIGH</span>
                <div>
                  <div class="tip-hunt-technique">T1486</div>
                  <div class="tip-hunt-name">Data Encrypted for Impact</div>
                </div>
              </div>
              <div class="tip-hunt-meta">
                <div class="tip-hunt-meta-item">Tactic: <span>Impact</span></div>
                <div class="tip-hunt-meta-item">Actor: <span>ALPHV/BlackCat</span></div>
              </div>
              <div class="tip-hunt-query"><span class="kw">SELECT</span> *
<span class="kw">FROM</span> file_events
<span class="kw">WHERE</span> extension_changed = <span class="str">true</span>
  <span class="kw">AND</span> new_extension <span class="op">NOT IN</span> (whitelist_extensions)
  <span class="kw">AND</span> event_time &gt; now() - <span class="str">INTERVAL 1 HOUR</span>
<span class="kw">GROUP BY</span> hostname <span class="kw">HAVING</span> count(*) &gt; 50</div>
              <div class="tip-hunt-footer">
                <span style="font-size:10px;color:#64748b;">Platform: VQL (Velociraptor)</span>
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipOpenHuntScheduler('Data Encrypted for Impact')">ðŸš€ Push to Hunting</button>
              </div>
            </div>

            <!-- Hypothesis 4 -->
            <div class="tip-hunt-card">
              <div class="tip-hunt-top">
                <span class="tip-priority-badge tip-prio-high">HIGH</span>
                <div>
                  <div class="tip-hunt-technique">T1078.002</div>
                  <div class="tip-hunt-name">Valid Accounts: Domain Accounts</div>
                </div>
              </div>
              <div class="tip-hunt-meta">
                <div class="tip-hunt-meta-item">Tactic: <span>Persistence</span></div>
                <div class="tip-hunt-meta-item">Actor: <span>APT29, Sandworm</span></div>
              </div>
              <div class="tip-hunt-query"><span class="kw">DeviceLogonEvents</span>
<span class="op">|</span> <span class="kw">where</span> LogonType == <span class="str">"Network"</span>
    <span class="op">and</span> AccountDomain != <span class="str">"WORKGROUP"</span>
    <span class="op">and</span> RemoteIPType == <span class="str">"Public"</span>
<span class="op">|</span> <span class="kw">summarize</span> count() <span class="kw">by</span> AccountName, RemoteIP, bin(Timestamp, 1h)</div>
              <div class="tip-hunt-footer">
                <span style="font-size:10px;color:#64748b;">Platform: KQL (Sentinel)</span>
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipOpenHuntScheduler('Valid Accounts: Domain Accounts')">ðŸš€ Push to Hunting</button>
              </div>
            </div>

            <!-- Hypothesis 5 -->
            <div class="tip-hunt-card">
              <div class="tip-hunt-top">
                <span class="tip-priority-badge tip-prio-medium">MEDIUM</span>
                <div>
                  <div class="tip-hunt-technique">T1071.001</div>
                  <div class="tip-hunt-name">Application Layer Protocol: Web</div>
                </div>
              </div>
              <div class="tip-hunt-meta">
                <div class="tip-hunt-meta-item">Tactic: <span>C2</span></div>
                <div class="tip-hunt-meta-item">Actor: <span>APT41</span></div>
              </div>
              <div class="tip-hunt-query"><span class="kw">index</span>=proxy_logs
<span class="op">|</span> <span class="kw">eval</span> beacon_interval=<span class="kw">round</span>(avg(_time))
<span class="op">|</span> <span class="kw">stats</span> stdev(beacon_interval) AS jitter, count BY src_ip, dest_domain
<span class="op">|</span> <span class="kw">where</span> jitter &lt; 5 <span class="op">AND</span> count &gt; 20
<span class="op">|</span> <span class="kw">sort</span> - count</div>
              <div class="tip-hunt-footer">
                <span style="font-size:10px;color:#64748b;">Platform: SPL (Splunk)</span>
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipOpenHuntScheduler('Application Layer Protocol: Web')">ðŸš€ Push to Hunting</button>
              </div>
            </div>

            <!-- Hypothesis 6 â€” ASSET-CONTEXT: Cisco CVE -->
            <div class="tip-hunt-card" style="border-color:rgba(249,115,22,0.3);">
              <div class="tip-hunt-top">
                <span class="tip-priority-badge tip-prio-critical">CRITICAL</span>
                <div>
                  <div class="tip-hunt-technique">CVE-2024-20353</div>
                  <div class="tip-hunt-name">Cisco ASA / FTD â€” ArcaneDoor WebVPN Exploit</div>
                </div>
              </div>
              <div class="tip-hunt-meta">
                <div class="tip-hunt-meta-item">Tactic: <span>Initial Access (T1190)</span></div>
                <div class="tip-hunt-meta-item">Actor: <span>UAT4356 (Storm-1849)</span></div>
                <div class="tip-hunt-meta-item" style="margin-top:4px;">
                  <span style="color:#f97316;">âš  Asset Match:</span>
                  <span style="color:#e8edf5;">3 x Cisco ASA 5506-X (v9.16.3) â€” Dacta Global perimeter</span>
                </div>
                <div class="tip-hunt-meta-item">
                  <span style="color:#f97316;">âš  Vuln Status:</span>
                  <span style="color:#ef4444;">UNPATCHED â€” last scan 2026-02-27</span>
                </div>
              </div>
              <div class="tip-hunt-query"><span class="kw">index</span>=firewall_logs sourcetype=cisco:asa
<span class="op">|</span> <span class="kw">search</span> (uri=<span class="str">"/+CSCOE+/session_password.html"</span> OR uri=<span class="str">"/+CSCOE+/logon.html"</span>)
<span class="op">|</span> <span class="kw">stats</span> count BY src_ip, dest_ip, uri, _time
<span class="op">|</span> <span class="kw">where</span> count &gt; 5
<span class="op">|</span> <span class="kw">sort</span> - count</div>
              <div class="tip-hunt-footer">
                <span style="font-size:10px;color:#f97316;font-weight:600;">ðŸ”§ Source: Asset Inventory + NVD</span>
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipOpenHuntScheduler('Cisco ASA / FTD â€” ArcaneDoor WebVPN Exploit')">ðŸš€ Push to Hunting</button>
              </div>
            </div>

            <!-- Hypothesis 7 â€” ASSET-CONTEXT: FortiGate CVE -->
            <div class="tip-hunt-card" style="border-color:rgba(249,115,22,0.3);">
              <div class="tip-hunt-top">
                <span class="tip-priority-badge tip-prio-high">HIGH</span>
                <div>
                  <div class="tip-hunt-technique">CVE-2024-21762</div>
                  <div class="tip-hunt-name">Fortinet FortiOS â€” Out-of-Bounds Write (SSL VPN)</div>
                </div>
              </div>
              <div class="tip-hunt-meta">
                <div class="tip-hunt-meta-item">Tactic: <span>Initial Access (T1190)</span></div>
                <div class="tip-hunt-meta-item">Actor: <span>Sandworm, APT28</span></div>
                <div class="tip-hunt-meta-item" style="margin-top:4px;">
                  <span style="color:#f97316;">âš  Asset Match:</span>
                  <span style="color:#e8edf5;">2 x FortiGate 60F (v7.2.5) â€” SPMT branch offices</span>
                </div>
                <div class="tip-hunt-meta-item">
                  <span style="color:#f97316;">âš  Vuln Status:</span>
                  <span style="color:#f59e0b;">PATCH PENDING â€” scheduled 2026-03-05</span>
                </div>
              </div>
              <div class="tip-hunt-query"><span class="kw">event.type</span>:<span class="str">"network"</span> <span class="op">AND</span>
<span class="kw">destination.port</span>:<span class="str">443</span> <span class="op">AND</span>
<span class="kw">url.path</span>:(<span class="str">"/remote/logincheck"</span> <span class="op">OR</span> <span class="str">"/remote/hostcheck_validate"</span>)
<span class="op">|</span> <span class="kw">where</span> source.geo.country_iso_code != <span class="str">"SG"</span>
<span class="op">|</span> <span class="kw">stats</span> count <span class="kw">BY</span> source.ip, destination.ip</div>
              <div class="tip-hunt-footer">
                <span style="font-size:10px;color:#f97316;font-weight:600;">ðŸ”§ Source: Asset Inventory + NVD</span>
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipOpenHuntScheduler('Fortinet FortiOS â€” Out-of-Bounds Write (SSL VPN)')">ðŸš€ Push to Hunting</button>
              </div>
            </div>

          </div><!-- end hunt grid -->
        </div><!-- end hunt panel -->

      </div><!-- end ops grid -->
    </div><!-- end ops tab -->

    <!-- ===================================
         TAB 2: ACTORS & CAMPAIGNS
         =================================== -->
    <div class="tip-tab-panel" id="tip-panel-actors">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px;">
        <div>
          <div style="font-family:'Sora',sans-serif;font-size:16px;font-weight:700;color:#e8edf5;">Threat Actor Watchlist</div>
          <div style="font-size:12px;color:#64748b;margin-top:3px;">6 actors tracked Â· Updated in real-time from DACTA TIP</div>
        </div>
        <button class="tip-btn tip-btn-primary" onclick="document.getElementById('tip-add-actor-modal').classList.add('open')">+ Add Actor</button>
      </div>

      <div class="tip-actor-grid">

        <!-- APT29 -->
        <div class="tip-actor-card" id="tip-actor-apt29">
          <div class="tip-actor-header" onclick="tipToggleActor('tip-actor-apt29')">
            <div class="tip-live-dot red"></div>
            <div class="tip-actor-name-wrap">
              <div style="display:flex;align-items:center;gap:8px;">
                <div class="tip-actor-name">APT29</div>
                <span class="tip-tag tip-tag-critical">CRITICAL</span>
                <span class="tip-trending-badge">â†‘ TRENDING</span>
              </div>
              <div class="tip-actor-alias">Cozy Bear Â· Midnight Blizzard</div>
              <div class="tip-actor-origin">ðŸ‡·ðŸ‡º Russia Â· Espionage</div>
            </div>
            <div style="text-align:right;flex-shrink:0;">
              <div class="tip-actor-stats">
                <div class="tip-stat-item">
                  <div class="tip-stat-val cyan">12</div>
                  <div class="tip-stat-label">New IOCs 24h</div>
                </div>
                <div class="tip-stat-item">
                  <div class="tip-stat-val orange">3</div>
                  <div class="tip-stat-label">New TTPs 7d</div>
                </div>
              </div>
              <div class="tip-actor-last-update">Updated 23m ago</div>
            </div>
          </div>
          <div class="tip-actor-body" id="tip-actor-apt29-body">
            <div class="tip-actor-expand">
              <div class="tip-actor-section-label">Target Sectors</div>
              <div class="tip-sector-tags">
                <span class="tip-sector-tag">Government</span>
                <span class="tip-sector-tag">Financial Services</span>
                <span class="tip-sector-tag">Defence</span>
                <span class="tip-sector-tag">Think Tanks</span>
              </div>
              <div class="tip-actor-section-label">Affected DACTA Clients</div>
              <div class="tip-affected-clients">
                <span class="tip-client-chip">Dacta Global</span>
                <span class="tip-client-chip">SPMT</span>
                <span class="tip-client-chip">Global Advisor Co</span>
              </div>
              <div class="tip-actor-quick-actions">
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipToast('ðŸ“¡','APT29 IOCs queued for SIEM push')">ðŸ“¡ Push IOCs</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸŽ¯','Hunt job created for APT29 TTPs')">ðŸŽ¯ Hunt</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="switchTiTab('report');tipToast('ðŸ“„','Report Builder pre-populated with APT29 context')">ðŸ“„ Brief</button>
                <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="tipToast('ðŸ—‘','APT29 removed from watchlist')">Remove</button>
              </div>
              <div class="tip-actor-section-label">Recent Campaigns</div>
              <div class="tip-campaigns-list">
                <div class="tip-campaign-row"><span class="tip-campaign-name">Operation Midnight Snow</span><span class="tip-campaign-iocs">43 IOCs</span><span class="tip-campaign-date">Jan 2026 â€“ present</span></div>
                <div class="tip-campaign-row"><span class="tip-campaign-name">SolarFlare Credential Harvest</span><span class="tip-campaign-iocs">28 IOCs</span><span class="tip-campaign-date">Nov 2025 â€“ Jan 2026</span></div>
                <div class="tip-campaign-row"><span class="tip-campaign-name">Diplomatic Phish Wave</span><span class="tip-campaign-iocs">15 IOCs</span><span class="tip-campaign-date">Oct 2025</span></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Lazarus -->
        <div class="tip-actor-card" id="tip-actor-lazarus">
          <div class="tip-actor-header" onclick="tipToggleActor('tip-actor-lazarus')">
            <div class="tip-live-dot orange"></div>
            <div class="tip-actor-name-wrap">
              <div style="display:flex;align-items:center;gap:8px;">
                <div class="tip-actor-name">Lazarus Group</div>
                <span class="tip-tag tip-tag-high">HIGH</span>
              </div>
              <div class="tip-actor-alias">Hidden Cobra Â· ZINC</div>
              <div class="tip-actor-origin">ðŸ‡°ðŸ‡µ North Korea Â· Financial / Crypto</div>
            </div>
            <div style="text-align:right;flex-shrink:0;">
              <div class="tip-actor-stats">
                <div class="tip-stat-item">
                  <div class="tip-stat-val cyan">8</div>
                  <div class="tip-stat-label">New IOCs 24h</div>
                </div>
                <div class="tip-stat-item">
                  <div class="tip-stat-val orange">1</div>
                  <div class="tip-stat-label">New TTPs 7d</div>
                </div>
              </div>
              <div class="tip-actor-last-update">Updated 1h 4m ago</div>
            </div>
          </div>
          <div class="tip-actor-body" id="tip-actor-lazarus-body">
            <div class="tip-actor-expand">
              <div class="tip-actor-section-label">Target Sectors</div>
              <div class="tip-sector-tags">
                <span class="tip-sector-tag">Financial Services</span>
                <span class="tip-sector-tag">Cryptocurrency</span>
                <span class="tip-sector-tag">DeFi</span>
                <span class="tip-sector-tag">Gaming</span>
              </div>
              <div class="tip-actor-section-label">Affected DACTA Clients</div>
              <div class="tip-affected-clients">
                <span class="tip-client-chip">Dacta Global</span>
                <span class="tip-client-chip">Naga World</span>
              </div>
              <div class="tip-actor-quick-actions">
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipToast('ðŸ“¡','Lazarus IOCs queued for SIEM push')">ðŸ“¡ Push IOCs</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸŽ¯','Hunt job created for Lazarus TTPs')">ðŸŽ¯ Hunt</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸ“„','Report Builder pre-populated')">ðŸ“„ Brief</button>
                <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="tipToast('ðŸ—‘','Lazarus removed from watchlist')">Remove</button>
              </div>
              <div class="tip-actor-section-label">Recent Campaigns</div>
              <div class="tip-campaigns-list">
                <div class="tip-campaign-row"><span class="tip-campaign-name">AppleJeus Variant-Q1</span><span class="tip-campaign-iocs">62 IOCs</span><span class="tip-campaign-date">Feb 2026 â€“ present</span></div>
                <div class="tip-campaign-row"><span class="tip-campaign-name">TraderTraitor Exchange Attack</span><span class="tip-campaign-iocs">34 IOCs</span><span class="tip-campaign-date">Dec 2025 â€“ Feb 2026</span></div>
              </div>
            </div>
          </div>
        </div>

        <!-- FIN7 -->
        <div class="tip-actor-card" id="tip-actor-fin7">
          <div class="tip-actor-header" onclick="tipToggleActor('tip-actor-fin7')">
            <div class="tip-live-dot orange"></div>
            <div class="tip-actor-name-wrap">
              <div style="display:flex;align-items:center;gap:8px;">
                <div class="tip-actor-name">FIN7</div>
                <span class="tip-tag tip-tag-high">HIGH</span>
                <span class="tip-trending-badge">â†‘ TRENDING</span>
              </div>
              <div class="tip-actor-alias">Carbanak Group Â· NAVIGATOR</div>
              <div class="tip-actor-origin">ðŸ‡·ðŸ‡º Russia Â· Financial Crime</div>
            </div>
            <div style="text-align:right;flex-shrink:0;">
              <div class="tip-actor-stats">
                <div class="tip-stat-item">
                  <div class="tip-stat-val red">15</div>
                  <div class="tip-stat-label">New IOCs 24h</div>
                </div>
                <div class="tip-stat-item">
                  <div class="tip-stat-val orange">2</div>
                  <div class="tip-stat-label">New TTPs 7d</div>
                </div>
              </div>
              <div class="tip-actor-last-update">Updated 45m ago</div>
            </div>
          </div>
          <div class="tip-actor-body" id="tip-actor-fin7-body">
            <div class="tip-actor-expand">
              <div class="tip-actor-section-label">Target Sectors</div>
              <div class="tip-sector-tags">
                <span class="tip-sector-tag">Hospitality</span>
                <span class="tip-sector-tag">Retail</span>
                <span class="tip-sector-tag">Financial Services</span>
                <span class="tip-sector-tag">Restaurant Chains</span>
              </div>
              <div class="tip-actor-section-label">Affected DACTA Clients</div>
              <div class="tip-affected-clients">
                <span class="tip-client-chip">Naga World</span>
                <span class="tip-client-chip">SPMT</span>
              </div>
              <div class="tip-actor-quick-actions">
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipToast('ðŸ“¡','FIN7 IOCs queued for SIEM push')">ðŸ“¡ Push IOCs</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸŽ¯','Hunt job created for FIN7 TTPs')">ðŸŽ¯ Hunt</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸ“„','Report Builder pre-populated')">ðŸ“„ Brief</button>
                <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="tipToast('ðŸ—‘','FIN7 removed from watchlist')">Remove</button>
              </div>
              <div class="tip-actor-section-label">Recent Campaigns</div>
              <div class="tip-campaigns-list">
                <div class="tip-campaign-row"><span class="tip-campaign-name">PhishKit Carbanak-2026</span><span class="tip-campaign-iocs">17 IOCs</span><span class="tip-campaign-date">Feb 2026 â€“ present</span></div>
                <div class="tip-campaign-row"><span class="tip-campaign-name">POS Skimmer Update Q1</span><span class="tip-campaign-iocs">11 IOCs</span><span class="tip-campaign-date">Jan â€“ Feb 2026</span></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Sandworm -->
        <div class="tip-actor-card" id="tip-actor-sandworm">
          <div class="tip-actor-header" onclick="tipToggleActor('tip-actor-sandworm')">
            <div class="tip-live-dot red"></div>
            <div class="tip-actor-name-wrap">
              <div style="display:flex;align-items:center;gap:8px;">
                <div class="tip-actor-name">Sandworm</div>
                <span class="tip-tag tip-tag-critical">CRITICAL</span>
              </div>
              <div class="tip-actor-alias">Voodoo Bear Â· BlackEnergy</div>
              <div class="tip-actor-origin">ðŸ‡·ðŸ‡º Russia Â· Sabotage / ICS</div>
            </div>
            <div style="text-align:right;flex-shrink:0;">
              <div class="tip-actor-stats">
                <div class="tip-stat-item">
                  <div class="tip-stat-val cyan">5</div>
                  <div class="tip-stat-label">New IOCs 24h</div>
                </div>
                <div class="tip-stat-item">
                  <div class="tip-stat-val red">4</div>
                  <div class="tip-stat-label">New TTPs 7d</div>
                </div>
              </div>
              <div class="tip-actor-last-update">Updated 2h 18m ago</div>
            </div>
          </div>
          <div class="tip-actor-body" id="tip-actor-sandworm-body">
            <div class="tip-actor-expand">
              <div class="tip-actor-section-label">Target Sectors</div>
              <div class="tip-sector-tags">
                <span class="tip-sector-tag">Energy / Utilities</span>
                <span class="tip-sector-tag">Critical Infrastructure</span>
                <span class="tip-sector-tag">Government</span>
                <span class="tip-sector-tag">Transport</span>
              </div>
              <div class="tip-actor-section-label">Affected DACTA Clients</div>
              <div class="tip-affected-clients">
                <span style="font-size:11px;color:#64748b;font-style:italic">Low direct exposure â€” monitoring for sector cross-contamination</span>
              </div>
              <div class="tip-actor-quick-actions">
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipToast('ðŸ“¡','Sandworm IOCs queued for SIEM push')">ðŸ“¡ Push IOCs</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸŽ¯','Hunt job created for Sandworm TTPs')">ðŸŽ¯ Hunt</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸ“„','Report Builder pre-populated')">ðŸ“„ Brief</button>
                <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="tipToast('ðŸ—‘','Sandworm removed from watchlist')">Remove</button>
              </div>
              <div class="tip-actor-section-label">Recent Campaigns</div>
              <div class="tip-campaigns-list">
                <div class="tip-campaign-row"><span class="tip-campaign-name">Industroyer-3 Probes</span><span class="tip-campaign-iocs">8 IOCs</span><span class="tip-campaign-date">Feb 2026</span></div>
                <div class="tip-campaign-row"><span class="tip-campaign-name">AcidPour APAC Targeting</span><span class="tip-campaign-iocs">22 IOCs</span><span class="tip-campaign-date">Dec 2025 â€“ Feb 2026</span></div>
              </div>
            </div>
          </div>
        </div>

        <!-- APT41 -->
        <div class="tip-actor-card" id="tip-actor-apt41">
          <div class="tip-actor-header" onclick="tipToggleActor('tip-actor-apt41')">
            <div class="tip-live-dot yellow"></div>
            <div class="tip-actor-name-wrap">
              <div style="display:flex;align-items:center;gap:8px;">
                <div class="tip-actor-name">APT41</div>
                <span class="tip-tag tip-tag-medium">MEDIUM</span>
              </div>
              <div class="tip-actor-alias">Winnti Â· Double Dragon</div>
              <div class="tip-actor-origin">ðŸ‡¨ðŸ‡³ China Â· Espionage / Financial</div>
            </div>
            <div style="text-align:right;flex-shrink:0;">
              <div class="tip-actor-stats">
                <div class="tip-stat-item">
                  <div class="tip-stat-val cyan">3</div>
                  <div class="tip-stat-label">New IOCs 24h</div>
                </div>
                <div class="tip-stat-item">
                  <div class="tip-stat-val" style="color:#64748b">0</div>
                  <div class="tip-stat-label">New TTPs 7d</div>
                </div>
              </div>
              <div class="tip-actor-last-update">Updated 4h 32m ago</div>
            </div>
          </div>
          <div class="tip-actor-body" id="tip-actor-apt41-body">
            <div class="tip-actor-expand">
              <div class="tip-actor-section-label">Target Sectors</div>
              <div class="tip-sector-tags">
                <span class="tip-sector-tag">Healthcare</span>
                <span class="tip-sector-tag">Technology</span>
                <span class="tip-sector-tag">Telecoms</span>
                <span class="tip-sector-tag">Gaming</span>
                <span class="tip-sector-tag">Financial Services</span>
              </div>
              <div class="tip-actor-section-label">Affected DACTA Clients</div>
              <div class="tip-affected-clients">
                <span class="tip-client-chip">Dacta Global</span>
                <span class="tip-client-chip">Global Advisor Co</span>
              </div>
              <div class="tip-actor-quick-actions">
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipToast('ðŸ“¡','APT41 IOCs queued for SIEM push')">ðŸ“¡ Push IOCs</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸŽ¯','Hunt job created for APT41 TTPs')">ðŸŽ¯ Hunt</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸ“„','Report Builder pre-populated')">ðŸ“„ Brief</button>
                <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="tipToast('ðŸ—‘','APT41 removed from watchlist')">Remove</button>
              </div>
              <div class="tip-actor-section-label">Recent Campaigns</div>
              <div class="tip-campaigns-list">
                <div class="tip-campaign-row"><span class="tip-campaign-name">Double Dragon CDN Abuse</span><span class="tip-campaign-iocs">12 IOCs</span><span class="tip-campaign-date">Feb 2026</span></div>
              </div>
            </div>
          </div>
        </div>

        <!-- ALPHV/BlackCat -->
        <div class="tip-actor-card" id="tip-actor-alphv">
          <div class="tip-actor-header" onclick="tipToggleActor('tip-actor-alphv')">
            <div class="tip-live-dot orange"></div>
            <div class="tip-actor-name-wrap">
              <div style="display:flex;align-items:center;gap:8px;">
                <div class="tip-actor-name">ALPHV / BlackCat</div>
                <span class="tip-tag tip-tag-high">HIGH</span>
                <span class="tip-trending-badge">â†‘ TRENDING</span>
              </div>
              <div class="tip-actor-alias">Noberus Â· Scattered Canary</div>
              <div class="tip-actor-origin">ðŸŒ Unknown Â· Ransomware-as-a-Service</div>
            </div>
            <div style="text-align:right;flex-shrink:0;">
              <div class="tip-actor-stats">
                <div class="tip-stat-item">
                  <div class="tip-stat-val red">20</div>
                  <div class="tip-stat-label">New IOCs 24h</div>
                </div>
                <div class="tip-stat-item">
                  <div class="tip-stat-val orange">1</div>
                  <div class="tip-stat-label">New TTPs 7d</div>
                </div>
              </div>
              <div class="tip-actor-last-update">Updated 18m ago</div>
            </div>
          </div>
          <div class="tip-actor-body" id="tip-actor-alphv-body">
            <div class="tip-actor-expand">
              <div class="tip-actor-section-label">Target Sectors</div>
              <div class="tip-sector-tags">
                <span class="tip-sector-tag">Healthcare</span>
                <span class="tip-sector-tag">Financial Services</span>
                <span class="tip-sector-tag">Legal</span>
                <span class="tip-sector-tag">Hospitality</span>
                <span class="tip-sector-tag">Critical Infrastructure</span>
              </div>
              <div class="tip-actor-section-label">Affected DACTA Clients</div>
              <div class="tip-affected-clients">
                <span class="tip-client-chip">Dacta Global</span>
                <span class="tip-client-chip">SPMT</span>
                <span class="tip-client-chip">Global Advisor Co</span>
                <span class="tip-client-chip">Naga World</span>
                <span class="tip-client-chip">ADV Partners</span>
              </div>
              <div class="tip-actor-quick-actions">
                <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipToast('ðŸ“¡','ALPHV IOCs queued for all-client SIEM push')">ðŸ“¡ Push IOCs</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸŽ¯','Hunt job created for ALPHV TTPs')">ðŸŽ¯ Hunt</button>
                <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸ“„','Report Builder pre-populated')">ðŸ“„ Brief</button>
                <button class="tip-btn tip-btn-danger tip-btn-xs" onclick="tipToast('ðŸ—‘','ALPHV removed from watchlist')">Remove</button>
              </div>
              <div class="tip-actor-section-label">Recent Campaigns</div>
              <div class="tip-campaigns-list">
                <div class="tip-campaign-row"><span class="tip-campaign-name">BlackCat Ransom Wave 6</span><span class="tip-campaign-iocs">29 IOCs</span><span class="tip-campaign-date">Feb 2026 â€“ present</span></div>
                <div class="tip-campaign-row"><span class="tip-campaign-name">Healthcare Extortion Series</span><span class="tip-campaign-iocs">41 IOCs</span><span class="tip-campaign-date">Jan â€“ Feb 2026</span></div>
                <div class="tip-campaign-row"><span class="tip-campaign-name">APAC Ransomware Sweep</span><span class="tip-campaign-iocs">18 IOCs</span><span class="tip-campaign-date">Dec 2025</span></div>
              </div>
            </div>
          </div>
        </div>

      </div><!-- end actor grid -->
    </div><!-- end actors tab -->

    <!-- ===================================
         TAB 3: ATT&CK COVERAGE
         =================================== -->
    <div class="tip-tab-panel" id="tip-panel-attack">
      <div class="tip-attack-header">
        <div>
          <div style="font-family:'Sora',sans-serif;font-size:16px;font-weight:700;color:#e8edf5;">MITRE ATT&amp;CK Coverage Heatmap</div>
          <div style="font-size:12px;color:#64748b;margin-top:3px;" id="tip-attack-scope">Scoped to: Dacta Global Â· Financial Services Â· APAC</div>
        </div>
        <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
          <div class="tip-attack-legend">
            <span class="tip-legend-label">Low</span>
            <div class="tip-legend-scale"></div>
            <span class="tip-legend-label">Critical</span>
          </div>
          <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipExportNavigator()">â†“ Export Navigator</button>
        </div>
      </div>

      <div class="tip-panel" style="padding:16px;">
        <div class="tip-attack-container">
          <div class="tip-attack-grid" id="tip-attack-grid">
            <!-- Rendered by JS -->
          </div>
        </div>
      </div>
    </div><!-- end attack tab -->

    <!-- ===================================
         TAB 4: SIEM PUSH
         =================================== -->
    <div class="tip-tab-panel" id="tip-panel-siem">
      <!-- Push All Banner -->
      <div class="tip-push-all-banner">
        <div class="tip-push-all-info">
          <strong>SIEM Push Control</strong> â€” Manage IOC distribution to all client SIEMs.
          Last global sync: <strong>4m ago</strong> Â· Total active IOCs across all clients: <strong>8,452</strong>
        </div>
        <button class="tip-btn tip-btn-primary" id="tip-push-all-btn" onclick="tipPushAll()">ðŸš€ PUSH ALL CLIENTS</button>
      </div>
      <div id="tip-push-all-progress" class="tip-push-progress"><div class="tip-push-progress-bar"></div></div>

      <div class="tip-siem-grid">

        <!-- Dacta Global â€” Elastic â€” Live -->
        <div class="tip-siem-card live">
          <div class="tip-siem-card-header">
            <div>
              <div class="tip-siem-client-name">Dacta Global</div>
              <div class="tip-siem-platform">
                <span style="background:rgba(16,185,129,0.12);border:1px solid rgba(16,185,129,0.2);border-radius:4px;padding:1px 6px;font-size:10px;font-weight:600;color:#10b981;">Elastic SIEM</span>
                SOCaaS
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:6px;">
              <div class="tip-status-dot tip-status-live"></div>
              <span style="font-size:11px;color:#10b981;font-weight:600;">LIVE</span>
            </div>
          </div>
          <div class="tip-siem-body">
            <div class="tip-siem-stats">
              <div class="tip-siem-stat"><div class="tip-siem-stat-val">6</div><div class="tip-siem-stat-label">IOC Sets</div></div>
              <div class="tip-siem-stat"><div class="tip-siem-stat-val" style="color:#00d4ff;">2,847</div><div class="tip-siem-stat-label">Active IOCs</div></div>
              <div class="tip-siem-stat"><div class="tip-siem-stat-val">8m</div><div class="tip-siem-stat-label">Last Push</div></div>
            </div>
            <div class="tip-siem-last-push">Last pushed: <strong>8 minutes ago</strong> Â· 2,847 IOCs active Â· Push #1,483</div>
            <div class="tip-siem-actions">
              <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipRepush('Dacta Global')">â†º Re-Push</button>
              <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipOpenIocSetModal('Dacta Global')">âš™ Manage Sets</button>
            </div>
          </div>
        </div>

        <!-- SPMT â€” Sentinel â€” Live -->
        <div class="tip-siem-card live">
          <div class="tip-siem-card-header">
            <div>
              <div class="tip-siem-client-name">SPMT</div>
              <div class="tip-siem-platform">
                <span style="background:rgba(0,120,212,0.12);border:1px solid rgba(0,120,212,0.3);border-radius:4px;padding:1px 6px;font-size:10px;font-weight:600;color:#60a5fa;">Microsoft Sentinel</span>
                SOCaaS
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:6px;">
              <div class="tip-status-dot tip-status-live"></div>
              <span style="font-size:11px;color:#10b981;font-weight:600;">LIVE</span>
            </div>
          </div>
          <div class="tip-siem-body">
            <div class="tip-siem-stats">
              <div class="tip-siem-stat"><div class="tip-siem-stat-val">4</div><div class="tip-siem-stat-label">IOC Sets</div></div>
              <div class="tip-siem-stat"><div class="tip-siem-stat-val" style="color:#00d4ff;">1,923</div><div class="tip-siem-stat-label">Active IOCs</div></div>
              <div class="tip-siem-stat"><div class="tip-siem-stat-val">12m</div><div class="tip-siem-stat-label">Last Push</div></div>
            </div>
            <div class="tip-siem-last-push">Last pushed: <strong>12 minutes ago</strong> Â· 1,923 IOCs active Â· Push #847</div>
            <div class="tip-siem-actions">
              <button class="tip-btn tip-btn-primary tip-btn-sm" onclick="tipRepush('SPMT')">â†º Re-Push</button>
              <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipOpenIocSetModal('SPMT')">âš™ Manage Sets</button>
            </div>
          </div>
        </div>

        <!-- Global Advisor Co â€” Splunk â€” STALE -->
        <div class="tip-siem-card stale">
          <div class="tip-siem-card-header">
            <div>
              <div class="tip-siem-client-name">Global Advisor Co</div>
              <div class="tip-siem-platform">
                <span style="background:rgba(249,115,22,0.12);border:1px solid rgba(249,115,22,0.25);border-radius:4px;padding:1px 6px;font-size:10px;font-weight:600;color:#f97316;">Splunk Enterprise</span>
                SOCaaS
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:6px;">
              <div class="tip-status-dot tip-status-stale"></div>
              <span style="font-size:11px;color:#f59e0b;font-weight:600;">STALE</span>
            </div>
          </div>
          <div class="tip-siem-body">
            <div class="tip-siem-stats">
              <div class="tip-siem-stat"><div class="tip-siem-stat-val">5</div><div class="tip-siem-stat-label">IOC Sets</div></div>
              <div class="tip-siem-stat"><div class="tip-siem-stat-val" style="color:#f59e0b;">2,156</div><div class="tip-siem-stat-label">Active IOCs</div></div>
              <div class="tip-siem-stat"><div class="tip-siem-stat-val" style="color:#f59e0b;">72m</div><div class="tip-siem-stat-label">Last Push</div></div>
            </div>
            <div class="tip-stale-warning">
              âš  Last push was <strong>72 minutes ago</strong> â€” exceeds 60min threshold. Splunk HEC connector may require re-authentication. Recommend immediate re-push.
            </div>
            <div class="tip-siem-actions">
              <button class="tip-btn tip-btn-warning tip-btn-sm" onclick="tipRepush('Global Advisor Co')">â†º Re-Push Now</button>
              <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipOpenIocSetModal('Global Advisor Co')">âš™ Manage Sets</button>
            </div>
          </div>
        </div>

        <!-- Naga World â€” MDR only -->
        <div class="tip-siem-card mdr">
          <div class="tip-siem-card-header">
            <div>
              <div class="tip-siem-client-name">Naga World</div>
              <div class="tip-siem-platform">
                <span style="background:rgba(100,116,139,0.12);border:1px solid rgba(100,116,139,0.2);border-radius:4px;padding:1px 6px;font-size:10px;font-weight:600;color:#94a3b8;">No SIEM (MDR-only)</span>
                MDR Â· Jira Push
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:6px;">
              <div class="tip-status-dot tip-status-mdr"></div>
              <span style="font-size:11px;color:#94a3b8;font-weight:600;">JIRA</span>
            </div>
          </div>
          <div class="tip-siem-body">
            <div class="tip-siem-stats">
              <div class="tip-siem-stat"><div class="tip-siem-stat-val">3</div><div class="tip-siem-stat-label">IOC Sets</div></div>
              <div class="tip-siem-stat"><div class="tip-siem-stat-val" style="color:#94a3b8;">892</div><div class="tip-siem-stat-label">Active IOCs</div></div>
              <div class="tip-siem-stat"><div class="tip-siem-stat-val">19m</div><div class="tip-siem-stat-label">Last Push</div></div>
            </div>
            <div class="tip-siem-last-push">Alerts delivered via Jira tickets Â· Last Jira push: <strong>19 minutes ago</strong> Â· 892 active IOC alerts</div>
            <div class="tip-siem-actions">
              <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipRepush('Naga World')">â†º Re-Push Jira</button>
              <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipOpenIocSetModal('Naga World')">âš™ Manage Sets</button>
            </div>
          </div>
        </div>

        <!-- ADV Partners â€” MDR only -->
        <div class="tip-siem-card mdr">
          <div class="tip-siem-card-header">
            <div>
              <div class="tip-siem-client-name">ADV Partners</div>
              <div class="tip-siem-platform">
                <span style="background:rgba(100,116,139,0.12);border:1px solid rgba(100,116,139,0.2);border-radius:4px;padding:1px 6px;font-size:10px;font-weight:600;color:#94a3b8;">No SIEM (MDR-only)</span>
                MDR Â· Jira Push
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:6px;">
              <div class="tip-status-dot tip-status-mdr"></div>
              <span style="font-size:11px;color:#94a3b8;font-weight:600;">JIRA</span>
            </div>
          </div>
          <div class="tip-siem-body">
            <div class="tip-siem-stats">
              <div class="tip-siem-stat"><div class="tip-siem-stat-val">2</div><div class="tip-siem-stat-label">IOC Sets</div></div>
              <div class="tip-siem-stat"><div class="tip-siem-stat-val" style="color:#94a3b8;">634</div><div class="tip-siem-stat-label">Active IOCs</div></div>
              <div class="tip-siem-stat"><div class="tip-siem-stat-val">31m</div><div class="tip-siem-stat-label">Last Push</div></div>
            </div>
            <div class="tip-siem-last-push">Alerts delivered via Jira tickets Â· Last Jira push: <strong>31 minutes ago</strong> Â· 634 active IOC alerts</div>
            <div class="tip-siem-actions">
              <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipRepush('ADV Partners')">â†º Re-Push Jira</button>
              <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipOpenIocSetModal('ADV Partners')">âš™ Manage Sets</button>
            </div>
          </div>
        </div>

      </div><!-- end siem grid -->
    </div><!-- end siem tab -->

    <!-- ===================================
         TAB 5: REPORTING
         =================================== -->
    <div class="tip-tab-panel" id="tip-panel-report">
      <div class="tip-report-layout">

        <!-- Report Builder -->
        <div class="tip-panel">
          <div class="tip-panel-header">
            <div class="tip-panel-title">
              <span class="tip-panel-title-icon">ðŸ› </span>
              Report Builder
            </div>
          </div>
          <div class="tip-panel-body">
            <div style="display:flex;flex-direction:column;gap:12px;">
              <div class="tip-form-group">
                <label style="font-size:11px;color:#64748b;text-transform:uppercase;letter-spacing:.05em;">Report Type</label>
                <select class="tip-form-select" id="tip-report-type">
                  <option value="monthly">Monthly Threat Brief</option>
                  <option value="incident">Incident Context Report</option>
                  <option value="sector">Sector Threat Summary</option>
                  <option value="executive">Executive Brief</option>
                </select>
              </div>
              <div class="tip-form-group">
                <label style="font-size:11px;color:#64748b;text-transform:uppercase;letter-spacing:.05em;">Client</label>
                <select class="tip-form-select" id="tip-report-client">
                  <option>Dacta Global</option>
                  <option>SPMT</option>
                  <option>Global Advisor Co</option>
                  <option>Naga World</option>
                  <option>ADV Partners</option>
                </select>
              </div>
              <div class="tip-form-group">
                <label style="font-size:11px;color:#64748b;text-transform:uppercase;letter-spacing:.05em;">Period</label>
                <select class="tip-form-select" id="tip-report-period">
                  <option>February 2026 (current month)</option>
                  <option>January 2026</option>
                  <option>Last 30 days</option>
                  <option>Q1 2026 (Janâ€“Mar)</option>
                  <option>Custom date range...</option>
                </select>
              </div>
              <div>
                <div style="font-size:11px;color:#64748b;text-transform:uppercase;letter-spacing:.05em;margin-bottom:8px;">Content Modules</div>
                <div class="tip-checkboxes-grid">
                  <label class="tip-checkbox-item"><input type="checkbox" checked> IOC Push Summary</label>
                  <label class="tip-checkbox-item"><input type="checkbox" checked> Active Threat Actors</label>
                  <label class="tip-checkbox-item"><input type="checkbox" checked> ATT&amp;CK Coverage Change</label>
                  <label class="tip-checkbox-item"><input type="checkbox" checked> Campaign Activity</label>
                  <label class="tip-checkbox-item"><input type="checkbox"> Dark Web Mentions</label>
                  <label class="tip-checkbox-item"><input type="checkbox" checked> Executive Verdict</label>
                </div>
              </div>
              <button class="tip-btn tip-btn-primary" style="width:100%;justify-content:center;" onclick="tipGenerateReport()">
                âš¡ Generate Report
              </button>
            </div>

            <!-- Report Preview -->
            <div class="tip-report-preview" id="tip-report-preview">
              <!-- Filled by JS -->
            </div>
            <div id="tip-report-actions-bar" style="display:none;margin-top:10px;display:none;gap:8px;">
              <button class="tip-btn tip-btn-success tip-btn-sm" onclick="tipToast('âœ…','Report published to client portal')">âœ“ Publish to Portal</button>
              <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸ’¾','Report saved as draft')">Save Draft</button>
              <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸ“¥','Report exported as PDF')">â†“ Export PDF</button>
            </div>
          </div>
        </div>

        <!-- Recent Reports -->
        <div class="tip-panel">
          <div class="tip-panel-header">
            <div class="tip-panel-title">
              <span class="tip-panel-title-icon">ðŸ“‹</span>
              Recent Reports
            </div>
            <button class="tip-btn tip-btn-secondary tip-btn-sm" onclick="tipToast('ðŸ”','Searching report archive...')">View All</button>
          </div>
          <div class="tip-panel-body">
            <div class="tip-recent-reports">

              <div class="tip-report-row">
                <span class="tip-report-type-badge tip-rtype-monthly">Monthly Brief</span>
                <div class="tip-report-info">
                  <div class="tip-report-name">Monthly Threat Brief â€” SPMT</div>
                  <div class="tip-report-meta">January 2026 Â· 5 pages Â· analyst.chen</div>
                </div>
                <span class="tip-status-published">Published</span>
                <div class="tip-report-actions">
                  <button class="tip-btn tip-btn-secondary tip-btn-xs" onclick="tipToast('ðŸ“„','Opening report...')">View</button>
                  <button class="tip-btn tip-btn-secondary tip-btn-xs" onclick="tipToast('ðŸ“¥','Downloading PDF...')">â†“</button>
                </div>
              </div>

              <div class="tip-report-row">
                <span class="tip-report-type-badge tip-rtype-incident">Incident</span>
                <div class="tip-report-info">
                  <div class="tip-report-name">Incident Context Report â€” Naga World</div>
                  <div class="tip-report-meta">February 2026 Â· 3 pages Â· analyst.lee</div>
                </div>
                <span class="tip-status-draft">Draft</span>
                <div class="tip-report-actions">
                  <button class="tip-btn tip-btn-secondary tip-btn-xs" onclick="tipToast('âœï¸','Opening draft editor...')">Edit</button>
                  <button class="tip-btn tip-btn-success tip-btn-xs" onclick="tipToast('âœ…','Report published to client portal')">Publish</button>
                </div>
              </div>

              <div class="tip-report-row">
                <span class="tip-report-type-badge tip-rtype-sector">Sector Summary</span>
                <div class="tip-report-info">
                  <div class="tip-report-name">Sector Threat Summary â€” Global Advisor Co</div>
                  <div class="tip-report-meta">Q4 2025 Â· 3 pages Â· analyst.wong</div>
                </div>
                <span class="tip-status-published">Published</span>
                <div class="tip-report-actions">
                  <button class="tip-btn tip-btn-secondary tip-btn-xs" onclick="tipToast('ðŸ“„','Opening report...')">View</button>
                  <button class="tip-btn tip-btn-secondary tip-btn-xs" onclick="tipToast('ðŸ“¥','Downloading PDF...')">â†“</button>
                </div>
              </div>

              <div class="tip-report-row">
                <span class="tip-report-type-badge tip-rtype-exec">Exec Brief</span>
                <div class="tip-report-info">
                  <div class="tip-report-name">Executive Brief â€” Dacta Global</div>
                  <div class="tip-report-meta">February 2026 Â· 1 page Â· analyst.tan</div>
                </div>
                <span class="tip-status-draft">Draft</span>
                <div class="tip-report-actions">
                  <button class="tip-btn tip-btn-secondary tip-btn-xs" onclick="tipToast('âœï¸','Opening draft editor...')">Edit</button>
                  <button class="tip-btn tip-btn-success tip-btn-xs" onclick="tipToast('âœ…','Report published to client portal')">Publish</button>
                </div>
              </div>

            </div><!-- end recent reports -->
          </div>
        </div>

      </div><!-- end report layout -->
    </div><!-- end report tab -->

  </div><!-- end content -->
</div><!-- end tip-root -->

<!-- ============================================================
     JAVASCRIPT
     ============================================================ -->
<script>
(function() {
'use strict';

/* =============================================
   TAB SWITCHING
   ============================================= */
function switchTiTab(tabName) {
  const tabs = ['ops','actors','attack','siem','report'];
  tabs.forEach(t => {
    const panel = document.getElementById('tip-panel-' + t);
    const btn = document.getElementById('tip-tab-btn-' + t);
    if (panel) panel.classList.toggle('active', t === tabName);
    if (btn) btn.classList.toggle('active', t === tabName);
  });
  // Close ATT&CK side panel when leaving the attack tab
  var sp = document.getElementById('tip-attack-sidepanel');
  if (sp) sp.classList.remove('open');
  if (tabName === 'attack') tipRenderAttackGrid();
}
window.switchTiTab = switchTiTab;

/* =============================================
   CLIENT CONTEXT DATA
   ============================================= */
const CLIENT_DATA = {
  dacta:  { name:'Dacta Global',      sector:'Financial Services', region:'APAC Â· Singapore', risk:'HIGH',     riskClass:'tip-tag-high' },
  spmt:   { name:'SPMT',              sector:'Financial Services', region:'APAC Â· Singapore', risk:'HIGH',     riskClass:'tip-tag-high' },
  gac:    { name:'Global Advisor Co', sector:'Financial Services', region:'APAC Â· Australia', risk:'MEDIUM',   riskClass:'tip-tag-medium' },
  naga:   { name:'Naga World',        sector:'Hospitality / Gaming', region:'SEA Â· Cambodia', risk:'HIGH',     riskClass:'tip-tag-high' },
  adv:    { name:'ADV Partners',      sector:'Professional Services', region:'APAC Â· Singapore', risk:'MEDIUM', riskClass:'tip-tag-medium' },
};

function tipUpdateClientContext(val) {
  const d = CLIENT_DATA[val];
  if (!d) return;
  document.getElementById('tip-ctx-sector').textContent = d.sector;
  document.getElementById('tip-ctx-region').textContent = d.region;
  const riskEl = document.getElementById('tip-ctx-risk');
  riskEl.textContent = d.risk + ' RISK';
  riskEl.className = 'tip-tag ' + d.riskClass;
  document.getElementById('tip-attack-scope').textContent = 'Scoped to: ' + d.name + ' Â· ' + d.sector + ' Â· ' + d.region.split('Â·')[0].trim();
}
window.tipUpdateClientContext = tipUpdateClientContext;

/* =============================================
   IOC TRIAGE
   ============================================= */
let tipPendingCount = 8;

function tipToggleIoc(id) {
  const card = document.getElementById(id);
  if (!card || card.classList.contains('approved') || card.classList.contains('rejected')) return;
  const exp = document.getElementById(id + '-exp');
  if (exp) exp.classList.toggle('open');
}
window.tipToggleIoc = tipToggleIoc;

function tipApproveIoc(id) {
  const card = document.getElementById(id);
  if (!card || card.classList.contains('approved') || card.classList.contains('rejected')) return;
  card.classList.add('approved');
  const actions = card.querySelector('.tip-ioc-actions');
  if (actions) {
    actions.innerHTML = '<span class="tip-approved-stamp">âœ“ APPROVED</span>';
  }
  tipDecrementPending();
  tipToast('âœ…', 'IOC approved and queued for SIEM push');
}
window.tipApproveIoc = tipApproveIoc;

function tipRejectIoc(id) {
  const card = document.getElementById(id);
  if (!card || card.classList.contains('approved') || card.classList.contains('rejected')) return;
  card.classList.add('rejected');
  const actions = card.querySelector('.tip-ioc-actions');
  if (actions) {
    actions.innerHTML = '<span class="tip-rejected-stamp">âœ• REJECTED</span>';
  }
  tipDecrementPending();
  tipToast('ðŸš«', 'IOC rejected â€” FALSE_POSITIVE sighting logged to DACTA TIP');
}
window.tipRejectIoc = tipRejectIoc;

function tipDecrementPending() {
  tipPendingCount = Math.max(0, tipPendingCount - 1);
  const el = document.getElementById('tip-triage-count');
  if (el) {
    el.textContent = tipPendingCount + ' Pending';
    if (tipPendingCount === 0) {
      el.classList.remove('tip-badge-count-red');
      el.style.background = 'rgba(16,185,129,0.12)';
      el.style.borderColor = 'rgba(16,185,129,0.25)';
      el.style.color = '#10b981';
    }
  }
}

function tipAutoApprove() {
  // Auto-approve IOCs with confidence >= 90%: ioc-1 (92%), ioc-3 (95%), ioc-8 (96%)
  const highConf = ['tip-ioc-1','tip-ioc-3','tip-ioc-4','tip-ioc-7','tip-ioc-8'];
  let count = 0;
  highConf.forEach(id => {
    const card = document.getElementById(id);
    if (card && !card.classList.contains('approved') && !card.classList.contains('rejected')) {
      setTimeout(() => tipApproveIoc(id), count * 200);
      count++;
    }
  });
  if (count > 0) {
    setTimeout(() => tipToast('âš¡', count + ' high-confidence IOCs auto-approved and pushed'), 300);
  } else {
    tipToast('â„¹ï¸', 'No pending high-confidence IOCs to auto-approve');
  }
}
window.tipAutoApprove = tipAutoApprove;

/* =============================================
   SIGHTINGS
   ============================================= */
function tipToggleSightingForm() {
  const form = document.getElementById('tip-sighting-form');
  if (form) form.classList.toggle('open');
}
window.tipToggleSightingForm = tipToggleSightingForm;

function tipSubmitSighting() {
  const val = document.getElementById('tip-sight-ioc-val');
  if (val && val.value.trim()) {
    tipToast('âœ…', 'Sighting logged Â· Confidence score updated in DACTA TIP');
    tipToggleSightingForm();
    val.value = '';
  } else {
    tipToast('âš ï¸', 'Please enter an IOC value');
  }
}
window.tipSubmitSighting = tipSubmitSighting;

/* =============================================
   ACTOR CARDS
   ============================================= */
function tipToggleActor(id) {
  const card = document.getElementById(id);
  if (!card) return;
  const body = document.getElementById(id + '-body');
  if (body) body.classList.toggle('open');
}
window.tipToggleActor = tipToggleActor;

/* =============================================
   SEARCH
   ============================================= */
const SEARCH_DATA = [
  { type:'IP', typeClass:'tip-ioc-ip', value:'185.220.101.34', conf:92, actor:'APT29', campaign:'Operation Midnight Snow', firstSeen:'2026-02-14', lastSeen:'2026-02-27', tags:['espionage','c2'], relatedIocs:43 },
  { type:'DOMAIN', typeClass:'tip-ioc-domain', value:'login-verify.microsoft-365[.]club', conf:78, actor:'FIN7', campaign:'PhishKit Carbanak-2026', firstSeen:'2026-02-19', lastSeen:'2026-02-26', tags:['phishing','financial'], relatedIocs:17 },
  { type:'HASH', typeClass:'tip-ioc-hash', value:'a3b9c8d7e6f5a4b3c2d1e0f9â€¦ef12', conf:95, actor:'Lazarus Group', campaign:'AppleJeus Variant-Q1', firstSeen:'2026-01-28', lastSeen:'2026-02-25', tags:['malware','financial'], relatedIocs:62 },
  { type:'URL', typeClass:'tip-ioc-url', value:'hxxps://update-service[.]net/payload.exe', conf:85, actor:'ALPHV', campaign:'BlackCat Ransom Wave 6', firstSeen:'2026-02-21', lastSeen:'2026-02-28', tags:['ransomware','dropper'], relatedIocs:29 },
  { type:'IP', typeClass:'tip-ioc-ip', value:'91.234.99.87', conf:71, actor:'Sandworm', campaign:'Industroyer-3 Probes', firstSeen:'2026-02-10', lastSeen:'2026-02-24', tags:['ics','infrastructure'], relatedIocs:8 },
  { type:'DOMAIN', typeClass:'tip-ioc-domain', value:'cdn-static.azureedge-cdn[.]com', conf:68, actor:'APT41', campaign:'Double Dragon CDN Abuse', firstSeen:'2026-02-16', lastSeen:'2026-02-27', tags:['espionage','c2'], relatedIocs:12 },
  { type:'HASH', typeClass:'tip-ioc-hash', value:'f7e2a1b8c9d3e4f5a6b7c8d3â€¦c8d3', conf:88, actor:'FIN7', campaign:'PhishKit Carbanak-2026', firstSeen:'2026-02-22', lastSeen:'2026-02-28', tags:['malware','financial'], relatedIocs:17 },
  { type:'IP', typeClass:'tip-ioc-ip', value:'203.176.48.112', conf:96, actor:'Lazarus', campaign:'AppleJeus Variant-Q1', firstSeen:'2026-02-27', lastSeen:'2026-02-28', tags:['financial','c2'], relatedIocs:62 },
];

function tipHandleSearch(q) {
  if (q.length < 2) { tipHideSearchOverlay(); return; }
  const results = SEARCH_DATA.filter(d =>
    d.value.toLowerCase().includes(q.toLowerCase()) ||
    d.actor.toLowerCase().includes(q.toLowerCase()) ||
    d.campaign.toLowerCase().includes(q.toLowerCase()) ||
    d.type.toLowerCase().includes(q.toLowerCase())
  );
  renderSearchResults(results);
  tipShowSearchOverlay();
}
window.tipHandleSearch = tipHandleSearch;

function renderSearchResults(results) {
  const container = document.getElementById('tip-search-results-container');
  if (!container) return;
  if (results.length === 0) {
    container.innerHTML = '<div class="tip-empty-state">No results found in DACTA TIP</div>';
    return;
  }
  container.innerHTML = results.map(r => `
    <div class="tip-search-result-card">
      <div class="tip-src-top">
        <span class="tip-ioc-badge ${r.typeClass}">${r.type}</span>
        <span style="font-family:'IBM Plex Mono',monospace;font-size:12px;color:#e8edf5;">${r.value}</span>
        <span style="margin-left:auto;font-family:'IBM Plex Mono',monospace;font-size:11px;color:${r.conf>=90?'#10b981':r.conf>=70?'#f59e0b':'#ff6b6b'};">${r.conf}%</span>
      </div>
      <div class="tip-src-meta">
        <div class="tip-src-meta-item">Actor: <span>${r.actor}</span></div>
        <div class="tip-src-meta-item">Campaign: <span>${r.campaign}</span></div>
        <div class="tip-src-meta-item">First: <span>${r.firstSeen}</span></div>
        <div class="tip-src-meta-item">Last: <span>${r.lastSeen}</span></div>
        <div class="tip-src-meta-item">Related IOCs: <span style="color:#00d4ff;">${r.relatedIocs}</span></div>
      </div>
      <div style="display:flex;gap:4px;margin-top:6px;flex-wrap:wrap;">
        ${r.tags.map(t => `<span style="font-size:9px;padding:1px 6px;border-radius:3px;background:rgba(0,212,255,0.07);border:1px solid rgba(0,212,255,0.15);color:#64748b;">${t}</span>`).join('')}
      </div>
      <div class="tip-src-actions">
        <button class="tip-btn tip-btn-primary tip-btn-xs" onclick="event.stopPropagation();tipToast('ðŸ“¡','${r.value} pushed to affected SIEMs')">Push to SIEMs</button>
        <button class="tip-btn tip-btn-secondary tip-btn-xs" onclick="tipToast('ðŸ”—','Opening in DACTA TIP...')">Open in DACTA TIP â†—</button>
      </div>
    </div>
  `).join('');
}

function tipShowSearchOverlay() {
  const overlay = document.getElementById('tip-search-overlay');
  if (overlay) overlay.classList.add('open');
}
window.tipShowSearchOverlay = tipShowSearchOverlay;

function tipHideSearchOverlay() {
  const overlay = document.getElementById('tip-search-overlay');
  if (overlay) overlay.classList.remove('open');
}
window.tipHideSearchOverlay = tipHideSearchOverlay;

function tipFilterActors(q) {
  // Used by add actor modal
}
window.tipFilterActors = tipFilterActors;

/* =============================================
   ATT&CK HEATMAP
   ============================================= */
const ATTACK_DATA = [
  { tactic:'Initial Access', id:'TA0001', techniques:[
    { id:'T1566.001', name:'Spearphishing Attachment', score:9, actor:'APT29' },
    { id:'T1566.002', name:'Spearphishing Link', score:8, actor:'FIN7' },
    { id:'T1190', name:'Exploit Public-Facing App', score:6, actor:'APT41' },
    { id:'T1133', name:'External Remote Services', score:5, actor:'Sandworm' },
    { id:'T1078', name:'Valid Accounts', score:7, actor:'APT29' },
  ]},
  { tactic:'Execution', id:'TA0002', techniques:[
    { id:'T1059.001', name:'PowerShell', score:8, actor:'APT29' },
    { id:'T1059.003', name:'Windows Command Shell', score:7, actor:'FIN7' },
    { id:'T1059.007', name:'JavaScript', score:5, actor:'ALPHV' },
    { id:'T1047', name:'WMI Execution', score:6, actor:'APT41' },
    { id:'T1204.002', name:'Malicious File', score:9, actor:'Lazarus' },
  ]},
  { tactic:'Persistence', id:'TA0003', techniques:[
    { id:'T1547.001', name:'Registry Run Keys', score:6, actor:'FIN7' },
    { id:'T1053.005', name:'Scheduled Task', score:7, actor:'APT29' },
    { id:'T1543.003', name:'Windows Service', score:5, actor:'Sandworm' },
    { id:'T1078.002', name:'Domain Accounts', score:8, actor:'APT29' },
  ]},
  { tactic:'Privilege Escalation', id:'TA0004', techniques:[
    { id:'T1548.002', name:'Bypass UAC', score:5, actor:'FIN7' },
    { id:'T1134.001', name:'Token Impersonation', score:4, actor:'APT41' },
    { id:'T1068', name:'Exploit Vulnerability', score:7, actor:'Lazarus' },
    { id:'T1055', name:'Process Injection', score:8, actor:'Lazarus' },
  ]},
  { tactic:'Defense Evasion', id:'TA0005', techniques:[
    { id:'T1055.001', name:'DLL Injection', score:9, actor:'Lazarus' },
    { id:'T1562.001', name:'Disable Security Tools', score:7, actor:'ALPHV' },
    { id:'T1070.004', name:'File Deletion', score:6, actor:'APT29' },
    { id:'T1027', name:'Obfuscated Files', score:8, actor:'FIN7' },
    { id:'T1140', name:'Deobfuscate/Decode', score:5, actor:'APT41' },
  ]},
  { tactic:'Credential Access', id:'TA0006', techniques:[
    { id:'T1003.001', name:'LSASS Memory', score:8, actor:'APT29' },
    { id:'T1110.001', name:'Password Guessing', score:5, actor:'ALPHV' },
    { id:'T1555.003', name:'Browser Credentials', score:7, actor:'FIN7' },
    { id:'T1558.003', name:'Kerberoasting', score:6, actor:'APT29' },
  ]},
  { tactic:'Discovery', id:'TA0007', techniques:[
    { id:'T1082', name:'System Info Discovery', score:6, actor:'APT41' },
    { id:'T1018', name:'Remote System Discovery', score:5, actor:'Sandworm' },
    { id:'T1087.002', name:'Domain Account Discovery', score:7, actor:'APT29' },
    { id:'T1083', name:'File & Dir Discovery', score:4, actor:'FIN7' },
  ]},
  { tactic:'Lateral Movement', id:'TA0008', techniques:[
    { id:'T1021.001', name:'RDP', score:7, actor:'ALPHV' },
    { id:'T1021.002', name:'SMB/Admin Shares', score:8, actor:'ALPHV' },
    { id:'T1550.002', name:'Pass the Hash', score:6, actor:'APT29' },
    { id:'T1570', name:'Lateral Tool Transfer', score:5, actor:'Lazarus' },
  ]},
  { tactic:'Command & Control', id:'TA0011', techniques:[
    { id:'T1071.001', name:'Web Protocols', score:9, actor:'APT41' },
    { id:'T1071.004', name:'DNS', score:7, actor:'APT29' },
    { id:'T1573.002', name:'Asymmetric Crypto', score:8, actor:'Lazarus' },
    { id:'T1090.003', name:'Multi-hop Proxy', score:6, actor:'Sandworm' },
    { id:'T1105', name:'Ingress Tool Transfer', score:7, actor:'FIN7' },
  ]},
  { tactic:'Exfiltration', id:'TA0010', techniques:[
    { id:'T1048.003', name:'Alt Protocol Exfil', score:6, actor:'APT41' },
    { id:'T1041', name:'Exfil Over C2', score:8, actor:'APT29' },
    { id:'T1567.002', name:'Exfil to Cloud', score:5, actor:'FIN7' },
  ]},
  { tactic:'Impact', id:'TA0040', techniques:[
    { id:'T1486', name:'Data Encrypted for Impact', score:10, actor:'ALPHV' },
    { id:'T1490', name:'Inhibit System Recovery', score:9, actor:'ALPHV' },
    { id:'T1561.002', name:'Disk Structure Wipe', score:7, actor:'Sandworm' },
    { id:'T1489', name:'Service Stop', score:8, actor:'ALPHV' },
  ]},
];

let attackRendered = false;

function tipRenderAttackGrid() {
  if (attackRendered) return;
  attackRendered = true;
  const grid = document.getElementById('tip-attack-grid');
  if (!grid) return;

  grid.innerHTML = ATTACK_DATA.map(tactic => `
    <div class="tip-tactic-section">
      <div class="tip-tactic-header">
        <div class="tip-tactic-name">${tactic.tactic}</div>
      </div>
      <div class="tip-tactic-techniques">
        ${tactic.techniques.map(tech => `
          <div class="tip-technique-cell tip-heat-${Math.round(tech.score)}"
               data-id="${tech.id}" data-name="${tech.name}" data-score="${tech.score}"
               data-actor="${tech.actor}" data-tactic="${tactic.tactic}"
               onmouseenter="tipShowTooltip(event, this)"
               onmouseleave="tipHideTooltip()"
               onclick="tipOpenSidepanel(this)">
            <div class="tip-technique-id">${tech.id}</div>
            ${tech.score > 0 ? `<div class="tip-technique-score">${tech.score}</div>` : ''}
          </div>
        `).join('')}
      </div>
    </div>
  `).join('');
}
window.tipRenderAttackGrid = tipRenderAttackGrid;

function tipShowTooltip(event, el) {
  const tt = document.getElementById('tip-attack-tooltip');
  if (!tt) return;
  document.getElementById('tip-tt-tactic').textContent = el.dataset.tactic;
  document.getElementById('tip-tt-name').textContent = el.dataset.name;
  document.getElementById('tip-tt-score').textContent = 'Score: ' + el.dataset.score + '/10';
  document.getElementById('tip-tt-actor').textContent = 'â†‘ ' + el.dataset.actor;
  tt.classList.add('visible');
  tipPositionTooltip(event);
}
window.tipShowTooltip = tipShowTooltip;

function tipPositionTooltip(event) {
  const tt = document.getElementById('tip-attack-tooltip');
  if (!tt) return;
  const x = event.clientX + 16;
  const y = event.clientY - 10;
  const rect = tt.getBoundingClientRect();
  tt.style.left = Math.min(x, window.innerWidth - rect.width - 10) + 'px';
  tt.style.top = Math.min(y, window.innerHeight - rect.height - 10) + 'px';
}

document.addEventListener('mousemove', function(e) {
  const tt = document.getElementById('tip-attack-tooltip');
  if (tt && tt.classList.contains('visible')) tipPositionTooltip(e);
});

function tipHideTooltip() {
  const tt = document.getElementById('tip-attack-tooltip');
  if (tt) tt.classList.remove('visible');
}
window.tipHideTooltip = tipHideTooltip;

function tipOpenSidepanel(el) {
  const id = el.dataset.id;
  const name = el.dataset.name;
  const score = parseFloat(el.dataset.score);
  const actor = el.dataset.actor;
  const tactic = el.dataset.tactic;

  document.getElementById('tip-sp-id').textContent = id;
  document.getElementById('tip-sp-name').textContent = name;
  document.getElementById('tip-sp-tactic').textContent = tactic;

  const scoreEl = document.getElementById('tip-sp-score-val');
  scoreEl.textContent = score;
  scoreEl.style.color = score >= 8 ? '#ff6b6b' : score >= 5 ? '#f59e0b' : '#10b981';

  // IOC List
  const iocList = document.getElementById('tip-sp-ioc-list');
  const sampleIocs = SEARCH_DATA.filter(d => d.actor === actor || d.actor.includes(actor.split(' ')[0])).slice(0,3);
  iocList.innerHTML = sampleIocs.length ? sampleIocs.map(ioc => `
    <div class="tip-sp-ioc-item">
      <span class="tip-ioc-badge ${ioc.typeClass}">${ioc.type}</span>
      <span class="tip-sp-ioc-val">${ioc.value}</span>
      <span style="margin-left:auto;font-size:10px;color:${ioc.conf>=90?'#10b981':'#f59e0b'}">${ioc.conf}%</span>
    </div>
  `).join('') : '<div style="font-size:11px;color:#64748b">No matching indicators</div>';

  // Actor list
  const actorList = document.getElementById('tip-sp-actor-list');
  actorList.innerHTML = `
    <div class="tip-sp-actor-item"><div class="tip-live-dot red" style="flex-shrink:0"></div>${actor}</div>
  `;

  // Campaigns
  const campaigns = document.getElementById('tip-sp-campaigns');
  const actorObj = Object.values({apt29:{name:'APT29',campaigns:['Operation Midnight Snow','Diplomatic Phish Wave']},lazarus:{name:'Lazarus',campaigns:['AppleJeus Variant-Q1','TraderTraitor Exchange Attack']},fin7:{name:'FIN7',campaigns:['PhishKit Carbanak-2026','POS Skimmer Update Q1']},sandworm:{name:'Sandworm',campaigns:['Industroyer-3 Probes','AcidPour APAC Targeting']},apt41:{name:'APT41',campaigns:['Double Dragon CDN Abuse']},alphv:{name:'ALPHV',campaigns:['BlackCat Ransom Wave 6','Healthcare Extortion Series']}}).find(a => actor.includes(a.name) || a.name.includes(actor.split(' ')[0]));
  campaigns.innerHTML = actorObj ? actorObj.campaigns.map(c => `<div style="font-size:12px;color:#94a3b8;padding:4px 0;border-bottom:1px solid rgba(255,255,255,0.04)">${c}</div>`).join('') : '<div style="font-size:11px;color:#64748b">No campaigns found</div>';

  document.getElementById('tip-attack-sidepanel').classList.add('open');
}
window.tipOpenSidepanel = tipOpenSidepanel;

function tipExportNavigator() {
  const layers = ATTACK_DATA.flatMap(tactic =>
    tactic.techniques.map(tech => ({ techniqueID: tech.id, score: tech.score * 10, comment: tech.actor }))
  );
  const nav = {
    name: 'DACTA TI Coverage',
    versions: { attack: '14', navigator: '4.9.1', layer: '4.5' },
    domain: 'enterprise-attack',
    description: 'DACTA MCC â€” Live ATT&CK coverage layer',
    techniques: layers,
    gradient: { colors: ['#050c15', '#0f2d5e', '#0d7377', '#b45309', '#ef4444'], minValue: 0, maxValue: 100 },
    metadata: [],
    links: [],
    showTacticRowBackground: true,
    tacticRowBackground: '#080d1a'
  };
  const blob = new Blob([JSON.stringify(nav, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'DACTA_ATTnCK_Navigator.json';
  a.click(); URL.revokeObjectURL(url);
  tipToast('â†“', 'Navigator layer JSON downloaded');
}
window.tipExportNavigator = tipExportNavigator;

/* =============================================
   HUNT SCHEDULING MODAL
   ============================================= */
function tipOpenHuntScheduler(hypothesisName) {
  document.getElementById('tip-sched-hyp-name').textContent = hypothesisName;
  // Reset to "Hunt Now" selected
  var opts = document.querySelectorAll('#tip-hunt-sched-modal .tip-sched-option');
  opts.forEach(function(o) { o.classList.remove('selected'); });
  if (opts[0]) opts[0].classList.add('selected');
  document.querySelectorAll('#tip-hunt-sched-modal .tip-sched-fields').forEach(function(f) { f.classList.remove('visible'); });
  document.getElementById('tip-hunt-sched-modal').classList.add('open');
}
window.tipOpenHuntScheduler = tipOpenHuntScheduler;

function tipSelectSchedOption(el, type) {
  var modal = document.getElementById('tip-hunt-sched-modal');
  modal.querySelectorAll('.tip-sched-option').forEach(function(o) { o.classList.remove('selected'); });
  el.classList.add('selected');
  // Show/hide sub-fields
  modal.querySelectorAll('.tip-sched-fields').forEach(function(f) { f.classList.remove('visible'); });
  if (type === 'scheduled') {
    document.getElementById('tip-sched-fields-scheduled').classList.add('visible');
  } else if (type === 'recurring') {
    document.getElementById('tip-sched-fields-recurring').classList.add('visible');
  }
}
window.tipSelectSchedOption = tipSelectSchedOption;

function tipSelectPrio(btn) {
  btn.parentElement.querySelectorAll('.tip-btn').forEach(function(b) {
    b.classList.remove('selected');
    b.style.background = '';
  });
  btn.classList.add('selected');
  btn.style.background = btn.style.color.replace(')', ',0.1)').replace('rgb', 'rgba');
}
window.tipSelectPrio = tipSelectPrio;

/* =============================================
   SIEM PUSH
   ============================================= */
function tipRepush(clientName) {
  const btn = event && event.target;
  if (btn) {
    btn.textContent = 'â†º Pushingâ€¦';
    btn.disabled = true;
    setTimeout(() => {
      btn.textContent = 'â†º Re-Push';
      btn.disabled = false;
      tipToast('âœ…', clientName + ' â€” SIEM push completed successfully');
    }, 1800);
  }
}
window.tipRepush = tipRepush;

function tipOpenIocSetModal(clientName) {
  document.getElementById('tip-modal-client-name').textContent = clientName;
  document.getElementById('tip-iocset-modal').classList.add('open');
}
window.tipOpenIocSetModal = tipOpenIocSetModal;

function tipPushAll() {
  const btn = document.getElementById('tip-push-all-btn');
  const progress = document.getElementById('tip-push-all-progress');
  if (btn) { btn.textContent = 'â³ Pushing all clientsâ€¦'; btn.disabled = true; }
  if (progress) progress.classList.add('active');
  setTimeout(() => {
    if (btn) { btn.textContent = 'ðŸš€ PUSH ALL CLIENTS'; btn.disabled = false; }
    if (progress) progress.classList.remove('active');
    tipToast('âœ…', 'All 5 clients pushed successfully â€” 8,452 IOCs distributed');
  }, 2000);
}
window.tipPushAll = tipPushAll;

/* =============================================
   REPORTING
   ============================================= */
function tipGenerateReport() {
  const type = document.getElementById('tip-report-type').value;
  const client = document.getElementById('tip-report-client').value;
  const period = document.getElementById('tip-report-period').value;
  const preview = document.getElementById('tip-report-preview');
  const actionsBar = document.getElementById('tip-report-actions-bar');

  const reportContent = {
    monthly: `
      <h3>Monthly Threat Brief â€” ${client}</h3>
      <div class="tip-rp-meta">${period} Â· CONFIDENTIAL Â· Classification: TLP:AMBER</div>
      <h4>Executive Summary</h4>
      <p>During the reporting period, DACTA identified <strong>3,847 new indicators of compromise</strong> relevant to ${client}'s sector profile. Three active threat actor groups â€” APT29, FIN7, and ALPHV/BlackCat â€” demonstrated elevated activity against financial services targets in APAC.</p>
      <h4>IOC Push Summary</h4>
      <p>Total IOCs pushed to ${client} SIEM during period: <strong>2,847</strong>. Breakdown by category:</p>
      <ul>
        <li>C2 IP Blocklist: 892 entries (+143 vs prior period)</li>
        <li>Malicious Hash Watchlist: 634 entries (+87 new)</li>
        <li>Phishing Domain Block: 421 entries (+210 new)</li>
        <li>APT Actor IOCs: 516 entries</li>
        <li>Ransomware Group IOCs: 384 entries (+95 new)</li>
      </ul>
      <h4>Active Threat Actors</h4>
      <ul>
        <li><strong>APT29 (CRITICAL)</strong> â€” 12 new IOCs in 24h, 3 new TTPs in 7d. TRENDING. Focus on financial credential harvesting.</li>
        <li><strong>ALPHV/BlackCat (HIGH)</strong> â€” 20 new IOCs in 24h. Active ransomware campaign targeting APAC financial sector.</li>
        <li><strong>FIN7 (HIGH)</strong> â€” 15 new IOCs in 24h. New phishing infrastructure observed.</li>
      </ul>
      <h4>ATT&CK Coverage Change</h4>
      <p>3 new techniques added to coverage this period: T1566.001 (Spearphishing Attachment), T1486 (Data Encrypted for Impact), T1055.001 (DLL Injection). Overall coverage score: <strong>78%</strong> of priority techniques.</p>
      <h4>Campaign Activity</h4>
      <p>2 new campaigns attributed this period: <em>BlackCat Ransom Wave 6</em> (ALPHV, 29 IOCs) and <em>PhishKit Carbanak-2026</em> (FIN7, 17 IOCs).</p>
      <h4>Executive Verdict</h4>
      <div class="tip-rp-verdict"><strong>Risk Posture: HIGH â†‘</strong><br>Threat level for ${client} has increased from MEDIUM to HIGH during this period driven by active ALPHV ransomware campaign activity and APT29 credential harvesting operations targeting APAC financial institutions. Recommend immediate review of endpoint hardening controls and MFA coverage.</div>`,
    incident: `
      <h3>Incident Context Report â€” ${client}</h3>
      <div class="tip-rp-meta">${period} Â· CONFIDENTIAL Â· TLP:RED</div>
      <h4>IOC Context</h4>
      <p>IP 203.176.48.112 has been confirmed TRUE_POSITIVE by analyst.wong. Associated with Lazarus Group C2 infrastructure. VT score: 56/70. GreyNoise: malicious.</p>
      <h4>Actor Attribution</h4>
      <p>Attribution to <strong>Lazarus Group (Hidden Cobra / ZINC)</strong> with HIGH confidence. North Korean state-sponsored actor. Primary motivation: financial theft, particularly targeting cryptocurrency and banking sectors.</p>
      <h4>Campaign Analysis</h4>
      <p>Campaign: <em>AppleJeus Variant-Q1</em>. First seen 2026-01-28. 62 related indicators across IP, domain, and hash types. Active as of 2026-02-28.</p>
      <h4>Kill Chain Mapping</h4>
      <ul>
        <li>T1566.001 â€” Spearphishing attachment delivering trojanized trading application</li>
        <li>T1055.001 â€” DLL injection into legitimate financial software process</li>
        <li>T1071.001 â€” Web protocol C2 communication to 203.176.48.112</li>
        <li>T1041 â€” Exfiltration over established C2 channel</li>
      </ul>
      <h4>Executive Verdict</h4>
      <div class="tip-rp-verdict"><strong>Immediate Action Required</strong><br>Block 203.176.48.112 at perimeter. Audit trading application installations for DLL sideloading indicators. Escalate to IR team if any internal beaconing detected.</div>`,
    sector: `
      <h3>Sector Threat Summary â€” Financial Services APAC</h3>
      <div class="tip-rp-meta">${period} Â· CONFIDENTIAL Â· TLP:AMBER Â· Client: ${client}</div>
      <h4>Sector Threat Landscape</h4>
      <p>The APAC financial services sector faces elevated threat activity from 3 CRITICAL and 4 HIGH priority actors. Ransomware and credential harvesting remain the dominant attack motives in this period.</p>
      <h4>Top 3 Active Actors</h4>
      <ul>
        <li><strong>APT29</strong> â€” Credential harvesting targeting financial institutions and investment firms. New MO: OAuth token theft via phishing of Microsoft 365 users.</li>
        <li><strong>ALPHV/BlackCat</strong> â€” Ransomware targeting financial sector with double-extortion. Average ransom demand for sector: $4.2M USD.</li>
        <li><strong>Lazarus Group</strong> â€” Financially motivated attacks on cryptocurrency exchanges and trading platforms.</li>
      </ul>
      <h4>Key Vulnerabilities Being Exploited</h4>
      <ul>
        <li>CVE-2025-21210 â€” Windows CLFS driver â€” exploited by APT29 for local privilege escalation</li>
        <li>CVE-2025-0842 â€” Popular banking software SDK â€” Lazarus Group supply chain attack</li>
        <li>Misconfigured Entra ID / Azure AD â€” APT29 persistent access</li>
      </ul>
      <h4>Trend Direction</h4>
      <div class="tip-rp-verdict"><strong>â†‘ ESCALATING</strong><br>Sector threat activity has increased 34% quarter-over-quarter. Ransomware groups are prioritising APAC due to high ransom payment rates (72% of victims paid in Q4 2025 vs 61% globally).</div>`,
    executive: `
      <h3>Executive Brief â€” ${client}</h3>
      <div class="tip-rp-meta">${period} Â· BOARD-LEVEL Â· TLP:WHITE</div>
      <h4>Current Risk Rating</h4>
      <p style="font-size:20px;font-weight:700;color:#ff6b6b;">HIGH â†‘</p>
      <p>Risk posture increased from MEDIUM to HIGH. Three critical threat actors are actively targeting your sector.</p>
      <h4>By the Numbers</h4>
      <ul>
        <li>ðŸš¨ <strong>3,847</strong> new threat indicators ingested</li>
        <li>ðŸ“¡ <strong>2,847</strong> IOCs pushed to your SIEM</li>
        <li>ðŸ‘¤ <strong>3</strong> actors actively targeting your sector</li>
        <li>ðŸŽ¯ <strong>4</strong> new attack techniques observed</li>
      </ul>
      <h4>Top Risk</h4>
      <div class="tip-rp-verdict"><strong>Ransomware â€” ALPHV/BlackCat is the #1 threat.</strong><br>20 new indicators in the last 24 hours. Active campaign targeting APAC financial institutions. DACTA has deployed countermeasures. No confirmed compromise detected in your environment.</div>
      <p style="font-size:11px;color:#64748b;margin-top:12px;">Prepared by DACTA Threat Intelligence Â· analyst.tan Â· Full technical detail available on request</p>`
  };

  preview.innerHTML = reportContent[type] || reportContent.monthly;
  preview.classList.add('visible');
  if (actionsBar) { actionsBar.style.display = 'flex'; }
  tipToast('âš¡', 'Report draft generated â€” ready for review');
}
window.tipGenerateReport = tipGenerateReport;

/* =============================================
   TOAST
   ============================================= */
let tipToastTimer = null;
function tipToast(icon, msg) {
  const toast = document.getElementById('tip-toast');
  const iconEl = document.getElementById('tip-toast-icon');
  const msgEl = document.getElementById('tip-toast-msg');
  if (!toast) return;
  if (iconEl) iconEl.textContent = icon;
  if (msgEl) msgEl.textContent = msg;
  toast.classList.add('visible');
  if (tipToastTimer) clearTimeout(tipToastTimer);
  tipToastTimer = setTimeout(() => toast.classList.remove('visible'), 3000);
}
window.tipToast = tipToast;

/* =============================================
   LIVE COUNTER SIMULATION
   ============================================= */
function tipSimulateLive() {
  const syncEl = document.getElementById('tip-last-sync');
  const iocEl = document.getElementById('tip-ioc-today');
  let mins = 2;
  let iocs = 3847;

  setInterval(() => {
    mins++;
    if (mins >= 5) {
      mins = 0;
      iocs += Math.floor(Math.random() * 50) + 10;
      if (iocEl) iocEl.textContent = iocs.toLocaleString();
    }
    if (syncEl) syncEl.textContent = mins > 0 ? mins + 'm ago' : 'just now';
  }, 60000);
}

/* =============================================
   CLOSE MODALS ON ESCAPE
   ============================================= */
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    document.getElementById('tip-attack-sidepanel').classList.remove('open');
    document.getElementById('tip-iocset-modal').classList.remove('open');
    document.getElementById('tip-hunt-sched-modal').classList.remove('open');
    document.getElementById('tip-add-actor-modal').classList.remove('open');
    tipHideSearchOverlay();
  }
});

/* =============================================
   CLOSE MODALS ON OVERLAY CLICK
   ============================================= */
document.getElementById('tip-iocset-modal').addEventListener('click', function(e) {
  if (e.target === this) this.classList.remove('open');
});
document.getElementById('tip-add-actor-modal').addEventListener('click', function(e) {
  if (e.target === this) this.classList.remove('open');
});

/* =============================================
   INIT
   ============================================= */
tipSimulateLive();
// Render attack grid if already on that tab
if (document.getElementById('tip-panel-attack') && document.getElementById('tip-panel-attack').classList.contains('active')) {
  tipRenderAttackGrid();
}

})();
</script>


      </div><!-- end intel -->



      <!-- =====================================================
           PAGE: DATA PRIVACY ENGINE
           ===================================================== -->
      <div class="page" id="page-privacy">

        <!-- Page Header -->
        <div class="page-header">
          <div>
            <div class="page-title">Data Privacy Engine</div>
            <div class="page-subtitle">PDPA-Compliant Multi-LLM Investigation Pipeline</div>
          </div>
          <div class="page-actions" style="align-items:center;">
            <div class="priv-status-indicator">
              <div class="priv-status-dot"></div>
              All Systems Operational
            </div>
            <button class="btn btn-primary btn-sm">&#9881; Configure Policies</button>
          </div>
        </div>

        <!-- Metrics Row -->
        <div class="metrics-row" style="margin-bottom:20px;">
          <div class="metric-card cyan">
            <div class="metric-label">Records Tokenized Today</div>
            <div class="metric-value">34,892</div>
            <div class="metric-sub">&#8593; 12% from yesterday</div>
          </div>
          <div class="metric-card green">
            <div class="metric-label">PII Detection Rate</div>
            <div class="metric-value">99.7%</div>
            <div class="metric-sub">above 99.5% target</div>
          </div>
          <div class="metric-card purple">
            <div class="metric-label">Active Policies</div>
            <div class="metric-value">12</div>
            <div class="metric-sub">across 4 tenants</div>
          </div>
          <div class="metric-card amber">
            <div class="metric-label">Mean Tokenization Latency</div>
            <div class="metric-value">23ms</div>
            <div class="metric-sub">p99: 47ms</div>
          </div>
        </div>

        <!-- Pipeline Hero Section -->
        <div class="card" style="margin-bottom:18px;padding:0;overflow:hidden;">
          <div class="card-header" style="padding:14px 18px 12px;border-bottom:1px solid var(--border-subtle);">
            <span class="card-title">Privacy Pipeline â€” End-to-End Data Flow</span>
            <span style="font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">SOC Alert &rarr; Anonymized LLM Input &rarr; Re-identified Report</span>
          </div>
          <!-- Pipeline diagram -->
          <div class="privacy-pipeline">

            <!-- Input node: Raw SOC Alert -->
            <div class="priv-io-node">
              <div class="priv-io-box">
                <span class="priv-io-icon">&#128268;</span>
                <div style="font-size:10px;font-weight:700;color:var(--text-primary);margin-bottom:2px;">Raw SOC Alert</div>
                <div style="font-size:9px;color:var(--text-muted);">SIEM event<br>with PII</div>
              </div>
            </div>

            <!-- Connector 0 -->
            <div class="pipeline-connector">
              <div class="pipeline-connector-line glow">
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-arrow"></div>
              </div>
            </div>

            <!-- Stage 1: Tokenization Vault -->
            <div class="pipeline-stage stage-cyan">
              <div class="pipeline-stage-num">Layer 01</div>
              <div style="display:flex;align-items:center;gap:7px;margin-bottom:4px;">
                <span class="pipeline-stage-icon">&#128273;</span>
                <div>
                  <div class="pipeline-stage-title">Tokenization Vault</div>
                  <div class="pipeline-stage-sub">On-Premise / Dacta-Controlled</div>
                </div>
              </div>
              <div class="pipeline-stage-body">
                <div class="priv-token-map">
                  <div class="priv-token-map-row">
                    <span class="priv-token-orig">Naga World</span>
                    <span class="priv-token-arrow">&#8594;</span>
                    <span class="priv-token-val">[[CLIENT_0x7A]]</span>
                  </div>
                  <div class="priv-token-map-row">
                    <span class="priv-token-orig">192.168.1.45</span>
                    <span class="priv-token-arrow">&#8594;</span>
                    <span class="priv-token-val">[[IP_0x3F]]</span>
                  </div>
                  <div class="priv-token-map-row">
                    <span class="priv-token-orig">john@client.com</span>
                    <span class="priv-token-arrow">&#8594;</span>
                    <span class="priv-token-val">[[EMAIL_0x12]]</span>
                  </div>
                  <div class="priv-token-map-row">
                    <span class="priv-token-orig">win-srv-dc01</span>
                    <span class="priv-token-arrow">&#8594;</span>
                    <span class="priv-token-val">[[HOST_001]]</span>
                  </div>
                </div>
              </div>
              <div class="pipeline-stage-badge" style="color:var(--cyan);border-color:rgba(0,212,255,0.25);background:rgba(0,212,255,0.08);">&#128273; Reversible &middot; Vault-Secured</div>
            </div>

            <!-- Connector 1 -->
            <div class="pipeline-connector">
              <div class="pipeline-connector-line glow">
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-arrow"></div>
              </div>
            </div>

            <!-- Stage 2: Differential Privacy -->
            <div class="pipeline-stage stage-purple">
              <div class="pipeline-stage-num">Layer 02</div>
              <div style="display:flex;align-items:center;gap:7px;margin-bottom:4px;">
                <span class="pipeline-stage-icon">&#128737;</span>
                <div>
                  <div class="pipeline-stage-title">Differential Privacy</div>
                  <div class="pipeline-stage-sub">DP-Fusion Token-Level Protection</div>
                </div>
              </div>
              <div class="pipeline-stage-body">
                <div class="priv-epsilon-wrap">
                  <div class="priv-epsilon-label">
                    <span>Privacy Budget</span>
                    <span class="priv-epsilon-val">&epsilon; = 2.0</span>
                  </div>
                  <div class="priv-epsilon-bar"><div class="priv-epsilon-fill"></div></div>
                  <div class="priv-epsilon-ticks">
                    <span>&epsilon; 0</span>
                    <span>Privacy</span>
                    <span>Utility</span>
                    <span>&epsilon; 10</span>
                  </div>
                </div>
                <div style="font-size:10px;color:var(--text-muted);line-height:1.5;">Mathematically provable<br>privacy guarantee per token</div>
              </div>
              <div class="pipeline-stage-badge" style="color:var(--purple);border-color:rgba(139,92,246,0.25);background:rgba(139,92,246,0.08);">&epsilon;-bounded &middot; ICLR 2026</div>
            </div>

            <!-- Connector 2 -->
            <div class="pipeline-connector">
              <div class="pipeline-connector-line glow">
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-arrow"></div>
              </div>
            </div>

            <!-- Stage 3: 3-Round LLM Pipeline -->
            <div class="pipeline-stage stage-amber" style="min-width:220px;max-width:240px;">
              <div class="pipeline-stage-num">Layer 03</div>
              <div style="display:flex;align-items:center;gap:7px;margin-bottom:4px;">
                <span class="pipeline-stage-icon">&#129504;</span>
                <div>
                  <div class="pipeline-stage-title">3-Round Investigation</div>
                  <div class="pipeline-stage-sub">Adversarial Cross-Check Pipeline</div>
                </div>
              </div>
              <div class="pipeline-stage-body">
                <!-- Round 1 -->
                <div class="priv-round-item">
                  <div class="priv-round-num">1</div>
                  <div style="flex:1;">
                    <div class="priv-round-model">Claude Opus</div>
                    <div class="priv-round-purpose">Deep contextual reasoning</div>
                  </div>
                  <div class="priv-round-conf">94%</div>
                </div>
                <!-- Round arrow -->
                <div class="priv-round-arrow">
                  <div class="priv-flow-dot" style="left:50%;"></div>
                  &#8595;
                </div>
                <!-- Round 2 -->
                <div class="priv-round-item">
                  <div class="priv-round-num">2</div>
                  <div style="flex:1;">
                    <div class="priv-round-model">GPT 5.2</div>
                    <div class="priv-round-purpose">Cross-validation &amp; alternatives</div>
                  </div>
                  <div class="priv-round-conf">91%</div>
                </div>
                <!-- Round arrow -->
                <div class="priv-round-arrow">
                  <div class="priv-flow-dot" style="left:50%;animation-delay:0.5s;"></div>
                  &#8595;
                </div>
                <!-- Round 3 -->
                <div class="priv-round-item" style="border-color:rgba(245,158,11,0.2);background:rgba(245,158,11,0.04);">
                  <div class="priv-round-num" style="background:rgba(245,158,11,0.25);border-color:rgba(245,158,11,0.5);">3</div>
                  <div style="flex:1;">
                    <div class="priv-round-model">Gemini 3.1 Pro</div>
                    <div class="priv-round-purpose">Final synthesis &amp; confidence</div>
                  </div>
                  <div class="priv-round-conf" style="color:var(--green);">97%</div>
                </div>
              </div>
              <div class="pipeline-stage-badge" style="color:var(--amber);border-color:rgba(245,158,11,0.25);background:rgba(245,158,11,0.08);">&#129504; Adversarial Cross-Check</div>
            </div>

            <!-- Connector 3 -->
            <div class="pipeline-connector">
              <div class="pipeline-connector-line glow">
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-arrow"></div>
              </div>
            </div>

            <!-- Stage 4: Detokenization -->
            <div class="pipeline-stage stage-green">
              <div class="pipeline-stage-num">Layer 04</div>
              <div style="display:flex;align-items:center;gap:7px;margin-bottom:4px;">
                <span class="pipeline-stage-icon">&#9989;</span>
                <div>
                  <div class="pipeline-stage-title">Detokenization</div>
                  <div class="pipeline-stage-sub">Secure Re-identification</div>
                </div>
              </div>
              <div class="pipeline-stage-body">
                <div style="display:flex;flex-direction:column;gap:5px;">
                  <div style="display:flex;align-items:center;gap:6px;font-size:10.5px;color:var(--text-secondary);">
                    <span style="color:var(--green);font-size:11px;">&#10003;</span>
                    RBAC-gated access control
                  </div>
                  <div style="display:flex;align-items:center;gap:6px;font-size:10.5px;color:var(--text-secondary);">
                    <span style="color:var(--green);font-size:11px;">&#10003;</span>
                    Tamper-proof audit log
                  </div>
                  <div style="display:flex;align-items:center;gap:6px;font-size:10.5px;color:var(--text-secondary);">
                    <span style="color:var(--green);font-size:11px;">&#10003;</span>
                    Only authorised analysts<br>&nbsp;&nbsp;&nbsp;&nbsp;can reverse mapping
                  </div>
                  <div style="display:flex;align-items:center;gap:6px;font-size:10.5px;color:var(--text-secondary);">
                    <span style="color:var(--green);font-size:11px;">&#10003;</span>
                    Zero LLM token exposure
                  </div>
                </div>
              </div>
              <div class="pipeline-stage-badge" style="color:var(--green);border-color:rgba(16,185,129,0.25);background:rgba(16,185,129,0.08);">&#128274; Dacta-Only &middot; Zero LLM Exposure</div>
            </div>

            <!-- Connector to output -->
            <div class="pipeline-connector">
              <div class="pipeline-connector-line glow">
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-dot"></div>
                <div class="pipeline-connector-arrow"></div>
              </div>
            </div>

            <!-- Output node: Final Report -->
            <div class="priv-io-node">
              <div class="priv-io-box" style="border-color:rgba(16,185,129,0.25);background:rgba(16,185,129,0.05);">
                <span class="priv-io-icon">&#128196;</span>
                <div style="font-size:10px;font-weight:700;color:var(--green);margin-bottom:2px;">Final Report</div>
                <div style="font-size:9px;color:var(--text-muted);">Full PII<br>restored</div>
              </div>
            </div>

          </div><!-- end privacy-pipeline -->
        </div><!-- end pipeline hero card -->

        <!-- SOC Data Classification Table -->
        <div class="card" style="margin-bottom:18px;">
          <div class="card-header">
            <span class="card-title">SOC Data Classification &amp; Treatment Policy</span>
            <span style="font-size:11px;color:var(--text-muted);">7 categories &middot; auto-applied at ingestion</span>
          </div>
          <div class="table-wrap">
            <table class="priv-class-table">
              <thead>
                <tr>
                  <th>Data Category</th>
                  <th>Risk Level</th>
                  <th>Treatment</th>
                  <th>Example</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Client Names &amp; Domains</td>
                  <td><span class="priv-risk-badge priv-risk-critical">&#128308; Critical</span></td>
                  <td>Tokenize (reversible)</td>
                  <td class="mono">Naga World &rarr; [[CLIENT_0x7A]]</td>
                </tr>
                <tr>
                  <td>IP Addresses, Hostnames</td>
                  <td><span class="priv-risk-badge priv-risk-critical">&#128308; Critical</span></td>
                  <td>Pseudonymize</td>
                  <td class="mono">192.168.1.45 &rarr; [[IP_0x3F]]</td>
                </tr>
                <tr>
                  <td>Email Addresses</td>
                  <td><span class="priv-risk-badge priv-risk-critical">&#128308; Critical</span></td>
                  <td>Tokenize</td>
                  <td class="mono">john@client.com &rarr; [[EMAIL_0x12]]</td>
                </tr>
                <tr>
                  <td>MITRE ATT&amp;CK TTPs</td>
                  <td><span class="priv-risk-badge priv-risk-safe">&#128994; Safe</span></td>
                  <td>Pass Through</td>
                  <td class="mono">T1486 - Data Encrypted for Impact</td>
                </tr>
                <tr>
                  <td>File Hashes (SHA256)</td>
                  <td><span class="priv-risk-badge priv-risk-safe">&#128994; Safe</span></td>
                  <td>Pass Through</td>
                  <td class="mono">a1b2c3d4e5f6...</td>
                </tr>
                <tr>
                  <td>Timestamps</td>
                  <td><span class="priv-risk-badge priv-risk-moderate">&#128992; Moderate</span></td>
                  <td>Generalise &rarr; Restore</td>
                  <td class="mono">14:23:07 &rarr; 14:00-15:00 window</td>
                </tr>
                <tr>
                  <td>Raw Log Payloads</td>
                  <td><span class="priv-risk-badge priv-risk-critical">&#128308; Critical</span></td>
                  <td>Tokenize all identifiers</td>
                  <td class="mono">Keep structural patterns only</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Compliance Dashboard + Tokenization Chart row -->
        <div class="grid-2" style="margin-bottom:18px;">

          <!-- Left: Regulatory Compliance Status -->
          <div class="card">
            <div class="card-header">
              <span class="card-title">Regulatory Compliance Status</span>
              <span class="badge badge-green" style="font-size:10px;">4 frameworks</span>
            </div>
            <div class="priv-compliance-item">
              <div class="priv-compliance-badge ok">COMPLIANT</div>
              <div>
                <div class="priv-compliance-name">Singapore PDPA</div>
                <div class="priv-compliance-note">Anonymised data exempt from Parts III&ndash;VI &middot; Last audit: Jan 2026</div>
              </div>
            </div>
            <div class="priv-compliance-item">
              <div class="priv-compliance-badge ok">COMPLIANT</div>
              <div>
                <div class="priv-compliance-name">MAS TRM 2021</div>
                <div class="priv-compliance-note">Data residency maintained &middot; All processing on-premise</div>
              </div>
            </div>
            <div class="priv-compliance-item">
              <div class="priv-compliance-badge ok">COMPLIANT</div>
              <div>
                <div class="priv-compliance-name">GDPR (EU Clients)</div>
                <div class="priv-compliance-note">Cross-border transfer controls active &middot; SCCs in place</div>
              </div>
            </div>
            <div class="priv-compliance-item">
              <div class="priv-compliance-badge wip">IN PROGRESS</div>
              <div>
                <div class="priv-compliance-name">ISO 27701</div>
                <div class="priv-compliance-note">Certification expected Q2 2026 &middot; Gap assessment: 87% complete</div>
              </div>
            </div>
            <div class="priv-compliance-item">
              <div class="priv-compliance-badge planned">PLANNED</div>
              <div>
                <div class="priv-compliance-name">SOC 2 Type II</div>
                <div class="priv-compliance-note">AICPA Trust Service Criteria &middot; Audit kickoff targeted Q3 2026 &middot; 5 criteria mapped</div>
              </div>
            </div>
          </div>

          <!-- Right: Tenant Isolation Matrix + Tokenization Doughnut -->
          <div class="card">
            <div class="card-header">
              <span class="card-title">Tenant Isolation Matrix</span>
              <span style="font-size:11px;color:var(--text-muted);">Namespace segregation</span>
            </div>
            <div class="priv-tenant-grid" style="margin-bottom:14px;">
              <div class="priv-tenant-item">
                <div class="priv-tenant-name">SPMT</div>
                <div class="priv-tenant-ns">NS_SPMT_*</div>
                <div class="priv-tenant-badge">Zero cross-tenant leakage</div>
              </div>
              <div class="priv-tenant-item">
                <div class="priv-tenant-name">Naga World</div>
                <div class="priv-tenant-ns">NS_NAGA_*</div>
                <div class="priv-tenant-badge">Zero cross-tenant leakage</div>
              </div>
              <div class="priv-tenant-item">
                <div class="priv-tenant-name">ADV Partners</div>
                <div class="priv-tenant-ns">NS_ADVP_*</div>
                <div class="priv-tenant-badge">Zero cross-tenant leakage</div>
              </div>
              <div class="priv-tenant-item">
                <div class="priv-tenant-name">Global Advisor</div>
                <div class="priv-tenant-ns">NS_GLOB_*</div>
                <div class="priv-tenant-badge">Zero cross-tenant leakage</div>
              </div>
            </div>
            <!-- Tokenization by data type chart -->
            <div class="card-header" style="margin-top:4px;padding-top:12px;border-top:1px solid var(--border-subtle);">
              <span class="card-title" style="font-size:12px;">Tokenization by Data Type</span>
            </div>
            <div class="priv-chart-wrap">
              <canvas id="privTokenChart" style="max-height:180px;"></canvas>
              <div class="priv-chart-center">
                <div class="priv-chart-center-val">34.9K</div>
                <div class="priv-chart-center-lbl">Today</div>
              </div>
            </div>
            <div style="display:flex;flex-wrap:wrap;gap:8px;margin-top:8px;">
              <div style="display:flex;align-items:center;gap:5px;font-size:10px;color:var(--text-muted);"><span style="width:8px;height:8px;border-radius:50%;background:#00d4ff;display:inline-block;"></span>Client (41%)</div>
              <div style="display:flex;align-items:center;gap:5px;font-size:10px;color:var(--text-muted);"><span style="width:8px;height:8px;border-radius:50%;background:#8b5cf6;display:inline-block;"></span>IP/Host (33%)</div>
              <div style="display:flex;align-items:center;gap:5px;font-size:10px;color:var(--text-muted);"><span style="width:8px;height:8px;border-radius:50%;background:#f59e0b;display:inline-block;"></span>Email (17%)</div>
              <div style="display:flex;align-items:center;gap:5px;font-size:10px;color:var(--text-muted);"><span style="width:8px;height:8px;border-radius:50%;background:#10b981;display:inline-block;"></span>Other (9%)</div>
            </div>
          </div>

        </div><!-- end grid-2 -->

        <!-- Recent Tokenization Audit Log -->
        <div class="card">
          <div class="card-header">
            <span class="card-title">Tokenization Audit Log</span>
            <div style="display:flex;gap:8px;">
              <span style="font-size:11px;color:var(--text-muted);">Last 6 events</span>
              <button class="btn btn-secondary btn-sm">View Full Log</button>
            </div>
          </div>

          <div class="priv-audit-item">
            <div class="priv-audit-ts">2026-02-27 22:41:03 SGT</div>
            <div class="priv-audit-type tok">Tokenize</div>
            <div class="priv-audit-body">
              <div class="priv-audit-main">Naga World alert #NW-4401 &mdash; 847 tokens generated across 4 categories</div>
              <div class="priv-audit-meta">Analyst: Wei Chen &middot; Policy: NW-PDPA-v3 &middot; Pipeline: Layer 01&ndash;04</div>
            </div>
            <div class="priv-audit-status">SUCCESS</div>
          </div>

          <div class="priv-audit-item">
            <div class="priv-audit-ts">2026-02-27 22:38:15 SGT</div>
            <div class="priv-audit-type detok">Detokenize</div>
            <div class="priv-audit-body">
              <div class="priv-audit-main">SPMT alert #SP-1892 &mdash; RBAC verified, full re-identification granted</div>
              <div class="priv-audit-meta">Analyst: Arun Patel &middot; Role: Senior Analyst &middot; MFA: &#10003; passed</div>
            </div>
            <div class="priv-audit-status">SUCCESS</div>
          </div>

          <div class="priv-audit-item">
            <div class="priv-audit-ts">2026-02-27 22:31:47 SGT</div>
            <div class="priv-audit-type tok">Tokenize</div>
            <div class="priv-audit-body">
              <div class="priv-audit-main">ADV Partners alert #AP-0334 &mdash; 512 tokens generated, DP-Fusion applied</div>
              <div class="priv-audit-meta">Analyst: Sarah Tan &middot; Policy: ADVP-MAS-v2 &middot; &epsilon; = 2.0 enforced</div>
            </div>
            <div class="priv-audit-status">SUCCESS</div>
          </div>

          <div class="priv-audit-item">
            <div class="priv-audit-ts">2026-02-27 22:19:22 SGT</div>
            <div class="priv-audit-type query">LLM Query</div>
            <div class="priv-audit-body">
              <div class="priv-audit-main">Naga World #NW-4398 &mdash; 3-round investigation complete, 97% confidence</div>
              <div class="priv-audit-meta">Models: Claude Opus &rarr; GPT 5.2 &rarr; Gemini 3.1 Pro &middot; Zero PII in LLM context</div>
            </div>
            <div class="priv-audit-status">SUCCESS</div>
          </div>

          <div class="priv-audit-item">
            <div class="priv-audit-ts">2026-02-27 22:05:11 SGT</div>
            <div class="priv-audit-type detok">Detokenize</div>
            <div class="priv-audit-body">
              <div class="priv-audit-main">Global Advisor alert #GA-0891 &mdash; partial detokenisation (client name only)</div>
              <div class="priv-audit-meta">Analyst: John Lim &middot; Role: Lead Analyst &middot; Partial scope: CLIENT_* only</div>
            </div>
            <div class="priv-audit-status">SUCCESS</div>
          </div>

          <div class="priv-audit-item" style="border-bottom:none;">
            <div class="priv-audit-ts">2026-02-27 21:58:04 SGT</div>
            <div class="priv-audit-type tok">Tokenize</div>
            <div class="priv-audit-body">
              <div class="priv-audit-main">SPMT alert #SP-1891 &mdash; 1,203 tokens generated, bulk ingestion event</div>
              <div class="priv-audit-meta">Analyst: System (auto) &middot; Policy: SPMT-PDPA-v4 &middot; Latency: 18ms</div>
            </div>
            <div class="priv-audit-status">SUCCESS</div>
          </div>

        </div><!-- end audit log card -->

      </div><!-- end page-privacy -->


      <!-- =====================================================
           PAGE: WAR ROOM â€” IR / DFIR CENTER
           ===================================================== -->
      <div class="page" id="page-warroom">

        <!-- PAGE HEADER -->
        <div class="page-header">
          <div>
            <div class="page-title">War Room &mdash; DACTA Incident Response</div>
            <div class="page-subtitle">DFIR / MDR / SOCaaS &middot; Hot &amp; Cold Mode &middot; 7-Phase Lifecycle</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm" onclick="wr2OpenNewEng()">&#x2795; New Engagement</button>
            <button class="btn btn-secondary btn-sm">&#x1F4CB; Export All Reports</button>
            <button class="btn btn-primary btn-sm" onclick="wr2ToggleCopilot()">&#x2728; Copilot</button>
          </div>
        </div>

        <!-- ENGAGEMENT SELECTOR BAR -->
        <div class="wr2-eng-bar" id="wr2EngBar">
          <div class="wr2-eng-tab active" onclick="wr2SelectEng(this,'eng003')" data-eng="eng003">
            <span class="wr2-eng-id">WR-2026-003</span>
            <span class="wr2-eng-name">NagaWorld &mdash; Ransomware</span>
            <span class="wr2-mode-hot">HOT</span>
            <span class="badge badge-red">SEV-1</span>
            <span class="badge badge-open">Active</span>
          </div>
          <div class="wr2-eng-tab" onclick="wr2SelectEng(this,'eng004')" data-eng="eng004">
            <span class="wr2-eng-id">WR-2026-004</span>
            <span class="wr2-eng-name">ADV Partners &mdash; BEC</span>
            <span class="wr2-mode-cold">COLD</span>
            <span class="badge badge-amber">SEV-2</span>
            <span class="badge badge-open">Active</span>
          </div>
          <div class="wr2-eng-add" onclick="wr2OpenNewEng()">&#x2B; Add Engagement</div>
        </div>

        <!-- ========== ENGAGEMENT: eng003 (Hot Mode) ========== -->
        <div class="wr2-engagement-panel active" id="wr2-panel-eng003">

          <!-- TOP STATUS BAR -->
          <div class="wr2-topbar">
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Engagement ID</span>
              <span class="wr2-tb-val mono" id="wr2-eid-003">WR-2026-003</span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Client</span>
              <span class="wr2-tb-val">NagaWorld Ltd.</span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Incident Type</span>
              <span class="wr2-tb-val"><span class="badge badge-red" style="font-size:10px;">Ransomware</span></span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Severity</span>
              <span class="wr2-tb-val"><span class="wr2-sev-badge sev1">SEV-1 CRITICAL</span></span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Elapsed Time</span>
              <span class="wr2-tb-val">
                <div class="wr2-timer-wrap">
                  <span class="wr2-elapsed" id="wr2ElapsedHot">14:32:07</span>
                  <button class="wr2-timer-btn" id="wr2PauseHot" onclick="wr2ToggleTimer('hot')" title="Pause / Resume Timer">&#x23F8;</button>
                  <span class="wr2-timer-paused-label" id="wr2PausedLabelHot" style="display:none;">PAUSED</span>
                </div>
                <div class="wr2-manhours-row">
                  Man-hours: <span class="wr2-manhours-val" id="wr2ManhoursHot">29:04</span> <span style="color:var(--text-muted);">(2 analysts)</span>
                </div>
              </span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Phase</span>
              <span class="wr2-tb-val"><span class="badge badge-amber">INVESTIGATE</span></span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Lead Analyst</span>
              <span class="wr2-tb-val">K. Rasmussen</span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Status</span>
              <span class="wr2-tb-val"><span class="wr2-status-active">Active</span></span>
            </div>
            <div class="wr2-topbar-spacer"></div>
            <div class="wr2-topbar-item" style="border-right:none;">
              <span class="wr2-tb-label">TLP</span>
              <span class="wr2-tlp-badge amber">TLP:AMBER</span>
            </div>
            <!-- Task 7: Share button in topbar -->
            <div class="wr2-topbar-item" style="border-right:none;padding:0 10px;">
              <button class="wr-share-btn" onclick="openWrShareModal()">
                &#x1F465; Share &amp; Collaborate
              </button>
            </div>
          </div>

          <!-- PHASE PIPELINE -->
          <div class="wr2-phase-row">
            <div class="wr2-phase-item done">
              <div class="wr2-ph-dot">&#x2713;</div>
              <span class="wr2-ph-label">Activate</span>
            </div>
            <div class="wr2-phase-item done">
              <div class="wr2-ph-dot">&#x2713;</div>
              <span class="wr2-ph-label">Scope</span>
            </div>
            <div class="wr2-phase-item done">
              <div class="wr2-ph-dot">&#x2713;</div>
              <span class="wr2-ph-label">Collect</span>
            </div>
            <div class="wr2-phase-item current">
              <div class="wr2-ph-dot">4</div>
              <span class="wr2-ph-label">Investigate</span>
            </div>
            <div class="wr2-phase-item pending">
              <div class="wr2-ph-dot">5</div>
              <span class="wr2-ph-label">Contain</span>
            </div>
            <div class="wr2-phase-item pending">
              <div class="wr2-ph-dot">6</div>
              <span class="wr2-ph-label">Eradicate</span>
            </div>
            <div class="wr2-phase-item pending">
              <div class="wr2-ph-dot">7</div>
              <span class="wr2-ph-label">Report</span>
            </div>
          </div>

          <!-- MAIN LAYOUT: TABS + COPILOT -->
          <div class="wr2-layout">

            <!-- LEFT: TABBED MAIN CONTENT -->
            <div class="wr2-main" id="wr2MainPanel003">
              <!-- Inner nav -->
              <div class="wr2-nav" id="wr2Nav003">
                <div class="wr2-nav-tab active" onclick="wr2SwitchTab(this,'wr2-003-overview','wr2Nav003','wr2Content003')">Overview</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-003-scoping','wr2Nav003','wr2Content003')">Scoping</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-003-evidence','wr2Nav003','wr2Content003')">Evidence</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-003-investigation','wr2Nav003','wr2Content003')">Investigation <span class="tab-badge">47</span></div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-003-assets','wr2Nav003','wr2Content003')">Assets <span class="tab-badge">23</span></div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-003-containment','wr2Nav003','wr2Content003')">Containment</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-003-eradication','wr2Nav003','wr2Content003')">Eradication</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-003-reports','wr2Nav003','wr2Content003')">Reports</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-003-comms','wr2Nav003','wr2Content003')">Comms</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-003-settings','wr2Nav003','wr2Content003')">Settings</div>
              </div>

              <!-- Tab panes container -->
              <div id="wr2Content003" style="flex:1; overflow-y:auto; display:flex; flex-direction:column;">

                <!-- ======= TAB: OVERVIEW ======= -->
                <div class="wr2-tab-pane active" id="wr2-003-overview">

                  <!-- KPI Row -->
                  <div class="wr2-kpi-row">
                    <div class="wr2-kpi cyan">
                      <div class="wr2-kpi-label">Elapsed Time</div>
                      <div class="wr2-kpi-value" id="wr2KpiElapsed003">14:32</div>
                      <div class="wr2-kpi-sub">hrs since activation</div>
                    </div>
                    <div class="wr2-kpi red">
                      <div class="wr2-kpi-label">IOCs Found</div>
                      <div class="wr2-kpi-value">47</div>
                      <div class="wr2-kpi-sub">12 high-confidence</div>
                    </div>
                    <div class="wr2-kpi amber">
                      <div class="wr2-kpi-label">Affected Assets</div>
                      <div class="wr2-kpi-value">23</div>
                      <div class="wr2-kpi-sub">8 confirmed compromised</div>
                    </div>
                    <div class="wr2-kpi green">
                      <div class="wr2-kpi-label">Actions Taken</div>
                      <div class="wr2-kpi-value">14</div>
                      <div class="wr2-kpi-sub">6 containment actions</div>
                    </div>
                  </div>

                  <!-- Horizontal Attack Timeline -->
                  <div class="wr2-atk-timeline">
                    <div class="wr2-atk-title">Attack Timeline â€” NagaWorld Ransomware</div>
                    <div class="wr2-atk-track">
                      <div class="wr2-atk-node" title="Initial Access via phishing email â€” 01:14">
                        <div class="wr2-atk-dot initial">&#x1F4E7;</div>
                        <div class="wr2-atk-node-time">01:14</div>
                        <div class="wr2-atk-node-label">Phishing<br>Email</div>
                      </div>
                      <div class="wr2-atk-node" title="Macro execution drops Cobalt Strike beacon">
                        <div class="wr2-atk-dot exec">&#x26A1;</div>
                        <div class="wr2-atk-node-time">01:47</div>
                        <div class="wr2-atk-node-label">Macro<br>Exec</div>
                      </div>
                      <div class="wr2-atk-node" title="Scheduled task persistence established">
                        <div class="wr2-atk-dot persist">&#x1F527;</div>
                        <div class="wr2-atk-node-time">02:03</div>
                        <div class="wr2-atk-node-label">Persistence<br>Scheduled Task</div>
                      </div>
                      <div class="wr2-atk-node" title="C2 beacon to 185.220.101.47:443">
                        <div class="wr2-atk-dot c2">&#x1F4F6;</div>
                        <div class="wr2-atk-node-time">02:11</div>
                        <div class="wr2-atk-node-label">C2<br>Beacon</div>
                      </div>
                      <div class="wr2-atk-node" title="Lateral movement via PsExec to DC">
                        <div class="wr2-atk-dot lateral">&#x27A1;</div>
                        <div class="wr2-atk-node-time">03:55</div>
                        <div class="wr2-atk-node-label">Lateral<br>PsExec</div>
                      </div>
                      <div class="wr2-atk-node" title="Domain admin credentials harvested via LSASS dump">
                        <div class="wr2-atk-dot persist">&#x1F511;</div>
                        <div class="wr2-atk-node-time">04:22</div>
                        <div class="wr2-atk-node-label">Cred<br>Harvest</div>
                      </div>
                      <div class="wr2-atk-node" title="Data exfiltration to mega.nz â€” ~280GB">
                        <div class="wr2-atk-dot exfil">&#x2B06;</div>
                        <div class="wr2-atk-node-time">06:10</div>
                        <div class="wr2-atk-node-label">Exfil<br>280GB</div>
                      </div>
                      <div class="wr2-atk-node" title="ALPHV/BlackCat ransomware payload dropped and executed">
                        <div class="wr2-atk-dot impact">&#x1F525;</div>
                        <div class="wr2-atk-node-time">09:47</div>
                        <div class="wr2-atk-node-label">Ransomware<br>ALPHV</div>
                      </div>
                      <div class="wr2-atk-node" title="Network isolation initiated by DACTA">
                        <div class="wr2-atk-dot contain">&#x1F6E1;</div>
                        <div class="wr2-atk-node-time">10:15</div>
                        <div class="wr2-atk-node-label">Containment<br>Initiated</div>
                      </div>
                    </div>
                  </div>

                  <!-- Overview 3-col grid -->
                  <div class="wr2-overview-grid">

                    <!-- Response Team -->
                    <div class="wr2-panel">
                      <div class="wr2-panel-title">
                        Response Team
                        <span style="color:var(--green);font-size:10px;">4 Online</span>
                      </div>
                      <div class="wr2-team-member">
                        <div class="wr2-avatar lead">KR</div>
                        <div class="wr2-member-info">
                          <div class="wr2-member-name">K. Rasmussen</div>
                          <div class="wr2-member-role">Lead Analyst / IR Lead</div>
                        </div>
                        <div class="wr2-online-dot online"></div>
                      </div>
                      <div class="wr2-team-member">
                        <div class="wr2-avatar analyst">PT</div>
                        <div class="wr2-member-info">
                          <div class="wr2-member-name">P. Tran</div>
                          <div class="wr2-member-role">Malware Analyst</div>
                        </div>
                        <div class="wr2-online-dot online"></div>
                      </div>
                      <div class="wr2-team-member">
                        <div class="wr2-avatar forensics">SL</div>
                        <div class="wr2-member-info">
                          <div class="wr2-member-name">S. Lim</div>
                          <div class="wr2-member-role">Digital Forensics</div>
                        </div>
                        <div class="wr2-online-dot online"></div>
                      </div>
                      <div class="wr2-team-member">
                        <div class="wr2-avatar threat">MN</div>
                        <div class="wr2-member-info">
                          <div class="wr2-member-name">M. Nguyen</div>
                          <div class="wr2-member-role">Threat Intelligence</div>
                        </div>
                        <div class="wr2-online-dot online"></div>
                      </div>
                      <div class="wr2-team-member">
                        <div class="wr2-avatar analyst" style="background:rgba(100,116,139,0.1);color:#94a3b8;border-color:rgba(100,116,139,0.2);">JW</div>
                        <div class="wr2-member-info">
                          <div class="wr2-member-name">J. Wang</div>
                          <div class="wr2-member-role">Network Analyst</div>
                        </div>
                        <div class="wr2-online-dot away"></div>
                      </div>
                    </div>

                    <!-- MITRE Coverage -->
                    <div class="wr2-panel">
                      <div class="wr2-panel-title">MITRE ATT&amp;CK Coverage</div>
                      <div class="wr2-mitre-labels">
                        <span class="wr2-mitre-label">Recon</span>
                        <span class="wr2-mitre-label">Res</span>
                        <span class="wr2-mitre-label">Init</span>
                        <span class="wr2-mitre-label">Exec</span>
                        <span class="wr2-mitre-label">Perst</span>
                        <span class="wr2-mitre-label">PrvEsc</span>
                        <span class="wr2-mitre-label">Def</span>
                        <span class="wr2-mitre-label">Cred</span>
                        <span class="wr2-mitre-label">Disc</span>
                        <span class="wr2-mitre-label">Lat</span>
                        <span class="wr2-mitre-label">Exfil</span>
                      </div>
                      <div class="wr2-mitre-grid" id="wr2MitreGrid003"></div>
                      <div style="display:flex;gap:8px;margin-top:8px;font-size:9px;color:var(--text-muted);">
                        <span><span style="display:inline-block;width:8px;height:8px;background:rgba(255,255,255,0.04);border-radius:1px;margin-right:3px;"></span>None</span>
                        <span><span style="display:inline-block;width:8px;height:8px;background:rgba(245,158,11,0.25);border-radius:1px;margin-right:3px;"></span>Low</span>
                        <span><span style="display:inline-block;width:8px;height:8px;background:rgba(239,68,68,0.45);border-radius:1px;margin-right:3px;"></span>Med</span>
                        <span><span style="display:inline-block;width:8px;height:8px;background:rgba(239,68,68,0.8);border-radius:1px;margin-right:3px;"></span>High</span>
                      </div>
                    </div>

                    <!-- Engagement Details + Activity Feed -->
                    <div class="wr2-panel">
                      <div class="wr2-panel-title">Engagement Details</div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Client</span><span class="wr2-detail-val2">NagaWorld Ltd.</span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Mode</span><span class="wr2-detail-val2"><span class="wr2-mode-hot">HOT MODE</span></span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Incident Type</span><span class="wr2-detail-val2"><span class="badge badge-red" style="font-size:9px;">Ransomware</span></span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Severity</span><span class="wr2-detail-val2"><span class="wr2-sev-badge sev1">SEV-1</span></span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">TLP</span><span class="wr2-detail-val2"><span class="wr2-tlp-badge amber" style="font-size:9px;">TLP:AMBER</span></span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Opened</span><span class="wr2-detail-val2" style="font-family:var(--font-mono);font-size:10px;">2026-02-28 13:24 SGT</span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Retainer</span><span class="wr2-detail-val2">MDR Enterprise</span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">SLA Remaining</span><span class="wr2-detail-val2" style="color:var(--amber);">1h 28m</span></div>
                    </div>

                  </div>

                  <!-- Activity Feed -->
                  <div class="wr2-panel" style="margin-top:0;">
                    <div class="wr2-panel-title">Activity Feed <span style="color:var(--cyan);font-size:9px;font-weight:400;">Live</span></div>
                    <div class="wr2-feed-item">
                      <span class="wr2-feed-time">03:58</span>
                      <span class="wr2-feed-dot red"></span>
                      <span class="wr2-feed-text"><strong>K. Rasmussen</strong> identified ALPHV ransom note at <span style="font-family:var(--font-mono);font-size:10px;">C:\Users\Public\RECOVER_FILES.txt</span></span>
                    </div>
                    <div class="wr2-feed-item">
                      <span class="wr2-feed-time">03:52</span>
                      <span class="wr2-feed-dot amber"></span>
                      <span class="wr2-feed-text"><strong>P. Tran</strong> submitted hash <span class="mono">a3f4bc...</span> to VirusTotal â€” <strong style="color:var(--red-bright);">58/72 detections</strong></span>
                    </div>
                    <div class="wr2-feed-item">
                      <span class="wr2-feed-time">03:44</span>
                      <span class="wr2-feed-dot purple"></span>
                      <span class="wr2-feed-text"><strong>S. Lim</strong> acquired memory image from <span class="mono">NAGA-DC01</span> (32GB) â€” chain of custody logged</span>
                    </div>
                    <div class="wr2-feed-item">
                      <span class="wr2-feed-time">03:31</span>
                      <span class="wr2-feed-dot green"></span>
                      <span class="wr2-feed-text"><strong>M. Nguyen</strong> linked C2 IP <span class="mono">185.220.101.47</span> to ALPHV infrastructure via MISP</span>
                    </div>
                    <div class="wr2-feed-item">
                      <span class="wr2-feed-time">03:15</span>
                      <span class="wr2-feed-dot cyan"></span>
                      <span class="wr2-feed-text">Status update sent to <strong>NagaWorld CISO (D. Sok)</strong> â€” Phase 4 briefing</span>
                    </div>
                    <div class="wr2-feed-item">
                      <span class="wr2-feed-time">02:58</span>
                      <span class="wr2-feed-dot red"></span>
                      <span class="wr2-feed-text"><strong>K. Rasmussen</strong> isolated <span class="mono">NAGA-WS-047</span> from network â€” authorization: D. Sok</span>
                    </div>
                  </div>

                </div><!-- end overview tab -->

                <!-- ======= TAB: SCOPING ======= -->
                <div class="wr2-tab-pane" id="wr2-003-scoping">
                  <div style="background:rgba(16,185,129,0.07);border:1px solid rgba(16,185,129,0.2);border-radius:8px;padding:12px 14px;margin-bottom:16px;font-size:11px;color:var(--green);display:flex;align-items:flex-start;gap:10px;">
                    <span style="font-size:16px;">&#x26A1;</span>
                    <div><strong>HOT MODE â€” Pre-populated from MDR telemetry.</strong> Environment data auto-pulled from Sentinel &amp; CrowdStrike. Review and confirm below.</div>
                  </div>

                  <div class="wr2-question-group">
                    <div class="wr2-qg-title">&#x1F3E2; Environment Overview</div>
                    <div class="wr2-field-row">
                      <div class="wr2-field"><label class="wr2-field-label">AD Domain Count</label><input type="number" value="2"></div>
                      <div class="wr2-field"><label class="wr2-field-label">Total Endpoints</label><input type="number" value="847"></div>
                      <div class="wr2-field"><label class="wr2-field-label">Domain Controllers</label><input type="number" value="3"></div>
                      <div class="wr2-field"><label class="wr2-field-label">Servers</label><input type="number" value="42"></div>
                    </div>
                    <div class="wr2-field-row">
                      <div class="wr2-field"><label class="wr2-field-label">SIEM Platform</label><select><option>Microsoft Sentinel</option><option>Splunk</option><option>Elastic SIEM</option></select></div>
                      <div class="wr2-field"><label class="wr2-field-label">EDR Solution</label><select><option>CrowdStrike Falcon</option><option>SentinelOne</option><option>Microsoft Defender</option></select></div>
                      <div class="wr2-field"><label class="wr2-field-label">Backup Strategy</label><select><option>Veeam â€” Offsite</option><option>Azure Backup</option><option>Unknown</option></select></div>
                    </div>
                  </div>

                  <div class="wr2-question-group">
                    <div class="wr2-qg-title">&#x1F4F6; Network Topology</div>
                    <div class="wr2-field-row">
                      <div class="wr2-field"><label class="wr2-field-label">Internal Subnet Ranges</label><input type="text" value="10.1.0.0/16, 10.2.0.0/16, 192.168.100.0/24"></div>
                      <div class="wr2-field"><label class="wr2-field-label">Internet Egress IPs</label><input type="text" value="203.174.21.50, 203.174.21.51"></div>
                    </div>
                    <div class="wr2-field-row">
                      <div class="wr2-field"><label class="wr2-field-label">VPN Solution</label><input type="text" value="Palo Alto GlobalProtect"></div>
                      <div class="wr2-field"><label class="wr2-field-label">Cloud Presence</label><select><option>Azure + AWS</option><option>Azure Only</option><option>On-prem Only</option></select></div>
                    </div>
                  </div>

                  <div class="wr2-question-group">
                    <div class="wr2-qg-title">&#x1F4CB; Incident Context</div>
                    <div class="wr2-field-row">
                      <div class="wr2-field" style="flex:2;"><label class="wr2-field-label">Initial Discovery Method</label><input type="text" value="SOC alert â€” mass encryption activity detected by Sentinel at 09:47 SGT"></div>
                      <div class="wr2-field"><label class="wr2-field-label">Patient Zero (suspected)</label><input type="text" value="NAGA-WS-012 (Finance dept)"></div>
                    </div>
                    <div class="wr2-field-row">
                      <div class="wr2-field" style="flex:2;"><label class="wr2-field-label">Business Impact Summary</label><textarea style="height:52px;">Hotel operations systems offline. Check-in/POS systems down. ~USD 2.4M/hr revenue impact estimated.</textarea></div>
                    </div>
                  </div>

                  <div style="display:flex;gap:10px;margin-top:4px;">
                    <button class="btn btn-primary btn-sm">&#x1F4CB; Generate Scoping Summary</button>
                    <button class="btn btn-secondary btn-sm">&#x1F916; AI Scoping Guidance</button>
                    <button class="btn btn-secondary btn-sm">&#x1F4BE; Save</button>
                  </div>
                </div><!-- end scoping tab -->

                <!-- ======= TAB: EVIDENCE ======= -->
                <div class="wr2-tab-pane" id="wr2-003-evidence">
                  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
                    <div style="font-size:10px;color:var(--text-muted);">Chain of custody tracked. All items logged with analyst, timestamp, and hash.</div>
                    <div style="display:flex;gap:8px;">
                      <button class="btn btn-secondary btn-sm">&#x1F4E4; Client Upload Portal</button>
                      <button class="btn btn-primary btn-sm">&#x2B; Add Evidence Item</button>
                    </div>
                  </div>

                  <!-- Tier 1 -->
                  <div class="wr2-tier">
                    <div class="wr2-tier-header" onclick="wr2ToggleTier(this)">
                      <span class="wr2-tier-badge t1">T1</span>
                      <span class="wr2-tier-name">Tier 1 &mdash; Endpoint Forensics</span>
                      <span class="wr2-tier-prog">6/8 items collected</span>
                      <span style="color:var(--text-muted);font-size:11px;margin-left:auto;">&#x25BC;</span>
                    </div>
                    <div class="wr2-tier-body">
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">Memory Image â€” NAGA-DC01 (32GB)</span><span class="wr2-ev-status-badge analyzed">analyzed</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">Memory Image â€” NAGA-WS-012 (16GB)</span><span class="wr2-ev-status-badge analyzed">analyzed</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">Disk Image â€” NAGA-WS-012 (2TB)</span><span class="wr2-ev-status-badge collected">collected</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">Windows Event Logs â€” All DCs (30 days)</span><span class="wr2-ev-status-badge analyzed">analyzed</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">CrowdStrike EDR Telemetry (72h window)</span><span class="wr2-ev-status-badge analyzed">analyzed</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">MFT â€” NAGA-WS-012</span><span class="wr2-ev-status-badge collected">collected</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2610;</span><span class="wr2-ev-name">Prefetch Files â€” Finance workstations (18 hosts)</span><span class="wr2-ev-status-badge collecting">collecting</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2610;</span><span class="wr2-ev-name">Ransomware Binary Sample (ALPHV)</span><span class="wr2-ev-status-badge requested">requested</span></div>
                    </div>
                  </div>

                  <!-- Tier 2 -->
                  <div class="wr2-tier">
                    <div class="wr2-tier-header" onclick="wr2ToggleTier(this)">
                      <span class="wr2-tier-badge t2">T2</span>
                      <span class="wr2-tier-name">Tier 2 &mdash; Network Evidence</span>
                      <span class="wr2-tier-prog">3/5 items collected</span>
                      <span style="color:var(--text-muted);font-size:11px;margin-left:auto;">&#x25BC;</span>
                    </div>
                    <div class="wr2-tier-body">
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">Firewall Logs â€” Palo Alto (30 days)</span><span class="wr2-ev-status-badge analyzed">analyzed</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">NetFlow Data â€” Core switches (72h)</span><span class="wr2-ev-status-badge collected">collected</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">DNS Query Logs â€” Internal resolver</span><span class="wr2-ev-status-badge analyzed">analyzed</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2610;</span><span class="wr2-ev-name">Full Packet Capture â€” Perimeter (post-incident)</span><span class="wr2-ev-status-badge collecting">collecting</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2610;</span><span class="wr2-ev-name">Proxy Logs â€” Zscaler (30 days)</span><span class="wr2-ev-status-badge requested">requested</span></div>
                    </div>
                  </div>

                  <!-- Tier 3 -->
                  <div class="wr2-tier">
                    <div class="wr2-tier-header" onclick="wr2ToggleTier(this)">
                      <span class="wr2-tier-badge t3">T3</span>
                      <span class="wr2-tier-name">Tier 3 &mdash; Identity &amp; Directory</span>
                      <span class="wr2-tier-prog">2/4 items collected</span>
                      <span style="color:var(--text-muted);font-size:11px;margin-left:auto;">&#x25BC;</span>
                    </div>
                    <div class="wr2-tier-body">
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">AD Audit Logs â€” Authentication events (30 days)</span><span class="wr2-ev-status-badge analyzed">analyzed</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">Azure AD Sign-in Logs</span><span class="wr2-ev-status-badge collected">collected</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2610;</span><span class="wr2-ev-name">Privileged Account Activity Report</span><span class="wr2-ev-status-badge pending">pending</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2610;</span><span class="wr2-ev-name">Group Policy Changes (30 days)</span><span class="wr2-ev-status-badge pending">pending</span></div>
                    </div>
                  </div>

                  <!-- Tier 4 -->
                  <div class="wr2-tier">
                    <div class="wr2-tier-header" onclick="wr2ToggleTier(this)">
                      <span class="wr2-tier-badge t4">T4</span>
                      <span class="wr2-tier-name">Tier 4 &mdash; Cloud &amp; Email</span>
                      <span class="wr2-tier-prog">1/3 items collected</span>
                      <span style="color:var(--text-muted);font-size:11px;margin-left:auto;">&#x25BC;</span>
                    </div>
                    <div class="wr2-tier-body">
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2611;</span><span class="wr2-ev-name">O365 Message Trace â€” Patient zero mailbox</span><span class="wr2-ev-status-badge analyzed">analyzed</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2610;</span><span class="wr2-ev-name">O365 Unified Audit Log (90 days)</span><span class="wr2-ev-status-badge requested">requested</span></div>
                      <div class="wr2-ev-item"><span class="wr2-ev-check">&#x2610;</span><span class="wr2-ev-name">Azure Activity Log â€” Suspicious resource changes</span><span class="wr2-ev-status-badge pending">pending</span></div>
                    </div>
                  </div>

                </div><!-- end evidence tab -->

                <!-- ======= TAB: INVESTIGATION ======= -->
                <div class="wr2-tab-pane" id="wr2-003-investigation">

                  <!-- IOC Registry -->
                  <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.1em;color:var(--text-muted);margin-bottom:8px;">IOC Registry &mdash; 47 indicators</div>
                  <div class="table-wrap" style="margin-bottom:16px;max-height:220px;overflow-y:auto;">
                    <table>
                      <thead>
                        <tr>
                          <th>Type</th><th>Indicator</th><th>Description</th><th>VT Score</th><th>Sources</th><th>Status</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="wr2-ioc-row"><td><span class="wr2-ioc-type ip">IP</span></td><td class="mono">185.220.101.47</td><td>ALPHV C2 Server</td><td><span class="wr2-vt-score high">58/72</span></td><td style="font-size:10px;color:var(--purple);">MISP &#x2022; AbuseIPDB</td><td><span class="badge badge-red" style="font-size:9px;">Confirmed</span></td></tr>
                        <tr class="wr2-ioc-row"><td><span class="wr2-ioc-type hash">Hash</span></td><td class="mono" style="font-size:10px;">a3f4bc7d1e...</td><td>ALPHV Ransomware Binary</td><td><span class="wr2-vt-score high">61/72</span></td><td style="font-size:10px;color:var(--purple);">VT &#x2022; MISP</td><td><span class="badge badge-red" style="font-size:9px;">Confirmed</span></td></tr>
                        <tr class="wr2-ioc-row"><td><span class="wr2-ioc-type domain">Domain</span></td><td class="mono" style="font-size:10px;">updates.typo3-cdn.net</td><td>CS Beacon C2 Domain</td><td><span class="wr2-vt-score high">45/72</span></td><td style="font-size:10px;color:var(--purple);">MISP &#x2022; Shodan</td><td><span class="badge badge-red" style="font-size:9px;">Confirmed</span></td></tr>
                        <tr class="wr2-ioc-row"><td><span class="wr2-ioc-type ip">IP</span></td><td class="mono">91.108.4.180</td><td>Exfil Staging Server</td><td><span class="wr2-vt-score high">32/72</span></td><td style="font-size:10px;color:var(--purple);">Shodan</td><td><span class="badge badge-amber" style="font-size:9px;">Likely</span></td></tr>
                        <tr class="wr2-ioc-row"><td><span class="wr2-ioc-type hash">Hash</span></td><td class="mono" style="font-size:10px;">f82c19a3e...</td><td>Cobalt Strike Beacon DLL</td><td><span class="wr2-vt-score high">54/72</span></td><td style="font-size:10px;color:var(--purple);">VT &#x2022; MISP</td><td><span class="badge badge-red" style="font-size:9px;">Confirmed</span></td></tr>
                        <tr class="wr2-ioc-row"><td><span class="wr2-ioc-type file">File</span></td><td class="mono" style="font-size:10px;">RECOVER_FILES.txt</td><td>ALPHV Ransom Note</td><td><span class="wr2-vt-score med">12/72</span></td><td style="font-size:10px;color:var(--purple);">VT</td><td><span class="badge badge-amber" style="font-size:9px;">Confirmed</span></td></tr>
                        <tr class="wr2-ioc-row"><td><span class="wr2-ioc-type email">Email</span></td><td class="mono" style="font-size:10px;">no-reply@secure-doc-share.com</td><td>Phishing sender</td><td><span class="wr2-vt-score med">8/72</span></td><td style="font-size:10px;color:var(--purple);">VT</td><td><span class="badge badge-amber" style="font-size:9px;">Confirmed</span></td></tr>
                        <tr class="wr2-ioc-row"><td><span class="wr2-ioc-type domain">Domain</span></td><td class="mono" style="font-size:10px;">secure-doc-share.com</td><td>Phishing landing page</td><td><span class="wr2-vt-score high">41/72</span></td><td style="font-size:10px;color:var(--purple);">VT &#x2022; MISP</td><td><span class="badge badge-red" style="font-size:9px;">Confirmed</span></td></tr>
                      </tbody>
                    </table>
                  </div>

                  <!-- Vertical Timeline -->
                  <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.1em;color:var(--text-muted);margin-bottom:10px;">Attack Timeline &mdash; Detailed with MITRE Mapping</div>
                  <div style="margin-bottom:16px;">
                    <div class="wr2-vtl-item">
                      <div class="wr2-vtl-dot initial">&#x1F4E7;</div>
                      <div class="wr2-vtl-body">
                        <div class="wr2-vtl-time">2026-02-28 01:14 SGT</div>
                        <div class="wr2-vtl-title">Spear-phishing Email Delivered</div>
                        <div class="wr2-vtl-desc">Email from no-reply@secure-doc-share.com to finance@nagaworld.com. Subject: "Urgent: Q4 Audit Document Review". Contains malicious Word macro attachment.</div>
                        <span class="wr2-vtl-mitre">T1566.001 &mdash; Spearphishing Attachment</span>
                      </div>
                    </div>
                    <div class="wr2-vtl-item">
                      <div class="wr2-vtl-dot exec">&#x26A1;</div>
                      <div class="wr2-vtl-body">
                        <div class="wr2-vtl-time">2026-02-28 01:47 SGT</div>
                        <div class="wr2-vtl-title">Macro Execution â€” Cobalt Strike Dropper</div>
                        <div class="wr2-vtl-desc">User enabled macros. VBA script downloaded stage-1 payload from hxxps://updates.typo3-cdn.net/kb/update.exe. Cobalt Strike beacon established on NAGA-WS-012.</div>
                        <span class="wr2-vtl-mitre">T1059.005 &mdash; Visual Basic</span> <span class="wr2-vtl-mitre" style="margin-left:4px;">T1105 &mdash; Ingress Tool Transfer</span>
                      </div>
                    </div>
                    <div class="wr2-vtl-item">
                      <div class="wr2-vtl-dot persist">&#x1F527;</div>
                      <div class="wr2-vtl-body">
                        <div class="wr2-vtl-time">2026-02-28 02:03 SGT</div>
                        <div class="wr2-vtl-title">Persistence via Scheduled Task</div>
                        <div class="wr2-vtl-desc">Scheduled task "MicrosoftEdgeUpdateTaskMachineUA" created under SYSTEM. Beacon restarts every 15 minutes on NAGA-WS-012.</div>
                        <span class="wr2-vtl-mitre">T1053.005 &mdash; Scheduled Task/Job</span>
                      </div>
                    </div>
                    <div class="wr2-vtl-item">
                      <div class="wr2-vtl-dot lateral">&#x27A1;</div>
                      <div class="wr2-vtl-body">
                        <div class="wr2-vtl-time">2026-02-28 03:55 SGT</div>
                        <div class="wr2-vtl-title">Lateral Movement via PsExec to Domain Controller</div>
                        <div class="wr2-vtl-desc">Attacker used harvested domain admin credentials (svc_backup) to PsExec into NAGA-DC01. Cobalt Strike beacon deployed on DC.</div>
                        <span class="wr2-vtl-mitre">T1021.002 &mdash; SMB/Windows Admin Shares</span>
                      </div>
                    </div>
                    <div class="wr2-vtl-item">
                      <div class="wr2-vtl-dot impact">&#x1F525;</div>
                      <div class="wr2-vtl-body">
                        <div class="wr2-vtl-time">2026-02-28 09:47 SGT</div>
                        <div class="wr2-vtl-title">Ransomware Deployment â€” ALPHV/BlackCat</div>
                        <div class="wr2-vtl-desc">ALPHV ransomware binary deployed via GPO across 847 endpoints. Encryption of .docx, .xlsx, .pdf, .db files. Extension changed to .alphv_enc. Ransom note dropped to C:\Users\Public\.</div>
                        <span class="wr2-vtl-mitre">T1486 &mdash; Data Encrypted for Impact</span> <span class="wr2-vtl-mitre" style="margin-left:4px;">T1490 &mdash; Inhibit System Recovery</span>
                      </div>
                    </div>
                    <div class="wr2-vtl-item">
                      <div class="wr2-vtl-dot contain">&#x1F6E1;</div>
                      <div class="wr2-vtl-body">
                        <div class="wr2-vtl-time">2026-02-28 10:15 SGT</div>
                        <div class="wr2-vtl-title">DACTA Containment Initiated</div>
                        <div class="wr2-vtl-desc">CrowdStrike Network Containment activated on 23 high-risk hosts. Firewall rules blocking C2 IPs pushed. DACTA War Room activated, WR-2026-003 opened.</div>
                        <span class="wr2-vtl-mitre" style="background:rgba(16,185,129,0.12);color:var(--green);border-color:rgba(16,185,129,0.25);">RESPONSE ACTION</span>
                      </div>
                    </div>
                  </div>

                  <!-- Analyst Notebook -->
                  <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.1em;color:var(--text-muted);margin-bottom:8px;">Analyst Notebook</div>
                  <textarea class="wr2-notebook" placeholder="Free-form investigation notes (markdown supported)...">## ALPHV/BlackCat Investigation Notes â€” WR-2026-003
Analyst: K. Rasmussen | 2026-02-28

### Key Findings
- Patient zero: NAGA-WS-012 (Finance), user: m.chan@nagaworld.com
- Initial vector: spear-phishing via secure-doc-share.com (registered 2026-02-21, 7 days before attack)
- Cobalt Strike beacon config extracted: watermark 0x5dc7f1, malleable C2 profile mimics Google Analytics
- ALPHV binary compiled for Windows x64, uses Rust language (typical for BlackCat)
- Exfil confirmed to mega.nz personal account â€” investigating if decryption key purchasable

### Open Questions
- [ ] Was svc_backup credential in breach database? Check HaveIBeenPwned API
- [ ] Any other email recipients of phishing email?
- [ ] Backup integrity â€” are Veeam backups on isolated network?
</textarea>
                  <div style="display:flex;gap:8px;margin-top:8px;">
                    <button class="btn btn-primary btn-sm">&#x1F916; Generate AI Investigation Brief</button>
                    <button class="btn btn-secondary btn-sm">&#x1F4BE; Save Notes</button>
                  </div>
                </div><!-- end investigation tab -->

                <!-- ======= TAB: ASSETS ======= -->
                <div class="wr2-tab-pane" id="wr2-003-assets">
                  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
                    <div style="font-size:10px;color:var(--text-muted);">23 assets tracked &mdash; drag cards to update status</div>
                    <button class="btn btn-primary btn-sm">&#x2B; Add Asset</button>
                  </div>
                  <div class="wr2-kanban">
                    <!-- Unexamined -->
                    <div class="wr2-kanban-col">
                      <div class="wr2-kanban-col-header">Unexamined <span class="wr2-kanban-col-count">4</span></div>
                      <div class="wr2-asset-card unexamined">
                        <div class="wr2-asset-hostname">NAGA-WS-033</div>
                        <div class="wr2-asset-ip">10.1.5.33</div>
                        <div class="wr2-edr-status active">&#x25CF; CrowdStrike Active</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win11 Pro</span><span class="wr2-asset-analyst">â€”</span></div>
                      </div>
                      <div class="wr2-asset-card unexamined">
                        <div class="wr2-asset-hostname">NAGA-WS-041</div>
                        <div class="wr2-asset-ip">10.1.5.41</div>
                        <div class="wr2-edr-status active">&#x25CF; CrowdStrike Active</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win10 Ent</span><span class="wr2-asset-analyst">â€”</span></div>
                      </div>
                      <div class="wr2-asset-card unexamined">
                        <div class="wr2-asset-hostname">NAGA-SRV-07</div>
                        <div class="wr2-asset-ip">10.2.1.7</div>
                        <div class="wr2-edr-status offline">&#x25CF; Offline</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win Server 2022</span><span class="wr2-asset-analyst">â€”</span></div>
                      </div>
                      <div class="wr2-asset-card unexamined">
                        <div class="wr2-asset-hostname">NAGA-WS-056</div>
                        <div class="wr2-asset-ip">10.1.6.56</div>
                        <div class="wr2-edr-status unknown">&#x25CF; Unknown</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win10 Ent</span><span class="wr2-asset-analyst">â€”</span></div>
                      </div>
                    </div>
                    <!-- Under Investigation -->
                    <div class="wr2-kanban-col">
                      <div class="wr2-kanban-col-header">Under Investigation <span class="wr2-kanban-col-count">7</span></div>
                      <div class="wr2-asset-card investigating">
                        <div class="wr2-asset-hostname">NAGA-DC01</div>
                        <div class="wr2-asset-ip">10.2.0.1</div>
                        <div class="wr2-edr-status active">&#x25CF; CrowdStrike Active</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win Server 2019 DC</span><span class="wr2-asset-analyst" style="color:var(--cyan);">S.Lim</span></div>
                      </div>
                      <div class="wr2-asset-card investigating">
                        <div class="wr2-asset-hostname">NAGA-WS-019</div>
                        <div class="wr2-asset-ip">10.1.3.19</div>
                        <div class="wr2-edr-status active">&#x25CF; CrowdStrike Active</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win11 Pro</span><span class="wr2-asset-analyst" style="color:var(--cyan);">P.Tran</span></div>
                      </div>
                      <div class="wr2-asset-card investigating">
                        <div class="wr2-asset-hostname">NAGA-SRV-12</div>
                        <div class="wr2-asset-ip">10.2.1.12</div>
                        <div class="wr2-edr-status active">&#x25CF; CrowdStrike Active</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win Server 2019</span><span class="wr2-asset-analyst" style="color:var(--cyan);">K.Rasmussen</span></div>
                      </div>
                    </div>
                    <!-- Contained -->
                    <div class="wr2-kanban-col">
                      <div class="wr2-kanban-col-header">Contained <span class="wr2-kanban-col-count">6</span></div>
                      <div class="wr2-asset-card contained">
                        <div class="wr2-asset-hostname">NAGA-WS-047</div>
                        <div class="wr2-asset-ip">10.1.6.47</div>
                        <div class="wr2-edr-status active">&#x25CF; Network Isolated</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win10 Ent</span><span class="wr2-asset-analyst" style="color:var(--amber);">K.Rasmussen</span></div>
                      </div>
                      <div class="wr2-asset-card contained">
                        <div class="wr2-asset-hostname">NAGA-WS-022</div>
                        <div class="wr2-asset-ip">10.1.4.22</div>
                        <div class="wr2-edr-status active">&#x25CF; Network Isolated</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win10 Ent</span><span class="wr2-asset-analyst" style="color:var(--amber);">K.Rasmussen</span></div>
                      </div>
                      <div class="wr2-asset-card contained">
                        <div class="wr2-asset-hostname">NAGA-SRV-03</div>
                        <div class="wr2-asset-ip">10.2.0.3</div>
                        <div class="wr2-edr-status active">&#x25CF; Network Isolated</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win Server 2022</span><span class="wr2-asset-analyst" style="color:var(--amber);">K.Rasmussen</span></div>
                      </div>
                    </div>
                    <!-- Compromised -->
                    <div class="wr2-kanban-col">
                      <div class="wr2-kanban-col-header" style="color:var(--red-bright);">Compromised <span class="wr2-kanban-col-count" style="background:rgba(239,68,68,0.15);color:#ff6b6b;">8</span></div>
                      <div class="wr2-asset-card compromised">
                        <div class="wr2-asset-hostname">NAGA-WS-012</div>
                        <div class="wr2-asset-ip">10.1.2.12</div>
                        <div class="wr2-edr-status offline">&#x25CF; Offline â€” Imaging</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win10 Ent</span><span class="wr2-asset-analyst" style="color:#ff6b6b;">Patient Zero</span></div>
                      </div>
                      <div class="wr2-asset-card compromised">
                        <div class="wr2-asset-hostname">NAGA-DC02</div>
                        <div class="wr2-asset-ip">10.2.0.2</div>
                        <div class="wr2-edr-status active">&#x25CF; Network Isolated</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win Server 2019 DC</span><span class="wr2-asset-analyst" style="color:#ff6b6b;">S.Lim</span></div>
                      </div>
                      <div class="wr2-asset-card compromised">
                        <div class="wr2-asset-hostname">NAGA-SRV-01</div>
                        <div class="wr2-asset-ip">10.2.0.1</div>
                        <div class="wr2-edr-status active">&#x25CF; Network Isolated</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">File Server</span><span class="wr2-asset-analyst" style="color:#ff6b6b;">K.Rasmussen</span></div>
                      </div>
                    </div>
                    <!-- Clean -->
                    <div class="wr2-kanban-col">
                      <div class="wr2-kanban-col-header" style="color:var(--green);">Clean <span class="wr2-kanban-col-count" style="background:rgba(16,185,129,0.12);color:var(--green);">3</span></div>
                      <div class="wr2-asset-card clean">
                        <div class="wr2-asset-hostname">NAGA-WS-001</div>
                        <div class="wr2-asset-ip">10.1.0.1</div>
                        <div class="wr2-edr-status active">&#x25CF; CrowdStrike Active</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win11 Pro</span><span class="wr2-asset-analyst" style="color:var(--green);">Verified</span></div>
                      </div>
                      <div class="wr2-asset-card clean">
                        <div class="wr2-asset-hostname">NAGA-WS-002</div>
                        <div class="wr2-asset-ip">10.1.0.2</div>
                        <div class="wr2-edr-status active">&#x25CF; CrowdStrike Active</div>
                        <div class="wr2-asset-meta"><span class="wr2-asset-os">Win11 Pro</span><span class="wr2-asset-analyst" style="color:var(--green);">Verified</span></div>
                      </div>
                    </div>
                  </div>
                </div><!-- end assets tab -->

                <!-- ======= TAB: CONTAINMENT ======= -->
                <div class="wr2-tab-pane" id="wr2-003-containment">
                  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
                    <div style="font-size:10px;color:var(--text-muted);">All containment actions require client authorization. Authorized by: D. Sok (NagaWorld CISO)</div>
                    <div style="display:flex;gap:8px;">
                      <button class="btn btn-secondary btn-sm">&#x1F4CB; Client-Friendly Instructions</button>
                      <button class="btn btn-primary btn-sm">&#x2B; Add Action</button>
                    </div>
                  </div>
                  <div class="table-wrap" style="margin-bottom:16px;">
                    <table>
                      <thead><tr><th>#</th><th>Action</th><th>Status</th><th>Priority</th><th>Assigned</th><th>Authorized By</th><th>Timestamp</th></tr></thead>
                      <tbody>
                        <tr><td class="mono" style="font-size:10px;">CA-001</td><td>Network Isolation â€” 23 hosts via CrowdStrike</td><td><span class="wr2-action-status completed">Completed</span></td><td><span class="wr2-action-priority critical">Critical</span></td><td>K. Rasmussen</td><td>D. Sok</td><td class="mono" style="font-size:10px;">10:18 SGT</td></tr>
                        <tr><td class="mono" style="font-size:10px;">CA-002</td><td>Block C2 IPs (185.220.101.47, 91.108.4.180) at perimeter FW</td><td><span class="wr2-action-status completed">Completed</span></td><td><span class="wr2-action-priority critical">Critical</span></td><td>K. Rasmussen</td><td>D. Sok</td><td class="mono" style="font-size:10px;">10:22 SGT</td></tr>
                        <tr><td class="mono" style="font-size:10px;">CA-003</td><td>Disable svc_backup domain account</td><td><span class="wr2-action-status completed">Completed</span></td><td><span class="wr2-action-priority critical">Critical</span></td><td>P. Tran</td><td>D. Sok</td><td class="mono" style="font-size:10px;">10:35 SGT</td></tr>
                        <tr><td class="mono" style="font-size:10px;">CA-004</td><td>Reset all privileged account passwords (DA, EA)</td><td><span class="wr2-action-status in_progress">In Progress</span></td><td><span class="wr2-action-priority critical">Critical</span></td><td>S. Lim</td><td>D. Sok</td><td class="mono" style="font-size:10px;">11:00 SGT</td></tr>
                        <tr><td class="mono" style="font-size:10px;">CA-005</td><td>Block mega.nz egress at proxy (Zscaler)</td><td><span class="wr2-action-status completed">Completed</span></td><td><span class="wr2-action-priority high">High</span></td><td>K. Rasmussen</td><td>D. Sok</td><td class="mono" style="font-size:10px;">11:14 SGT</td></tr>
                        <tr><td class="mono" style="font-size:10px;">CA-006</td><td>Revoke all active VPN sessions &amp; enforce MFA re-enrollment</td><td><span class="wr2-action-status approved">Approved</span></td><td><span class="wr2-action-priority high">High</span></td><td>M. Nguyen</td><td>Pending</td><td class="mono" style="font-size:10px;">â€”</td></tr>
                        <tr><td class="mono" style="font-size:10px;">CA-007</td><td>Enable enhanced logging on all DCs (Audit Policy GPO)</td><td><span class="wr2-action-status planned">Planned</span></td><td><span class="wr2-action-priority medium">Medium</span></td><td>J. Wang</td><td>â€”</td><td class="mono" style="font-size:10px;">â€”</td></tr>
                      </tbody>
                    </table>
                  </div>

                  <!-- Decision Matrix -->
                  <div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.1em;color:var(--text-muted);margin-bottom:8px;">Decision Matrix</div>
                  <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px;">
                    <div class="wr2-panel">
                      <div class="wr2-panel-title">Network Isolation Criteria</div>
                      <div style="font-size:11px;color:var(--text-secondary);line-height:1.7;">
                        &#x2705; Active C2 beaconing detected<br>
                        &#x2705; Ransomware binary executed<br>
                        &#x2705; Lateral movement from host<br>
                        &#x26A0;&#xFE0F; Encryption in progress<br>
                        &#x26A0;&#xFE0F; Credential dumping activity
                      </div>
                    </div>
                    <div class="wr2-panel">
                      <div class="wr2-panel-title">Account Disable Criteria</div>
                      <div style="font-size:11px;color:var(--text-secondary);line-height:1.7;">
                        &#x2705; Account used for lateral movement<br>
                        &#x2705; Credentials in attacker hands (confirmed)<br>
                        &#x2705; Unusual logon patterns post-incident<br>
                        &#x26A0;&#xFE0F; Service account with unusual auth<br>
                        &#x26A0;&#xFE0F; DA/EA accounts â€” immediate escalation
                      </div>
                    </div>
                  </div>
                </div><!-- end containment tab -->

                <!-- ======= TAB: ERADICATION ======= -->
                <div class="wr2-tab-pane" id="wr2-003-eradication">
                  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
                    <div style="font-size:10px;color:var(--amber);">&#x26A0;&#xFE0F; Eradication must only begin after full scope is confirmed. Phase 4 (Investigate) still in progress.</div>
                    <button class="btn btn-secondary btn-sm">&#x1F4CA; Eradication Progress Report</button>
                  </div>

                  <div class="wr2-errad-group">
                    <div class="wr2-errad-group-title">&#x1F527; Persistence Mechanisms</div>
                    <div class="wr2-errad-item">
                      <input type="checkbox" checked>
                      <div class="wr2-errad-body">
                        <div class="wr2-errad-tech">T1053.005 &mdash; Scheduled Task</div>
                        <div class="wr2-errad-desc">Remove "MicrosoftEdgeUpdateTaskMachineUA" scheduled task from all affected hosts</div>
                      </div>
                      <span class="wr2-errad-status done">Done</span>
                    </div>
                    <div class="wr2-errad-item">
                      <input type="checkbox">
                      <div class="wr2-errad-body">
                        <div class="wr2-errad-tech">T1547.001 &mdash; Registry Run Keys</div>
                        <div class="wr2-errad-desc">Scan and remove any persistence in HKLM/HKCU Run keys matching Cobalt Strike beacon signatures</div>
                      </div>
                      <span class="wr2-errad-status open">Open</span>
                    </div>
                    <div class="wr2-errad-item">
                      <input type="checkbox">
                      <div class="wr2-errad-body">
                        <div class="wr2-errad-tech">T1505.003 &mdash; Web Shell</div>
                        <div class="wr2-errad-desc">Check IIS servers (NAGA-SRV-01, NAGA-SRV-12) for web shell deployment by attacker</div>
                      </div>
                      <span class="wr2-errad-status pending">Pending</span>
                    </div>
                  </div>

                  <div class="wr2-errad-group">
                    <div class="wr2-errad-group-title">&#x1F511; Credential Cleanup</div>
                    <div class="wr2-errad-item">
                      <input type="checkbox" checked>
                      <div class="wr2-errad-body">
                        <div class="wr2-errad-tech">T1003.001 &mdash; LSASS Memory Dump</div>
                        <div class="wr2-errad-desc">Reset all domain admin, enterprise admin, and service account passwords. Force Kerberos ticket invalidation (krbtgt reset x2)</div>
                      </div>
                      <span class="wr2-errad-status done">Done</span>
                    </div>
                    <div class="wr2-errad-item">
                      <input type="checkbox">
                      <div class="wr2-errad-body">
                        <div class="wr2-errad-tech">T1558.001 &mdash; Golden Ticket</div>
                        <div class="wr2-errad-desc">Assess if attacker created Golden Ticket. If confirmed: reset krbtgt twice with 10h gap, force re-auth of all domain accounts</div>
                      </div>
                      <span class="wr2-errad-status open">Open</span>
                    </div>
                    <div class="wr2-errad-item">
                      <input type="checkbox">
                      <div class="wr2-errad-body">
                        <div class="wr2-errad-tech">T1078 &mdash; Valid Accounts</div>
                        <div class="wr2-errad-desc">Audit all service accounts for unnecessary privileges. Implement least-privilege (tiering model)</div>
                      </div>
                      <span class="wr2-errad-status pending">Pending</span>
                    </div>
                  </div>

                  <div class="wr2-errad-group">
                    <div class="wr2-errad-group-title">&#x1F4E6; Recovery Tracking</div>
                    <div class="table-wrap">
                      <table>
                        <thead><tr><th>Asset</th><th>Method</th><th>Status</th><th>Est. Recovery</th></tr></thead>
                        <tbody>
                          <tr><td class="mono" style="font-size:11px;">NAGA-WS-012</td><td>Reimage from gold image</td><td><span class="wr2-ev-status-badge collecting">In Progress</span></td><td>2h</td></tr>
                          <tr><td class="mono" style="font-size:11px;">NAGA-DC02</td><td>Restore from Veeam backup (2026-02-27)</td><td><span class="wr2-ev-status-badge pending">Pending</span></td><td>4h</td></tr>
                          <tr><td class="mono" style="font-size:11px;">NAGA-SRV-01</td><td>Restore from Veeam backup (2026-02-27)</td><td><span class="wr2-ev-status-badge pending">Pending</span></td><td>6h</td></tr>
                          <tr><td class="mono" style="font-size:11px;">NAGA-WS-047</td><td>Reimage from gold image</td><td><span class="wr2-ev-status-badge pending">Pending</span></td><td>2h</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div><!-- end eradication tab -->

                <!-- ======= TAB: REPORTS ======= -->
                <div class="wr2-tab-pane" id="wr2-003-reports">
                  <div class="wr2-report-section">
                    <div class="wr2-report-section-title">&#x1F4CA; Executive Summary <span style="font-size:9px;color:var(--text-muted);font-weight:400;">(1-2 page non-technical brief)</span></div>
                    <div style="font-size:11px;color:var(--text-secondary);line-height:1.7;margin-bottom:10px;">
                      On 28 February 2026, NagaWorld Ltd. experienced a ransomware attack attributed to the ALPHV/BlackCat threat actor group. The attack originated via a targeted spear-phishing email and resulted in the encryption of files across 847 endpoints. DACTA's MDR team detected the incident and activated War Room WR-2026-003 within 28 minutes of ransomware deployment. Containment actions isolated 23 high-risk systems within 45 minutes. Investigation is ongoing; recovery timeline estimated at 36-48 hours.
                    </div>
                    <div class="wr2-export-btn-row">
                      <button class="btn btn-primary btn-sm">&#x1F916; Generate Full Executive Summary</button>
                      <button class="btn btn-secondary btn-sm">&#x1F4E4; Export PDF</button>
                      <button class="btn btn-secondary btn-sm">&#x1F4C4; Export DOCX</button>
                    </div>
                  </div>
                  <div class="wr2-report-section">
                    <div class="wr2-report-section-title">&#x1F50D; Technical Report</div>
                    <div style="font-size:11px;color:var(--text-secondary);margin-bottom:10px;">Detailed forensic analysis, kill chain reconstruction, MITRE mapping, and remediation evidence. Auto-populates from investigation data.</div>
                    <div class="wr2-export-btn-row">
                      <button class="btn btn-primary btn-sm">&#x1F916; Generate Technical Report</button>
                      <button class="btn btn-secondary btn-sm">&#x1F4E4; Export PDF</button>
                    </div>
                  </div>
                  <div class="wr2-report-section">
                    <div class="wr2-report-section-title">&#x1F4CB; IOC Export</div>
                    <div style="font-size:11px;color:var(--text-secondary);margin-bottom:10px;">Export 47 IOCs for blocking, sharing, and threat intelligence integration.</div>
                    <div class="wr2-export-btn-row">
                      <button class="btn btn-secondary btn-sm">&#x1F4C8; Export CSV</button>
                      <button class="btn btn-secondary btn-sm">&#x1F9E9; Export STIX 2.1</button>
                      <button class="btn btn-secondary btn-sm">&#x1F4E4; Export MISP JSON</button>
                    </div>
                  </div>
                  <div class="wr2-report-section">
                    <div class="wr2-report-section-title">&#x1F4A1; Lessons Learned</div>
                    <div style="font-size:11px;color:var(--text-secondary);margin-bottom:8px;">Post-incident analysis to be completed within 5 business days.</div>
                    <textarea class="wr2-notebook" style="height:80px;" placeholder="Document lessons learned, detection gaps, and improvement recommendations...">1. Email security gateway (Microsoft Defender for O365) did not detonate the macro in sandbox â€” investigate Safe Attachments policy gap
2. svc_backup had DA privileges but was created 4 years ago with no review â€” privileged access governance improvement required
3. Backup solution (Veeam) appears intact â€” isolation of backup server proved effective</textarea>
                  </div>
                  <div class="wr2-report-section">
                    <div class="wr2-report-section-title">&#x1F4AC; Client Status Updates Log</div>
                    <div class="wr2-comm-item">
                      <span class="wr2-comm-type-badge status_update">Status Update</span>
                      <div class="wr2-comm-body">
                        <div class="wr2-comm-subject">WR-2026-003 â€” Initial Assessment &amp; Containment Brief</div>
                        <div class="wr2-comm-meta">To: D. Sok (CISO), M. Chea (CEO) &mdash; 2026-02-28 11:00 SGT &mdash; K. Rasmussen</div>
                      </div>
                    </div>
                    <div class="wr2-comm-item">
                      <span class="wr2-comm-type-badge status_update">Status Update</span>
                      <div class="wr2-comm-body">
                        <div class="wr2-comm-subject">WR-2026-003 â€” Phase 4 Investigation Update</div>
                        <div class="wr2-comm-meta">To: D. Sok (CISO) &mdash; 2026-02-28 15:15 SGT &mdash; K. Rasmussen</div>
                      </div>
                    </div>
                  </div>
                </div><!-- end reports tab -->

                <!-- ======= TAB: COMMS ======= -->
                <div class="wr2-tab-pane" id="wr2-003-comms">
                  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
                    <div style="font-size:10px;color:var(--text-muted);">All communications logged for chain of custody and audit trail</div>
                    <button class="btn btn-primary btn-sm">&#x270F; Draft New Communication</button>
                  </div>

                  <div class="wr2-panel" style="margin-bottom:12px;">
                    <div class="wr2-panel-title">Communication Log</div>
                    <div class="wr2-comm-item">
                      <span class="wr2-comm-type-badge status_update">Status Update</span>
                      <div class="wr2-comm-body">
                        <div class="wr2-comm-subject">WR-2026-003 â€” Initial Assessment &amp; Containment Brief</div>
                        <div class="wr2-comm-meta">To: D. Sok (CISO), M. Chea (CEO) &mdash; 28 Feb 11:00 SGT &mdash; K. Rasmussen</div>
                      </div>
                    </div>
                    <div class="wr2-comm-item">
                      <span class="wr2-comm-type-badge internal_brief">Internal Brief</span>
                      <div class="wr2-comm-body">
                        <div class="wr2-comm-subject">War Room WR-2026-003 â€” Team Briefing &amp; Task Assignment</div>
                        <div class="wr2-comm-meta">To: DACTA IR Team &mdash; 28 Feb 10:30 SGT &mdash; K. Rasmussen</div>
                      </div>
                    </div>
                    <div class="wr2-comm-item">
                      <span class="wr2-comm-type-badge client_email">Client Email</span>
                      <div class="wr2-comm-body">
                        <div class="wr2-comm-subject">URGENT: DACTA Incident Response Activation â€” NagaWorld Ransomware</div>
                        <div class="wr2-comm-meta">To: D. Sok &mdash; 28 Feb 10:05 SGT &mdash; K. Rasmussen</div>
                      </div>
                    </div>
                    <div class="wr2-comm-item">
                      <span class="wr2-comm-type-badge status_update">Status Update</span>
                      <div class="wr2-comm-body">
                        <div class="wr2-comm-subject">WR-2026-003 â€” Phase 4 Investigation Update (3PM SGT)</div>
                        <div class="wr2-comm-meta">To: D. Sok (CISO) &mdash; 28 Feb 15:15 SGT &mdash; K. Rasmussen</div>
                      </div>
                    </div>
                    <div class="wr2-comm-item">
                      <span class="wr2-comm-type-badge escalation">Escalation</span>
                      <div class="wr2-comm-body">
                        <div class="wr2-comm-subject">Regulatory Notification Advisory â€” Potential PDPA Obligation (Cambodia)</div>
                        <div class="wr2-comm-meta">To: NagaWorld Legal + Compliance &mdash; 28 Feb 13:00 SGT &mdash; K. Rasmussen</div>
                      </div>
                    </div>
                  </div>

                  <div class="wr2-panel">
                    <div class="wr2-panel-title">Draft Communication</div>
                    <div class="wr2-field-row" style="margin-bottom:8px;">
                      <div class="wr2-field"><label class="wr2-field-label">Type</label><select><option>Status Update</option><option>Client Email</option><option>Internal Brief</option><option>Escalation</option></select></div>
                      <div class="wr2-field" style="flex:2;"><label class="wr2-field-label">Subject</label><input type="text" placeholder="Communication subject..."></div>
                    </div>
                    <div class="wr2-field" style="margin-bottom:8px;"><label class="wr2-field-label">Recipients</label><input type="text" placeholder="Name / email..."></div>
                    <div class="wr2-field" style="margin-bottom:8px;"><label class="wr2-field-label">Message</label><textarea style="height:80px;" placeholder="Communication body..."></textarea></div>
                    <div style="display:flex;gap:8px;">
                      <button class="btn btn-primary btn-sm">&#x1F916; AI Draft from Template</button>
                      <button class="btn btn-secondary btn-sm">&#x1F4E4; Send</button>
                    </div>
                  </div>
                </div><!-- end comms tab -->

                <!-- ======= TAB: SETTINGS ======= -->
                <div class="wr2-tab-pane" id="wr2-003-settings">
                  <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                    <div>
                      <div class="wr2-settings-section">
                        <div class="wr2-settings-title">Engagement Configuration</div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">Engagement ID</span><span class="wr2-settings-val mono">WR-2026-003</span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">Client</span><span class="wr2-settings-val">NagaWorld Ltd.</span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">Mode</span><span class="wr2-settings-val"><span class="wr2-mode-hot">HOT MODE</span></span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">TLP Marking</span><span class="wr2-settings-val"><select style="background:transparent;border:none;color:var(--text-primary);font-size:11px;cursor:pointer;outline:none;"><option>TLP:AMBER</option><option>TLP:RED</option><option>TLP:GREEN</option></select></span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">SLA Target</span><span class="wr2-settings-val">4h Initial Response / 24h Full Report</span></div>
                      </div>
                      <div class="wr2-settings-section">
                        <div class="wr2-settings-title">Team Management</div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">K. Rasmussen</span><span class="wr2-settings-val" style="color:var(--cyan);">Lead Analyst</span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">P. Tran</span><span class="wr2-settings-val">Malware Analyst</span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">S. Lim</span><span class="wr2-settings-val">Forensics</span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">M. Nguyen</span><span class="wr2-settings-val">Threat Intelligence</span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">J. Wang</span><span class="wr2-settings-val">Network Analyst</span></div>
                        <div style="margin-top:8px;"><button class="btn btn-secondary btn-sm">&#x2B; Add Team Member</button></div>
                      </div>
                    </div>
                    <div>
                      <div class="wr2-settings-section">
                        <div class="wr2-settings-title">Notifications</div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">Slack Alerts</span><span class="wr2-toggle on" onclick="this.classList.toggle('on');this.classList.toggle('off');"></span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">Email on Phase Change</span><span class="wr2-toggle on" onclick="this.classList.toggle('on');this.classList.toggle('off');"></span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">SMS on SEV-1 Escalation</span><span class="wr2-toggle on" onclick="this.classList.toggle('on');this.classList.toggle('off');"></span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">Client Auto-Reports (6h)</span><span class="wr2-toggle off" onclick="this.classList.toggle('on');this.classList.toggle('off');"></span></div>
                      </div>
                      <div class="wr2-settings-section">
                        <div class="wr2-settings-title">Integrations</div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">Jira Project</span><span class="wr2-settings-val mono" style="color:var(--cyan);">NAGA-IR-2026</span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">Slack Channel</span><span class="wr2-settings-val mono">#wr-2026-003</span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">MISP Instance</span><span class="wr2-settings-val" style="color:var(--green);">Connected</span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">VirusTotal API</span><span class="wr2-settings-val" style="color:var(--green);">Connected</span></div>
                        <div class="wr2-settings-row"><span class="wr2-settings-key">CrowdStrike API</span><span class="wr2-settings-val" style="color:var(--green);">Connected</span></div>
                      </div>
                    </div>
                  </div>
                </div><!-- end settings tab -->

              </div><!-- end wr2Content003 -->
            </div><!-- end wr2-main -->

            <!-- WAR ROOM CHAT PANEL (Task 7) -->
            <div class="wr2-copilot" id="wr2Copilot003">
              <div class="wr2-cop-header" onclick="wr2ToggleCopilotPanel('wr2Copilot003')">
                <div class="wr2-cop-icon">&#x1F4AC;</div>
                <span class="wr2-cop-title">War Room Chat</span>
                <span class="wr2-cop-toggle">&#x276F;</span>
              </div>
              <div class="wr2-cop-body" id="wr2CopBody003">
                <!-- Internal chat messages -->
                <div class="wr-chat-internal-msg">
                  <div class="wr2-cop-msg-label">D. Sok (NagaWorld)</div>
                  <div class="wr-chat-msg-text">Can you confirm the affected subnet? We need to notify our network team.</div>
                </div>
                <div class="wr-chat-internal-msg">
                  <div class="wr2-cop-msg-label">John Lim (Dacta)</div>
                  <div class="wr-chat-msg-text">Confirmed â€” 10.10.4.0/24, isolating now. Finance VLAN. We're also seeing activity on 10.10.5.12.</div>
                </div>
                <div class="wr2-cop-msg ai">
                  <div class="wr2-cop-msg-label">Copilot</div>
                  War Room WR-2026-003 â€” NagaWorld Ransomware. Currently in <strong>Phase 4: Investigate</strong>. I've analyzed the available telemetry. You're tracking ALPHV/BlackCat with confirmed C2 at 185.220.101.47. 47 IOCs confirmed.
                </div>
                <div class="wr2-cop-msg ai">
                  <div class="wr2-cop-msg-label">Copilot</div>
                  <strong>Immediate priority:</strong> Assess potential Golden Ticket creation given the DC compromise. svc_backup had DA rights â€” full krbtgt reset cycle is recommended.
                </div>
              </div>
              <div class="wr2-cop-suggestions" id="wr2CopSuggestions003">
                <div class="wr2-cop-sug-label">Suggested for Phase 4</div>
                <button class="wr2-cop-sug" onclick="wr2CopilotQuery(this,'wr2CopBody003')">&#x1F4CB; Generate investigation brief</button>
                <button class="wr2-cop-sug" onclick="wr2CopilotQuery(this,'wr2CopBody003')">&#x1F510; Check for Golden Ticket indicators</button>
                <button class="wr2-cop-sug" onclick="wr2CopilotQuery(this,'wr2CopBody003')">&#x1F4E4; Draft Phase 5 containment plan</button>
                <button class="wr2-cop-sug" onclick="wr2CopilotQuery(this,'wr2CopBody003')">&#x2139; Explain ALPHV/BlackCat TTPs</button>
              </div>
              <!-- Task 7: Chat mode toggle -->
              <div class="wr-chat-mode-toggle" id="wrChatModeToggle003">
                <button class="wr-chat-mode-btn active" id="wrChatModeAI003" onclick="setWrChatMode('ai','003')">
                  &#x2728; Copilot
                </button>
                <button class="wr-chat-mode-btn internal" id="wrChatModeInternal003" onclick="setWrChatMode('internal','003')">
                  &#x1F465; Internal
                </button>
              </div>
              <div class="wr2-cop-input-row">
                <input class="wr2-cop-input" type="text" placeholder="Ask Copilot..." id="wr2CopInput003" onkeydown="if(event.key==='Enter')wr2CopilotSend('wr2CopInput003','wr2CopBody003')">
                <button class="wr2-cop-send" id="wrChatSendBtn003" onclick="wr2CopilotSend('wr2CopInput003','wr2CopBody003')">&#x27A4;</button>
              </div>
            </div><!-- end war room chat -->


          </div><!-- end wr2-layout -->

        </div><!-- end eng003 panel -->


        <!-- ========== ENGAGEMENT: eng004 (Cold Mode) ========== -->
        <div class="wr2-engagement-panel" id="wr2-panel-eng004">

          <!-- TOP STATUS BAR -->
          <div class="wr2-topbar" style="--topbar-accent: #60a5fa;">
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Engagement ID</span>
              <span class="wr2-tb-val mono">WR-2026-004</span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Client</span>
              <span class="wr2-tb-val">ADV Partners Group</span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Incident Type</span>
              <span class="wr2-tb-val"><span class="badge badge-amber" style="font-size:10px;">BEC / Email Fraud</span></span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Severity</span>
              <span class="wr2-tb-val"><span class="wr2-sev-badge sev2">SEV-2 HIGH</span></span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Elapsed Time</span>
              <span class="wr2-tb-val">
                <div class="wr2-timer-wrap">
                  <span class="wr2-elapsed" id="wr2ElapsedCold">02:14:33</span>
                  <button class="wr2-timer-btn" id="wr2PauseCold" onclick="wr2ToggleTimer('cold')" title="Pause / Resume Timer">&#x23F8;</button>
                  <span class="wr2-timer-paused-label" id="wr2PausedLabelCold" style="display:none;">PAUSED</span>
                </div>
                <div class="wr2-manhours-row">
                  Man-hours: <span class="wr2-manhours-val" id="wr2ManhoursCold">02:14</span> <span style="color:var(--text-muted);">(1 analyst)</span>
                </div>
              </span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Phase</span>
              <span class="wr2-tb-val"><span class="badge badge-blue">SCOPE</span></span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Lead Analyst</span>
              <span class="wr2-tb-val">M. Nguyen</span>
            </div>
            <div class="wr2-topbar-item">
              <span class="wr2-tb-label">Status</span>
              <span class="wr2-tb-val"><span class="wr2-status-monitoring">Scoping</span></span>
            </div>
            <div class="wr2-topbar-spacer"></div>
            <div class="wr2-topbar-item" style="border-right:none;">
              <span class="wr2-tb-label">TLP</span>
              <span class="wr2-tlp-badge red">TLP:RED</span>
            </div>
          </div>

          <!-- PHASE PIPELINE -->
          <div class="wr2-phase-row">
            <div class="wr2-phase-item done"><div class="wr2-ph-dot">&#x2713;</div><span class="wr2-ph-label">Activate</span></div>
            <div class="wr2-phase-item current"><div class="wr2-ph-dot">2</div><span class="wr2-ph-label">Scope</span></div>
            <div class="wr2-phase-item pending"><div class="wr2-ph-dot">3</div><span class="wr2-ph-label">Collect</span></div>
            <div class="wr2-phase-item pending"><div class="wr2-ph-dot">4</div><span class="wr2-ph-label">Investigate</span></div>
            <div class="wr2-phase-item pending"><div class="wr2-ph-dot">5</div><span class="wr2-ph-label">Contain</span></div>
            <div class="wr2-phase-item pending"><div class="wr2-ph-dot">6</div><span class="wr2-ph-label">Eradicate</span></div>
            <div class="wr2-phase-item pending"><div class="wr2-ph-dot">7</div><span class="wr2-ph-label">Report</span></div>
          </div>

          <!-- MAIN LAYOUT -->
          <div class="wr2-layout">
            <div class="wr2-main" id="wr2MainPanel004">
              <div class="wr2-nav" id="wr2Nav004">
                <div class="wr2-nav-tab active" onclick="wr2SwitchTab(this,'wr2-004-overview','wr2Nav004','wr2Content004')">Overview</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-004-scoping','wr2Nav004','wr2Content004')">Scoping</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-004-evidence','wr2Nav004','wr2Content004')">Evidence</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-004-investigation','wr2Nav004','wr2Content004')">Investigation</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-004-containment','wr2Nav004','wr2Content004')">Containment</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-004-reports','wr2Nav004','wr2Content004')">Reports</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-004-comms','wr2Nav004','wr2Content004')">Comms</div>
                <div class="wr2-nav-tab" onclick="wr2SwitchTab(this,'wr2-004-settings','wr2Nav004','wr2Content004')">Settings</div>
              </div>
              <div id="wr2Content004" style="flex:1;overflow-y:auto;display:flex;flex-direction:column;">

                <!-- OVERVIEW TAB â€” eng004 -->
                <div class="wr2-tab-pane active" id="wr2-004-overview">
                  <div class="wr2-kpi-row">
                    <div class="wr2-kpi cyan"><div class="wr2-kpi-label">Elapsed Time</div><div class="wr2-kpi-value">02:14</div><div class="wr2-kpi-sub">hrs since activation</div></div>
                    <div class="wr2-kpi red"><div class="wr2-kpi-label">IOCs Found</div><div class="wr2-kpi-value">3</div><div class="wr2-kpi-sub">preliminary only</div></div>
                    <div class="wr2-kpi amber"><div class="wr2-kpi-label">Affected Accounts</div><div class="wr2-kpi-value">2</div><div class="wr2-kpi-sub">suspected</div></div>
                    <div class="wr2-kpi green"><div class="wr2-kpi-label">Actions Taken</div><div class="wr2-kpi-value">2</div><div class="wr2-kpi-sub">email investigation</div></div>
                  </div>
                  <div class="wr2-cold-notice">
                    <span style="font-size:18px;">&#x2744;</span>
                    <div><strong>COLD MODE â€” DFIR Retainer / Ad-hoc Engagement.</strong> No MDR telemetry available. Environment Discovery Questionnaire must be completed before collection can begin. Please proceed to the <strong>Scoping</strong> tab.</div>
                  </div>
                  <div class="wr2-overview-grid">
                    <div class="wr2-panel">
                      <div class="wr2-panel-title">Response Team</div>
                      <div class="wr2-team-member"><div class="wr2-avatar lead">MN</div><div class="wr2-member-info"><div class="wr2-member-name">M. Nguyen</div><div class="wr2-member-role">Lead Analyst / BEC Specialist</div></div><div class="wr2-online-dot online"></div></div>
                      <div class="wr2-team-member"><div class="wr2-avatar analyst">KR</div><div class="wr2-member-info"><div class="wr2-member-name">K. Rasmussen</div><div class="wr2-member-role">IR Advisor</div></div><div class="wr2-online-dot away"></div></div>
                    </div>
                    <div class="wr2-panel">
                      <div class="wr2-panel-title">Engagement Details</div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Client</span><span class="wr2-detail-val2">ADV Partners Group</span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Mode</span><span class="wr2-detail-val2"><span class="wr2-mode-cold">COLD MODE</span></span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Incident Type</span><span class="wr2-detail-val2"><span class="badge badge-amber" style="font-size:9px;">BEC</span></span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Severity</span><span class="wr2-detail-val2"><span class="wr2-sev-badge sev2">SEV-2</span></span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">TLP</span><span class="wr2-detail-val2"><span class="wr2-tlp-badge red" style="font-size:9px;">TLP:RED</span></span></div>
                      <div class="wr2-detail-row2"><span class="wr2-detail-key2">Opened</span><span class="wr2-detail-val2" style="font-family:var(--font-mono);font-size:10px;">2026-02-28 01:42 SGT</span></div>
                    </div>
                    <div class="wr2-panel">
                      <div class="wr2-panel-title">Activity Feed</div>
                      <div class="wr2-feed-item"><span class="wr2-feed-time">02:05</span><span class="wr2-feed-dot cyan"></span><span class="wr2-feed-text"><strong>M. Nguyen</strong> sent Environment Discovery Questionnaire to ADV Partners IT</span></div>
                      <div class="wr2-feed-item"><span class="wr2-feed-time">01:58</span><span class="wr2-feed-dot amber"></span><span class="wr2-feed-text"><strong>M. Nguyen</strong> completed initial scoping call with ADV Partners CISO</span></div>
                      <div class="wr2-feed-item"><span class="wr2-feed-time">01:42</span><span class="wr2-feed-dot green"></span><span class="wr2-feed-text">War Room WR-2026-004 activated â€” Cold Mode, BEC investigation</span></div>
                    </div>
                  </div>
                </div><!-- end eng004 overview -->

                <!-- SCOPING TAB â€” eng004 -->
                <div class="wr2-tab-pane" id="wr2-004-scoping">
                  <div class="wr2-cold-notice">
                    <span style="font-size:18px;">&#x2744;</span>
                    <div><strong>COLD MODE â€” Environment Discovery Required.</strong> No telemetry available. Complete the questionnaire to establish the investigation baseline. AI-assisted guidance available.</div>
                  </div>
                  <div style="display:flex;gap:10px;margin-bottom:14px;">
                    <button class="btn btn-primary btn-sm">&#x1F916; AI Scoping Call Guidance</button>
                    <button class="btn btn-secondary btn-sm">&#x1F4CB; Generate Scope Summary</button>
                  </div>
                  <div class="wr2-question-group">
                    <div class="wr2-qg-title">&#x1F3E2; Environment Overview</div>
                    <div class="wr2-field-row">
                      <div class="wr2-field"><label class="wr2-field-label">AD Domain Count</label><input type="number" placeholder="e.g. 1"></div>
                      <div class="wr2-field"><label class="wr2-field-label">Total Endpoints</label><input type="number" placeholder="e.g. 150"></div>
                      <div class="wr2-field"><label class="wr2-field-label">O365 Tenant</label><input type="text" placeholder="tenant.onmicrosoft.com"></div>
                    </div>
                    <div class="wr2-field-row">
                      <div class="wr2-field"><label class="wr2-field-label">Email Platform</label><select><option value="">-- Select --</option><option>Microsoft O365</option><option>Google Workspace</option><option>On-prem Exchange</option></select></div>
                      <div class="wr2-field"><label class="wr2-field-label">EDR Solution</label><select><option value="">-- Select --</option><option>None</option><option>Microsoft Defender</option><option>CrowdStrike</option><option>SentinelOne</option></select></div>
                      <div class="wr2-field"><label class="wr2-field-label">MFA Enforced?</label><select><option value="">-- Select --</option><option>Yes â€” All accounts</option><option>Partial</option><option>No</option></select></div>
                    </div>
                  </div>
                  <div class="wr2-question-group">
                    <div class="wr2-qg-title">&#x1F4E7; BEC Incident Specifics</div>
                    <div class="wr2-field-row">
                      <div class="wr2-field" style="flex:2;"><label class="wr2-field-label">Incident Description</label><textarea style="height:52px;" placeholder="Describe the BEC incident: who received fraudulent email, what was requested, any payments made..."></textarea></div>
                    </div>
                    <div class="wr2-field-row">
                      <div class="wr2-field"><label class="wr2-field-label">Suspected Compromised Accounts</label><input type="text" placeholder="e.g. cfo@advpartners.com"></div>
                      <div class="wr2-field"><label class="wr2-field-label">Financial Exposure</label><input type="text" placeholder="e.g. USD 280,000 wire transfer pending"></div>
                    </div>
                    <div class="wr2-field-row">
                      <div class="wr2-field"><label class="wr2-field-label">When First Detected</label><input type="datetime-local"></div>
                      <div class="wr2-field"><label class="wr2-field-label">Discovery Method</label><input type="text" placeholder="e.g. Finance team flagged suspicious email"></div>
                    </div>
                  </div>
                  <div style="display:flex;gap:10px;">
                    <button class="btn btn-primary btn-sm">&#x1F4BE; Save Questionnaire</button>
                    <button class="btn btn-secondary btn-sm">&#x27A1; Proceed to Evidence Collection</button>
                  </div>
                </div><!-- end eng004 scoping -->

                <!-- Placeholder tabs for eng004 -->
                <div class="wr2-tab-pane" id="wr2-004-evidence">
                  <div class="wr2-cold-notice"><span style="font-size:18px;">&#x26A0;&#xFE0F;</span><div>Evidence collection cannot begin until scoping questionnaire is completed. Please return to the <strong>Scoping</strong> tab and complete the environment discovery.</div></div>
                  <div class="wr2-panel"><div class="wr2-panel-title">Evidence Request List â€” Pending Scoping</div><div style="font-size:11px;color:var(--text-muted);padding:10px 0;">Once scoping is complete, evidence tiers will be automatically populated based on environment type and incident classification.</div></div>
                </div>
                <div class="wr2-tab-pane" id="wr2-004-investigation">
                  <div class="wr2-cold-notice"><span style="font-size:18px;">&#x26A0;&#xFE0F;</span><div>Investigation phase requires evidence collection first. Current phase: <strong>SCOPE</strong>. Proceed through phases in order.</div></div>
                </div>
                <div class="wr2-tab-pane" id="wr2-004-containment">
                  <div class="wr2-cold-notice"><span style="font-size:18px;">&#x26A0;&#xFE0F;</span><div>Containment actions will be available after investigation is underway. Preliminary BEC containment (inbox rules, password reset) can begin now.</div></div>
                  <div style="display:flex;gap:8px;"><button class="btn btn-amber btn-sm">&#x26A1; Emergency: Reset Compromised Account Passwords</button><button class="btn btn-secondary btn-sm">&#x1F4E7; Remove Malicious Inbox Rules</button></div>
                </div>
                <div class="wr2-tab-pane" id="wr2-004-reports"><div class="wr2-cold-notice"><span style="font-size:18px;">&#x26A0;&#xFE0F;</span><div>Reports will be generated as investigation progresses. Return here at Phase 7 for full report generation.</div></div></div>
                <div class="wr2-tab-pane" id="wr2-004-comms">
                  <div class="wr2-panel">
                    <div class="wr2-panel-title">Communication Log</div>
                    <div class="wr2-comm-item"><span class="wr2-comm-type-badge client_email">Client Email</span><div class="wr2-comm-body"><div class="wr2-comm-subject">DACTA Incident Response Activation â€” WR-2026-004</div><div class="wr2-comm-meta">To: ADV Partners CISO &mdash; 28 Feb 01:45 SGT &mdash; M. Nguyen</div></div></div>
                    <div class="wr2-comm-item"><span class="wr2-comm-type-badge internal_brief">Internal Brief</span><div class="wr2-comm-body"><div class="wr2-comm-subject">WR-2026-004 â€” BEC Investigation Brief (Cold Mode)</div><div class="wr2-comm-meta">To: DACTA IR Team &mdash; 28 Feb 01:50 SGT &mdash; M. Nguyen</div></div></div>
                  </div>
                </div>
                <div class="wr2-tab-pane" id="wr2-004-settings">
                  <div class="wr2-settings-section"><div class="wr2-settings-title">Engagement Configuration</div>
                    <div class="wr2-settings-row"><span class="wr2-settings-key">Engagement ID</span><span class="wr2-settings-val mono">WR-2026-004</span></div>
                    <div class="wr2-settings-row"><span class="wr2-settings-key">Client</span><span class="wr2-settings-val">ADV Partners Group</span></div>
                    <div class="wr2-settings-row"><span class="wr2-settings-key">Mode</span><span class="wr2-settings-val"><span class="wr2-mode-cold">COLD MODE</span></span></div>
                    <div class="wr2-settings-row"><span class="wr2-settings-key">Retainer Type</span><span class="wr2-settings-val">DFIR Ad-hoc</span></div>
                  </div>
                  <div class="wr2-settings-section"><div class="wr2-settings-title">Team</div>
                    <div class="wr2-settings-row"><span class="wr2-settings-key">M. Nguyen</span><span class="wr2-settings-val" style="color:var(--cyan);">Lead Analyst</span></div>
                    <div class="wr2-settings-row"><span class="wr2-settings-key">K. Rasmussen</span><span class="wr2-settings-val">IR Advisor</span></div>
                    <div style="margin-top:8px;"><button class="btn btn-secondary btn-sm">&#x2B; Add Member</button></div>
                  </div>
                </div>

              </div><!-- end wr2Content004 -->
            </div><!-- end wr2-main eng004 -->

            <!-- COPILOT eng004 -->
            <div class="wr2-copilot" id="wr2Copilot004">
              <div class="wr2-cop-header" onclick="wr2ToggleCopilotPanel('wr2Copilot004')">
                <div class="wr2-cop-icon">&#x2728;</div>
                <span class="wr2-cop-title">War Room Copilot</span>
                <span class="wr2-cop-toggle">&#x276F;</span>
              </div>
              <div class="wr2-cop-body" id="wr2CopBody004">
                <div class="wr2-cop-msg ai">
                  <div class="wr2-cop-msg-label">Copilot</div>
                  War Room WR-2026-004 â€” ADV Partners BEC. <strong>COLD MODE</strong> engaged. No telemetry available. We're starting from zero â€” environment discovery is critical.
                </div>
                <div class="wr2-cop-msg ai">
                  <div class="wr2-cop-msg-label">Copilot</div>
                  <strong>Priority now:</strong> Complete the scoping questionnaire. For BEC cases, I recommend requesting O365 Unified Audit Log and message trace as your first evidence items.
                </div>
              </div>
              <div class="wr2-cop-suggestions">
                <div class="wr2-cop-sug-label">Suggested for Phase 2 (COLD)</div>
                <button class="wr2-cop-sug" onclick="wr2CopilotQuery(this,'wr2CopBody004')">&#x1F4CB; Guide me through scoping call</button>
                <button class="wr2-cop-sug" onclick="wr2CopilotQuery(this,'wr2CopBody004')">&#x1F4E7; BEC evidence checklist</button>
                <button class="wr2-cop-sug" onclick="wr2CopilotQuery(this,'wr2CopBody004')">&#x1F6AB; Emergency containment steps</button>
                <button class="wr2-cop-sug" onclick="wr2CopilotQuery(this,'wr2CopBody004')">&#x1F4B0; Financial fraud recovery steps</button>
              </div>
              <div class="wr2-cop-input-row">
                <input class="wr2-cop-input" type="text" placeholder="Ask Copilot..." id="wr2CopInput004" onkeydown="if(event.key==='Enter')wr2CopilotSend('wr2CopInput004','wr2CopBody004')">
                <button class="wr2-cop-send" onclick="wr2CopilotSend('wr2CopInput004','wr2CopBody004')">&#x27A4;</button>
              </div>
            </div><!-- end copilot eng004 -->

          </div><!-- end wr2-layout eng004 -->

        </div><!-- end eng004 panel -->

      </div><!-- end page-warroom -->





      <!-- =====================================================
           PAGE 12: ASSET MANAGEMENT
           ===================================================== -->
      <div class="page" id="page-assets">
        <div class="page-header">
          <div>
            <div class="page-title">Asset Management</div>
            <div class="page-subtitle">Loading asset inventory...</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm" onclick="exportAssetCSV()">â†“ Export CSV</button>
            <button class="btn btn-primary btn-sm" onclick="openRegisterAssetModal()">+ Register Asset</button>
          </div>
        </div>

        <div class="metrics-row" style="margin-bottom:16px;">
          <div class="metric-card cyan"><div class="metric-label">Total Assets</div><div class="metric-value">â€”</div></div>
          <div class="metric-card red"><div class="metric-label">Critical Risk</div><div class="metric-value">â€”</div><div class="metric-sub">score &gt; 80</div></div>
          <div class="metric-card green"><div class="metric-label">Agent Active</div><div class="metric-value">â€”</div></div>
          <div class="metric-card amber"><div class="metric-label">Agent Offline</div><div class="metric-value">â€”</div></div>
        </div>

        <div class="card">
          <div class="table-wrap">
            <table>
              <thead><tr><th>Hostname</th><th>Type</th><th>OS</th><th>IP Address</th><th>Organization</th><th>Risk Score</th><th>Agent</th><th>Last Seen</th><th>Actions</th></tr></thead>
              <tbody id="assetsTableBody"></tbody>
            </table>
          </div>
        </div>
      </div><!-- end assets -->


      <!-- =====================================================
           PAGE 13: REPORTING & COMPLIANCE
           ===================================================== -->
      <div class="page" id="page-reporting">
        <div class="page-header">
          <div>
            <div class="page-title">Reporting &amp; Compliance</div>
            <div class="page-subtitle">Generate SOC reports and track compliance posture</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary btn-sm">âœ¨ Generate Report (AI)</button>
          </div>
        </div>

        <div class="grid-2" style="margin-bottom:16px;">
          <div>
            <div style="font-size:10px;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.1em;margin-bottom:10px;">Recent Reports</div>
            <div class="report-card">
              <div class="report-icon" style="background:rgba(0,212,255,0.1);">ðŸ“Š</div>
              <div class="report-info">
                <div class="report-title">Monthly SOC Report â€” January 2026</div>
                <div class="report-meta">All Clients Â· Generated 2026-02-05 Â· AI-assisted</div>
              </div>
              <span class="badge badge-green">Published</span>
              <button class="btn btn-secondary btn-xs">Download</button>
            </div>
            <div class="report-card">
              <div class="report-icon" style="background:rgba(139,92,246,0.1);">ðŸ“‹</div>
              <div class="report-info">
                <div class="report-title">Q4 2025 Quarterly Business Review Deck</div>
                <div class="report-meta">Dacta Global Â· Generated 2026-01-15</div>
              </div>
              <span class="badge badge-green">Published</span>
              <button class="btn btn-secondary btn-xs">Download</button>
            </div>
            <div class="report-card">
              <div class="report-icon" style="background:rgba(239,68,68,0.1);">ðŸš¨</div>
              <div class="report-info">
                <div class="report-title">Incident Summary â€” DAC-18094 Phishing Campaign</div>
                <div class="report-meta">Naga World Â· Generated 2026-02-12</div>
              </div>
              <span class="badge badge-cyan">Draft</span>
              <button class="btn btn-primary btn-xs">Finalize</button>
            </div>
            <div class="report-card">
              <div class="report-icon" style="background:rgba(245,158,11,0.1);">ðŸ“ˆ</div>
              <div class="report-info">
                <div class="report-title">Weekly SOC Metrics â€” Week 8, 2026</div>
                <div class="report-meta">All Clients Â· Auto-generated Â· Fri 22:00</div>
              </div>
              <span class="badge badge-amber">Generating...</span>
              <button class="btn btn-secondary btn-xs">Preview</button>
            </div>
          </div>

          <div>
            <div style="font-size:10px;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.1em;margin-bottom:10px;">Compliance Status by Organization</div>
            <div class="card">
              <div style="display:flex;flex-direction:column;gap:10px;">
                <div style="padding:10px;background:var(--bg-elevated);border-radius:7px;">
                  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
                    <span style="font-size:12px;font-weight:600;color:var(--text-primary);">Dacta Global</span>
                    <span class="badge badge-green">MAS TRM Compliant</span>
                  </div>
                  <div class="progress-bar"><div class="progress-fill" style="width:98%;background:var(--green);"></div></div>
                  <div style="font-size:10px;color:var(--text-muted);margin-top:3px;">98% Â· Next audit: Apr 2026</div>
                </div>
                <div style="padding:10px;background:var(--bg-elevated);border-radius:7px;">
                  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
                    <span style="font-size:12px;font-weight:600;color:var(--text-primary);">SPMT</span>
                    <span class="badge badge-green">ISO 27001</span>
                  </div>
                  <div class="progress-bar"><div class="progress-fill" style="width:94%;background:var(--green);"></div></div>
                  <div style="font-size:10px;color:var(--text-muted);margin-top:3px;">94% Â· Certification renewal: Jun 2026</div>
                </div>
                <div style="padding:10px;background:var(--bg-elevated);border-radius:7px;">
                  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
                    <span style="font-size:12px;font-weight:600;color:var(--text-primary);">Naga World</span>
                    <span class="badge badge-amber">PCI-DSS Review</span>
                  </div>
                  <div class="progress-bar"><div class="progress-fill" style="width:81%;background:var(--amber);"></div></div>
                  <div style="font-size:10px;color:var(--text-muted);margin-top:3px;">81% Â· 3 open findings</div>
                </div>
                <div style="padding:10px;background:var(--bg-elevated);border-radius:7px;">
                  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
                    <span style="font-size:12px;font-weight:600;color:var(--text-primary);">ADV Partners</span>
                    <span class="badge badge-green">CIS L1</span>
                  </div>
                  <div class="progress-bar"><div class="progress-fill" style="width:96%;background:var(--green);"></div></div>
                  <div style="font-size:10px;color:var(--text-muted);margin-top:3px;">96% Â· Next review: Mar 2026</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div><!-- end reporting -->


      <!-- =====================================================
           PAGE 14: CLIENT PORTAL
           ===================================================== -->
      <div class="page" id="page-clientportal">

        <!-- STATE 1: Welcome Splash -->
        <div class="cp-splash" id="cpSplash">
          <div class="cp-splash-bg"></div>
          <div class="cp-splash-content">
            <div class="cp-splash-icon">
              <div class="cp-splash-shield">ðŸ›¡</div>
            </div>
            <h1 class="cp-splash-title">Welcome Back</h1>
            <div class="cp-splash-org">Dacta Global</div>
            <div class="cp-splash-since">
              Since your last login, <strong>2 hours 14 mins</strong> ago
            </div>

            <div class="cp-splash-stats">
              <div class="cp-splash-stat-line">
                <span class="cp-splash-stat-icon green">âœ“</span>
                <span>Your environment has been continuously monitored with <strong>zero interruptions</strong></span>
              </div>
              <div class="cp-splash-stat-line">
                <span class="cp-splash-stat-icon amber">âš¡</span>
                <span><strong>3 new alerts</strong> were detected and <strong>2 were automatically resolved</strong> by our AI engine</span>
              </div>
              <div class="cp-splash-stat-line">
                <span class="cp-splash-stat-icon red">ðŸ”´</span>
                <span><strong>1 P1 critical incident</strong> is actively being investigated by our SOC team</span>
              </div>
              <div class="cp-splash-stat-line">
                <span class="cp-splash-stat-icon cyan">ðŸ“Š</span>
                <span>SLA compliance remains at <strong>98.4%</strong>, exceeding your <strong>98% target</strong></span>
              </div>
              <div class="cp-splash-stat-line">
                <span class="cp-splash-stat-icon green">ðŸ›¡</span>
                <span><strong>157.5K events</strong> were blocked across your environment in the last 24 hours</span>
              </div>
            </div>

            <button class="cp-splash-continue" onclick="enterClientPortal()">
              Continue to Dashboard
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </button>

            <div class="cp-splash-footer">
              ðŸ” Your data is protected by Dactaâ€™s Privacy Engine Â· PDPA Compliant Â· Zero PII Exposure
            </div>
          </div>
        </div>

        <!-- STATE 2: Dashboard (hidden by default) -->
        <div class="cp-dashboard" id="cpDashboard" style="display:none;">
          <div class="page-header">
            <div>
              <div class="page-title">Client Portal</div>
              <div class="page-subtitle">Client-facing view â€” preview what each organization sees</div>
            </div>
            <div class="page-actions">
              <select class="filter-select">
                <option>Dacta Global</option>
                <option>SPMT</option>
                <option>Naga World</option>
                <option>ADV Partners</option>
              </select>
              <button class="btn btn-secondary btn-sm">ðŸ”— Share Portal Link</button>
            </div>
          </div>

          <!-- Portal preview frame -->
          <div style="border:1px solid var(--border-card);border-radius:10px;overflow:hidden;">
            <div style="background:var(--bg-elevated);padding:8px 14px;display:flex;align-items:center;gap:8px;border-bottom:1px solid var(--border-subtle);">
              <div style="width:10px;height:10px;border-radius:50%;background:rgba(239,68,68,0.5);"></div>
              <div style="width:10px;height:10px;border-radius:50%;background:rgba(245,158,11,0.5);"></div>
              <div style="width:10px;height:10px;border-radius:50%;background:rgba(16,185,129,0.5);"></div>
              <div style="background:var(--bg-input);border:1px solid var(--border-subtle);border-radius:4px;padding:3px 12px;flex:1;font-size:11px;color:var(--text-muted);max-width:300px;font-family:var(--font-mono);">portal.dacta.sg/dactaglobal</div>
              <span class="badge badge-green" style="margin-left:auto;">CLIENT VIEW</span>
            </div>
            <div class="cp-portal-inner" style="padding:24px;background:var(--bg-base);position:relative;overflow:hidden;">
              <!-- Animated mesh gradient background -->
              <div class="cp-mesh-bg"></div>

              <!-- Period Summary Banner -->
              <div class="cp-period-summary" id="cpPeriodSummary">
                <div class="cp-period-icon">ðŸ“Š</div>
                <div class="cp-period-text">
                  In the <strong>last 24 hours</strong>, Dactaâ€™s SOC team processed <strong>47 alerts</strong> across your environment.
                  <strong>1 critical incident</strong> was escalated and is actively being investigated.
                  <strong>44 alerts</strong> were resolved automatically by AI, maintaining a <strong>98.4% SLA compliance rate</strong>.
                  Your mean time to detect is <strong>4.2 minutes</strong> â€” well within the 5-minute target.
                </div>
              </div>

              <!-- Client Header with Security Score -->
              <div class="cp-header-row">
                <div style="display:flex;align-items:center;gap:12px;">
                  <div class="cp-logo-badge">
                    <div class="cp-shield-anim">
                      <svg width="36" height="36" viewBox="0 0 36 36" fill="none"><path d="M18 3L5 9v9c0 8.3 5.5 16.1 13 18 7.5-1.9 13-9.7 13-18V9L18 3z" fill="url(#cpShieldGrad)" stroke="rgba(0,212,255,0.4)" stroke-width="1"/><defs><linearGradient id="cpShieldGrad" x1="5" y1="3" x2="31" y2="30"><stop offset="0%" stop-color="#00d4ff" stop-opacity="0.3"/><stop offset="100%" stop-color="#0066cc" stop-opacity="0.3"/></linearGradient></defs><text x="18" y="22" text-anchor="middle" fill="#00d4ff" font-size="14" font-weight="800" font-family="var(--font-display)">D</text></svg>
                    </div>
                  </div>
                  <div>
                    <div style="font-family:var(--font-display);font-size:18px;font-weight:700;color:var(--text-primary);letter-spacing:-0.02em;">Dacta Global â€” Security Dashboard</div>
                    <div style="font-size:11px;color:var(--text-muted);">Managed by Dacta SG Â· Updated live Â· <span style="color:#10b981;">All systems operational</span></div>
                  </div>
                </div>
                <div class="cp-security-score">
                  <canvas id="cpSecurityGauge" width="80" height="80"></canvas>
                  <div class="cp-score-label">
                    <div class="cp-score-val">94</div>
                    <div class="cp-score-sub">Security Score</div>
                  </div>
                </div>
              </div>

              <!-- Metrics Row -->
              <div class="metrics-row cp-metrics-row" style="margin-bottom:16px;">
                <div class="metric-card cp-glow-card red"><div class="metric-label">Active Incidents</div><div class="metric-value" style="font-size:32px;">1</div><div class="metric-sub">P1 â€” Under investigation</div></div>
                <div class="metric-card cp-glow-card amber"><div class="metric-label">Open Tickets</div><div class="metric-value" style="font-size:32px;">4</div><div class="metric-sub">2 P2 Â· 2 P3</div></div>
                <div class="metric-card cp-glow-card green"><div class="metric-label">Resolved (30d)</div><div class="metric-value" style="font-size:32px;">47</div><div class="metric-sub">+12% vs last month</div></div>
                <div class="metric-card cp-glow-card cyan"><div class="metric-label">SLA Compliance</div><div class="metric-value" style="font-size:32px;">98.4<span style="font-size:16px;">%</span></div><div class="metric-sub">Above 98% target</div></div>
              </div>

              <!-- SLA Performance Card -->
              <div class="cp-sla-card cp-glass-card">
                <div class="cp-sla-title">ðŸ“Š SLA Performance â€” February 2026</div>
                <div class="cp-sla-row">
                  <span class="cp-sla-label">MTTD (Mean Time to Detect)</span>
                  <div class="cp-sla-bar-wrap"><div class="cp-sla-bar"><div class="cp-sla-fill" style="width:84%;"></div></div><div class="cp-sla-meta"><span class="cp-sla-val">4.2 min</span><span class="cp-sla-target">âœ“ Target: &lt;5 min</span></div></div>
                </div>
                <div class="cp-sla-row">
                  <span class="cp-sla-label">MTTR (Mean Time to Respond)</span>
                  <div class="cp-sla-bar-wrap"><div class="cp-sla-bar"><div class="cp-sla-fill" style="width:60%;"></div></div><div class="cp-sla-meta"><span class="cp-sla-val">18 min</span><span class="cp-sla-target">âœ“ Target: &lt;30 min</span></div></div>
                </div>
                <div class="cp-sla-row">
                  <span class="cp-sla-label">P1 Response Time</span>
                  <div class="cp-sla-bar-wrap"><div class="cp-sla-bar"><div class="cp-sla-fill" style="width:40%;"></div></div><div class="cp-sla-meta"><span class="cp-sla-val">6 min</span><span class="cp-sla-target">âœ“ Target: &lt;15 min</span></div></div>
                </div>
                <div class="cp-sla-row" style="margin-bottom:0;">
                  <span class="cp-sla-label">False Positive Rate</span>
                  <div class="cp-sla-bar-wrap"><div class="cp-sla-bar"><div class="cp-sla-fill" style="width:55%;"></div></div><div class="cp-sla-meta"><span class="cp-sla-val">8.2%</span><span class="cp-sla-target">âœ“ Target: &lt;15%</span></div></div>
                </div>
              </div>

              <!-- Recent Incidents -->
              <div class="card cp-incidents-card" style="background:rgba(17,24,39,0.9);margin-bottom:12px;">
                <div class="card-header"><span class="card-title">Recent Incidents</span><span class="badge badge-red" style="font-size:9px;">1 ACTIVE</span></div>
                <div class="cp-incident-item cp-sev-p1">
                  <span class="ticket-id">DAC-18158</span><span class="badge badge-p1">P1</span>
                  <span class="ticket-title">Potential Ransomware Activity â€” Under Investigation</span>
                  <div class="ticket-meta"><div class="status-dot red"></div><span style="font-size:11px;color:var(--red-bright);font-weight:600;">ACTIVE</span></div>
                </div>
                <div class="cp-incident-item cp-sev-p2">
                  <span class="ticket-id">DAC-18157</span><span class="badge badge-p2">P2</span>
                  <span class="ticket-title">Unusual Internal Host Communication â€” Monitoring</span>
                  <div class="ticket-meta"><div class="status-dot amber"></div><span class="ticket-time">9h ago</span></div>
                </div>
                <div class="cp-incident-item cp-sev-p2">
                  <span class="ticket-id">DAC-18145</span><span class="badge badge-p2">P2</span>
                  <span class="ticket-title">Suspicious DNS Tunneling â€” SPMT-DC-02</span>
                  <div class="ticket-meta"><div class="status-dot green"></div><span class="ticket-time">Resolved 6h ago</span></div>
                </div>
                <div class="cp-incident-item cp-sev-p3">
                  <span class="ticket-id">DAC-18132</span><span class="badge badge-p3">P3</span>
                  <span class="ticket-title">Blocked C2 Communication â€” 185.220.101.42</span>
                  <div class="ticket-meta"><div class="status-dot green"></div><span class="ticket-time">Resolved 12h ago</span></div>
                </div>
                <div class="cp-incident-item cp-sev-p3" style="border-bottom:none;">
                  <span class="ticket-id">DAC-18109</span><span class="badge badge-p3">P3</span>
                  <span class="ticket-title">Forensic Script Execution â€” NW-WS-019</span>
                  <div class="ticket-meta"><div class="status-dot green"></div><span class="ticket-time">Resolved 1d ago</span></div>
                </div>
              </div>

              <!-- Monthly Security Summary -->
              <div class="cp-summary-card">
                <div class="cp-summary-title">
                  <span>ðŸ“ˆ February 2026 â€” Monthly Security Summary</span>
                  <span style="font-size:10px;color:var(--text-muted);font-weight:400;">Preview Â· Draft</span>
                </div>
                <div class="cp-summary-grid">
                  <div class="cp-summary-item"><div class="cp-summary-item-label">Total Alerts Processed</div><div class="cp-summary-item-val">847</div></div>
                  <div class="cp-summary-item tp"><div class="cp-summary-item-label">True Positives</div><div class="cp-summary-item-val">72</div><div class="cp-summary-item-pct">8.5% of total</div></div>
                  <div class="cp-summary-item fp"><div class="cp-summary-item-label">False Positives</div><div class="cp-summary-item-val">612</div><div class="cp-summary-item-pct">72.3% of total</div></div>
                  <div class="cp-summary-item btp"><div class="cp-summary-item-label">Benign True Positives</div><div class="cp-summary-item-val">163</div><div class="cp-summary-item-pct">19.2% of total</div></div>
                </div>
                <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:8px;">
                  <div style="background:var(--bg-base);border:1px solid var(--border-subtle);border-radius:7px;padding:10px 12px;">
                    <div style="font-size:10px;color:var(--text-muted);margin-bottom:3px;">Escalated to Client</div>
                    <div style="font-size:18px;font-weight:800;font-family:var(--font-display);color:var(--red);">4</div>
                    <div style="font-size:10px;color:var(--text-muted);">incidents</div>
                  </div>
                  <div style="background:var(--bg-base);border:1px solid var(--border-subtle);border-radius:7px;padding:10px 12px;">
                    <div style="font-size:10px;color:var(--text-muted);margin-bottom:3px;">New Detection Rules</div>
                    <div style="font-size:18px;font-weight:800;font-family:var(--font-display);color:var(--cyan);">7</div>
                    <div style="font-size:10px;color:var(--text-muted);">created this month</div>
                  </div>
                  <div style="background:var(--bg-base);border:1px solid var(--border-subtle);border-radius:7px;padding:10px 12px;">
                    <div style="font-size:10px;color:var(--text-muted);margin-bottom:3px;">MITRE Coverage</div>
                    <div style="font-size:18px;font-weight:800;font-family:var(--font-display);color:var(--purple);">47<span style="font-size:12px;">/201</span></div>
                    <div style="font-size:10px;color:var(--green);">+3 techniques this month</div>
                  </div>
                </div>
              </div>

              <!-- Published Reports -->
              <div class="card" style="background:rgba(17,24,39,0.9);margin-bottom:12px;">
                <div class="card-header"><span class="card-title">Published Reports</span></div>
                <div class="cp-reports-grid">
                  <div class="cp-report-card">
                    <div class="cp-report-icon">ðŸ“Š</div>
                    <div class="cp-report-info">
                      <div class="cp-report-name">February 2026 Monthly SOC Report</div>
                      <div class="cp-report-meta">Generated 28 Feb Â· 12 pages</div>
                    </div>
                    <span class="badge badge-amber" style="font-size:9px;">DRAFT</span>
                  </div>
                  <div class="cp-report-card">
                    <div class="cp-report-icon">ðŸ“Š</div>
                    <div class="cp-report-info">
                      <div class="cp-report-name">January 2026 Monthly SOC Report</div>
                      <div class="cp-report-meta">Published 1 Feb Â· 14 pages</div>
                    </div>
                    <span class="badge badge-green" style="font-size:9px;">PUBLISHED</span>
                  </div>
                  <div class="cp-report-card">
                    <div class="cp-report-icon">ðŸ“‹</div>
                    <div class="cp-report-info">
                      <div class="cp-report-name">Q4 2025 QBR Deck</div>
                      <div class="cp-report-meta">Published 15 Jan Â· 28 slides</div>
                    </div>
                    <span class="badge badge-green" style="font-size:9px;">PUBLISHED</span>
                  </div>
                  <div class="cp-report-card">
                    <div class="cp-report-icon">ðŸ“ˆ</div>
                    <div class="cp-report-info">
                      <div class="cp-report-name">2025 Annual Security Review</div>
                      <div class="cp-report-meta">Published 10 Jan Â· 32 pages</div>
                    </div>
                    <span class="badge badge-green" style="font-size:9px;">PUBLISHED</span>
                  </div>
                </div>
              </div>

              <!-- Client Portal Geo Map -->
              <div class="card cp-geo-card" style="background:rgba(17,24,39,0.9);margin-bottom:12px;">
                <div class="card-header"><span class="card-title">Threat Geography</span><span style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">Alert Origins Â· Last 24 Hours</span></div>
                <div style="position:relative;overflow:hidden;border-radius:6px;">
                  <canvas id="cpGeoMapCanvas" style="width:100%;height:240px;display:block;"></canvas>
                  <div id="cpGeoSvgTooltip" style="position:absolute;display:none;pointer-events:none;background:rgba(8,12,24,0.95);border:1px solid rgba(0,212,255,0.2);border-radius:6px;padding:6px 10px;font-size:10px;color:#e8edf5;font-family:'IBM Plex Sans',sans-serif;box-shadow:0 4px 16px rgba(0,0,0,0.5);z-index:10;white-space:nowrap;">
                    <div id="cpGeoTipName" style="font-weight:700;margin-bottom:2px;"></div>
                    <div id="cpGeoTipInfo" style="color:#8892a4;font-size:9px;"></div>
                  </div>
                </div>
                <div class="cc-geomap-legend">
                  <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#ef4444;box-shadow:0 0 6px #ef4444;"></span>Malicious</span>
                  <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#f59e0b;box-shadow:0 0 6px #f59e0b;"></span>Suspicious</span>
                  <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#10b981;box-shadow:0 0 6px #10b981;"></span>Internal</span>
                  <span class="cc-geomap-legend-item"><span class="cc-geo-dot" style="background:#00d4ff;box-shadow:0 0 6px #00d4ff;"></span>Informational</span>
                </div>
              </div>

              <!-- Data Protection Badge -->
              <div class="cp-privacy-banner">
                ðŸ” Your data is protected by Dactaâ€™s Privacy Engine Â· <strong>PDPA Compliant</strong> Â· All AI processing uses anonymized data Â· <strong>Zero PII exposure</strong>
              </div>
            </div>
          </div>
        </div><!-- end cpDashboard -->

      </div><!-- end clientportal -->


      <!-- =====================================================
           PAGE 15: INTEGRATIONS HUB
           ===================================================== -->
      <div class="page" id="page-integrations">
        <div class="page-header">
          <div>
            <div class="page-title">Integrations Hub</div>
            <div class="page-subtitle" id="integrationSubtitle">Dacta operational stack â€” loading...</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-primary btn-sm" onclick="showAddIntegrationModal()">+ Add Integration</button>
          </div>
        </div>

        <div class="integrations-grid" id="integrationsGrid"></div>
      </div><!-- end integrations -->


      <!-- =====================================================
           PAGE 16: AI USAGE DASHBOARD
           ===================================================== -->
      <div class="page" id="page-aiusage">
        <div class="page-header">
          <div>
            <div class="page-title">AI Usage Dashboard</div>
            <div class="page-subtitle">Live Tracking Â· Real-time</div>
          </div>
          <div class="page-actions">
            <select class="filter-select"><option>February 2026</option><option>January 2026</option><option>December 2025</option></select>
            <button class="btn btn-secondary btn-sm">â†“ Export</button>
          </div>
        </div>

        <!-- Top metrics -->
        <div class="metrics-row" style="margin-bottom:20px;">
          <div class="metric-card cyan"><div class="metric-label">Total Cost</div><div class="metric-value">$0<span style="font-size:16px;">.00</span></div><div class="metric-sub">this month</div></div>
          <div class="metric-card purple"><div class="metric-label">Total Requests</div><div class="metric-value">0</div></div>
          <div class="metric-card green"><div class="metric-label">Verdict Accepted</div><div class="metric-value">â€”</div><div class="metric-sub">of AI verdicts</div></div>
          <div class="metric-card amber"><div class="metric-label">Parser Validated</div><div class="metric-value">â€”</div><div class="metric-sub">accuracy</div></div>
        </div>

        <div class="grid-2" style="margin-bottom:16px;">
          <!-- By Provider -->
          <div class="card">
            <div class="card-header"><span class="card-title">Usage by Provider</span></div>
            <div style="height:200px;position:relative;"><canvas id="aiProviderChart"></canvas></div>
            <div class="ai-legend" style="margin-top:12px;">
              <div style="font-size:11px;color:var(--text-muted);text-align:center;padding:12px;">No AI calls tracked yet â€” data populates in real-time as investigations run</div>
            </div>
          </div>

          <!-- By Function -->
          <div class="card">
            <div class="card-header"><span class="card-title">Usage by Function</span></div>
            <div style="padding:16px;text-align:center;font-size:11px;color:var(--text-muted);">
              No function usage data yet â€” will populate as AI features are used
            </div>
          </div>
        </div>

        <!-- Daily usage chart -->
        <div class="card">
          <div class="card-header"><span class="card-title">Daily AI Request Volume</span></div>
          <div style="height:180px;position:relative;"><canvas id="aiDailyChart"></canvas></div>
        </div>
      </div><!-- end aiusage -->


      <!-- =====================================================
           PAGE 17: USER MANAGEMENT
           ===================================================== -->
      <div class="page" id="page-users">
        <div class="page-header">
          <div>
            <div class="page-title">User Management</div>
            <div class="page-subtitle">9 users across 5 roles</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm">â†“ Export</button>
            <button class="btn btn-primary btn-sm">+ Invite User</button>
          </div>
        </div>

        <div class="grid-2" style="margin-bottom:16px;">
          <div class="card">
            <div class="card-header"><span class="card-title">Users</span></div>
            <div class="table-wrap">
              <table>
                <thead><tr><th>Name</th><th>Email</th><th>Role</th><th>Status</th><th>Last Login</th></tr></thead>
                <tbody>
                  <tr><td><div style="display:flex;align-items:center;gap:8px;"><div class="user-avatar" style="width:22px;height:22px;font-size:9px;">JL</div><span style="color:var(--text-primary);">John Lim</span></div></td><td style="font-family:var(--font-mono);font-size:10px;">john.lim@dacta.sg</td><td><span class="badge badge-cyan">SOC L2</span></td><td><div class="status-dot green" style="display:inline-block;"></div></td><td class="mono">Now</td></tr>
                  <tr><td><div style="display:flex;align-items:center;gap:8px;"><div class="user-avatar" style="width:22px;height:22px;font-size:9px;background:linear-gradient(135deg,#f59e0b,#ef4444);">ST</div><span style="color:var(--text-primary);">Sarah Tan</span></div></td><td style="font-family:var(--font-mono);font-size:10px;">sarah.tan@dacta.sg</td><td><span class="badge badge-blue">SOC L1</span></td><td><div class="status-dot green" style="display:inline-block;"></div></td><td class="mono">22m ago</td></tr>
                  <tr><td><div style="display:flex;align-items:center;gap:8px;"><div class="user-avatar" style="width:22px;height:22px;font-size:9px;background:linear-gradient(135deg,#10b981,#3b82f6);">MW</div><span style="color:var(--text-primary);">Marcus Wong</span></div></td><td style="font-family:var(--font-mono);font-size:10px;">marcus.w@dacta.sg</td><td><span class="badge badge-blue">SOC L1</span></td><td><div class="status-dot amber" style="display:inline-block;"></div></td><td class="mono">1h ago</td></tr>
                  <tr><td><div style="display:flex;align-items:center;gap:8px;"><div class="user-avatar" style="width:22px;height:22px;font-size:9px;background:linear-gradient(135deg,#8b5cf6,#06b6d4);">RL</div><span style="color:var(--text-primary);">Raj Lingam</span></div></td><td style="font-family:var(--font-mono);font-size:10px;">raj.l@dacta.sg</td><td><span class="badge badge-cyan">SOC L2</span></td><td><div class="status-dot gray" style="display:inline-block;"></div></td><td class="mono">6h ago</td></tr>
                  <tr><td><div style="display:flex;align-items:center;gap:8px;"><div class="user-avatar" style="width:22px;height:22px;font-size:9px;background:linear-gradient(135deg,#f97316,#8b5cf6);">AH</div><span style="color:var(--text-primary);">Aisha Hassan</span></div></td><td style="font-family:var(--font-mono);font-size:10px;">aisha.h@dacta.sg</td><td><span class="badge badge-blue">SOC L1</span></td><td><div class="status-dot gray" style="display:inline-block;"></div></td><td class="mono">6h ago</td></tr>
                  <tr><td><div style="display:flex;align-items:center;gap:8px;"><div class="user-avatar" style="width:22px;height:22px;font-size:9px;background:linear-gradient(135deg,#ef4444,#8b5cf6);">WC</div><span style="color:var(--text-primary);">Wei Chen</span></div></td><td style="font-family:var(--font-mono);font-size:10px;">wei.chen@dacta.sg</td><td><span class="badge badge-purple">SOC Manager</span></td><td><div class="status-dot gray" style="display:inline-block;"></div></td><td class="mono">8h ago</td></tr>
                  <tr><td><div style="display:flex;align-items:center;gap:8px;"><div class="user-avatar" style="width:22px;height:22px;font-size:9px;background:linear-gradient(135deg,#3b82f6,#10b981);">KT</div><span style="color:var(--text-primary);">Kevin Toh</span></div></td><td style="font-family:var(--font-mono);font-size:10px;">kevin.t@dacta.sg</td><td><span class="badge badge-amber">Engineer</span></td><td><div class="status-dot green" style="display:inline-block;"></div></td><td class="mono">45m ago</td></tr>
                  <tr><td><div style="display:flex;align-items:center;gap:8px;"><div class="user-avatar" style="width:22px;height:22px;font-size:9px;background:linear-gradient(135deg,#00d4ff,#3b82f6);">NS</div><span style="color:var(--text-primary);">Nadia Soh</span></div></td><td style="font-family:var(--font-mono);font-size:10px;">nadia.s@dacta.sg</td><td><span class="badge badge-green">Hunter</span></td><td><div class="status-dot gray" style="display:inline-block;"></div></td><td class="mono">2d ago</td></tr>
                  <tr><td><div style="display:flex;align-items:center;gap:8px;"><div class="user-avatar" style="width:22px;height:22px;font-size:9px;background:linear-gradient(135deg,#ef4444,#f97316);">AD</div><span style="color:var(--text-primary);">Admin Dacta</span></div></td><td style="font-family:var(--font-mono);font-size:10px;">admin@dacta.sg</td><td><span class="badge badge-red">Admin</span></td><td><div class="status-dot green" style="display:inline-block;"></div></td><td class="mono">1h ago</td></tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="card">
            <div class="card-header"><span class="card-title">Role-Based Access Matrix</span></div>
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>Permission</th>
                    <th>SOC L1</th>
                    <th>SOC L2</th>
                    <th>Engineer</th>
                    <th>Manager</th>
                    <th>Admin</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style="color:var(--text-secondary);">View Tickets</td><td style="color:var(--green);">âœ“</td><td style="color:var(--green);">âœ“</td><td style="color:var(--green);">âœ“</td><td style="color:var(--green);">âœ“</td><td style="color:var(--green);">âœ“</td></tr>
                  <tr><td style="color:var(--text-secondary);">Manage Tickets</td><td style="color:var(--cyan);">Own</td><td style="color:var(--green);">âœ“</td><td>â€”</td><td style="color:var(--green);">âœ“</td><td style="color:var(--green);">âœ“</td></tr>
                  <tr><td style="color:var(--text-secondary);">Response Actions</td><td>â€”</td><td style="color:var(--green);">âœ“</td><td>â€”</td><td style="color:var(--green);">âœ“</td><td style="color:var(--green);">âœ“</td></tr>
                  <tr><td style="color:var(--text-secondary);">Detection Rules</td><td>View</td><td>View</td><td style="color:var(--green);">âœ“</td><td>View</td><td style="color:var(--green);">âœ“</td></tr>
                  <tr><td style="color:var(--text-secondary);">Threat Hunting</td><td>â€”</td><td style="color:var(--cyan);">Collab</td><td>â€”</td><td style="color:var(--green);">âœ“</td><td style="color:var(--green);">âœ“</td></tr>
                  <tr><td style="color:var(--text-secondary);">Reports (Generate)</td><td>â€”</td><td>â€”</td><td>â€”</td><td style="color:var(--green);">âœ“</td><td style="color:var(--green);">âœ“</td></tr>
                  <tr><td style="color:var(--text-secondary);">Client Portal Mgmt</td><td>â€”</td><td>â€”</td><td>â€”</td><td style="color:var(--green);">âœ“</td><td style="color:var(--green);">âœ“</td></tr>
                  <tr><td style="color:var(--text-secondary);">Integrations Config</td><td>â€”</td><td>â€”</td><td style="color:var(--green);">âœ“</td><td>â€”</td><td style="color:var(--green);">âœ“</td></tr>
                  <tr><td style="color:var(--text-secondary);">User Management</td><td>â€”</td><td>â€”</td><td>â€”</td><td>â€”</td><td style="color:var(--green);">âœ“</td></tr>
                  <tr><td style="color:var(--text-secondary);">AI Config / LLM</td><td>â€”</td><td>â€”</td><td>â€”</td><td>â€”</td><td style="color:var(--green);">âœ“</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div><!-- end users -->


      <!-- =====================================================
           PAGE 18: SETTINGS
           ===================================================== -->
      <div class="page" id="page-settings">
        <div class="page-header">
          <div><div class="page-title">Settings</div><div class="page-subtitle">Platform configuration and preferences</div></div>
          <div class="page-actions"><button class="btn btn-primary btn-sm">ðŸ’¾ Save Changes</button></div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 1: CLIENT CONNECTOR CONFIGURATION
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="card stg-section" style="margin-bottom:24px;">
          <div class="card-header" style="margin-bottom:16px;">
            <div>
              <span class="card-title">Client Environment Connectors</span>
              <div class="stg-section-sub">Per-tenant log source & security tool integrations â€” these connect to the clientâ€™s environment for RAG-powered AI investigation</div>
            </div>
            <div class="stg-org-selector">
              <span class="stg-org-label">Client Org:</span>
              <select class="stg-org-select">
                <option>MAS â€” Monetary Authority of Singapore</option>
                <option>SingTel â€” Network Operations</option>
                <option>ST Engineering â€” OT Division</option>
                <option>GovTech â€” Smart Nation</option>
                <option selected>Dacta SG â€” Internal SOC</option>
              </select>
            </div>
          </div>

          <div class="stg-connector-grid">

            <!-- 1. SIEM Connector -->
            <div class="stg-conn-card">
              <div class="stg-conn-top">
                <div class="stg-conn-icon">ðŸ“Š</div>
                <div class="stg-conn-meta">
                  <div class="stg-conn-name">SIEM Connector</div>
                  <span class="badge badge-green" style="font-size:9px;padding:2px 7px;margin-top:3px;display:inline-flex;">Connected</span>
                </div>
                <div class="stg-conn-status-dot connected"></div>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">CONNECTION TYPE</div>
                <select class="stg-conn-select">
                  <option selected>Elastic SIEM</option>
                  <option>Splunk Enterprise</option>
                  <option>Microsoft Sentinel</option>
                  <option>QRadar</option>
                </select>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">ENDPOINT URL</div>
                <input class="stg-conn-input" value="https://elastic.mas.gov.sg:9200" />
              </div>
              <div class="stg-conn-footer">
                <button class="stg-conn-test-btn">âš¡ Test Connection</button>
                <div class="stg-conn-sync">Last synced: 2 min ago</div>
              </div>
            </div>

            <!-- 2. EDR Connector -->
            <div class="stg-conn-card">
              <div class="stg-conn-top">
                <div class="stg-conn-icon">ðŸ›¡</div>
                <div class="stg-conn-meta">
                  <div class="stg-conn-name">EDR Connector</div>
                  <span class="badge badge-green" style="font-size:9px;padding:2px 7px;margin-top:3px;display:inline-flex;">Connected</span>
                </div>
                <div class="stg-conn-status-dot connected"></div>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">CONNECTION TYPE</div>
                <select class="stg-conn-select">
                  <option selected>CrowdStrike Falcon</option>
                  <option>SentinelOne</option>
                  <option>Microsoft Defender</option>
                  <option>Carbon Black</option>
                </select>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">ENDPOINT URL</div>
                <input class="stg-conn-input" value="https://falcon.crowdstrike.com/api" />
              </div>
              <div class="stg-conn-footer">
                <button class="stg-conn-test-btn">âš¡ Test Connection</button>
                <div class="stg-conn-sync">Last synced: 5 min ago</div>
              </div>
            </div>

            <!-- 3. Threat Intel Connector -->
            <div class="stg-conn-card">
              <div class="stg-conn-top">
                <div class="stg-conn-icon">ðŸ”</div>
                <div class="stg-conn-meta">
                  <div class="stg-conn-name">Threat Intel Connector</div>
                  <span class="badge badge-green" style="font-size:9px;padding:2px 7px;margin-top:3px;display:inline-flex;">Connected</span>
                </div>
                <div class="stg-conn-status-dot connected"></div>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">CONNECTION TYPE</div>
                <select class="stg-conn-select">
                  <option selected>MISP (Self-hosted)</option>
                  <option>AlienVault OTX</option>
                  <option>VirusTotal Enterprise</option>
                  <option>Recorded Future</option>
                </select>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">ENDPOINT URL</div>
                <input class="stg-conn-input" value="https://misp.dacta.sg/api" />
              </div>
              <div class="stg-conn-footer">
                <button class="stg-conn-test-btn">âš¡ Test Connection</button>
                <div class="stg-conn-sync">Last synced: 12 min ago</div>
              </div>
            </div>

            <!-- 4. Identity & Access Connector -->
            <div class="stg-conn-card">
              <div class="stg-conn-top">
                <div class="stg-conn-icon">ðŸ‘¤</div>
                <div class="stg-conn-meta">
                  <div class="stg-conn-name">Identity &amp; Access Connector</div>
                  <span class="badge badge-green" style="font-size:9px;padding:2px 7px;margin-top:3px;display:inline-flex;">Connected</span>
                </div>
                <div class="stg-conn-status-dot connected"></div>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">CONNECTION TYPE</div>
                <select class="stg-conn-select">
                  <option selected>Microsoft Entra ID</option>
                  <option>Okta</option>
                  <option>CyberArk</option>
                  <option>JumpCloud</option>
                </select>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">ENDPOINT URL</div>
                <input class="stg-conn-input" value="https://graph.microsoft.com/v1.0" />
              </div>
              <div class="stg-conn-footer">
                <button class="stg-conn-test-btn">âš¡ Test Connection</button>
                <div class="stg-conn-sync">Last synced: 8 min ago</div>
              </div>
            </div>

            <!-- 5. DACTA Knowledge Base -->
            <div class="stg-conn-card">
              <div class="stg-conn-top">
                <div class="stg-conn-icon">ðŸ“š</div>
                <div class="stg-conn-meta">
                  <div class="stg-conn-name">DACTA Knowledge Base</div>
                  <span class="badge badge-green" style="font-size:9px;padding:2px 7px;margin-top:3px;display:inline-flex;">Connected</span>
                </div>
                <div class="stg-conn-status-dot connected"></div>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">CONNECTION TYPE</div>
                <select class="stg-conn-select">
                  <option selected>PostgreSQL + pgvector</option>
                  <option>Weaviate</option>
                  <option>Pinecone</option>
                  <option>ChromaDB</option>
                </select>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">ENDPOINT URL</div>
                <input class="stg-conn-input" value="postgresql://kb.dacta.sg:5432/rag_vectors" />
              </div>
              <div class="stg-conn-footer">
                <button class="stg-conn-test-btn">âš¡ Test Connection</button>
                <div class="stg-conn-sync">Last synced: 1 hr ago</div>
              </div>
            </div>

            <!-- 6. Ticketing & Workflow -->
            <div class="stg-conn-card">
              <div class="stg-conn-top">
                <div class="stg-conn-icon">ðŸ“‹</div>
                <div class="stg-conn-meta">
                  <div class="stg-conn-name">Ticketing &amp; Workflow</div>
                  <span class="badge badge-green" style="font-size:9px;padding:2px 7px;margin-top:3px;display:inline-flex;">Connected</span>
                </div>
                <div class="stg-conn-status-dot connected"></div>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">CONNECTION TYPE</div>
                <select class="stg-conn-select">
                  <option selected>ServiceNow</option>
                  <option>Jira Service Mgmt</option>
                  <option>Freshservice</option>
                  <option>DACTA Internal</option>
                </select>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">ENDPOINT URL</div>
                <input class="stg-conn-input" value="https://dacta.service-now.com/api" />
              </div>
              <div class="stg-conn-footer">
                <button class="stg-conn-test-btn">âš¡ Test Connection</button>
                <div class="stg-conn-sync">Last synced: 3 min ago</div>
              </div>
            </div>

            <!-- 7. Network & Firewall -->
            <div class="stg-conn-card" style="border-color:rgba(239,68,68,0.20);">
              <div class="stg-conn-top">
                <div class="stg-conn-icon" style="background:rgba(239,68,68,0.08);">ðŸŒ</div>
                <div class="stg-conn-meta">
                  <div class="stg-conn-name">Network &amp; Firewall</div>
                  <span class="badge badge-red" style="font-size:9px;padding:2px 7px;margin-top:3px;display:inline-flex;">Disconnected</span>
                </div>
                <div class="stg-conn-status-dot disconnected"></div>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">CONNECTION TYPE</div>
                <select class="stg-conn-select">
                  <option selected>Palo Alto Panorama</option>
                  <option>Fortinet FortiManager</option>
                  <option>Cisco FMC</option>
                  <option>Zscaler</option>
                </select>
              </div>
              <div class="stg-conn-field">
                <div class="stg-conn-field-label">ENDPOINT URL</div>
                <input class="stg-conn-input" placeholder="https://panorama.example.com/api/" />
              </div>
              <div class="stg-conn-footer">
                <button class="stg-conn-test-btn" style="border-color:rgba(239,68,68,0.35);color:#ef4444;background:rgba(239,68,68,0.08);">âš¡ Connect</button>
                <div class="stg-conn-sync" style="color:#ef4444;">Last synced: Never</div>
              </div>
            </div>

          </div><!-- end connector grid -->

          <!-- Data Residency Row -->
          <div class="stg-residency-row">
            <div class="stg-residency-item">
              <span>ðŸ”’</span>
              <span>Data Residency:</span>
              <strong>ðŸ‡¸ðŸ‡¬ Singapore (ap-southeast-1)</strong>
              <span class="badge badge-green" style="font-size:9px;padding:2px 7px;">Verified</span>
            </div>
            <div class="stg-residency-item" style="color:#4d5a6e;">|</div>
            <div class="stg-residency-item">
              <span>ðŸ”</span>
              <span>Encryption:</span>
              <strong>AES-256-GCM at rest, TLS 1.3 in transit</strong>
              <span class="badge badge-cyan" style="font-size:9px;padding:2px 7px;">Active</span>
            </div>
            <div class="stg-residency-item" style="color:#4d5a6e;">|</div>
            <div class="stg-residency-item">
              <span>ðŸ”„</span>
              <span>Redaction Pipeline:</span>
              <strong>3-Round Active</strong>
              <span class="badge badge-green" style="font-size:9px;padding:2px 7px;">Live</span>
            </div>
          </div>

          <!-- Per-Tenant Log Sources -->
          <div style="margin-top:18px;">
            <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
              <div style="display:flex;align-items:center;gap:8px;">
                <span style="font-family:var(--font-display);font-size:13px;font-weight:600;color:var(--text-primary);">Log Sources</span>
                <span class="badge badge-cyan" style="font-size:9px;padding:2px 7px;">8 Active</span>
              </div>
              <button class="btn btn-secondary btn-sm" style="font-size:10px;">+ Add Log Source</button>
            </div>
            <div class="table-wrap" style="max-height:220px;overflow-y:auto;">
              <table>
                <thead><tr><th>Log Source</th><th>Type</th><th>Protocol</th><th>EPS (Avg)</th><th>Status</th><th>Last Event</th></tr></thead>
                <tbody>
                  <tr><td style="color:var(--text-primary);font-weight:500;">CS Falcon â€” Endpoints</td><td><span class="badge badge-cyan" style="font-size:9px;">EDR</span></td><td style="font-family:var(--font-mono);font-size:10px;">HTTPS API Pull</td><td class="mono">340</td><td><div class="status-dot green" style="display:inline-block;"></div> Ingesting</td><td class="mono">12s ago</td></tr>
                  <tr><td style="color:var(--text-primary);font-weight:500;">Palo Alto PA-5260</td><td><span class="badge badge-amber" style="font-size:9px;">Firewall</span></td><td style="font-family:var(--font-mono);font-size:10px;">Syslog TCP/514</td><td class="mono">1,280</td><td><div class="status-dot green" style="display:inline-block;"></div> Ingesting</td><td class="mono">3s ago</td></tr>
                  <tr><td style="color:var(--text-primary);font-weight:500;">Entra ID â€” Sign-ins</td><td><span class="badge badge-purple" style="font-size:9px;">Identity</span></td><td style="font-family:var(--font-mono);font-size:10px;">Graph API v1.0</td><td class="mono">85</td><td><div class="status-dot green" style="display:inline-block;"></div> Ingesting</td><td class="mono">45s ago</td></tr>
                  <tr><td style="color:var(--text-primary);font-weight:500;">Windows DC â€” Security</td><td><span class="badge badge-blue" style="font-size:9px;">OS Logs</span></td><td style="font-family:var(--font-mono);font-size:10px;">WEF / Winlogbeat</td><td class="mono">520</td><td><div class="status-dot green" style="display:inline-block;"></div> Ingesting</td><td class="mono">8s ago</td></tr>
                  <tr><td style="color:var(--text-primary);font-weight:500;">Exchange Online</td><td><span class="badge badge-blue" style="font-size:9px;">Email</span></td><td style="font-family:var(--font-mono);font-size:10px;">Graph API v1.0</td><td class="mono">190</td><td><div class="status-dot green" style="display:inline-block;"></div> Ingesting</td><td class="mono">22s ago</td></tr>
                  <tr><td style="color:var(--text-primary);font-weight:500;">Zscaler ZIA</td><td><span class="badge badge-green" style="font-size:9px;">Proxy</span></td><td style="font-family:var(--font-mono);font-size:10px;">NSS Feed</td><td class="mono">750</td><td><div class="status-dot green" style="display:inline-block;"></div> Ingesting</td><td class="mono">5s ago</td></tr>
                  <tr><td style="color:var(--text-primary);font-weight:500;">AWS CloudTrail</td><td><span class="badge badge-amber" style="font-size:9px;">Cloud</span></td><td style="font-family:var(--font-mono);font-size:10px;">S3 â†’ SQS â†’ Elastic</td><td class="mono">420</td><td><div class="status-dot green" style="display:inline-block;"></div> Ingesting</td><td class="mono">1m ago</td></tr>
                  <tr><td style="color:var(--text-primary);font-weight:500;">CyberArk PAS</td><td><span class="badge badge-red" style="font-size:9px;">PAM</span></td><td style="font-family:var(--font-mono);font-size:10px;">Syslog TCP/1514</td><td class="mono">60</td><td><div class="status-dot green" style="display:inline-block;"></div> Ingesting</td><td class="mono">2m ago</td></tr>
                </tbody>
              </table>
            </div>
            <div style="margin-top:8px;display:flex;gap:16px;flex-wrap:wrap;">
              <span style="font-size:10px;color:var(--text-muted);">Total EPS: <strong style="color:var(--cyan);">3,645</strong></span>
              <span style="font-size:10px;color:var(--text-muted);">Daily Volume: <strong style="color:var(--text-secondary);">~315M events</strong></span>
              <span style="font-size:10px;color:var(--text-muted);">Retention: <strong style="color:var(--text-secondary);">90 days hot / 365 days warm</strong></span>
            </div>
          </div>

        </div><!-- end connector config card -->


        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             SECTION 2: SEVERITY-GATED RAG ROUTER
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="card stg-section" style="margin-bottom:24px;">
          <div class="card-header" style="margin-bottom:18px;">
            <div>
              <span class="card-title">AI Investigation RAG Router</span>
              <div class="stg-rag-subtitle">Severity-gated retrieval pipeline â€” controls depth, model tier, and domain scope per alert priority</div>
            </div>
            <span class="badge badge-cyan">Live Config</span>
          </div>

          <div class="stg-rag-lanes">

            <!-- P1 Critical -->
            <div class="stg-rag-lane" style="border-color:rgba(239,68,68,0.20);background:rgba(239,68,68,0.03);">
              <div class="stg-rag-lane-sev">
                <div class="stg-sev-badge p1">P1 / P0</div>
                <div class="stg-sev-label">Critical</div>
                <div class="stg-sev-label" style="margin-top:2px;">Full RAG Pipeline</div>
              </div>
              <div class="stg-rag-flow">
                <span class="stg-chip p1">Alert Ingest</span>
                <span class="stg-arrow p1">â†’</span>
                <span class="stg-chip p1">3-Round Redaction</span>
                <span class="stg-arrow p1">â†’</span>
                <span class="stg-chip p1">Classifier (Haiku)</span>
                <span class="stg-arrow p1">â†’</span>
                <span class="stg-chip p1">All 7 Domain Handlers</span>
                <span class="stg-arrow p1">â†’</span>
                <span class="stg-chip p1">Context Aggregator</span>
                <span class="stg-arrow p1">â†’</span>
                <span class="stg-chip p1">Reasoner (Opus)</span>
                <span class="stg-arrow p1">â†’</span>
                <span class="stg-chip p1">Investigation Brief</span>
              </div>
              <div class="stg-rag-stats">
                <div class="stg-stat-row"><span class="stg-stat-label">Model</span><span class="stg-stat-val" style="color:#ef4444;">Claude Opus</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Latency</span><span class="stg-stat-val">~18s</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Domains</span><span class="stg-stat-val">7 / 7</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Trigger</span><span class="stg-stat-val">Auto on alert</span></div>
              </div>
            </div>

            <!-- P2 High -->
            <div class="stg-rag-lane" style="border-color:rgba(249,115,22,0.18);background:rgba(249,115,22,0.025);">
              <div class="stg-rag-lane-sev">
                <div class="stg-sev-badge p2">P2</div>
                <div class="stg-sev-label">High</div>
                <div class="stg-sev-label" style="margin-top:2px;">Selective RAG</div>
              </div>
              <div class="stg-rag-flow">
                <span class="stg-chip p2">Alert Ingest</span>
                <span class="stg-arrow p2">â†’</span>
                <span class="stg-chip p2">3-Round Redaction</span>
                <span class="stg-arrow p2">â†’</span>
                <span class="stg-chip p2">Classifier (Haiku)</span>
                <span class="stg-arrow p2">â†’</span>
                <span class="stg-chip p2">TI + SIEM Handlers</span>
                <span class="stg-arrow p2">â†’</span>
                <span class="stg-chip p2">Reasoner (Sonnet)</span>
                <span class="stg-arrow p2">â†’</span>
                <span class="stg-chip p2">Summary Card</span>
              </div>
              <div class="stg-rag-stats">
                <div class="stg-stat-row"><span class="stg-stat-label">Model</span><span class="stg-stat-val" style="color:#f97316;">Claude Sonnet</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Latency</span><span class="stg-stat-val">~8s</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Domains</span><span class="stg-stat-val">2 / 7</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Trigger</span><span class="stg-stat-val">Auto on assign</span></div>
              </div>
            </div>

            <!-- P3 Medium -->
            <div class="stg-rag-lane" style="border-color:rgba(245,158,11,0.16);background:rgba(245,158,11,0.02);">
              <div class="stg-rag-lane-sev">
                <div class="stg-sev-badge p3">P3</div>
                <div class="stg-sev-label">Medium</div>
                <div class="stg-sev-label" style="margin-top:2px;">Lightweight Enrichment</div>
              </div>
              <div class="stg-rag-flow">
                <span class="stg-chip p3">Alert Ingest</span>
                <span class="stg-arrow p3">â†’</span>
                <span class="stg-chip p3">Redaction (R1 only)</span>
                <span class="stg-arrow p3">â†’</span>
                <span class="stg-chip p3">KB Cache Lookup</span>
                <span class="stg-arrow p3">â†’</span>
                <span class="stg-chip p3">TI Enrichment</span>
                <span class="stg-arrow p3">â†’</span>
                <span class="stg-chip p3">Context Card</span>
              </div>
              <div class="stg-rag-stats">
                <div class="stg-stat-row"><span class="stg-stat-label">Model</span><span class="stg-stat-val" style="color:#f59e0b;">Haiku (classifier)</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Latency</span><span class="stg-stat-val">~3s</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Domains</span><span class="stg-stat-val">1 / 7</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Trigger</span><span class="stg-stat-val">On analyst open</span></div>
              </div>
            </div>

            <!-- P4 Info -->
            <div class="stg-rag-lane" style="border-color:rgba(16,185,129,0.14);background:rgba(16,185,129,0.015);">
              <div class="stg-rag-lane-sev">
                <div class="stg-sev-badge p4">P4</div>
                <div class="stg-sev-label">Info / Low</div>
                <div class="stg-sev-label" style="margin-top:2px;">Rule-Based Only</div>
              </div>
              <div class="stg-rag-flow">
                <span class="stg-chip p4">Alert Ingest</span>
                <span class="stg-arrow p4">â†’</span>
                <span class="stg-chip p4">Rule Engine</span>
                <span class="stg-arrow p4">â†’</span>
                <span class="stg-chip p4">Asset Tag</span>
                <span class="stg-arrow p4">â†’</span>
                <span class="stg-chip p4">Auto-Close / Queue</span>
              </div>
              <div class="stg-rag-stats">
                <div class="stg-stat-row"><span class="stg-stat-label">Model</span><span class="stg-stat-val" style="color:#10b981;">None (rule-based)</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Latency</span><span class="stg-stat-val">&lt;1s</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Domains</span><span class="stg-stat-val">0 / 7</span></div>
                <div class="stg-stat-row"><span class="stg-stat-label">Trigger</span><span class="stg-stat-val">Auto on ingest</span></div>
              </div>
            </div>

          </div><!-- end rag lanes -->

          <!-- Override row -->
          <div class="stg-rag-override">
            <svg width="14" height="14" viewBox="0 0 16 16" fill="none" style="flex-shrink:0;"><circle cx="8" cy="8" r="7" stroke="#00d4ff" stroke-width="1.5" opacity="0.6"/><path d="M8 5v4M8 11v.5" stroke="#00d4ff" stroke-width="1.5" stroke-linecap="round"/></svg>
            <span>Analysts can trigger Full RAG on any severity via <kbd>âŒ˜K</kbd> Command Bar or the <kbd>Run AI</kbd> button on any alert card.</span>
            <span class="badge badge-cyan" style="font-size:9px;padding:2px 8px;margin-left:auto;white-space:nowrap;">On-Demand</span>
          </div>

        </div><!-- end RAG router card -->


        <div class="grid-2">
          <!-- LLM Configuration -->
          <div class="card">
            <div class="card-header"><span class="card-title">LLM Configuration</span><span class="badge badge-cyan">AI Engine</span></div>
            <div style="display:flex;flex-direction:column;gap:12px;">
              <div>
                <div style="font-size:11px;color:var(--text-muted);margin-bottom:5px;">Primary Model (Investigation Briefs)</div>
                <select class="filter-select" style="width:100%;">
                  <option>Claude 3.5 Sonnet (Recommended)</option>
                  <option>Claude 3 Opus</option>
                  <option>GPT-4o</option>
                  <option>Gemini 1.5 Pro</option>
                </select>
              </div>
              <div>
                <div style="font-size:11px;color:var(--text-muted);margin-bottom:5px;">Fast Model (Enrichment, Triage)</div>
                <select class="filter-select" style="width:100%;">
                  <option>Claude 3.5 Haiku (Recommended)</option>
                  <option>GPT-4o Mini</option>
                  <option>Gemini Flash</option>
                  <option>DeepSeek V3</option>
                </select>
              </div>
              <div>
                <div style="font-size:11px;color:var(--text-muted);margin-bottom:5px;">Threat Intel Model</div>
                <select class="filter-select" style="width:100%;">
                  <option>Perplexity Sonar Pro</option>
                  <option>Claude 3.5 Sonnet</option>
                  <option>GPT-4o + Web Browsing</option>
                </select>
              </div>
              <div>
                <div style="font-size:11px;color:var(--text-muted);margin-bottom:5px;">Monthly AI Budget Cap</div>
                <input class="filter-input" value="$250.00" style="width:100%;">
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;padding:10px;background:var(--bg-elevated);border-radius:7px;">
                <span style="font-size:12px;color:var(--text-secondary);">Auto-run AI on all P1/P2 alerts</span>
                <div style="width:36px;height:20px;background:var(--cyan);border-radius:10px;cursor:pointer;position:relative;"><div style="width:16px;height:16px;background:#fff;border-radius:50%;position:absolute;right:2px;top:2px;"></div></div>
              </div>
            </div>
          </div>

          <!-- SLA Configuration -->
          <div class="card">
            <div class="card-header"><span class="card-title">SLA Configuration</span></div>
            <div style="display:flex;flex-direction:column;gap:8px;">
              <div style="padding:10px;background:var(--bg-elevated);border-radius:7px;display:flex;align-items:center;gap:12px;">
                <span class="badge badge-p1">P1</span>
                <div style="flex:1;">
                  <div style="font-size:11px;color:var(--text-muted);">Response / Resolution</div>
                </div>
                <input class="filter-input" value="15 min" style="width:80px;text-align:center;">
                <span style="color:var(--text-muted);">/</span>
                <input class="filter-input" value="4 hr" style="width:80px;text-align:center;">
              </div>
              <div style="padding:10px;background:var(--bg-elevated);border-radius:7px;display:flex;align-items:center;gap:12px;">
                <span class="badge badge-p2">P2</span>
                <div style="flex:1;"><div style="font-size:11px;color:var(--text-muted);">Response / Resolution</div></div>
                <input class="filter-input" value="30 min" style="width:80px;text-align:center;">
                <span style="color:var(--text-muted);">/</span>
                <input class="filter-input" value="12 hr" style="width:80px;text-align:center;">
              </div>
              <div style="padding:10px;background:var(--bg-elevated);border-radius:7px;display:flex;align-items:center;gap:12px;">
                <span class="badge badge-p3">P3</span>
                <div style="flex:1;"><div style="font-size:11px;color:var(--text-muted);">Response / Resolution</div></div>
                <input class="filter-input" value="2 hr" style="width:80px;text-align:center;">
                <span style="color:var(--text-muted);">/</span>
                <input class="filter-input" value="48 hr" style="width:80px;text-align:center;">
              </div>
              <div style="padding:10px;background:var(--bg-elevated);border-radius:7px;display:flex;align-items:center;gap:12px;">
                <span class="badge badge-p4">P4</span>
                <div style="flex:1;"><div style="font-size:11px;color:var(--text-muted);">Response / Resolution</div></div>
                <input class="filter-input" value="8 hr" style="width:80px;text-align:center;">
                <span style="color:var(--text-muted);">/</span>
                <input class="filter-input" value="7 days" style="width:80px;text-align:center;">
              </div>
            </div>
          </div>

          <!-- Notifications -->
          <div class="card">
            <div class="card-header"><span class="card-title">Notification Settings</span></div>
            <div style="display:flex;flex-direction:column;gap:10px;">
              <div style="display:flex;align-items:center;justify-content:space-between;padding:10px;background:var(--bg-elevated);border-radius:7px;">
                <div><div style="font-size:12px;font-weight:600;color:var(--text-primary);">P1 Alert â€” Slack + SMS</div><div style="font-size:10px;color:var(--text-muted);">#soc-critical channel</div></div>
                <div style="width:36px;height:20px;background:var(--cyan);border-radius:10px;cursor:pointer;position:relative;"><div style="width:16px;height:16px;background:#fff;border-radius:50%;position:absolute;right:2px;top:2px;"></div></div>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;padding:10px;background:var(--bg-elevated);border-radius:7px;">
                <div><div style="font-size:12px;font-weight:600;color:var(--text-primary);">Shift Handover Reminder</div><div style="font-size:10px;color:var(--text-muted);">30 min before shift end</div></div>
                <div style="width:36px;height:20px;background:var(--cyan);border-radius:10px;cursor:pointer;position:relative;"><div style="width:16px;height:16px;background:#fff;border-radius:50%;position:absolute;right:2px;top:2px;"></div></div>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;padding:10px;background:var(--bg-elevated);border-radius:7px;">
                <div><div style="font-size:12px;font-weight:600;color:var(--text-primary);">SLA Breach Warning</div><div style="font-size:10px;color:var(--text-muted);">When 80% of SLA window elapsed</div></div>
                <div style="width:36px;height:20px;background:var(--cyan);border-radius:10px;cursor:pointer;position:relative;"><div style="width:16px;height:16px;background:#fff;border-radius:50%;position:absolute;right:2px;top:2px;"></div></div>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;padding:10px;background:var(--bg-elevated);border-radius:7px;">
                <div><div style="font-size:12px;font-weight:600;color:var(--text-primary);">Daily Digest Email</div><div style="font-size:10px;color:var(--text-muted);">08:00 SGT every morning</div></div>
                <div style="width:36px;height:20px;background:var(--bg-input);border:1px solid var(--border-card);border-radius:10px;cursor:pointer;position:relative;"><div style="width:16px;height:16px;background:var(--text-muted);border-radius:50%;position:absolute;left:2px;top:1px;"></div></div>
              </div>
            </div>
          </div>

          <!-- Tenant Settings -->
          <div class="card">
            <div class="card-header"><span class="card-title">Tenant Settings</span></div>
            <div style="display:flex;flex-direction:column;gap:10px;">
              <div>
                <div style="font-size:11px;color:var(--text-muted);margin-bottom:5px;">Organization Name</div>
                <input class="filter-input" value="Dacta SG Pte Ltd" style="width:100%;">
              </div>
              <div>
                <div style="font-size:11px;color:var(--text-muted);margin-bottom:5px;">Timezone</div>
                <select class="filter-select" style="width:100%;"><option>Asia/Singapore (UTC+8)</option><option>UTC</option></select>
              </div>
              <div>
                <div style="font-size:11px;color:var(--text-muted);margin-bottom:5px;">Data Retention Policy</div>
                <select class="filter-select" style="width:100%;"><option>12 months</option><option>24 months</option><option>7 years (Compliance)</option></select>
              </div>
              <div>
                <div style="font-size:11px;color:var(--text-muted);margin-bottom:5px;">Ticket ID Prefix</div>
                <input class="filter-input" value="DAC-" style="width:100%;">
              </div>
            </div>
          </div>
        </div>
      </div><!-- end settings -->


      <!-- =====================================================
           PAGE: DATA ARCHITECTURE
           ===================================================== -->
      <div class="page" id="page-dataarch">
        <div class="page-header">
          <div>
            <div class="page-title">Data Architecture</div>
            <div class="page-subtitle">Dual-model ingestion â€” SOCaaS &amp; MDR-only clients</div>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm">â†“ Export Diagram</button>
          </div>
        </div>

        <div class="da-page-grid">

          <!-- â”€â”€ STAT CARDS â”€â”€ -->
          <div class="da-stats-row">
            <div class="da-stat-card">
              <div class="da-stat-label">Active Clients</div>
              <div class="da-stat-value da-cyan">12</div>
              <div class="da-stat-sub">Across both models</div>
            </div>
            <div class="da-stat-card">
              <div class="da-stat-label">SOCaaS Clients</div>
              <div class="da-stat-value da-green">5</div>
              <div class="da-stat-sub">With Elastic SIEM</div>
            </div>
            <div class="da-stat-card">
              <div class="da-stat-label">MDR-Only Clients</div>
              <div class="da-stat-value da-amber">7</div>
              <div class="da-stat-sub">EDR / XDR / Email direct</div>
            </div>
            <div class="da-stat-card">
              <div class="da-stat-label">Alert Bus</div>
              <div class="da-stat-value" style="font-size:16px;font-weight:800;color:#10b981;">Jira</div>
              <div class="da-stat-sub"><span class="da-badge da-badge-green" style="font-size:8px;">Single Source of Truth</span></div>
            </div>
          </div>

          <!-- â”€â”€ ARCHITECTURE DIAGRAM â”€â”€ -->
          <div class="da-diagram-wrapper">
            <div class="da-diagram-title">Dual-Model Data Flow â€” SOCaaS (Model A) &amp; MDR-only (Model B)</div>

            <!-- MAIN DUAL-MODEL GRID: [Clients] [Connector] [Jira] [Connector] [MCC] -->
            <div class="da-dual-grid">

              <!-- â•â•â•â• COLUMN 1: CLIENT MODELS (A on top, B on bottom) â•â•â•â• -->
              <div class="da-clients-col">

                <!-- MODEL A â€” SOCaaS -->
                <div class="da-model-zone da-model-a">
                  <div class="da-model-label da-green">MODEL A â€” SOCaaS (Full SIEM)</div>

                  <!-- Full Log Sources card -->
                  <div class="da-source-card da-edr">
                    <div class="da-source-title">ðŸ“Š Full Log Sources</div>
                    <div class="da-source-sub">Firewall, EDR, Identity, OS, Cloud, Email</div>
                    <div class="da-client-count">5 clients</div>
                  </div>

                  <!-- Arrow down -->
                  <div style="display:flex;flex-direction:column;align-items:center;gap:3px;padding:2px 0;">
                    <div class="da-flow-line da-green" style="width:2px;height:20px;flex:none;animation-delay:0s;"></div>
                    <div class="da-arrow-head da-down da-green"></div>
                  </div>

                  <!-- Elastic SIEM card -->
                  <div class="da-siem-card" style="flex:1;">
                    <div class="da-siem-header">
                      <div class="da-siem-logo da-pulse-ring">âš¡</div>
                      <div>
                        <div class="da-siem-name">Elastic SIEM</div>
                        <div class="da-siem-sub">DACTA Managed Detection</div>
                      </div>
                    </div>
                    <div class="da-siem-section" style="flex:none;">
                      <div class="da-eps-badge" style="margin-bottom:3px;">
                        <div class="da-eps-dot"></div>
                        3,645 EPS &nbsp;Â·&nbsp; 600+ rules &nbsp;Â·&nbsp; ECS
                      </div>
                      <div class="da-siem-desc">Detects, correlates, and enriches events â†’ creates Jira tickets on alert fire.</div>
                    </div>
                  </div>
                </div>

                <!-- MODEL B â€” MDR-only -->
                <div class="da-model-zone da-model-b">
                  <div class="da-model-label da-cyan">MODEL B â€” MDR-only (No SIEM)</div>

                  <!-- EDR/XDR card -->
                  <div class="da-source-card da-edr">
                    <div class="da-source-title">ðŸ›¡ EDR / XDR Alerts</div>
                    <div class="da-source-sub">CrowdStrike, SentinelOne, Defender, Trend, Heimdal</div>
                    <div class="da-source-sub" style="margin-top:2px;">Direct alert feed â€” no SIEM</div>
                    <div class="da-client-count">7 clients</div>
                  </div>

                  <!-- Email Security card -->
                  <div class="da-source-card da-email">
                    <div class="da-source-title">ðŸ“§ Email Security</div>
                    <div class="da-source-sub">Mimecast, Proofpoint, M365 Defender</div>
                    <div class="da-source-sub" style="margin-top:2px;">Phishing, malware, BEC alerts</div>
                  </div>
                </div>

              </div><!-- /da-clients-col -->

              <!-- â•â•â•â• COLUMN 2: CONVERGING CONNECTOR â•â•â•â• -->
              <div class="da-h-connector-zone">
                <!-- Top half: Model A green arrow -->
                <div class="da-merge-arrow">
                  <div class="da-h-line da-green" style="animation-delay:0s;"></div>
                  <div class="da-chevron da-green">â€º</div>
                </div>
                <!-- Divider dot -->
                <div style="width:6px;height:6px;border-radius:50%;background:rgba(255,255,255,0.1);flex-shrink:0;"></div>
                <!-- Bottom half: Model B cyan arrow -->
                <div class="da-merge-arrow">
                  <div class="da-h-line da-cyan" style="animation-delay:0.4s;"></div>
                  <div class="da-chevron da-cyan">â€º</div>
                </div>
              </div><!-- /connector col 2 -->

              <!-- â•â•â•â• COLUMN 3: JIRA â€” UNIVERSAL ALERT BUS â•â•â•â• -->
              <div class="da-zone-jira">
                <div class="da-jira-card">
                  <div class="da-jira-header">
                    <div class="da-jira-icon da-pulse-ring">ðŸŽ«</div>
                    <div>
                      <div class="da-jira-name">Jira Service Management</div>
                      <div class="da-jira-subtitle">Universal Alert Bus</div>
                    </div>
                  </div>

                  <div class="da-convergence-badge">
                    <div class="da-convergence-dot"></div>
                    All Alerts Converge Here
                  </div>

                  <div class="da-jira-detail">
                    <div style="margin-bottom:6px;font-family:'Sora',sans-serif;font-size:9.5px;font-weight:700;color:var(--text-primary);letter-spacing:0.06em;text-transform:uppercase;">Single Source of Truth</div>
                    Ticket creation &nbsp;Â·&nbsp; SLA assignment<br>
                    Priority mapping &nbsp;Â·&nbsp; Analyst routing<br><br>
                    <span style="color:var(--text-muted);font-size:9.5px;">Both Model A and Model B clients funnel all detection alerts through Jira before reaching MCC.</span>
                  </div>
                </div>
              </div><!-- /da-zone-jira -->

              <!-- â•â•â•â• COLUMN 4: JIRA â†’ MCC CONNECTOR â•â•â•â• -->
              <div class="da-h-connector-zone">
                <div style="display:flex;flex-direction:column;align-items:center;gap:5px;height:100%;justify-content:center;">
                  <!-- Main forward arrow -->
                  <div class="da-h-arrow" style="width:100%;">
                    <div class="da-h-line da-cyan" style="animation-delay:0.2s;"></div>
                    <div class="da-chevron da-cyan">â€º</div>
                  </div>
                  <!-- Bi-directional workflow sync -->
                  <div style="text-align:center;">
                    <div class="da-ondemand-label">Jira â†” MCC</div>
                    <div class="da-ondemand-label">Every 30s</div>
                  </div>
                  <!-- Return arrow (MCC â†’ Clients) -->
                  <div class="da-return-arrow">
                    <div class="da-return-label" style="color:#8b5cf6;">â—‚ sync</div>
                    <div class="da-h-line da-purple" style="animation-delay:0.6s;"></div>
                  </div>
                </div>
              </div><!-- /connector col 4 -->

              <!-- â•â•â•â• COLUMN 5: MCC PLATFORM â•â•â•â• -->
              <div class="da-zone-mcc" style="align-self:stretch;">
                <div class="da-mcc-card">
                  <div class="da-mcc-header">
                    <div class="da-mcc-icon da-pulse-ring">â™¦</div>
                    <div>
                      <div class="da-mcc-name">Mission Control Center</div>
                      <div class="da-mcc-sub">For Blue Team, By Blue Team</div>
                    </div>
                  </div>

                  <!-- Layer 1: Alert Feed -->
                  <div class="da-layer">
                    <div class="da-layer-header">
                      <div class="da-layer-title">Alert Feed</div>
                      <span class="da-badge da-badge-green">PRIMARY</span>
                    </div>
                    <div class="da-layer-route">All alerts via Jira sync</div>
                    <div class="da-layer-desc">Powers Dashboard, Triage Queue, metrics, and SLA timers. Both model clients unified here.</div>
                  </div>

                  <!-- Layer 2: Investigation Drill-Down -->
                  <div class="da-layer">
                    <div class="da-layer-header">
                      <div class="da-layer-title">Investigation Drill-Down</div>
                      <span class="da-badge da-badge-cyan">ON-DEMAND</span>
                    </div>
                    <div class="da-layer-route">MCC â†’ Client EDR/XDR API (direct)</div>
                    <div class="da-layer-desc">Bypasses Jira for deep telemetry: process trees, network connections, file details. ~3â€“5s per lookup.</div>
                  </div>

                  <!-- Layer 3: AI/RAG Pipeline -->
                  <div class="da-layer">
                    <div class="da-layer-header">
                      <div class="da-layer-title">AI / RAG Pipeline</div>
                      <span class="da-badge da-badge-amber">ENRICHMENT</span>
                    </div>
                    <div class="da-layer-route">Severity-gated RAG Router</div>
                    <div class="da-layer-desc">Queries TI, KB, and entity stores via pgvector SQL for investigation context and AI Copilot.</div>
                  </div>

                  <!-- Layer 4: Workflow Sync -->
                  <div class="da-layer">
                    <div class="da-layer-header">
                      <div class="da-layer-title">Workflow Sync</div>
                      <span class="da-badge da-badge-purple">BI-DIRECTIONAL</span>
                    </div>
                    <div class="da-layer-route">Jira â†” MCC (every 30s)</div>
                    <div class="da-layer-desc">Status updates, comments, and resolution flow back to Jira for client visibility.</div>
                  </div>
                </div>
              </div><!-- /da-zone-mcc -->

            </div><!-- /da-dual-grid -->

            <!-- On-demand EDR annotation -->
            <div style="margin-top:12px;padding:8px 14px;background:rgba(0,212,255,0.04);border:1px dashed rgba(0,212,255,0.18);border-radius:8px;display:flex;align-items:center;gap:10px;">
              <span style="font-size:13px;">â†©</span>
              <span style="font-family:'IBM Plex Mono',monospace;font-size:9.5px;color:#00d4ff;font-weight:600;">ON-DEMAND EDR QUERY</span>
              <span style="font-family:'IBM Plex Sans',sans-serif;font-size:10.5px;color:var(--text-secondary);">MCC queries client EDR/XDR APIs directly during investigation drill-down â€” regardless of model (A or B). Bypasses Jira for deep telemetry.</span>
            </div>

          </div><!-- /da-diagram-wrapper -->

          <!-- â”€â”€ FLOW SUMMARY TABLE â”€â”€ -->
          <div class="da-table-wrapper">
            <div class="da-table-heading">â‡„ Integration Flow Reference</div>
            <table class="da-table">
              <thead>
                <tr>
                  <th>Data Flow</th>
                  <th>Model</th>
                  <th>Direction</th>
                  <th>Protocol</th>
                  <th>Frequency</th>
                  <th>Latency</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Client Logs â†’ Elastic SIEM</td>
                  <td><span class="da-model-badge da-a">A Â· SOCaaS</span></td>
                  <td><span class="da-dir-push">â–¶ Push (Agent/Syslog)</span></td>
                  <td><span class="da-proto">Beats / Syslog</span></td>
                  <td>Continuous</td>
                  <td><span class="da-latency">Real-time</span></td>
                </tr>
                <tr>
                  <td>Elastic â†’ Jira (Alert Ticket)</td>
                  <td><span class="da-model-badge da-a">A Â· SOCaaS</span></td>
                  <td><span class="da-dir-push">â–¶ Push (Webhook)</span></td>
                  <td><span class="da-proto">HTTPS REST</span></td>
                  <td>On detection</td>
                  <td><span class="da-latency">&lt;3s</span></td>
                </tr>
                <tr>
                  <td>EDR/XDR â†’ Jira (Alert Ticket)</td>
                  <td><span class="da-model-badge da-b">B Â· MDR-only</span></td>
                  <td><span class="da-dir-push">â–¶ Push (Webhook)</span></td>
                  <td><span class="da-proto">HTTPS REST</span></td>
                  <td>On alert fire</td>
                  <td><span class="da-latency">&lt;5s</span></td>
                </tr>
                <tr>
                  <td>Email Security â†’ Jira</td>
                  <td><span class="da-model-badge da-b">B Â· MDR-only</span></td>
                  <td><span class="da-dir-push">â–¶ Push (Webhook)</span></td>
                  <td><span class="da-proto">HTTPS REST</span></td>
                  <td>On detection</td>
                  <td><span class="da-latency">&lt;5s</span></td>
                </tr>
                <tr>
                  <td>Jira â†’ MCC (Alert Sync)</td>
                  <td><span class="da-model-badge da-both">Both</span></td>
                  <td><span class="da-dir-pull">â†“ Pull (Polling)</span></td>
                  <td><span class="da-proto">REST API</span></td>
                  <td>Every 30s</td>
                  <td><span class="da-latency">&lt;5s</span></td>
                </tr>
                <tr>
                  <td>MCC â†’ Client EDR (Investigation)</td>
                  <td><span class="da-model-badge da-both">Both</span></td>
                  <td><span class="da-dir-pull">â†“ Pull (On-Demand)</span></td>
                  <td><span class="da-proto">HTTPS API</span></td>
                  <td>Per investigation</td>
                  <td><span class="da-latency">~3â€“5s</span></td>
                </tr>
                <tr>
                  <td>MCC â†” Jira (Workflow Sync)</td>
                  <td><span class="da-model-badge da-both">Both</span></td>
                  <td><span class="da-dir-bidir">â†• Bi-directional</span></td>
                  <td><span class="da-proto">REST API</span></td>
                  <td>Every 30s</td>
                  <td><span class="da-latency">&lt;5s</span></td>
                </tr>
                <tr>
                  <td>TI Sources â†’ MCC</td>
                  <td><span class="da-model-badge da-both">Both</span></td>
                  <td><span class="da-dir-pull">â†“ Pull (Scheduled)</span></td>
                  <td><span class="da-proto">TAXII / REST</span></td>
                  <td>Every 15min</td>
                  <td><span class="da-latency">N/A</span></td>
                </tr>
                <tr>
                  <td>MCC â†’ DACTA KB (RAG)</td>
                  <td><span class="da-model-badge da-both">Both</span></td>
                  <td><span class="da-dir-internal">â—ˆ Internal Query</span></td>
                  <td><span class="da-proto">pgvector SQL</span></td>
                  <td>Per AI invocation</td>
                  <td><span class="da-latency">~1s</span></td>
                </tr>
              </tbody>
            </table>
          </div>

        </div><!-- /da-page-grid -->
      </div><!-- /page-dataarch -->


      <!-- =====================================================
           PAGE 19: AUDIT LOG
           ===================================================== -->
      <div class="page" id="page-audit">
        <div class="page-header">
          <div><div class="page-title">Audit Log</div><div class="page-subtitle">All platform actions â€” immutable record</div></div>
          <div class="page-actions">
            <button class="btn btn-secondary btn-sm">â†“ Export CSV</button>
          </div>
        </div>

        <div class="filter-bar" style="margin-bottom:16px;">
          <span class="filter-label">Filter:</span>
          <input class="filter-input" placeholder="Search actions, users, targets..." style="width:250px;">
          <select class="filter-select"><option>All Users</option><option>John Lim</option><option>Sarah Tan</option><option>Marcus Wong</option><option>AI System</option></select>
          <select class="filter-select"><option>All Action Types</option><option>Ticket</option><option>Response</option><option>Auth</option><option>Config</option><option>AI</option></select>
          <select class="filter-select"><option>Last 24 Hours</option><option>Last 7 Days</option><option>Last 30 Days</option></select>
        </div>

        <div class="card">
          <div class="table-wrap">
            <table>
              <thead><tr><th>Timestamp</th><th>User</th><th>Action Type</th><th>Action</th><th>Target</th><th>Details</th><th>IP</th></tr></thead>
              <tbody id="auditLogBody"></tbody>
            </table>
          </div>
        </div>
      </div><!-- end audit -->

      <!-- =====================================================
           PAGE: ENTITY EXPLORER
           ===================================================== -->
      <div class="page" id="page-entities">
        <!-- Top Bar: Search + Filters -->
        <div class="ee-topbar">
          <div class="ee-search-wrap">
            <span class="ee-search-icon">ðŸ”</span>
            <input type="text" class="ee-search" id="eeSearch" placeholder="Search entities â€” hostname, IP, user, hash, domain...">
          </div>
          <div class="ee-filters" id="eeTypeFilters">
            <button class="ee-chip active" data-type="all">All</button>
            <button class="ee-chip" data-type="host">ðŸ–¥ Hosts</button>
            <button class="ee-chip" data-type="ip">ðŸŒ IPs</button>
            <button class="ee-chip" data-type="user">ðŸ‘¤ Users</button>
            <button class="ee-chip" data-type="domain">ðŸŒ Domains</button>
            <button class="ee-chip" data-type="process">âš™ï¸ Processes</button>
          </div>
          <div class="ee-time-filters" id="eeTimeFilters">
            <button class="ee-time-chip active" data-range="24h">24h</button>
            <button class="ee-time-chip" data-range="7d">7d</button>
            <button class="ee-time-chip" data-range="30d">30d</button>
            <button class="ee-time-chip" data-range="90d">90d</button>
          </div>
          <select class="ee-sort-select" id="eeSort">
            <option value="risk">Sort: Risk Score</option>
            <option value="active">Sort: Most Active</option>
            <option value="connected">Sort: Most Connected</option>
            <option value="recent">Sort: Recent</option>
          </select>
        </div>

        <!-- Split: Catalog + Canvas -->
        <div class="ee-split">
          <!-- Left: Entity Catalog -->
          <div class="ee-catalog">
            <div class="ee-catalog-header">
              <span>Entity Catalog</span>
              <span class="ee-catalog-count" id="eeCatalogCount">Loading...</span>
            </div>
            <div class="ee-catalog-list" id="eeCatalogList">
              <!-- Populated by JS -->
            </div>
          </div>

          <!-- Right: Canvas Mind Map -->
          <div class="ee-canvas-wrap">
            <div class="ee-canvas-header">
              <div style="display:flex;align-items:center;gap:16px;">
                <span class="ee-canvas-title">Entity Relationship Map</span>
                <div class="ee-legend">
                  <div class="ee-legend-item"><div class="ee-legend-dot" style="background:#00d4ff;"></div>Hosts</div>
                  <div class="ee-legend-item"><div class="ee-legend-dot" style="background:#8b5cf6;"></div>IPs</div>
                  <div class="ee-legend-item"><div class="ee-legend-dot" style="background:#10b981;"></div>Users</div>
                  <div class="ee-legend-item"><div class="ee-legend-dot" style="background:#f59e0b;"></div>Domains</div>
                  <div class="ee-legend-item"><div class="ee-legend-dot" style="background:#f97316;"></div>Processes</div>
                  <div class="ee-legend-item"><div class="ee-legend-dot" style="background:#ef4444;"></div>Malicious</div>
                </div>
              </div>
              <div class="ee-canvas-controls">
                <button class="ee-canvas-btn" id="eeZoomIn" title="Zoom In">+</button>
                <button class="ee-canvas-btn" id="eeZoomOut" title="Zoom Out">âˆ’</button>
                <button class="ee-canvas-btn" id="eeZoomReset" title="Reset View">â†º</button>
                <button class="ee-toggle-physics active" id="eeTogglePhysics">âš¡ Physics ON</button>
              </div>
            </div>
            <div class="ee-canvas-container" id="eeCanvasContainer">
              <canvas id="eeCanvas"></canvas>
              <div class="ee-tooltip" id="eeTooltip">
                <div class="ee-tooltip-name" id="eeTipName"></div>
                <div class="ee-tooltip-type" id="eeTipType"></div>
                <div class="ee-tooltip-stats">
                  <span>ðŸš¨ <em id="eeTipAlerts">0</em> alerts</span>
                  <span>ðŸ”— <em id="eeTipConns">0</em> connections</span>
                  <span>âš ï¸ Risk: <em id="eeTipRisk">0</em></span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Bottom: Entity Detail Panel -->
        <div class="ee-detail-panel" id="eeDetailPanel">
          <div class="ee-detail-header">
            <div class="ee-detail-icon" id="eeDetailIcon">ðŸ–¥</div>
            <div>
              <div class="ee-detail-name" id="eeDetailName">â€”</div>
              <div class="ee-detail-type-badge" id="eeDetailType">â€”</div>
            </div>
            <div class="ee-detail-risk-wrap">
              <canvas class="ee-detail-sparkline" id="eeDetailSparkline"></canvas>
              <div class="ee-detail-risk-score" id="eeDetailRisk">â€”</div>
            </div>
            <button class="ee-detail-close" id="eeDetailClose">âœ•</button>
          </div>
          <div class="ee-detail-body">
            <div>
              <div class="ee-detail-section-title">Entity Profile</div>
              <div class="ee-profile-grid" id="eeDetailProfile"></div>
            </div>
            <div>
              <div class="ee-detail-section-title">Associated Alerts</div>
              <div id="eeDetailAlerts"></div>
            </div>
            <div>
              <div class="ee-detail-section-title">Quick Actions</div>
              <div class="ee-actions">
                <button class="ee-action-btn primary">ðŸ” Investigate</button>
                <button class="ee-action-btn danger">ðŸš« Isolate Host</button>
                <button class="ee-action-btn">ðŸ‘ Add to Watchlist</button>
                <button class="ee-action-btn">ðŸ“¤ Export IOCs</button>
              </div>
            </div>
          </div>
        </div>
      </div><!-- end entities -->


      <!-- =====================================================
           PAGE: VULNERABILITY MANAGEMENT
           ===================================================== -->
      <div class="page" id="page-vulnmgmt">
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             ASSET VULNERABILITY MANAGEMENT â€” ARMIS AVM STYLE
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

        <!-- Page Header -->
        <div class="page-header">
          <div>
            <div class="page-title">Asset Vulnerability Management</div>
            <div class="page-subtitle">Aggregated from Nessus &middot; Rapid7 &middot; Qualys &middot; Tenable.io</div>
          </div>
          <div class="page-actions">
            <select class="filter-select" style="font-size:11px;padding:4px 10px;">
              <option>All Scanners</option>
              <option>Nessus Professional</option>
              <option>Rapid7 InsightVM</option>
              <option>Qualys VMDR</option>
              <option>Tenable.io</option>
              <option>CrowdStrike Spotlight</option>
            </select>
            <button class="btn btn-secondary btn-sm" onclick="this.textContent='Syncing...';setTimeout(()=>this.textContent='&#x21BB; Sync All',2000)">&#x21BB; Sync All</button>
            <button class="btn btn-primary btn-sm">&#x2913; Export</button>
          </div>
        </div>

        <!-- 1. Top Metrics Row -->
        <div class="avm-metrics">
          <!-- Total Vulnerabilities -->
          <div class="avm-metric-card avm-mc-red">
            <div class="avm-mc-label">Total Vulnerabilities</div>
            <div class="avm-mc-value red">12,847</div>
            <div class="avm-mc-sub">+342 since last scan</div>
            <div class="avm-mc-sparkline">
              <span style="height:40%;background:rgba(239,68,68,0.5);"></span>
              <span style="height:55%;background:rgba(239,68,68,0.5);"></span>
              <span style="height:48%;background:rgba(239,68,68,0.5);"></span>
              <span style="height:62%;background:rgba(239,68,68,0.5);"></span>
              <span style="height:58%;background:rgba(239,68,68,0.5);"></span>
              <span style="height:70%;background:rgba(239,68,68,0.5);"></span>
              <span style="height:75%;background:rgba(239,68,68,0.5);"></span>
              <span style="height:82%;background:rgba(239,68,68,0.8);"></span>
              <span style="height:90%;background:rgba(239,68,68,0.9);"></span>
              <span style="height:100%;background:#ff6b6b;"></span>
            </div>
          </div>
          <!-- Critical CVSS & Exploits -->
          <div class="avm-metric-card avm-mc-orange">
            <div class="avm-mc-label">Critical CVSS &amp; Exploits</div>
            <div class="avm-mc-value orange">9,345</div>
            <div class="avm-mc-sub">on 20K Assets</div>
            <div class="avm-mc-sparkline">
              <span style="height:35%;background:rgba(249,115,22,0.5);"></span>
              <span style="height:50%;background:rgba(249,115,22,0.5);"></span>
              <span style="height:60%;background:rgba(249,115,22,0.5);"></span>
              <span style="height:55%;background:rgba(249,115,22,0.5);"></span>
              <span style="height:65%;background:rgba(249,115,22,0.5);"></span>
              <span style="height:72%;background:rgba(249,115,22,0.5);"></span>
              <span style="height:68%;background:rgba(249,115,22,0.5);"></span>
              <span style="height:80%;background:rgba(249,115,22,0.6);"></span>
              <span style="height:88%;background:rgba(249,115,22,0.7);"></span>
              <span style="height:100%;background:#f97316;"></span>
            </div>
          </div>
          <!-- Most-Vulnerable Assets -->
          <div class="avm-metric-card avm-mc-amber">
            <div class="avm-mc-label">Most-Vulnerable Assets</div>
            <div class="avm-mc-value amber">1,528 CVEs</div>
            <div class="avm-mc-sub">on 1K Assets</div>
            <div class="avm-mc-sparkline">
              <span style="height:30%;background:rgba(245,158,11,0.4);"></span>
              <span style="height:45%;background:rgba(245,158,11,0.4);"></span>
              <span style="height:52%;background:rgba(245,158,11,0.4);"></span>
              <span style="height:48%;background:rgba(245,158,11,0.4);"></span>
              <span style="height:60%;background:rgba(245,158,11,0.4);"></span>
              <span style="height:67%;background:rgba(245,158,11,0.4);"></span>
              <span style="height:73%;background:rgba(245,158,11,0.5);"></span>
              <span style="height:79%;background:rgba(245,158,11,0.6);"></span>
              <span style="height:86%;background:rgba(245,158,11,0.7);"></span>
              <span style="height:100%;background:#f59e0b;"></span>
            </div>
          </div>
          <!-- Vulnerabilities By Asset Type donut indicator -->
          <div class="avm-metric-card avm-mc-purple" style="display:flex;flex-direction:column;gap:0;">
            <div class="avm-mc-label" style="margin-bottom:10px;">Vuln Distribution</div>
            <div style="display:flex;align-items:center;gap:14px;flex:1;">
              <div style="position:relative;width:72px;height:72px;flex-shrink:0;">
                <div style="width:72px;height:72px;border-radius:50%;background:conic-gradient(#ff6b6b 0% 30%,#f97316 30% 52%,#f59e0b 52% 68%,#8b5cf6 68% 81%,rgba(255,255,255,0.1) 81% 100%);"></div>
                <div style="position:absolute;inset:10px;border-radius:50%;background:var(--bg-card);display:flex;align-items:center;justify-content:center;flex-direction:column;">
                  <span style="font-size:13px;font-weight:800;font-family:var(--font-display);color:var(--text-primary);line-height:1;">354</span>
                  <span style="font-size:7px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.05em;">CVEs</span>
                </div>
              </div>
              <div style="display:flex;flex-direction:column;gap:5px;flex:1;">
                <div style="display:flex;align-items:center;gap:5px;"><span style="width:7px;height:7px;border-radius:50%;background:#ff6b6b;flex-shrink:0;"></span><span style="font-size:10px;color:var(--text-secondary);">Critical</span><span style="margin-left:auto;font-size:10px;font-family:var(--font-mono);color:var(--text-muted);">30%</span></div>
                <div style="display:flex;align-items:center;gap:5px;"><span style="width:7px;height:7px;border-radius:50%;background:#f97316;flex-shrink:0;"></span><span style="font-size:10px;color:var(--text-secondary);">High</span><span style="margin-left:auto;font-size:10px;font-family:var(--font-mono);color:var(--text-muted);">22%</span></div>
                <div style="display:flex;align-items:center;gap:5px;"><span style="width:7px;height:7px;border-radius:50%;background:#f59e0b;flex-shrink:0;"></span><span style="font-size:10px;color:var(--text-secondary);">Medium</span><span style="margin-left:auto;font-size:10px;font-family:var(--font-mono);color:var(--text-muted);">16%</span></div>
                <div style="display:flex;align-items:center;gap:5px;"><span style="width:7px;height:7px;border-radius:50%;background:#8b5cf6;flex-shrink:0;"></span><span style="font-size:10px;color:var(--text-secondary);">Low</span><span style="margin-left:auto;font-size:10px;font-family:var(--font-mono);color:var(--text-muted);">13%</span></div>
              </div>
            </div>
          </div>
        </div>

        <!-- 2. Vulnerability Trend Area Chart -->
        <div class="avm-trend-card">
          <div class="avm-trend-header">
            <span class="avm-trend-title">Vulnerability Trend â€” 8 Months</span>
            <div class="avm-trend-legend">
              <div class="avm-trend-leg-item"><span class="avm-trend-leg-dot" style="background:#ef4444;"></span>Critical</div>
              <div class="avm-trend-leg-item"><span class="avm-trend-leg-dot" style="background:#f97316;"></span>High</div>
              <div class="avm-trend-leg-item"><span class="avm-trend-leg-dot" style="background:#3b82f6;"></span>Medium</div>
              <div class="avm-trend-leg-item"><span class="avm-trend-leg-dot" style="background:#10b981;"></span>Low</div>
            </div>
          </div>
          <div class="avm-chart-wrap">
            <svg viewBox="0 0 800 180" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <!-- Medium/Low stacked area gradient (bottom, largest) -->
                <linearGradient id="gradLow" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0%" stop-color="#10b981" stop-opacity="0.55"/>
                  <stop offset="100%" stop-color="#10b981" stop-opacity="0.08"/>
                </linearGradient>
                <!-- Medium area gradient -->
                <linearGradient id="gradMed" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0%" stop-color="#3b82f6" stop-opacity="0.65"/>
                  <stop offset="100%" stop-color="#1e40af" stop-opacity="0.12"/>
                </linearGradient>
                <!-- High area gradient -->
                <linearGradient id="gradHigh" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0%" stop-color="#f97316" stop-opacity="0.75"/>
                  <stop offset="100%" stop-color="#ea580c" stop-opacity="0.15"/>
                </linearGradient>
                <!-- Critical area gradient -->
                <linearGradient id="gradCrit" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0%" stop-color="#ef4444" stop-opacity="0.9"/>
                  <stop offset="100%" stop-color="#b91c1c" stop-opacity="0.25"/>
                </linearGradient>
                <!-- Grid line pattern -->
                <pattern id="grid" width="100" height="30" patternUnits="userSpaceOnUse">
                  <line x1="0" y1="0" x2="0" y2="180" stroke="rgba(255,255,255,0.04)" stroke-width="1"/>
                  <line x1="0" y1="0" x2="800" y2="0" stroke="rgba(255,255,255,0.04)" stroke-width="1"/>
                </pattern>
              </defs>

              <!-- Background grid -->
              <rect width="800" height="180" fill="url(#grid)" rx="4"/>

              <!-- Horizontal grid lines -->
              <line x1="0" y1="45" x2="800" y2="45" stroke="rgba(255,255,255,0.05)" stroke-width="1" stroke-dasharray="4,4"/>
              <line x1="0" y1="90" x2="800" y2="90" stroke="rgba(255,255,255,0.05)" stroke-width="1" stroke-dasharray="4,4"/>
              <line x1="0" y1="135" x2="800" y2="135" stroke="rgba(255,255,255,0.05)" stroke-width="1" stroke-dasharray="4,4"/>

              <!-- Y-axis labels -->
              <text x="6" y="14" fill="rgba(255,255,255,0.3)" font-size="9" font-family="monospace">15K</text>
              <text x="6" y="48" fill="rgba(255,255,255,0.3)" font-size="9" font-family="monospace">12K</text>
              <text x="6" y="93" fill="rgba(255,255,255,0.3)" font-size="9" font-family="monospace">8K</text>
              <text x="6" y="138" fill="rgba(255,255,255,0.3)" font-size="9" font-family="monospace">4K</text>

              <!-- LAYER 1: Low/Green (bottom, largest) -->
              <!-- Points: Jul(0,155) Aug(114,150) Sep(228,145) Oct(342,148) Nov(457,140) Dec(571,135) Jan(685,130) Feb(800,122) baseline 180 -->
              <polygon
                points="0,155 114,150 228,145 342,148 457,140 571,135 685,128 800,120 800,180 0,180"
                fill="url(#gradLow)"/>
              <polyline
                points="0,155 114,150 228,145 342,148 457,140 571,135 685,128 800,120"
                fill="none" stroke="#10b981" stroke-width="1.5" stroke-opacity="0.7"/>

              <!-- LAYER 2: Medium/Blue -->
              <!-- Sits atop low â€” top edge is slightly above low -->
              <polygon
                points="0,130 114,122 228,118 342,120 457,110 571,104 685,95 800,86 800,180 0,180"
                fill="url(#gradMed)"/>
              <polyline
                points="0,130 114,122 228,118 342,120 457,110 571,104 685,95 800,86"
                fill="none" stroke="#3b82f6" stroke-width="1.5" stroke-opacity="0.8"/>

              <!-- LAYER 3: High/Orange -->
              <polygon
                points="0,95 114,88 228,82 342,85 457,74 571,66 685,56 800,46 800,180 0,180"
                fill="url(#gradHigh)"/>
              <polyline
                points="0,95 114,88 228,82 342,85 457,74 571,66 685,56 800,46"
                fill="none" stroke="#f97316" stroke-width="1.5" stroke-opacity="0.9"/>

              <!-- LAYER 4: Critical/Red (top, smallest) -->
              <polygon
                points="0,62 114,56 228,50 342,54 457,44 571,36 685,28 800,20 800,180 0,180"
                fill="url(#gradCrit)"/>
              <polyline
                points="0,62 114,56 228,50 342,54 457,44 571,36 685,28 800,20"
                fill="none" stroke="#ef4444" stroke-width="2" stroke-opacity="1"/>

              <!-- Data point dots on critical line -->
              <circle cx="0" cy="62" r="3" fill="#ef4444"/>
              <circle cx="114" cy="56" r="3" fill="#ef4444"/>
              <circle cx="228" cy="50" r="3" fill="#ef4444"/>
              <circle cx="342" cy="54" r="3" fill="#ef4444"/>
              <circle cx="457" cy="44" r="3" fill="#ef4444"/>
              <circle cx="571" cy="36" r="3" fill="#ef4444"/>
              <circle cx="685" cy="28" r="3" fill="#ef4444"/>
              <circle cx="800" cy="20" r="4" fill="#ff6b6b" stroke="rgba(255,255,255,0.3)" stroke-width="1.5"/>

              <!-- Current value annotation -->
              <text x="758" y="14" fill="#ff6b6b" font-size="10" font-family="monospace" text-anchor="end">9.3K</text>
            </svg>
          </div>
          <div class="avm-chart-xaxis">
            <span>Jul</span><span>Aug</span><span>Sep</span><span>Oct</span><span>Nov</span><span>Dec</span><span>Jan</span><span>Feb</span>
          </div>
        </div>

        <!-- 3. Two-column: Vulnerabilities By + CVEs in Headlines -->
        <div class="avm-mid-grid">
          <!-- LEFT: Vulnerabilities By -->
          <div class="avm-by-card">
            <div class="card-header" style="margin-bottom:12px;">
              <span class="card-title">Vulnerabilities By</span>
              <span class="badge badge-cyan">354 CVEs</span>
            </div>
            <div class="avm-by-tabs" id="avmByTabs">
              <button class="avm-by-tab active" onclick="avmSetTab(this,'assettype')">Asset Type</button>
              <button class="avm-by-tab" onclick="avmSetTab(this,'os')">OS</button>
              <button class="avm-by-tab" onclick="avmSetTab(this,'apps')">Applications</button>
              <button class="avm-by-tab" onclick="avmSetTab(this,'sites')">Sites</button>
            </div>

            <!-- Asset Type tab content -->
            <div id="avmTab-assettype" class="avm-by-content">
              <div class="avm-donut-wrap">
                <div class="avm-donut" style="background: conic-gradient(
                  #3b82f6 0% 30%,
                  #8b5cf6 30% 51%,
                  #f97316 51% 66%,
                  #10b981 66% 79%,
                  #f59e0b 79% 91%,
                  rgba(255,255,255,0.08) 91% 100%
                );"></div>
                <div class="avm-donut-center">
                  <div class="avm-donut-center-val">354</div>
                  <div class="avm-donut-center-label">CVEs<br>Open</div>
                </div>
              </div>
              <div class="avm-donut-legend">
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#3b82f6;"></span><span class="avm-donut-leg-name">Firefox</span><span class="avm-donut-leg-count">105</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#8b5cf6;"></span><span class="avm-donut-leg-name">Chrome</span><span class="avm-donut-leg-count">60</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#f97316;"></span><span class="avm-donut-leg-name">Notepad++</span><span class="avm-donut-leg-count">51</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#10b981;"></span><span class="avm-donut-leg-name">7-Zip</span><span class="avm-donut-leg-count">43</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#f59e0b;"></span><span class="avm-donut-leg-name">Adobe Acrobat</span><span class="avm-donut-leg-count">28</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:rgba(255,255,255,0.2);"></span><span class="avm-donut-leg-name">Others</span><span class="avm-donut-leg-count">67</span></div>
              </div>
            </div>

            <!-- OS tab content (hidden) -->
            <div id="avmTab-os" class="avm-by-content" style="display:none;">
              <div class="avm-donut-wrap">
                <div class="avm-donut" style="background: conic-gradient(
                  #00d4ff 0% 45%,
                  #3b82f6 45% 68%,
                  #8b5cf6 68% 82%,
                  rgba(255,255,255,0.08) 82% 100%
                );"></div>
                <div class="avm-donut-center">
                  <div class="avm-donut-center-val">621</div>
                  <div class="avm-donut-center-label">OS<br>Vulns</div>
                </div>
              </div>
              <div class="avm-donut-legend">
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#00d4ff;"></span><span class="avm-donut-leg-name">Windows 10/11</span><span class="avm-donut-leg-count">278</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#3b82f6;"></span><span class="avm-donut-leg-name">Windows Server</span><span class="avm-donut-leg-count">144</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#8b5cf6;"></span><span class="avm-donut-leg-name">Ubuntu Linux</span><span class="avm-donut-leg-count">87</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:rgba(255,255,255,0.2);"></span><span class="avm-donut-leg-name">Others</span><span class="avm-donut-leg-count">112</span></div>
              </div>
            </div>

            <!-- Applications tab content (hidden) -->
            <div id="avmTab-apps" class="avm-by-content" style="display:none;">
              <div class="avm-donut-wrap">
                <div class="avm-donut" style="background: conic-gradient(
                  #f97316 0% 36%,
                  #ef4444 36% 58%,
                  #f59e0b 58% 74%,
                  #10b981 74% 88%,
                  rgba(255,255,255,0.08) 88% 100%
                );"></div>
                <div class="avm-donut-center">
                  <div class="avm-donut-center-val">419</div>
                  <div class="avm-donut-center-label">App<br>Vulns</div>
                </div>
              </div>
              <div class="avm-donut-legend">
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#f97316;"></span><span class="avm-donut-leg-name">Apache HTTP</span><span class="avm-donut-leg-count">152</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#ef4444;"></span><span class="avm-donut-leg-name">OpenSSL</span><span class="avm-donut-leg-count">93</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#f59e0b;"></span><span class="avm-donut-leg-name">Java Runtime</span><span class="avm-donut-leg-count">67</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#10b981;"></span><span class="avm-donut-leg-name">nginx</span><span class="avm-donut-leg-count">58</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:rgba(255,255,255,0.2);"></span><span class="avm-donut-leg-name">Others</span><span class="avm-donut-leg-count">49</span></div>
              </div>
            </div>

            <!-- Sites tab content (hidden) -->
            <div id="avmTab-sites" class="avm-by-content" style="display:none;">
              <div class="avm-donut-wrap">
                <div class="avm-donut" style="background: conic-gradient(
                  #00d4ff 0% 40%,
                  #8b5cf6 40% 62%,
                  #f59e0b 62% 80%,
                  rgba(255,255,255,0.08) 80% 100%
                );"></div>
                <div class="avm-donut-center">
                  <div class="avm-donut-center-val">3</div>
                  <div class="avm-donut-center-label">Sites</div>
                </div>
              </div>
              <div class="avm-donut-legend">
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#00d4ff;"></span><span class="avm-donut-leg-name">Singapore HQ</span><span class="avm-donut-leg-count">5,214</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#8b5cf6;"></span><span class="avm-donut-leg-name">KL Branch</span><span class="avm-donut-leg-count">3,801</span></div>
                <div class="avm-donut-leg-row"><span class="avm-donut-leg-dot" style="background:#f59e0b;"></span><span class="avm-donut-leg-name">Jakarta DC</span><span class="avm-donut-leg-count">3,832</span></div>
              </div>
            </div>
          </div>

          <!-- RIGHT: CVEs In The Headlines -->
          <div class="avm-cve-card">
            <div class="card-header" style="margin-bottom:0;">
              <span class="card-title">CVEs In The Headlines</span>
              <span class="badge badge-amber">5 Active</span>
            </div>
            <div class="avm-cve-grid">
              <div class="avm-cve-item">
                <div class="avm-cve-id">CVE-2022-30190</div>
                <div class="avm-cve-name">Follina</div>
                <div class="avm-cve-count">35</div>
                <div class="avm-cve-unit">Affected Devices</div>
                <span class="badge badge-red" style="font-size:9px;padding:1px 5px;width:fit-content;">CVSS 9.8</span>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-30190" target="_blank" rel="noopener noreferrer" class="avm-cve-link">NIST &#x2197;</a>
              </div>
              <div class="avm-cve-item">
                <div class="avm-cve-id">CVE-2021-44228</div>
                <div class="avm-cve-name">Log4Shell</div>
                <div class="avm-cve-count">423</div>
                <div class="avm-cve-unit">Affected Devices</div>
                <span class="badge badge-red" style="font-size:9px;padding:1px 5px;width:fit-content;">CVSS 10.0</span>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" target="_blank" rel="noopener noreferrer" class="avm-cve-link">NIST &#x2197;</a>
              </div>
              <div class="avm-cve-item">
                <div class="avm-cve-id">CVE-2024-3094</div>
                <div class="avm-cve-name">XZ Utils</div>
                <div class="avm-cve-count">89</div>
                <div class="avm-cve-unit">Affected Devices</div>
                <span class="badge badge-red" style="font-size:9px;padding:1px 5px;width:fit-content;">CVSS 10.0</span>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-3094" target="_blank" rel="noopener noreferrer" class="avm-cve-link">NIST &#x2197;</a>
              </div>
              <div class="avm-cve-item">
                <div class="avm-cve-id">CVE-2023-44487</div>
                <div class="avm-cve-name">HTTP/2 Reset</div>
                <div class="avm-cve-count">156</div>
                <div class="avm-cve-unit">Affected Devices</div>
                <span class="badge badge-amber" style="font-size:9px;padding:1px 5px;width:fit-content;">CVSS 7.5</span>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-44487" target="_blank" rel="noopener noreferrer" class="avm-cve-link">NIST &#x2197;</a>
              </div>
              <div class="avm-cve-item">
                <div class="avm-cve-id">CVE-2021-34527</div>
                <div class="avm-cve-name">PrintNightmare</div>
                <div class="avm-cve-count">67</div>
                <div class="avm-cve-unit">Affected Devices</div>
                <span class="badge badge-red" style="font-size:9px;padding:1px 5px;width:fit-content;">CVSS 8.8</span>
                <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-34527" target="_blank" rel="noopener noreferrer" class="avm-cve-link">NIST &#x2197;</a>
              </div>
            </div>
          </div>
        </div>

        <!-- 4. Scanner Integration Status -->
        <div class="card" style="margin-bottom:16px;">
          <div class="card-header">
            <span class="card-title">Scanner Integration Status</span>
            <span class="badge badge-green">3 Connected</span>
          </div>
          <div class="avm-scanner-row">
            <div class="avm-scanner-pill">
              <span class="status-dot green"></span>
              <span class="avm-scanner-pill-name">Nessus Professional</span>
              <span class="avm-scanner-pill-status connected">Connected</span>
              <span style="font-size:10px;color:var(--text-muted);margin-left:4px;">&middot; 14,328 findings &middot; 2h ago</span>
            </div>
            <div class="avm-scanner-pill">
              <span class="status-dot green"></span>
              <span class="avm-scanner-pill-name">Rapid7 InsightVM</span>
              <span class="avm-scanner-pill-status connected">Connected</span>
              <span style="font-size:10px;color:var(--text-muted);margin-left:4px;">&middot; 8,921 findings &middot; 6h ago</span>
            </div>
            <div class="avm-scanner-pill">
              <span class="status-dot green"></span>
              <span class="avm-scanner-pill-name">Qualys VMDR</span>
              <span class="avm-scanner-pill-status connected">Connected</span>
              <span style="font-size:10px;color:var(--text-muted);margin-left:4px;">&middot; 9,102 findings &middot; 4h ago</span>
            </div>
            <div class="avm-scanner-pill">
              <span class="status-dot syncing"></span>
              <span class="avm-scanner-pill-name">Tenable.io</span>
              <span class="avm-scanner-pill-status syncing">Syncing&hellip;</span>
              <span style="font-size:10px;color:var(--text-muted);margin-left:4px;">&middot; 72% complete</span>
            </div>
            <div class="avm-scanner-pill">
              <span class="status-dot gray"></span>
              <span class="avm-scanner-pill-name">CrowdStrike Spotlight</span>
              <span class="avm-scanner-pill-status pending">Pending</span>
              <button class="btn btn-xs btn-secondary" style="margin-left:8px;">Configure</button>
            </div>
          </div>
        </div>

        <!-- 5. Vulnerability Table -->
        <div class="avm-vuln-table">
          <div class="card-header">
            <span class="card-title">Top Critical Findings</span>
            <div style="display:flex;align-items:center;gap:8px;margin-left:auto;">
              <span class="badge badge-red">23 Critical</span>
              <input class="filter-input" placeholder="Search CVE, title, host..." style="width:200px;">
            </div>
          </div>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>CVE ID</th>
                  <th>Title</th>
                  <th>CVSS</th>
                  <th>Affected Hosts</th>
                  <th>Exploitability</th>
                  <th>First Seen</th>
                  <th>Status</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><span class="mono" style="color:var(--cyan);">CVE-2026-21413</span></td>
                  <td style="color:var(--text-primary);font-weight:500;">Exchange Server Remote Code Execution</td>
                  <td><span class="avm-cvss critical">9.8</span></td>
                  <td>3 hosts</td>
                  <td><span class="avm-exploit-badge yes">&#x26A1; Active</span></td>
                  <td class="mono">2d ago</td>
                  <td><span class="vm-status-badge vm-status-open">Open</span></td>
                  <td><button class="btn btn-xs btn-danger">Patch</button></td>
                </tr>
                <tr>
                  <td><span class="mono" style="color:var(--cyan);">CVE-2026-0217</span></td>
                  <td style="color:var(--text-primary);font-weight:500;">Log4Shell Variant â€” JNDI Injection</td>
                  <td><span class="avm-cvss critical">9.1</span></td>
                  <td>12 hosts</td>
                  <td><span class="avm-exploit-badge yes">&#x26A1; Active</span></td>
                  <td class="mono">5d ago</td>
                  <td><span class="vm-status-badge vm-status-inprogress">In Progress</span></td>
                  <td><button class="btn btn-xs btn-secondary">View</button></td>
                </tr>
                <tr>
                  <td><span class="mono" style="color:var(--cyan);">CVE-2025-44892</span></td>
                  <td style="color:var(--text-primary);font-weight:500;">Apache Struts Remote Code Execution</td>
                  <td><span class="avm-cvss high">8.8</span></td>
                  <td>5 hosts</td>
                  <td><span class="avm-exploit-badge poc">PoC</span></td>
                  <td class="mono">3d ago</td>
                  <td><span class="vm-status-badge vm-status-open">Open</span></td>
                  <td><button class="btn btn-xs btn-danger">Patch</button></td>
                </tr>
                <tr>
                  <td><span class="mono" style="color:var(--cyan);">CVE-2026-1094</span></td>
                  <td style="color:var(--text-primary);font-weight:500;">Windows Print Spooler Privilege Escalation</td>
                  <td><span class="avm-cvss high">8.4</span></td>
                  <td>8 hosts</td>
                  <td><span class="avm-exploit-badge poc">PoC</span></td>
                  <td class="mono">7d ago</td>
                  <td><span class="vm-status-badge vm-status-inprogress">In Progress</span></td>
                  <td><button class="btn btn-xs btn-secondary">View</button></td>
                </tr>
                <tr>
                  <td><span class="mono" style="color:var(--cyan);">CVE-2025-38271</span></td>
                  <td style="color:var(--text-primary);font-weight:500;">OpenSSL Buffer Overflow</td>
                  <td><span class="avm-cvss high">8.1</span></td>
                  <td>4 hosts</td>
                  <td><span class="avm-exploit-badge no">No Known</span></td>
                  <td class="mono">4d ago</td>
                  <td><span class="vm-status-badge vm-status-open">Open</span></td>
                  <td><button class="btn btn-xs btn-danger">Patch</button></td>
                </tr>
                <tr>
                  <td><span class="mono" style="color:var(--cyan);">CVE-2026-5581</span></td>
                  <td style="color:var(--text-primary);font-weight:500;">Fortinet FortiOS SSL VPN Path Traversal</td>
                  <td><span class="avm-cvss high">7.5</span></td>
                  <td>2 hosts</td>
                  <td><span class="avm-exploit-badge yes">&#x26A1; Active</span></td>
                  <td class="mono">12d ago</td>
                  <td><span class="vm-status-badge vm-status-remediated">Remediated</span></td>
                  <td><button class="btn btn-xs btn-secondary">View</button></td>
                </tr>
                <tr>
                  <td><span class="mono" style="color:var(--cyan);">CVE-2025-29187</span></td>
                  <td style="color:var(--text-primary);font-weight:500;">VMware vCenter Server SSRF</td>
                  <td><span class="avm-cvss medium">6.5</span></td>
                  <td>1 host</td>
                  <td><span class="avm-exploit-badge poc">PoC</span></td>
                  <td class="mono">6d ago</td>
                  <td><span class="vm-status-badge vm-status-open">Open</span></td>
                  <td><button class="btn btn-xs btn-secondary">View</button></td>
                </tr>
                <tr>
                  <td><span class="mono" style="color:var(--cyan);">CVE-2026-3347</span></td>
                  <td style="color:var(--text-primary);font-weight:500;">Cisco IOS XE Web UI Command Injection</td>
                  <td><span class="avm-cvss medium">6.1</span></td>
                  <td>3 hosts</td>
                  <td><span class="avm-exploit-badge no">No Known</span></td>
                  <td class="mono">9d ago</td>
                  <td><span class="vm-status-badge vm-status-inprogress">In Progress</span></td>
                  <td><button class="btn btn-xs btn-secondary">View</button></td>
                </tr>
                <tr>
                  <td><span class="mono" style="color:var(--cyan);">CVE-2025-51204</span></td>
                  <td style="color:var(--text-primary);font-weight:500;">Microsoft Outlook Spoofing Vulnerability</td>
                  <td><span class="avm-cvss medium">5.4</span></td>
                  <td>14 hosts</td>
                  <td><span class="avm-exploit-badge no">No Known</span></td>
                  <td class="mono">11d ago</td>
                  <td><span class="vm-status-badge vm-status-open">Open</span></td>
                  <td><button class="btn btn-xs btn-secondary">View</button></td>
                </tr>
                <tr>
                  <td><span class="mono" style="color:var(--cyan);">CVE-2026-0892</span></td>
                  <td style="color:var(--text-primary);font-weight:500;">jQuery Cross-Site Scripting (XSS)</td>
                  <td><span class="avm-cvss medium">4.3</span></td>
                  <td>7 hosts</td>
                  <td><span class="avm-exploit-badge no">No Known</span></td>
                  <td class="mono">15d ago</td>
                  <td><span class="vm-status-badge vm-status-remediated">Remediated</span></td>
                  <td><button class="btn btn-xs btn-secondary">View</button></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <script>
        // Vulnerabilities By tab switcher
        function avmSetTab(btn, tabId) {
          // Update button states
          document.querySelectorAll('#avmByTabs .avm-by-tab').forEach(function(b) { b.classList.remove('active'); });
          btn.classList.add('active');
          // Show/hide tab panels
          var panels = ['assettype','os','apps','sites'];
          panels.forEach(function(id) {
            var el = document.getElementById('avmTab-' + id);
            if (el) el.style.display = (id === tabId) ? 'flex' : 'none';
          });
        }
        </script>

            </div><!-- end vulnmgmt -->




      <!-- ============================================================
           DACTA COPILOT PAGE
           ============================================================ -->
      <div class="page" id="page-copilot">

        <!-- Copilot Header -->
        <div class="copilot-header">
          <div class="copilot-header-top">
            <div class="copilot-title-row">
              <div class="copilot-logo-badge">&#x1F916;</div>
              <div class="copilot-title-text">
                <h1>DACTA <span>Copilot</span></h1>
                <p>AI-Powered Investigation Intelligence Â· Session #COP-2026-0228</p>
              </div>
            </div>
            <div class="copilot-header-actions">
              <div class="copilot-shortcut-badge"><kbd>Ctrl</kbd><kbd>K</kbd> Command Bar</div>
              <button class="btn btn-secondary btn-sm" onclick="openCopilotCmd()">&#x2318; Command Bar</button>
              <button class="btn btn-secondary btn-sm">&#x1F5C4; Export Session</button>
              <button class="btn btn-secondary btn-sm" onclick="clearCopilotScreen()" style="background:rgba(239,68,68,0.08);border-color:rgba(239,68,68,0.2);color:#f87171;">&#x1F5D1; Clear Screen</button>
              <button class="btn btn-primary btn-sm">+ New Session</button>
            </div>
          </div>
        </div>

        <!-- Domain Selector Bar -->
        <div class="copilot-domain-bar">
          <button class="domain-btn" onclick="selectDomain(this, 'all')">
            <span class="domain-icon">&#x26A1;</span> All Domains
          </button>
          <button class="domain-btn active" onclick="selectDomain(this, 'logsearch')">
            <span class="domain-icon">&#x1F50D;</span> Log Search
          </button>
          <button class="domain-btn" onclick="selectDomain(this, 'threatintel')">
            <span class="domain-icon">&#x1F6E1;&#xFE0F;</span> Threat Intel
          </button>
          <button class="domain-btn" onclick="selectDomain(this, 'scriptanalysis')">
            <span class="domain-icon">&#x1F9EC;</span> Script Analysis
          </button>
          <button class="domain-btn" onclick="selectDomain(this, 'mitre')">
            <span class="domain-icon">&#x1F5FA;&#xFE0F;</span> MITRE ATT&amp;CK
          </button>
          <button class="domain-btn" onclick="selectDomain(this, 'assetintel')">
            <span class="domain-icon">&#x1F5A5;&#xFE0F;</span> Asset Intel
          </button>
          <button class="domain-btn" onclick="selectDomain(this, 'ticketintel')">
            <span class="domain-icon">&#x1F4CB;</span> Ticket Intel
          </button>
          <button class="domain-btn" onclick="selectDomain(this, 'knowledge')">
            <span class="domain-icon">&#x1F4DA;</span> Knowledge
          </button>
        </div>

        <!-- Main Copilot Body -->
        <div class="copilot-body">

          <!-- Left: Conversation Area -->
          <div class="copilot-conversation">
            <!-- Conv header -->
            <div class="copilot-conv-header">
              <div class="copilot-conv-title">
                &#x1F5E8;&#xFE0F; Investigation Session
                <span class="badge badge-cyan" style="font-size:9px;padding:2px 7px;">NagaWorld Â· TKT-847</span>
              </div>
              <div class="copilot-session-indicator">
                <div class="copilot-session-dot"></div>
                Copilot Active
              </div>
            </div>

            <!-- Messages -->
            <div class="copilot-messages" id="copilotMessages">

              <!-- System welcome -->
              <div style="text-align:center;padding:8px 0;">
                <div style="display:inline-flex;align-items:center;gap:8px;background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:20px;padding:5px 14px;font-size:11px;color:var(--text-muted);">
                  <span style="color:var(--green);font-size:13px;">&#x25CF;</span>
                  Session started Â· NagaWorld context loaded Â· 6 data sources active
                </div>
              </div>

              <!-- MESSAGE 1: Analyst -->
              <div class="msg-row analyst">
                <div class="msg-avatar analyst-av">&#x1F464;</div>
                <div class="msg-content">
                  <div class="msg-meta">
                    <span class="msg-sender">J. Lim (Analyst)</span>
                    <span>14:32:07 SGT</span>
                  </div>
                  <div class="msg-bubble-analyst">Check IP 185.220.101.34</div>
                </div>
              </div>

              <!-- MESSAGE 1: Copilot Response â€” IOC Enrichment -->
              <div class="msg-row">
                <div class="msg-avatar copilot-av">&#x1F916;</div>
                <div class="msg-content" style="max-width:95%;">
                  <div class="msg-meta">
                    <span class="msg-sender">DACTA Copilot</span>
                    <span>14:32:09 SGT Â· 1.8s</span>
                    <span class="badge badge-red" style="font-size:9px;padding:1px 5px;">MALICIOUS</span>
                  </div>
                  <div class="msg-bubble-copilot">
                    <div style="font-size:12.5px;color:var(--text-secondary);margin-bottom:10px;line-height:1.5;">
                      IOC enrichment complete. Cross-referenced across 6 threat intelligence sources. This IP has <strong style="color:var(--red-bright);">multiple confirmed malicious indicators</strong> including active C2 association.
                    </div>

                    <!-- IOC Enrichment Card -->
                    <div class="ioc-enrichment-card">
                      <!-- Card Header -->
                      <div class="ioc-card-header">
                        <div class="ioc-verdict">
                          <div class="ioc-verdict-badge">&#x26D4; MALICIOUS</div>
                          <div>
                            <div class="ioc-ip-display">185.220.101.34</div>
                            <div style="font-size:10px;color:var(--text-muted);margin-top:2px;font-family:var(--font-mono);">Type: IPv4 Â· Autonomous System: AS24940</div>
                          </div>
                        </div>
                        <div class="ioc-confidence">
                          <div>
                            <div style="font-size:10px;color:var(--text-muted);margin-bottom:3px;">Confidence</div>
                            <div class="ioc-conf-bar">
                              <div class="ioc-conf-fill" style="width:95%;"></div>
                            </div>
                          </div>
                          <div style="font-size:13px;font-weight:700;color:var(--red-bright);font-family:var(--font-mono);">95%</div>
                        </div>
                      </div>

                      <!-- Sources Grid -->
                      <div class="ioc-sources-grid">
                        <div class="ioc-source-row">
                          <div class="ioc-source-icon src-vt">&#x1F9EA;</div>
                          <div class="ioc-source-body">
                            <div class="ioc-source-name">VirusTotal</div>
                            <div class="ioc-source-value"><strong style="color:var(--red-bright);">12/89</strong> vendors flagged</div>
                          </div>
                          <div class="ioc-indicator ind-red"></div>
                        </div>

                        <div class="ioc-source-row">
                          <div class="ioc-source-icon src-abuse">&#x1F6A8;</div>
                          <div class="ioc-source-body">
                            <div class="ioc-source-name">AbuseIPDB</div>
                            <div class="ioc-source-value"><strong style="color:var(--red-bright);">97%</strong> confidence Â· 347 reports/90d</div>
                          </div>
                          <div class="ioc-indicator ind-red"></div>
                        </div>

                        <div class="ioc-source-row">
                          <div class="ioc-source-icon src-shodan">&#x1F4E1;</div>
                          <div class="ioc-source-body">
                            <div class="ioc-source-name">Shodan</div>
                            <div class="ioc-source-value">Tor exit node Â· Port 443 open Â· Self-signed cert</div>
                          </div>
                          <div class="ioc-indicator ind-amber"></div>
                        </div>

                        <div class="ioc-source-row">
                          <div class="ioc-source-icon src-misp">&#x1F578;&#xFE0F;</div>
                          <div class="ioc-source-body">
                            <div class="ioc-source-name">MISP</div>
                            <div class="ioc-source-value"><strong style="color:#ff6b6b;">3 matching events</strong> (ransomware-related)</div>
                          </div>
                          <div class="ioc-indicator ind-red"></div>
                        </div>

                        <div class="ioc-source-row">
                          <div class="ioc-source-icon src-tfox">&#x1F98A;</div>
                          <div class="ioc-source-body">
                            <div class="ioc-source-name">ThreatFox</div>
                            <div class="ioc-source-value"><strong style="color:#ff6b6b;">LockBit 3.0</strong> C2 infrastructure</div>
                          </div>
                          <div class="ioc-indicator ind-red"></div>
                        </div>

                        <div class="ioc-source-row">
                          <div class="ioc-source-icon src-dns">&#x1F310;</div>
                          <div class="ioc-source-body">
                            <div class="ioc-source-name">Passive DNS</div>
                            <div class="ioc-source-value mono">dynserv[.]net</div>
                          </div>
                          <div class="ioc-indicator ind-amber"></div>
                        </div>

                        <div class="ioc-source-row">
                          <div class="ioc-source-icon src-geo">&#x1F4CD;</div>
                          <div class="ioc-source-body">
                            <div class="ioc-source-name">Geolocation</div>
                            <div class="ioc-source-value">Frankfurt, DE Â· <span class="mono">AS24940 Hetzner</span></div>
                          </div>
                          <div class="ioc-indicator ind-cyan"></div>
                        </div>

                        <div class="ioc-source-row">
                          <div class="ioc-source-icon src-vt">&#x23F1;&#xFE0F;</div>
                          <div class="ioc-source-body">
                            <div class="ioc-source-name">Timeline</div>
                            <div class="ioc-source-value mono">First: 2025-11-14 Â· Last: 2026-02-27</div>
                          </div>
                          <div class="ioc-indicator ind-amber"></div>
                        </div>
                      </div>

                      <!-- MITRE Row -->
                      <div class="ioc-mitre-row">
                        <div class="ioc-mitre-label">MITRE ATT&amp;CK</div>
                        <div style="display:flex;gap:5px;flex-wrap:wrap;">
                          <span class="mitre-tag">T1071.001</span>
                          <span class="mitre-tag">T1573</span>
                          <span class="mitre-tag">T1090</span>
                          <span style="font-size:10.5px;color:var(--text-muted);align-self:center;font-style:italic;">Web Protocol C2 Â· Encrypted Channel Â· Proxy</span>
                        </div>
                      </div>

                      <!-- Related IOCs -->
                      <div class="ioc-related-row">
                        <div class="ioc-related-label">Related IOCs</div>
                        <span class="related-ioc-chip">dynserv[.]net</span>
                        <span class="related-ioc-chip">185.220.101.42</span>
                        <span class="related-ioc-chip">a1b2c3d4e5f6...</span>
                        <span style="font-size:10px;color:var(--text-muted);cursor:pointer;">+7 more â€º</span>
                      </div>

                      <!-- DACTA History -->
                      <div class="ioc-dacta-history">
                        <div class="dacta-hist-icon">&#x1F4CA;</div>
                        <div class="dacta-hist-text">
                          <strong>DACTA History:</strong> This IP was also seen in <strong>WR-2025-017</strong> (NagaWorld, ransomware campaign, Nov 2025) â€” confirmed C2 node. Analyst note: "Blocked at perimeter, no lateral movement confirmed."
                        </div>
                      </div>

                      <!-- Actions -->
                      <div class="ioc-actions">
                        <button class="ioc-action-btn ioc-btn-warroom" onclick="showToast('Added to War Room IOC list')">&#x2B50; Add to War Room</button>
                        <button class="ioc-action-btn ioc-btn-block" onclick="showToast('Block rule queued for review')">&#x1F6AB; Block at Firewall</button>
                        <button class="ioc-action-btn ioc-btn-siem" onclick="showToast('Searching NagaWorld SIEM...')">&#x1F50E; Search in Client SIEM</button>
                        <button class="ioc-action-btn ioc-btn-stix" onclick="showToast('Exporting as STIX 2.1...')">&#x1F4E4; Export STIX</button>
                      </div>
                    </div>

                  </div>
                </div>
              </div>

              <!-- MESSAGE 2: Analyst -->
              <div class="msg-row analyst">
                <div class="msg-avatar analyst-av">&#x1F464;</div>
                <div class="msg-content">
                  <div class="msg-meta">
                    <span class="msg-sender">J. Lim (Analyst)</span>
                    <span>14:34:22 SGT</span>
                  </div>
                  <div class="msg-bubble-analyst">Show me all failed RDP logins to NW-DC-01 in the last 48 hours</div>
                </div>
              </div>

              <!-- MESSAGE 2: Copilot Response â€” KQL -->
              <div class="msg-row">
                <div class="msg-avatar copilot-av">&#x1F916;</div>
                <div class="msg-content" style="max-width:95%;">
                  <div class="msg-meta">
                    <span class="msg-sender">DACTA Copilot</span>
                    <span>14:34:24 SGT Â· 2.1s</span>
                    <span class="badge badge-cyan" style="font-size:9px;padding:1px 5px;">LOG SEARCH</span>
                  </div>
                  <div class="msg-bubble-copilot">
                    <div class="kql-response">
                      <div style="font-size:12.5px;color:var(--text-secondary);line-height:1.5;margin-bottom:4px;">
                        Generated KQL query for <strong style="color:var(--text-primary);">Elastic SIEM (NagaWorld)</strong> targeting failed RDP authentication events on <strong style="color:var(--cyan);font-family:var(--font-mono);">NW-DC-01</strong> over the last 48 hours:
                      </div>

                      <!-- KQL Code Block -->
                      <div class="kql-block">
                        <div class="kql-block-header">
                          <span class="kql-lang-badge">KQL Â· Elastic SIEM</span>
                          <button class="kql-copy-btn" onclick="showToast('Query copied to clipboard')">&#x1F4CB; Copy</button>
                        </div>
                        <pre><span class="cmt">// Failed RDP logins â€” NW-DC-01 â€” last 48h</span>
<span class="kw">event.code</span> : <span class="str">"4625"</span>
  <span class="op">AND</span> <span class="kw">winlog.event_data.LogonType</span> : <span class="str">"10"</span>
  <span class="op">AND</span> <span class="kw">host.name</span> : <span class="str">"NW-DC-01"</span>
  <span class="op">AND</span> <span class="kw">@timestamp</span> &gt;= <span class="fn">now()</span><span class="op">-</span><span class="num">48h</span>
  <span class="op">AND</span> <span class="kw">winlog.event_data.Status</span> : (<span class="str">"0xC000006D"</span> <span class="op">OR</span> <span class="str">"0xC0000064"</span> <span class="op">OR</span> <span class="str">"0xC000006A"</span>)
<span class="op">|</span> <span class="fn">stats</span> count() <span class="kw">as</span> event_count,
         <span class="fn">values</span>(<span class="kw">winlog.event_data.TargetUserName</span>) <span class="kw">as</span> attempted_users
  <span class="kw">by</span> <span class="kw">source.ip</span>
<span class="op">|</span> <span class="fn">sort</span> event_count <span class="op">desc</span></pre>
                      </div>

                      <!-- Plain English Explanation -->
                      <div class="kql-explanation">
                        <span style="font-size:16px;flex-shrink:0;">&#x1F4A1;</span>
                        <div>
                          Searching for Windows Security Event 4625 (logon failure) with Logon Type 10 (RemoteInteractive/RDP) against NW-DC-01, filtered by known failure status codes for bad credentials. Results grouped by source IP and sorted by frequency.
                        </div>
                      </div>

                      <!-- Results Table -->
                      <div class="kql-results-table">
                        <div class="kql-results-header">
                          <div class="kql-results-count"><strong>147</strong> events from <strong style="color:var(--amber);">12</strong> unique source IPs</div>
                          <div class="kql-results-meta">&#x1F4C5; 2026-02-26 14:34 â€“ 2026-02-28 14:34 SGT</div>
                        </div>
                        <table class="kql-table">
                          <thead>
                            <tr>
                              <th>Source IP</th>
                              <th>Attempts</th>
                              <th>Attempted Usernames</th>
                              <th>Last Seen</th>
                              <th>Status</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr class="kql-highlight-row">
                              <td class="mono suspicious">185.220.101.34</td>
                              <td class="suspicious">43</td>
                              <td class="mono" style="font-size:10px;">administrator, admin, svc_backup</td>
                              <td class="mono" style="font-size:10px;">14:31:52</td>
                              <td><span class="badge badge-red" style="font-size:9px;">&#x26A0; KNOWN C2</span></td>
                            </tr>
                            <tr class="kql-highlight-row">
                              <td class="mono suspicious">91.240.118.207</td>
                              <td class="suspicious">31</td>
                              <td class="mono" style="font-size:10px;">administrator, nwdomain\admin</td>
                              <td class="mono" style="font-size:10px;">13:58:11</td>
                              <td><span class="badge badge-amber" style="font-size:9px;">SUSPICIOUS</span></td>
                            </tr>
                            <tr class="kql-highlight-row">
                              <td class="mono suspicious">45.141.152.18</td>
                              <td class="suspicious">28</td>
                              <td class="mono" style="font-size:10px;">guest, test, administrator</td>
                              <td class="mono" style="font-size:10px;">11:22:44</td>
                              <td><span class="badge badge-amber" style="font-size:9px;">SUSPICIOUS</span></td>
                            </tr>
                            <tr>
                              <td class="mono">203.0.113.55</td>
                              <td>12</td>
                              <td class="mono" style="font-size:10px;">nw_svc_user</td>
                              <td class="mono" style="font-size:10px;">09:14:03</td>
                              <td><span class="badge badge-blue" style="font-size:9px;">REVIEW</span></td>
                            </tr>
                            <tr>
                              <td colspan="5" style="text-align:center;color:var(--text-muted);font-size:11px;padding:8px;font-style:italic;">
                                + 8 more source IPs with &lt; 8 attempts each
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>

                      <!-- Suggestion -->
                      <div class="kql-suggestion">
                        <span style="font-size:14px;">&#x1F916;</span>
                        <span>3 suspicious IPs have &gt;20 attempts. Want me to enrich all three and check for prior IOC history?</span>
                        <button class="kql-suggestion-btn" onclick="showToast('Enriching 3 IPs...')">Enrich All 3 â€º</button>
                      </div>

                    </div>
                  </div>
                </div>
              </div>

              <!-- MESSAGE 3: Analyst -->
              <div class="msg-row analyst">
                <div class="msg-avatar analyst-av">&#x1F464;</div>
                <div class="msg-content">
                  <div class="msg-meta">
                    <span class="msg-sender">J. Lim (Analyst)</span>
                    <span>14:36:48 SGT</span>
                  </div>
                  <div class="msg-bubble-analyst">What is T1053.005?</div>
                </div>
              </div>

              <!-- MESSAGE 3: Copilot Response â€” MITRE -->
              <div class="msg-row">
                <div class="msg-avatar copilot-av">&#x1F916;</div>
                <div class="msg-content" style="max-width:95%;">
                  <div class="msg-meta">
                    <span class="msg-sender">DACTA Copilot</span>
                    <span>14:36:49 SGT Â· 0.9s</span>
                    <span class="badge badge-purple" style="font-size:9px;padding:1px 5px;">MITRE ATT&amp;CK</span>
                  </div>
                  <div class="msg-bubble-copilot">
                    <div style="font-size:12.5px;color:var(--text-secondary);line-height:1.5;margin-bottom:10px;">
                      Technique found in the MITRE ATT&amp;CK knowledge base. This technique is <strong style="color:var(--amber);">relevant to the current investigation context</strong> â€” commonly used by LockBit 3.0 for persistence.
                    </div>

                    <!-- MITRE Card -->
                    <div class="mitre-card">
                      <div class="mitre-card-header">
                        <div>
                          <div class="mitre-technique-id">T1053.005</div>
                          <div class="mitre-technique-name">Scheduled Task / Job: Scheduled Task</div>
                          <div class="mitre-tactic-badges">
                            <span class="mitre-tactic-badge">Persistence</span>
                            <span class="mitre-tactic-badge">Execution</span>
                            <span class="mitre-tactic-badge">Privilege Escalation</span>
                          </div>
                        </div>
                        <div style="text-align:right;flex-shrink:0;">
                          <div style="font-size:10px;color:var(--text-muted);">ATT&amp;CK v14</div>
                          <div style="font-size:10px;color:var(--text-muted);margin-top:2px;">Sub-technique of T1053</div>
                          <div style="margin-top:6px;"><span class="badge badge-amber" style="font-size:10px;">Medium Prevalence</span></div>
                        </div>
                      </div>

                      <div class="mitre-card-body">
                        <div class="mitre-desc">
                          Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows: <span style="font-family:var(--font-mono);font-size:11px;color:var(--cyan);">schtasks /create</span>, the Task Scheduler GUI (<span style="font-family:var(--font-mono);font-size:11px;color:var(--cyan);">taskschd.msc</span>), or Windows Management Instrumentation (WMI). Scheduled tasks can also be set to execute code remotely from a UNC path.
                        </div>

                        <div class="mitre-detection-section">
                          <div class="mitre-section-label">&#x1F50D; Detection Methods</div>
                          <ul class="mitre-detection-list">
                            <li>Monitor for <span style="font-family:var(--font-mono);color:var(--green);">schtasks.exe</span> creation with unusual parameters or parent processes</li>
                            <li>Windows Event IDs <span style="font-family:var(--font-mono);color:var(--green);">4698, 4699, 4700, 4701, 4702</span> (scheduled task lifecycle events)</li>
                            <li>Monitor <span style="font-family:var(--font-mono);color:var(--green);">\Windows\System32\Tasks\</span> directory for unexpected XML files</li>
                            <li>Look for tasks with encoded payloads or PowerShell download cradles</li>
                          </ul>
                        </div>

                        <div class="mitre-related-section">
                          <span class="mitre-related-label">Related:</span>
                          <span class="mitre-related-tag">T1053</span>
                          <span class="mitre-related-tag">T1547.001</span>
                          <span class="mitre-related-tag">T1569.002</span>
                          <span class="mitre-related-tag">T1059.001</span>
                        </div>
                      </div>

                      <div class="mitre-card-actions">
                        <button class="mitre-action-btn mitre-btn-search" onclick="showToast('Searching for T1053.005 indicators in NagaWorld SIEM...')">
                          &#x1F50E; Hunt in NagaWorld SIEM
                        </button>
                        <button class="mitre-action-btn mitre-btn-rule" onclick="showToast('Generating detection rule for T1053.005...')">
                          &#x1F6E1; Generate Detection Rule
                        </button>
                        <button class="mitre-action-btn" style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.25);color:#a78bfa;" onclick="showToast('Opening MITRE ATT&CK Navigator...')">
                          &#x1F5FA;&#xFE0F; ATT&amp;CK Navigator
                        </button>
                      </div>
                    </div>

                  </div>
                </div>
              </div>

            </div><!-- end copilot-messages -->

            <!-- Saved Searches -->
            <div class="copilot-saved-searches collapsed" id="copilotSavedSearches">
              <div class="saved-searches-toggle" onclick="toggleSavedSearches()">
                <span>&#x1F4BE; Saved Search Templates</span>
                <span class="saved-searches-chevron">&#x25BE;</span>
              </div>
              <div class="saved-searches-list">
                <div class="saved-search-chip" onclick="insertSavedSearch('Brute Force Detection')">
                  &#x1F4A5; Brute Force Detection
                  <span class="search-chip-lang">KQL</span>
                </div>
                <div class="saved-search-chip" onclick="insertSavedSearch('Lateral Movement Hunt')">
                  &#x27A1;&#xFE0F; Lateral Movement Hunt
                  <span class="search-chip-lang">KQL</span>
                </div>
                <div class="saved-search-chip" onclick="insertSavedSearch('Phishing Email Analysis')">
                  &#x1F41F; Phishing Email Analysis
                  <span class="search-chip-lang">M365 KQL</span>
                </div>
                <div class="saved-search-chip" onclick="insertSavedSearch('Ransomware Indicators')">
                  &#x1F480; Ransomware Indicators
                  <span class="search-chip-lang">Sigma</span>
                </div>
                <div class="saved-search-chip" onclick="insertSavedSearch('Scheduled Task Creation')">
                  &#x23F0; Scheduled Task Creation
                  <span class="search-chip-lang">KQL</span>
                </div>
                <div class="saved-search-chip" onclick="insertSavedSearch('PowerShell Encoded Payloads')">
                  &#x1F4DC; PowerShell Encoded
                  <span class="search-chip-lang">KQL</span>
                </div>
              </div>
            </div>

            <!-- Input Area -->
            <div class="copilot-input-area">
              <div class="copilot-input-modes">
                <button class="copilot-mode-btn active" id="modeNL" onclick="switchMode('nl')">Natural Language</button>
                <span class="copilot-mode-sep">|</span>
                <button class="copilot-mode-btn" id="modeRaw" onclick="switchMode('raw')">Raw Query</button>
                <span class="copilot-mode-sep">|</span>
                <button class="copilot-mode-btn" id="modeGuided" onclick="switchMode('guided')">Guided Builder</button>
              </div>
              <div class="copilot-input-row">
                <select class="copilot-org-select">
                  <option>&#x1F3E2; NagaWorld</option>
                  <option>&#x1F3E2; Dacta Global</option>
                  <option>&#x1F3E2; Client Alpha</option>
                  <option>&#x1F3E2; Client Beta</option>
                </select>
                <textarea class="copilot-text-input" id="copilotInput" placeholder="Ask the Copilot anything... e.g. 'Check IP 8.8.8.8', 'Show me failed logins', 'What is T1059?'" rows="1" onkeydown="copilotInputKeydown(event)"></textarea>
                <button class="copilot-send-btn" onclick="copilotSend()">&#x27A4;</button>
              </div>
            </div>

          </div><!-- end copilot-conversation -->

          <!-- Right: Context Panel -->
          <div class="copilot-context-panel">

            <!-- Active Investigation Context -->
            <div class="ctx-card">
              <div class="ctx-card-header">
                &#x1F4CB; Active Context
                <span style="font-size:10px;color:var(--green);cursor:pointer;">&#x270F;&#xFE0F;</span>
              </div>
              <div class="ctx-card-body">
                <div class="ctx-row">
                  <span class="ctx-label">Client</span>
                  <span class="ctx-value cyan">NagaWorld</span>
                </div>
                <div class="ctx-row">
                  <span class="ctx-label">Ticket</span>
                  <span class="ctx-value mono amber" style="cursor:pointer;" onclick="navigate('investigation')">TKT-847 â†—</span>
                </div>
                <div class="ctx-row">
                  <span class="ctx-label">War Room</span>
                  <span class="ctx-value mono" style="cursor:pointer;color:var(--purple);" onclick="navigate('warroom')">WR-2026-003 â†—</span>
                </div>
                <div class="ctx-divider"></div>
                <div class="ctx-row">
                  <span class="ctx-label">Priority</span>
                  <span class="badge badge-p1" style="font-size:9px;">P1 CRITICAL</span>
                </div>
                <div class="ctx-row">
                  <span class="ctx-label">Analyst</span>
                  <span class="ctx-value">J. Lim</span>
                </div>
                <div class="ctx-row">
                  <span class="ctx-label">SLA</span>
                  <span class="ctx-value" style="color:var(--red-bright);font-family:var(--font-mono);font-weight:700;">01:47 left</span>
                </div>
              </div>
            </div>

            <!-- Connected Data Sources -->
            <div class="ctx-card">
              <div class="ctx-card-header">
                &#x1F9F0; Data Sources
                <span style="color:var(--green);font-size:10px;">6/6 Active</span>
              </div>
              <div class="ctx-card-body" style="gap:3px;">
                <div class="ds-item">
                  <div class="ds-icon" style="background:rgba(0,212,255,0.1);border:1px solid rgba(0,212,255,0.2);">&#x1F9F2;</div>
                  <span class="ds-name">Elastic SIEM</span>
                  <div class="ds-status connected-txt"><div class="ds-dot connected"></div>Live</div>
                </div>
                <div class="ds-item">
                  <div class="ds-icon" style="background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.2);">&#x1F6E1;</div>
                  <span class="ds-name">Trend Vision One</span>
                  <div class="ds-status connected-txt"><div class="ds-dot connected"></div>Live</div>
                </div>
                <div class="ds-item">
                  <div class="ds-icon" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.2);">&#x1F9EA;</div>
                  <span class="ds-name">VirusTotal</span>
                  <div class="ds-status api-txt"><div class="ds-dot api"></div>API</div>
                </div>
                <div class="ds-item">
                  <div class="ds-icon" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.2);">&#x1F6A8;</div>
                  <span class="ds-name">AbuseIPDB</span>
                  <div class="ds-status api-txt"><div class="ds-dot api"></div>API</div>
                </div>
                <div class="ds-item">
                  <div class="ds-icon" style="background:rgba(59,130,246,0.1);border:1px solid rgba(59,130,246,0.2);">&#x1F465;</div>
                  <span class="ds-name">Active Directory</span>
                  <div class="ds-status connected-txt"><div class="ds-dot connected"></div>Live</div>
                </div>
                <div class="ds-item">
                  <div class="ds-icon" style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.2);">&#x1F578;&#xFE0F;</div>
                  <span class="ds-name">MISP</span>
                  <div class="ds-status connected-txt"><div class="ds-dot connected"></div>Live</div>
                </div>
              </div>
            </div>

            <!-- Recent IOCs -->
            <div class="ctx-card">
              <div class="ctx-card-header">
                &#x1F52C; Recent IOCs
                <span style="font-size:10px;color:var(--cyan);cursor:pointer;">View All</span>
              </div>
              <div class="ctx-card-body" style="gap:3px;">
                <div class="recent-ioc-item">
                  <div class="recent-ioc-type ioc-type-ip">IP</div>
                  <span class="recent-ioc-value">185.220.101.34</span>
                  <span class="recent-ioc-verdict verdict-mal">MAL</span>
                </div>
                <div class="recent-ioc-item">
                  <div class="recent-ioc-type ioc-type-ip">IP</div>
                  <span class="recent-ioc-value">91.240.118.207</span>
                  <span class="recent-ioc-verdict verdict-sus">SUS</span>
                </div>
                <div class="recent-ioc-item">
                  <div class="recent-ioc-type ioc-type-ip">IP</div>
                  <span class="recent-ioc-value">45.141.152.18</span>
                  <span class="recent-ioc-verdict verdict-sus">SUS</span>
                </div>
                <div class="recent-ioc-item">
                  <div class="recent-ioc-type ioc-type-domain">DOM</div>
                  <span class="recent-ioc-value">dynserv[.]net</span>
                  <span class="recent-ioc-verdict verdict-mal">MAL</span>
                </div>
                <div class="recent-ioc-item">
                  <div class="recent-ioc-type ioc-type-hash">HSH</div>
                  <span class="recent-ioc-value">a1b2c3d4e5f6...</span>
                  <span class="recent-ioc-verdict verdict-mal">MAL</span>
                </div>
              </div>
            </div>

            <!-- Quick Actions -->
            <div class="ctx-card">
              <div class="ctx-card-header">&#x26A1; Quick Actions</div>
              <div class="ctx-card-body" style="gap:5px;">
                <button class="quick-action-btn" onclick="showToast('Opening War Room...'); navigate('warroom')">
                  <span class="quick-action-icon">&#x2694;&#xFE0F;</span> Open War Room WR-2026-003
                </button>
                <button class="quick-action-btn" onclick="showToast('Generating incident summary...')">
                  <span class="quick-action-icon">&#x1F4DD;</span> Generate Incident Summary
                </button>
                <button class="quick-action-btn" onclick="showToast('Exporting all IOCs as STIX 2.1...')">
                  <span class="quick-action-icon">&#x1F4E4;</span> Export Session IOCs
                </button>
                <button class="quick-action-btn" onclick="showToast('Drafting client notification...')">
                  <span class="quick-action-icon">&#x1F4E7;</span> Draft Client Notification
                </button>
                <button class="quick-action-btn" onclick="showToast('Loading playbook: Ransomware Response...')">
                  <span class="quick-action-icon">&#x1F4DA;</span> Open Ransomware Playbook
                </button>
              </div>
            </div>

          </div><!-- end copilot-context-panel -->

        </div><!-- end copilot-body -->

      </div><!-- end page-copilot -->

      <!-- ============================================================
           COMMAND BAR OVERLAY
           ============================================================ -->
      <div class="copilot-cmdbar-overlay" id="copilotCmdOverlay" onclick="closeCopilotCmd(event)">
        <div class="copilot-cmdbar" onclick="event.stopPropagation()">
          <div class="cmdbar-input-row">
            <span class="cmdbar-icon">&#x1F916;</span>
            <input type="text" class="cmdbar-input" id="cmdbarInput" placeholder="Search IPs, domains, hashes, tickets, techniques..." autocomplete="off" oninput="updateCmdBar(this.value)">
            <span class="cmdbar-esc">ESC</span>
          </div>
          <div class="cmdbar-suggestions" id="cmdbarSuggestions">
            <div class="cmdbar-suggestion-group-label">Quick Actions</div>
            <div class="cmdbar-item selected" onclick="closeCopilotCmd(); copilotAsk('Check IP...')">
              <div class="cmdbar-item-icon">&#x1F6E1;&#xFE0F;</div>
              <span class="cmdbar-item-label">Enrich IOC / Check IP, Domain, Hash</span>
              <span class="cmdbar-item-shortcut">ip: 8.8.8.8</span>
            </div>
            <div class="cmdbar-item" onclick="closeCopilotCmd()">
              <div class="cmdbar-item-icon">&#x1F50D;</div>
              <span class="cmdbar-item-label">Search Logs in SIEM</span>
              <span class="cmdbar-item-shortcut">search: failed logins</span>
            </div>
            <div class="cmdbar-item" onclick="closeCopilotCmd()">
              <div class="cmdbar-item-icon">&#x1F5FA;&#xFE0F;</div>
              <span class="cmdbar-item-label">MITRE Technique Lookup</span>
              <span class="cmdbar-item-shortcut">t: T1059</span>
            </div>
            <div class="cmdbar-item" onclick="closeCopilotCmd()">
              <div class="cmdbar-item-icon">&#x1F5A5;&#xFE0F;</div>
              <span class="cmdbar-item-label">Asset / User Lookup</span>
              <span class="cmdbar-item-shortcut">host: NW-DC-01</span>
            </div>
            <div class="cmdbar-suggestion-group-label" style="margin-top:4px;">Navigation</div>
            <div class="cmdbar-item" onclick="closeCopilotCmd(); navigate('warroom')">
              <div class="cmdbar-item-icon">&#x2694;&#xFE0F;</div>
              <span class="cmdbar-item-label">Go to War Room</span>
            </div>
            <div class="cmdbar-item" onclick="closeCopilotCmd(); navigate('investigation')">
              <div class="cmdbar-item-icon">&#x1F50D;</div>
              <span class="cmdbar-item-label">Go to Investigation Workspace</span>
            </div>
            <div class="cmdbar-item" onclick="closeCopilotCmd(); navigate('triage')">
              <div class="cmdbar-item-icon">&#x26A1;</div>
              <span class="cmdbar-item-label">Go to Triage Queue</span>
            </div>
          </div>
          <div class="cmdbar-footer">
            <span><kbd>â†‘â†“</kbd> navigate</span>
            <span><kbd>â†µ</kbd> select</span>
            <span><kbd>ESC</kbd> close</span>
            <span><kbd>@</kbd> mention IOC</span>
            <span><kbd>t:</kbd> technique</span>
          </div>
        </div>
      </div>

    </div><!-- end content-area -->
  </div><!-- end main -->
</div><!-- end app -->

<!-- Entity Drill-Down Panel -->
<div class="entity-panel-backdrop" id="entityPanelBackdrop" onclick="closeEntityPanel()"></div>
<div class="entity-panel" id="entityPanel">
  <div class="entity-panel-header">
    <div class="entity-panel-icon" id="epIcon">ðŸ–¥</div>
    <div class="entity-panel-title-wrap">
      <div class="entity-panel-name" id="epName">DACTASG-WS-047</div>
      <div class="entity-panel-type" id="epType">Workstation</div>
    </div>
    <div class="entity-panel-risk risk-red" id="epRisk" style="--risk-pct:94">
      <div class="entity-panel-risk-inner"><span id="epRiskVal">94</span></div>
    </div>
    <div class="entity-panel-close" onclick="closeEntityPanel()">âœ•</div>
  </div>
  <div class="entity-panel-timerange">
    <button class="active" onclick="setEntityTimeRange(this)">Last 24h</button>
    <button onclick="setEntityTimeRange(this)">7d</button>
    <button onclick="setEntityTimeRange(this)">30d</button>
    <button onclick="setEntityTimeRange(this)">Custom</button>
  </div>
  <!-- Drill-down to Entity Explorer -->
  <div style="padding:0 16px 8px;">
    <button id="epExploreBtn" onclick="drillToEntityExplorer()" style="width:100%;padding:8px 12px;background:linear-gradient(135deg,rgba(0,212,255,0.1),rgba(139,92,246,0.1));border:1px solid rgba(0,212,255,0.25);border-radius:7px;color:var(--cyan);font-size:11px;font-weight:600;font-family:var(--font-display);cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all 0.2s;letter-spacing:0.03em;">
      <span style="font-size:14px;">&#x1F50D;</span> Explore in Entity Explorer
      <span style="font-size:12px;opacity:0.6;">&#x2192;</span>
    </button>
  </div>
  <div class="entity-panel-body">

    <!-- Entity Profile -->
    <div>
      <div class="ep-section-title">Entity Profile</div>
      <div class="ep-profile-grid">
        <div class="ep-profile-item"><div class="ep-profile-label">Hostname</div><div class="ep-profile-value">DACTASG-WS-047</div></div>
        <div class="ep-profile-item"><div class="ep-profile-label">IP Address</div><div class="ep-profile-value mono">10.0.4.47</div></div>
        <div class="ep-profile-item"><div class="ep-profile-label">MAC Address</div><div class="ep-profile-value mono">5C:E0:C5:A1:34:7B</div></div>
        <div class="ep-profile-item"><div class="ep-profile-label">OS</div><div class="ep-profile-value">Windows 11 Pro (23H2)</div></div>
        <div class="ep-profile-item"><div class="ep-profile-label">Department</div><div class="ep-profile-value">Finance</div></div>
        <div class="ep-profile-item"><div class="ep-profile-label">Primary User</div><div class="ep-profile-value" style="font-size:10px;">john.santos@dactaglobal.com</div></div>
        <div class="ep-profile-item"><div class="ep-profile-label">Elastic Agent</div><div class="ep-profile-value">8.12 Â· <span style="color:var(--green);">Healthy</span></div></div>
        <div class="ep-profile-item"><div class="ep-profile-label">Last Boot</div><div class="ep-profile-value mono">2026-02-27 07:42 SGT</div></div>
        <div class="ep-profile-item" style="grid-column:span 2;"><div class="ep-profile-label">Domain</div><div class="ep-profile-value">dactaglobal.local</div></div>
      </div>
    </div>

    <!-- Risk Timeline -->
    <div>
      <div class="ep-section-title">Risk Timeline (7 Days)</div>
      <div class="ep-risk-chart" id="epRiskChart">
        <div class="ep-risk-bar-wrap">
          <div class="ep-risk-bar"><div class="ep-risk-bar-fill green" style="height:12%;"></div><div class="ep-risk-bar-value">12</div></div>
          <div class="ep-risk-bar-label">Mon</div>
        </div>
        <div class="ep-risk-bar-wrap">
          <div class="ep-risk-bar"><div class="ep-risk-bar-fill green" style="height:15%;"></div><div class="ep-risk-bar-value">15</div></div>
          <div class="ep-risk-bar-label">Tue</div>
        </div>
        <div class="ep-risk-bar-wrap">
          <div class="ep-risk-bar"><div class="ep-risk-bar-fill green" style="height:14%;"></div><div class="ep-risk-bar-value">14</div></div>
          <div class="ep-risk-bar-label">Wed</div>
        </div>
        <div class="ep-risk-bar-wrap">
          <div class="ep-risk-bar"><div class="ep-risk-bar-fill green" style="height:22%;"></div><div class="ep-risk-bar-value">22</div></div>
          <div class="ep-risk-bar-label">Thu</div>
        </div>
        <div class="ep-risk-bar-wrap">
          <div class="ep-risk-bar"><div class="ep-risk-bar-fill amber" style="height:35%;"></div><div class="ep-risk-bar-value">35</div></div>
          <div class="ep-risk-bar-label">Fri</div>
        </div>
        <div class="ep-risk-bar-wrap">
          <div class="ep-risk-bar"><div class="ep-risk-bar-fill red" style="height:78%;"></div><div class="ep-risk-bar-value">78</div></div>
          <div class="ep-risk-bar-label">Sat</div>
        </div>
        <div class="ep-risk-bar-wrap">
          <div class="ep-risk-bar"><div class="ep-risk-bar-fill red" style="height:94%;"></div><div class="ep-risk-bar-value">94</div></div>
          <div class="ep-risk-bar-label" style="color:var(--red);font-weight:700;">Today</div>
        </div>
      </div>
    </div>

    <!-- Activity Timeline -->
    <div>
      <div class="ep-section-title">Activity Timeline (24h)</div>
      <div class="ep-timeline">
        <div class="ep-timeline-item" onclick="this.classList.toggle('expanded')">
          <div class="ep-timeline-time">13:21:44</div>
          <div class="ep-timeline-dot red"></div>
          <div class="ep-timeline-content">
            <div class="ep-timeline-title">ðŸ”´ ALERT â€” Potential Ransomware Activity (DAC-18158)</div>
            <div class="ep-timeline-desc">847 files renamed (.docxâ†’.enc, .xlsxâ†’.enc) Â· Process: svchost.exe via powershell.exe</div>
            <div class="ep-timeline-detail">rule_name: Potential.Ransomware.File.Rename<br>process: svchost.exe (PID 7842)<br>parent: powershell.exe (PID 4821)<br>file_count: 847<br>rate: 19.7 files/sec<br>extensions: .docxâ†’.enc, .xlsxâ†’.enc, .pdfâ†’.enc<br>risk_score: 92 â†’ 94 (adjusted)</div>
          </div>
        </div>
        <div class="ep-timeline-item" onclick="this.classList.toggle('expanded')">
          <div class="ep-timeline-time">13:09:31</div>
          <div class="ep-timeline-dot amber"></div>
          <div class="ep-timeline-content">
            <div class="ep-timeline-title">ðŸŸ¡ ALERT â€” Unusual Host Communication (DAC-18157)</div>
            <div class="ep-timeline-desc">ADMIN$ share access to 4 hosts Â· User: john.santos (Domain Admin)</div>
            <div class="ep-timeline-detail">target_hosts: DACTASG-WS-012, DACTASG-WS-023, DACTASG-WS-031, DACTASG-WS-044<br>share: ADMIN$<br>protocol: SMB (445/TCP)<br>user: john.santos@dactaglobal.com<br>privilege: Domain Admin<br>duration: 3m 12s</div>
          </div>
        </div>
        <div class="ep-timeline-item" onclick="this.classList.toggle('expanded')">
          <div class="ep-timeline-time">12:58:17</div>
          <div class="ep-timeline-dot gray"></div>
          <div class="ep-timeline-content">
            <div class="ep-timeline-title">âšª EVENT â€” New process execution</div>
            <div class="ep-timeline-desc">powershell.exe -EncodedCommand [base64] Â· Parent: explorer.exe</div>
            <div class="ep-timeline-detail">process: powershell.exe (PID 4821)<br>cmdline: powershell.exe -EncodedCommand UwB0AGEAcgB0AC0A...<br>parent: explorer.exe (PID 2104)<br>user: john.santos<br>integrity_level: High</div>
          </div>
        </div>
        <div class="ep-timeline-item" onclick="this.classList.toggle('expanded')">
          <div class="ep-timeline-time">12:45:03</div>
          <div class="ep-timeline-dot gray"></div>
          <div class="ep-timeline-content">
            <div class="ep-timeline-title">âšª EVENT â€” File download</div>
            <div class="ep-timeline-desc">svcupdate.ps1 downloaded via Edge Â· Source: hxxps://update-service[.]net/pkg</div>
            <div class="ep-timeline-detail">browser: msedge.exe<br>url: hxxps://update-service[.]net/pkg/svcupdate.ps1<br>file: %TEMP%\svcupdate.ps1<br>size: 48.2 KB<br>sha256: a3f4b8c2d9e1f0a7...<br>zone_identifier: 3 (Internet)</div>
          </div>
        </div>
        <div class="ep-timeline-item" onclick="this.classList.toggle('expanded')">
          <div class="ep-timeline-time">12:30:00</div>
          <div class="ep-timeline-dot green"></div>
          <div class="ep-timeline-content">
            <div class="ep-timeline-title">ðŸŸ¢ EVENT â€” User login</div>
            <div class="ep-timeline-desc">john.santos â€” Interactive logon Â· Source IP: 10.0.4.1 (VPN Gateway)</div>
            <div class="ep-timeline-detail">logon_type: 10 (RemoteInteractive)<br>source_ip: 10.0.4.1<br>source_host: VPN-GW-01<br>auth_package: Kerberos<br>session_id: 0x3E7<br>elevated: true</div>
          </div>
        </div>
        <div class="ep-timeline-item" onclick="this.classList.toggle('expanded')">
          <div class="ep-timeline-time">09:15:22</div>
          <div class="ep-timeline-dot gray"></div>
          <div class="ep-timeline-content">
            <div class="ep-timeline-title">âšª EVENT â€” Elastic Agent check-in</div>
            <div class="ep-timeline-desc">Status: Healthy Â· Policy: Finance-Default</div>
            <div class="ep-timeline-detail">agent_version: 8.12.0<br>policy: Finance-Default (v4.2)<br>status: Healthy<br>cpu_usage: 2.1%<br>memory: 148 MB<br>last_policy_update: 2026-02-27 08:00:00</div>
          </div>
        </div>
        <div class="ep-timeline-item" onclick="this.classList.toggle('expanded')">
          <div class="ep-timeline-time">07:42:08</div>
          <div class="ep-timeline-dot green"></div>
          <div class="ep-timeline-content">
            <div class="ep-timeline-title">ðŸŸ¢ EVENT â€” System boot</div>
            <div class="ep-timeline-desc">Clean boot Â· Uptime: 5h 39m at time of incident</div>
            <div class="ep-timeline-detail">boot_type: Normal<br>secure_boot: Enabled<br>tpm: 2.0 (Healthy)<br>bitlocker: Enabled (C:)<br>boot_duration: 18s<br>startup_items: 12 (all verified)</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Connected Entities -->
    <div>
      <div class="ep-section-title">Connected Entities</div>
      <div class="ep-connections">
        <div class="ep-connection">
          <span class="ep-connection-dir">â†’</span>
          <div><div class="ep-connection-host">10.0.4.12 (DACTASG-WS-012)</div><div class="ep-connection-detail">ADMIN$ access Â· 13:09</div></div>
          <div class="ep-connection-risk amber"></div>
        </div>
        <div class="ep-connection">
          <span class="ep-connection-dir">â†’</span>
          <div><div class="ep-connection-host">10.0.4.23 (DACTASG-WS-023)</div><div class="ep-connection-detail">ADMIN$ access Â· 13:10</div></div>
          <div class="ep-connection-risk amber"></div>
        </div>
        <div class="ep-connection">
          <span class="ep-connection-dir">â†’</span>
          <div><div class="ep-connection-host">10.0.4.31 (DACTASG-WS-031)</div><div class="ep-connection-detail">ADMIN$ access Â· 13:11</div></div>
          <div class="ep-connection-risk amber"></div>
        </div>
        <div class="ep-connection">
          <span class="ep-connection-dir">â†’</span>
          <div><div class="ep-connection-host">10.0.4.44 (DACTASG-WS-044)</div><div class="ep-connection-detail">ADMIN$ access Â· 13:12</div></div>
          <div class="ep-connection-risk amber"></div>
        </div>
        <div class="ep-connection">
          <span class="ep-connection-dir">â†’</span>
          <div><div class="ep-connection-host">10.0.1.5 (DACTASG-DC-01)</div><div class="ep-connection-detail">Kerberos auth Â· 12:30</div></div>
          <div class="ep-connection-risk green"></div>
        </div>
        <div class="ep-connection">
          <span class="ep-connection-dir">â†</span>
          <div><div class="ep-connection-host">10.0.4.1 (VPN Gateway)</div><div class="ep-connection-detail">VPN session Â· 12:30</div></div>
          <div class="ep-connection-risk green"></div>
        </div>
      </div>
    </div>

    <!-- Associated Alerts -->
    <div>
      <div class="ep-section-title">Associated Alerts</div>
      <div class="ep-alerts">
        <div class="ep-alert-item">
          <span class="ep-alert-id">DAC-18158</span>
          <span class="badge badge-p1" style="font-size:9px;">P1</span>
          <span class="ep-alert-title">Ransomware Activity</span>
          <span class="ep-alert-status active">ACTIVE</span>
        </div>
        <div class="ep-alert-item">
          <span class="ep-alert-id">DAC-18157</span>
          <span class="badge badge-p2" style="font-size:9px;">P2</span>
          <span class="ep-alert-title">Unusual Communication</span>
          <span class="ep-alert-status investigating">INVESTIGATING</span>
        </div>
        <div class="ep-alert-item">
          <span class="ep-alert-id">DAC-18101</span>
          <span class="badge badge-p3" style="font-size:9px;">P3</span>
          <span class="ep-alert-title">Failed Auth (7 days ago)</span>
          <span class="ep-alert-status resolved">RESOLVED (FP)</span>
        </div>
      </div>
    </div>

  </div>
</div>


<script>
// ============================================================
//  DATA
// ============================================================
const triageData = [
  { id: 'DAC-18158', priority: 'P1', title: 'Potential Ransomware Activity Detected', org: 'Dacta Global', source: 'Jira', status: 'Investigating', assigned: 'John Lim', created: '13:21', sla: '02:18', slaColor: 'red' },
  { id: 'DAC-18157', priority: 'P2', title: 'Unusual Host Communication with Internal Hosts', org: 'Dacta Global', source: 'Jira', status: 'Open', assigned: 'Sarah Tan', created: '13:09', sla: '28:44', slaColor: 'amber' },
  { id: 'DAC-18138', priority: 'P3', title: 'Suspicious Mailbox Permission Delegation in Exchange Online', org: 'Dacta Global', source: 'Jira', status: 'Open', assigned: 'Marcus Wong', created: '12:48', sla: '47:12', slaColor: 'cyan' },
  { id: 'DAC-18128', priority: 'P3', title: 'O365 Exchange Suspicious Mailbox Right Delegation', org: 'Dacta Global', source: 'Jira', status: 'Open', assigned: 'Unassigned', created: '12:35', sla: '45:55', slaColor: 'cyan' },
  { id: 'DAC-18125', priority: 'P3', title: 'EDR Alert â€” Suspicious Process Execution Score: 42', org: 'Dacta Global', source: 'Jira', status: 'Open', assigned: 'Unassigned', created: '13:02', sla: '47:02', slaColor: 'cyan' },
  { id: 'DAC-18120', priority: 'P3', title: 'Application Control â€” Unauthorized Execution Request', org: 'Naga World', source: 'Jira', status: 'Open', assigned: 'Marcus Wong', created: '12:31', sla: '45:31', slaColor: 'cyan' },
  { id: 'DAC-18112', priority: 'P3', title: 'Endpoint Patch Failure â€” Multiple Hosts', org: 'SPMT', source: 'Jira', status: 'Open', assigned: 'Sarah Tan', created: '11:58', sla: '44:58', slaColor: 'cyan' },
  { id: 'DAC-18108', priority: 'P4', title: 'New Device Enrolled â€” M365 Conditional Access', org: 'ADV Partners', source: 'Jira', status: 'Open', assigned: 'Unassigned', created: '11:30', sla: 'â€”', slaColor: 'gray' },
  { id: 'DAC-18100', priority: 'P3', title: 'Suspicious PowerShell Encoded Command', org: 'Naga World', source: 'Jira', status: 'Escalated', assigned: 'John Lim', created: '10:44', sla: 'BREACHED', slaColor: 'red' },
  { id: 'DAC-18094', priority: 'P2', title: 'Phishing Email Reported by End User', org: 'Naga World', source: 'Jira', status: 'Closed', assigned: 'Sarah Tan', created: '09:15', sla: 'â€”', slaColor: 'gray' },
  { id: 'DAC-18090', priority: 'P3', title: 'Login from Unusual Country â€” Singapore Admin', org: 'Global Advisor Co', source: 'Jira', status: 'Closed', assigned: 'Marcus Wong', created: '08:52', sla: 'â€”', slaColor: 'gray' },
  { id: 'DAC-18085', priority: 'P4', title: 'FortiGate Certificate Expiry Warning â€” 30 days', org: 'SPMT', source: 'Jira', status: 'Closed', assigned: 'Kevin Toh', created: '08:20', sla: 'â€”', slaColor: 'gray' },
];

var rulesData = [];

const logSourcesData = [
  { status: 'green', name: 'Windows Security Events', vendor: 'Microsoft', siem: 'Elastic SIEM', index: 'logs-windows-security-*', org: 'All Clients', eventsDay: '1.2M', volume: '4.8 GB', parse: '99.2%', last: '12s ago' },
  { status: 'green', name: 'Microsoft 365 Unified Audit Log', vendor: 'Microsoft', siem: 'Elastic SIEM', index: 'logs-m365.audit-*', org: 'All Clients', eventsDay: '340K', volume: '1.1 GB', parse: '98.7%', last: '30s ago' },
  { status: 'green', name: 'Trend Vision One Workbench', vendor: 'Trend Micro', siem: 'TV1 API', index: 'tv1-workbench-*', org: 'Dacta Global', eventsDay: '8.4K', volume: '45 MB', parse: '100%', last: '1m ago' },
  { status: 'amber', name: 'FortiGate Firewall (SPMT)', vendor: 'Fortinet', siem: 'Elastic SIEM', index: 'logs-forti.firewall-*', org: 'SPMT', eventsDay: '280K', volume: '920 MB', parse: '94.1%', last: '2m ago' },
  { status: 'green', name: 'Heimdal Endpoint Security', vendor: 'Heimdal', siem: 'Heimdal Cloud', index: 'heimdal-events-*', org: 'All Clients', eventsDay: '62K', volume: '180 MB', parse: '99.8%', last: '15s ago' },
  { status: 'green', name: 'ThreatLocker Audit Log', vendor: 'ThreatLocker', siem: 'Elastic SIEM', index: 'logs-threatlocker-*', org: 'Naga World', eventsDay: '14K', volume: '38 MB', parse: '97.3%', last: '45s ago' },
  { status: 'amber', name: 'FortiGate Firewall (Naga World)', vendor: 'Fortinet', siem: 'Elastic SIEM', index: 'logs-forti.fw-nw-*', org: 'Naga World', eventsDay: '195K', volume: '610 MB', parse: '91.4%', last: '3m ago' },
  { status: 'red', name: 'CCTV Controller Syslog', vendor: 'Dahua', siem: 'Elastic SIEM', index: 'logs-dahua-cctv-*', org: 'Naga World', eventsDay: '0', volume: 'â€”', parse: 'â€”', last: '48h ago' },
  { status: 'green', name: 'Azure AD Sign-in Logs', vendor: 'Microsoft', siem: 'Elastic SIEM', index: 'logs-azure.signinlogs-*', org: 'All Clients', eventsDay: '28K', volume: '92 MB', parse: '99.9%', last: '20s ago' },
  { status: 'amber', name: 'Cisco ASA (ADV Partners)', vendor: 'Cisco', siem: 'Elastic SIEM', index: 'logs-cisco.asa-*', org: 'ADV Partners', eventsDay: '48K', volume: '140 MB', parse: '78.2%', last: '8m ago' },
];

const assetsData = [
  { host: 'DACTASG-WS-047', type: 'Workstation', os: 'Windows 11 Pro', ip: '10.0.4.47', org: 'Dacta Global', risk: 94, agent: 'red', last: '13:21' },
  { host: 'DACTASG-DC-01', type: 'Domain Controller', os: 'Windows Server 2022', ip: '10.0.0.1', org: 'Dacta Global', risk: 22, agent: 'green', last: '2m ago' },
  { host: 'DACTASG-SRV-12', type: 'File Server', os: 'Windows Server 2019', ip: '10.0.1.12', org: 'Dacta Global', risk: 45, agent: 'green', last: '1m ago' },
  { host: 'SPMT-DC-02', type: 'Domain Controller', os: 'Windows Server 2022', ip: '172.16.0.2', org: 'SPMT', risk: 18, agent: 'green', last: '4m ago' },
  { host: 'SPMT-WS-022', type: 'Workstation', os: 'Windows 10 Pro', ip: '172.16.4.22', org: 'SPMT', risk: 61, agent: 'amber', last: '31m ago' },
  { host: 'NW-WS-019', type: 'Workstation', os: 'Windows 11 Pro', ip: '192.168.10.19', org: 'Naga World', risk: 73, agent: 'amber', last: '12m ago' },
  { host: 'NW-SRV-EXCH', type: 'Exchange Server', os: 'Windows Server 2019', ip: '192.168.1.5', org: 'Naga World', risk: 38, agent: 'green', last: '3m ago' },
  { host: 'ADV-WS-011', type: 'Workstation', os: 'macOS 14 Sonoma', ip: '10.10.1.11', org: 'ADV Partners', risk: 12, agent: 'green', last: '7m ago' },
  { host: 'GAC-SRV-APP', type: 'App Server', os: 'Ubuntu 22.04 LTS', ip: '10.20.1.3', org: 'Global Advisor Co', risk: 29, agent: 'green', last: '5m ago' },
  { host: 'DACTASG-WS-031', type: 'Workstation', os: 'Windows 11 Pro', ip: '10.0.4.31', org: 'Dacta Global', risk: 15, agent: 'green', last: '18m ago' },
];

const integrationsData = [
  /* â”€â”€ Core SIEM & ITSM â”€â”€ */
  { name: 'Elastic SIEM', vendor: 'Elastic', icon: 'ðŸ”·', color: '#4fc3f7', connected: true, live: true, version: '8.12.1', alerts: '14 today', uptime: '99.8%', category: 'Core' },
  { name: 'JIRA Service Management', vendor: 'Atlassian', icon: 'ðŸŽ«', color: '#2684ff', connected: true, live: true, version: 'Cloud API v3', alerts: 'Bi-directional sync', uptime: '99.9%', category: 'Core' },
  { name: 'DACTA TIP', vendor: 'Dacta', icon: 'ðŸŒ', color: '#ff7043', connected: true, live: true, version: '2.0.0', alerts: 'IOC sync', uptime: '99.5%', category: 'Core' },
  { name: 'Confluence', vendor: 'Atlassian', icon: 'ðŸ“–', color: '#1868db', connected: false, live: false, version: 'Cloud API v2', alerts: 'KB articles', uptime: '99.9%', category: 'Core', desc: 'Collaborate on security runbooks and knowledge base' },
  /* â”€â”€ Communication & Notifications â”€â”€ */
  { name: 'Microsoft Teams', vendor: 'Microsoft', icon: 'ðŸŸ¦', color: '#5b5fc7', connected: false, live: false, version: 'Graph API v1.0', alerts: 'Client channels', uptime: '99.9%', category: 'Comms', desc: 'Push alert notifications to client Teams channels' },
  { name: 'WhatsApp Business', vendor: 'Meta', icon: 'ðŸ’¬', color: '#25d366', connected: false, live: false, version: 'Cloud API v18.0', alerts: 'Client notifications', uptime: '100%', category: 'Comms', desc: 'Send critical alerts via WhatsApp to client contacts' },
  { name: 'Slack', vendor: 'Slack', icon: 'ðŸ’œ', color: '#e91e63', connected: false, live: false, version: 'Webhook v2', alerts: 'Internal SOC', uptime: '100%', category: 'Comms', desc: 'Internal SOC team notifications and alerts' },
  { name: 'SMS Gateway', vendor: 'Twilio', icon: 'ðŸ“±', color: '#f22f46', connected: false, live: false, version: 'API v2', alerts: 'Alert escalations', uptime: '99.8%', category: 'Comms', desc: 'SMS escalation for P1/P2 incidents' },
  { name: 'Email (SMTP)', vendor: 'AWS SES', icon: 'ðŸ“§', color: '#ff9800', connected: false, live: false, version: 'SES v2', alerts: 'Report delivery', uptime: '99.9%', category: 'Comms', desc: 'Automated email delivery for reports and alerts' },
  /* â”€â”€ Workflow & Ops â”€â”€ */
  { name: 'Microsoft 365', vendor: 'Microsoft', icon: 'â˜', color: '#42a5f5', connected: false, live: false, version: 'Graph API v1.0', alerts: 'Audit logs', uptime: '99.9%', category: 'Workflow', desc: 'Ingest M365 audit logs and security events' },
  { name: 'PagerDuty', vendor: 'PagerDuty', icon: 'ðŸš¨', color: '#06ac38', connected: false, live: false, version: 'Events API v2', alerts: 'On-call routing', uptime: '100%', category: 'Workflow', desc: 'On-call scheduling and incident escalation' },
  { name: 'Perplexity Computer', vendor: 'Perplexity AI', icon: 'ðŸ¤–', color: '#00d4ff', connected: false, live: false, version: 'API v1', alerts: 'AI investigation', uptime: '99.9%', category: 'Workflow', desc: 'AI-powered threat investigation and analysis' },
];

const auditData = [
  { ts: '22:19:44', user: 'John Lim', type: 'AI', action: 'AI Investigation Brief generated', target: 'DAC-18158', details: 'Claude 3.5 Sonnet Â· 87% confidence', ip: '10.0.4.11' },
  { ts: '22:18:12', user: 'John Lim', type: 'Response', action: 'Hash Block initiated', target: 'a3f4b8c2...', details: 'Via EDR + Elastic Block List', ip: '10.0.4.11' },
  { ts: '22:15:03', user: 'AI System', type: 'Ticket', action: 'P1 ticket auto-created', target: 'DAC-18158', details: 'Risk score 92 â€” via Jira', ip: 'system' },
  { ts: '22:01:28', user: 'Sarah Tan', type: 'Ticket', action: 'Ticket assigned', target: 'DAC-18138', details: 'Assigned to Marcus Wong', ip: '10.0.4.12' },
  { ts: '21:55:40', user: 'Kevin Toh', type: 'Config', action: 'Detection rule modified', target: 'RUL-0147', details: 'Threshold changed 50â†’100', ip: '10.0.4.15' },
  { ts: '21:42:17', user: 'John Lim', type: 'Auth', action: 'Login', target: 'MCC Platform', details: 'Success â€” SSO via Azure AD', ip: '10.0.4.11' },
  { ts: '21:30:05', user: 'Marcus Wong', type: 'Ticket', action: 'Ticket closed', target: 'DAC-18090', details: 'Resolution: Benign â€” Analyst travel', ip: '10.0.4.13' },
  { ts: '21:18:33', user: 'AI System', type: 'AI', action: 'Parser generated', target: 'Cisco ASA (ADV)', details: 'DeepSeek V3 Â· 78% confidence', ip: 'system' },
  { ts: '20:55:12', user: 'Wei Chen', type: 'Ticket', action: 'Ticket escalated to client', target: 'DAC-18100', details: 'Naga World CISO notified via email', ip: '10.0.4.10' },
  { ts: '20:34:01', user: 'Kevin Toh', type: 'Config', action: 'New log source added', target: 'CCTV-Dahua', details: 'Naga World environment', ip: '10.0.4.15' },
  { ts: '20:15:48', user: 'Raj Lingam', type: 'Auth', action: 'Logout', target: 'MCC Platform', details: 'End of Shift B', ip: '10.0.4.14' },
  { ts: '19:58:22', user: 'AI System', type: 'AI', action: 'Monthly SOC Report generated', target: 'All Clients Jan 2026', details: 'Claude 3.5 Sonnet Â· 24 pages', ip: 'system' },
];

// MITRE Tactics
const mitreTactics = [
  { name: 'Recon', techs: ['T1595', 'T1592', '', ''] },
  { name: 'Res Dev', techs: ['T1588', 'T1583', '', ''] },
  { name: 'Init Access', techs: ['T1566', 'T1190', 'T1133', ''] },
  { name: 'Execution', techs: ['T1059', 'T1204', 'T1053', ''] },
  { name: 'Persist', techs: ['T1098', 'T1547', 'T1037', ''] },
  { name: 'Priv Esc', techs: ['T1548', 'T1134', '', ''] },
  { name: 'Defense Ev', techs: ['T1562', 'T1070', 'T1036', ''] },
  { name: 'Cred Access', techs: ['T1003', 'T1110', 'T1555', ''] },
  { name: 'Discovery', techs: ['T1069', 'T1087', 'T1083', ''] },
  { name: 'Lateral Mv', techs: ['T1021', 'T1534', '', ''] },
  { name: 'Impact', techs: ['T1486', 'T1489', 'T1491', ''] },
];

const mitreStatus = {
  'T1595': 'partial', 'T1592': 'empty', 'T1588': 'partial', 'T1583': 'empty',
  'T1566': 'covered', 'T1190': 'covered', 'T1133': 'partial',
  'T1059': 'covered', 'T1204': 'covered', 'T1053': 'partial',
  'T1098': 'covered', 'T1547': 'partial', 'T1037': 'empty',
  'T1548': 'partial', 'T1134': 'empty',
  'T1562': 'partial', 'T1070': 'covered', 'T1036': 'covered',
  'T1003': 'covered', 'T1110': 'covered', 'T1555': 'partial',
  'T1069': 'covered', 'T1087': 'covered', 'T1083': 'partial',
  'T1021': 'covered', 'T1534': 'empty',
  'T1486': 'covered', 'T1489': 'partial', 'T1491': 'empty',
};

// ============================================================
//  RENDER FUNCTIONS
// ============================================================

function renderTriage() {
  if (window._dactaMode === 'production') return;
  const tbody = document.getElementById('triageTableBody');
  if (!tbody) return;
  tbody.innerHTML = triageData.map(t => `
    <tr onclick="navigate('investigation')">
      <td class="mono" style="color:var(--cyan);">${t.id}</td>
      <td><span class="badge badge-${t.priority.toLowerCase()}">${t.priority}</span></td>
      <td style="max-width:260px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--text-primary);">${t.title}</td>
      <td>${t.org}</td>
      <td style="font-size:11px;">${t.source}</td>
      <td><span class="badge badge-${t.status === 'Open' ? 'open' : t.status === 'Closed' ? 'closed' : t.status === 'Escalated' ? 'escalated' : 'investigating'}">${t.status}</span></td>
      <td style="font-size:11px;">${t.assigned}</td>
      <td class="mono">${t.created}</td>
      <td style="font-family:var(--font-mono);font-size:11px;color:var(--${t.slaColor === 'red' ? 'red-bright' : t.slaColor === 'amber' ? 'amber' : t.slaColor === 'cyan' ? 'cyan' : 'text-muted'});">${t.sla}</td>
      <td>
        <div style="display:flex;gap:4px;">
          <button class="btn btn-xs btn-secondary">Assign</button>
          <button class="btn btn-xs btn-amber">Escalate</button>
        </div>
      </td>
    </tr>
  `).join('');
}

// ============================================================
//  DETECTION RULES â€” LIVE DATA FROM ELASTIC
// ============================================================
async function loadDetectionRulesLive() {
  console.log('[DetectionRules] Loading live rules from Elastic...');
  try {
    var resp = await fetch('/api/elastic', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        action: 'search',
        index: '.internal.alerts-security*',
        body: {
          size: 0,
          aggs: {
            rules: {
              terms: { field: 'kibana.alert.rule.name', size: 100 },
              aggs: {
                severity: { terms: { field: 'kibana.alert.severity', size: 1 } },
                category: { terms: { field: 'kibana.alert.rule.category', size: 1 } },
                latest: { top_hits: { size: 1, sort: [{ '@timestamp': 'desc' }], _source: ['kibana.alert.rule.name', 'kibana.alert.rule.category', 'kibana.alert.severity', 'kibana.alert.rule.description', 'kibana.alert.rule.tags'] } }
              }
            }
          }
        }
      })
    });
    var result = await resp.json();
    if (!result || !result.aggregations) { console.warn('[DetectionRules] No data'); return; }
    var buckets = result.aggregations.rules ? result.aggregations.rules.buckets : [];
    rulesData = [];
    var idx = 1;
    buckets.forEach(function(b) {
      var hit = (b.latest && b.latest.hits && b.latest.hits.hits && b.latest.hits.hits[0]) ? b.latest.hits.hits[0]._source : {};
      var alert = hit.kibana ? hit.kibana.alert || {} : {};
      var rule = alert.rule || {};
      var sev = (b.severity && b.severity.buckets && b.severity.buckets[0]) ? b.severity.buckets[0].key : 'medium';
      var cat = (b.category && b.category.buckets && b.category.buckets[0]) ? b.category.buckets[0].key : 'Custom Query Rule';
      var sevMap = { 'critical': 'Critical', 'high': 'High', 'medium': 'Medium', 'low': 'Low' };
      var typeMap = { 'Custom Query Rule': 'Sigma', 'Threshold Rule': 'Threshold', 'EQL Rule': 'EQL', 'Machine Learning Rule': 'ML', 'Indicator Match Rule': 'Correlation' };
      var tags = rule.tags || [];
      var mitre = '\u2014';
      tags.forEach(function(t) { if (t && t.match && t.match(/^T\d{4}/)) mitre = t; });
      var isDacta = b.key.indexOf('DACTA') >= 0;
      var logSources = [];
      if (b.key.toLowerCase().indexOf('ip ') >= 0 || b.key.toLowerCase().indexOf('ioc') >= 0) logSources.push('network');
      if (b.key.toLowerCase().indexOf('web') >= 0 || b.key.toLowerCase().indexOf('shell') >= 0) logSources.push('windows');
      if (b.key.toLowerCase().indexOf('edr') >= 0 || b.key.toLowerCase().indexOf('crowdstrike') >= 0) logSources.push('edr');
      if (b.key.toLowerCase().indexOf('firewall') >= 0 || b.key.toLowerCase().indexOf('forti') >= 0) logSources.push('firewall');
      if (logSources.length === 0) logSources.push('edr');

      rulesData.push({
        id: 'RUL-' + String(3000 + idx).padStart(4, '0'),
        name: b.key,
        type: typeMap[cat] || 'Sigma',
        mitre: mitre,
        severity: sevMap[sev] || 'Medium',
        logSources: logSources,
        author: isDacta ? 'Dacta SOC' : 'Custom',
        ver: '1.0',
        status: 'Production',
        fp: 'â€”',
        hits: b.doc_count
      });
      idx++;
    });

    // Update stats cards
    var page = document.getElementById('page-rules');
    if (page) {
      var statVals = page.querySelectorAll('.dr-stat-card .val');
      if (statVals.length >= 1) statVals[0].textContent = rulesData.length;
      if (statVals.length >= 2) statVals[1].textContent = rulesData.filter(function(r) { return r.status === 'Production'; }).length;
      if (statVals.length >= 3) statVals[2].textContent = '0';
      if (statVals.length >= 4) statVals[4].textContent = rulesData.filter(function(r) { return r.severity === 'Critical'; }).length;
      // Update page subtitle
      var sub = page.querySelector('.page-subtitle');
      if (sub) sub.innerHTML = rulesData.length + ' active rules from Elastic SIEM ' + jiraLiveBadge();
    }

    renderRules();
    renderPipeline();
    renderCoverage();
    renderEmergingThreats();
    renderMitre();
    console.log('[DetectionRules] Loaded ' + rulesData.length + ' rules from Elastic');
  } catch (err) {
    console.error('[DetectionRules] Error:', err);
  }
}

var _rulesPage = 1;
var _rulesPerPage = 50;

function renderRules() {
  var tbody = document.getElementById('drRepoTableBody');
  if (!tbody) return;
  var sevColor = { 'Critical':'red', 'High':'amber', 'Medium':'blue', 'Low':'gray', 'Informational':'gray' };
  var typeClass = { 'Sigma':'sigma', 'YARA':'yara', 'Correlation':'correlation', 'Threshold':'threshold', 'ML':'ml', 'EQL':'eql' };
  var authorClass = { 'Dacta SOC':'dacta', 'Community':'community', 'Custom':'custom' };
  var statusColor = { 'Production':'green', 'Testing':'amber', 'Draft':'gray', 'Deprecated':'red' };
  var lsClass = { 'windows':'windows', 'linux':'linux', 'firewall':'firewall', 'cloud':'cloud', 'edr':'edr', 'm365':'m365', 'network':'network', 'ot':'ot' };
  var total = rulesData.length;
  var totalPages = Math.max(1, Math.ceil(total / _rulesPerPage));
  if (_rulesPage > totalPages) _rulesPage = totalPages;
  if (_rulesPage < 1) _rulesPage = 1;
  var start = (_rulesPage - 1) * _rulesPerPage;
  var end = Math.min(start + _rulesPerPage, total);
  var pageData = rulesData.slice(start, end);
  var rows = '';
  for (var i = 0; i < pageData.length; i++) {
    var r = pageData[i];
    var lsBadges = '';
    var rls = r.logSources || [];
    for (var j = 0; j < rls.length; j++) {
      var ls = rls[j];
      lsBadges += '<span class="logsrc-tag ' + (lsClass[ls] || '') + '" style="font-size:8px;">' + ls + '</span>';
    }
    var fpColor = parseFloat(r.fp) > 15 ? 'var(--amber)' : 'var(--green)';
    rows += '<tr>';
    rows += '<td class="mono" style="color:var(--cyan);font-size:11px;">' + r.id + '</td>';
    rows += '<td style="color:var(--text-primary);font-weight:500;max-width:220px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + r.name + '</td>';
    rows += '<td><span class="rule-type-badge ' + (typeClass[r.type] || 'sigma') + '">' + r.type + '</span></td>';
    rows += '<td><span class="mitre-tag">' + r.mitre + '</span></td>';
    rows += '<td><span class="badge badge-' + (sevColor[r.severity] || 'blue') + '">' + r.severity + '</span></td>';
    rows += '<td style="max-width:140px;"><div style="display:flex;gap:3px;flex-wrap:wrap;">' + lsBadges + '</div></td>';
    rows += '<td><span class="author-badge ' + (authorClass[r.author] || 'dacta') + '" style="font-size:8px;">' + r.author + '</span></td>';
    rows += '<td style="font-family:var(--font-mono);font-size:10px;color:var(--text-muted);">' + r.ver + '</td>';
    rows += '<td><span class="badge badge-' + (statusColor[r.status] || 'green') + '" style="font-size:9px;">' + r.status + '</span></td>';
    rows += '<td style="font-family:var(--font-mono);font-size:11px;color:' + fpColor + ';">' + r.fp + '</td>';
    rows += '<td style="font-family:var(--font-mono);font-size:12px;font-weight:700;">' + r.hits + '</td>';
    rows += '<td><div style="display:flex;gap:4px;">';
    rows += '<button class="btn btn-xs btn-secondary" onclick="switchDrTab(\'builder\');showToast(\'Loading rule ' + r.id + ' in editor...\')">Edit</button>';
    rows += '<button class="btn btn-xs btn-secondary" onclick="navigate(\'rulelab\');showToast(\'Testing ' + r.id + '...\')">Test</button>';
    rows += '</div></td></tr>';
  }
  tbody.innerHTML = rows;
  // Render pagination bar
  var pbar = document.getElementById('drRepoPagination');
  if (!pbar) return;
  if (total === 0) { pbar.innerHTML = ''; return; }
  var startDisp = start + 1;
  var endDisp = end;
  var pageBtns = '';
  var maxBtns = 7;
  var pageStart = Math.max(1, _rulesPage - 3);
  var pageEnd = Math.min(totalPages, pageStart + maxBtns - 1);
  if (pageEnd - pageStart < maxBtns - 1) pageStart = Math.max(1, pageEnd - maxBtns + 1);
  for (var p = pageStart; p <= pageEnd; p++) {
    var active = (p === _rulesPage) ? 'background:rgba(0,212,255,0.15);color:var(--cyan);border-color:rgba(0,212,255,0.4);' : '';
    pageBtns += '<button class="btn btn-xs btn-secondary" style="min-width:28px;' + active + '" onclick="_rulesPage=' + p + ';renderRules();">' + p + '</button>';
  }
  var prevDis = _rulesPage <= 1 ? 'opacity:0.35;cursor:not-allowed;' : '';
  var nextDis = _rulesPage >= totalPages ? 'opacity:0.35;cursor:not-allowed;' : '';
  pbar.innerHTML = '<span style="font-size:10px;color:var(--text-muted);white-space:nowrap;">Showing ' + startDisp + 'â€“' + endDisp + ' of ' + total + '</span>'
    + '<div style="display:flex;gap:4px;align-items:center;flex-wrap:wrap;">'
    + '<button class="btn btn-xs btn-secondary" style="' + prevDis + '" onclick="if(_rulesPage>1){_rulesPage--;renderRules();}">&#8592; Prev</button>'
    + pageBtns
    + '<button class="btn btn-xs btn-secondary" style="' + nextDis + '" onclick="if(_rulesPage<' + totalPages + '){_rulesPage++;renderRules();}">Next &#8594;</button>'
    + '</div>';
}

function renderPipeline() {
  var tbody = document.getElementById('drPipelineTableBody');
  if (!tbody) return;
  var authorClass = { 'Dacta SOC':'dacta', 'Community':'community', 'Custom':'custom' };
  var inTesting = rulesData.filter(function(r) { return r.status === 'Testing'; });
  var inDraft = rulesData.filter(function(r) { return r.status === 'Draft'; });
  var inProd = rulesData.filter(function(r) { return r.status === 'Production'; });
  // Update stage counters
  var cd = document.getElementById('drPipeCountDraft');
  var ct = document.getElementById('drPipeCountTest');
  var cp = document.getElementById('drPipeCountProd');
  if (cd) cd.textContent = inDraft.length;
  if (ct) ct.textContent = inTesting.length;
  if (cp) cp.textContent = inProd.length;
  // Update badge
  var badge = document.getElementById('drPipelineBadge');
  var transitCount = inTesting.length + inDraft.length;
  if (badge) badge.textContent = transitCount + ' rules in transit';
  // Build rows â€” show in-testing first, then draft, limit to 20 rows
  var display = inTesting.concat(inDraft).slice(0, 20);
  if (display.length === 0 && rulesData.length > 0) {
    // If no Testing/Draft, show first 10 rules as production sample
    display = inProd.slice(0, 10);
  }
  if (display.length === 0) {
    tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:var(--text-muted);padding:16px;">No pipeline data available</td></tr>';
    return;
  }
  var rows = '';
  var stageMap = { 'Testing':'<span class="badge badge-amber">Testing</span>', 'Draft':'<span class="badge" style="background:rgba(100,116,139,0.15);color:#94a3b8;">Draft</span>', 'Production':'<span class="badge badge-green">Production</span>' };
  var actionMap = {
    'Testing': '<button class="btn btn-xs btn-primary" onclick="showToast(\'Promoting to Peer Review...\')">Promote</button>',
    'Draft': '<button class="btn btn-xs btn-secondary" onclick="showToast(\'Sent to backtest against 7-day logs\')">Test</button>',
    'Production': '<button class="btn btn-xs btn-secondary" onclick="showToast(\'Viewing deployment details...\')">View</button>'
  };
  var lsClass = { 'windows':'windows', 'linux':'linux', 'firewall':'firewall', 'cloud':'cloud', 'edr':'edr', 'm365':'m365', 'network':'network', 'ot':'ot' };
  for (var i = 0; i < display.length; i++) {
    var r = display[i];
    var lsBadges = '';
    var rls = r.logSources || [];
    for (var j = 0; j < rls.length; j++) {
      lsBadges += '<span class="logsrc-tag ' + (lsClass[rls[j]] || '') + '" style="font-size:8px;">' + rls[j] + '</span>';
    }
    rows += '<tr>';
    rows += '<td class="mono" style="color:var(--cyan);">' + r.id + '</td>';
    rows += '<td style="color:var(--text-primary);font-weight:500;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + r.name + '</td>';
    rows += '<td><span class="author-badge ' + (authorClass[r.author] || 'dacta') + '">' + r.author + '</span></td>';
    rows += '<td>' + (stageMap[r.status] || '<span class="badge badge-gray">' + r.status + '</span>') + '</td>';
    rows += '<td style="font-family:var(--font-mono);color:' + (r.fp === '\u2014' ? 'var(--text-muted)' : (parseFloat(r.fp) > 15 ? 'var(--amber)' : 'var(--green)')) + ';">' + r.fp + '</td>';
    rows += '<td style="max-width:120px;"><div style="display:flex;gap:3px;flex-wrap:wrap;">' + lsBadges + '</div></td>';
    rows += '<td>' + (actionMap[r.status] || '') + '</td>';
    rows += '</tr>';
  }
  tbody.innerHTML = rows;
}

function renderCoverage() {
  // Update top stat cards
  var total = rulesData.length;
  var prod = rulesData.filter(function(r) { return r.status === 'Production'; }).length;
  var crit = rulesData.filter(function(r) { return r.severity === 'Critical'; }).length;
  // Count unique log source types
  var lsSet = {};
  rulesData.forEach(function(r) {
    (r.logSources || []).forEach(function(ls) { lsSet[ls] = (lsSet[ls] || 0) + 1; });
  });
  var lsTypes = Object.keys(lsSet).length;
  var ct = document.getElementById('covStatTotal');
  var cls = document.getElementById('covStatLogSources');
  var cp = document.getElementById('covStatProduction');
  var cc = document.getElementById('covStatCritical');
  if (ct) ct.textContent = total;
  if (cls) cls.textContent = lsTypes;
  if (cp) cp.textContent = prod;
  if (cc) cc.textContent = crit;
  // Render log source matrix
  var matrix = document.getElementById('drLogSourceMatrix');
  if (matrix && total > 0) {
    var lsNames = { 'windows':'Windows', 'm365':'Microsoft 365', 'cloud':'Cloud / Azure', 'firewall':'Firewall', 'edr':'EDR', 'linux':'Linux Auditd', 'network':'DNS / Network', 'ot':'OT / ICS' };
    var lsTagClass = { 'windows':'windows', 'm365':'m365', 'cloud':'cloud', 'firewall':'firewall', 'edr':'edr', 'linux':'linux', 'network':'network', 'ot':'ot' };
    var allLs = ['windows','m365','cloud','firewall','edr','linux','network','ot'];
    var maxCount = 1;
    allLs.forEach(function(k) { if ((lsSet[k] || 0) > maxCount) maxCount = lsSet[k]; });
    var html = '';
    allLs.forEach(function(k) {
      var count = lsSet[k] || 0;
      var pct = Math.round((count / maxCount) * 100);
      var absRaw = total > 0 ? Math.round((count / total) * 100) : 0;
      var barColor = pct >= 70 ? 'var(--green)' : (pct >= 40 ? 'var(--amber)' : 'var(--red-bright)');
      var textColor = pct >= 70 ? 'var(--green)' : (pct >= 40 ? 'var(--amber)' : 'var(--red-bright)');
      html += '<div style="display:flex;align-items:center;gap:10px;padding:6px 0;">';
      html += '<span class="logsrc-tag ' + lsTagClass[k] + '" style="width:130px;">' + lsNames[k] + '</span>';
      html += '<div style="flex:1;height:8px;background:rgba(255,255,255,0.06);border-radius:4px;overflow:hidden;"><div style="width:' + pct + '%;height:100%;background:' + barColor + ';border-radius:4px;"></div></div>';
      html += '<span style="font-family:var(--font-mono);font-size:11px;color:' + textColor + ';font-weight:700;width:60px;text-align:right;">' + count + ' rules</span>';
      html += '</div>';
    });
    matrix.innerHTML = html;
  }
}

async function renderEmergingThreats() {
  var container = document.getElementById('etThreatList');
  if (!container) return;
  // Update stats from rulesData
  var total = rulesData.length;
  var prod = rulesData.filter(function(r) { return r.status === 'Production'; }).length;
  var testing = rulesData.filter(function(r) { return r.status === 'Testing'; }).length;
  var draft = rulesData.filter(function(r) { return r.status === 'Draft'; }).length;
  var sn = document.getElementById('etStatNew'); if (sn) sn.textContent = testing;
  var st = document.getElementById('etStatTesting'); if (st) st.textContent = testing;
  var sv = document.getElementById('etStatValidated'); if (sv) sv.textContent = prod;
  var sd = document.getElementById('etStatDraft'); if (sd) sd.textContent = draft;
  var stot = document.getElementById('etStatTotal'); if (stot) stot.textContent = total;
  // Try OpenCTI first
  var threats = null;
  try {
    var resp = await fetch('/api/opencti', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        query: '{ reports(first: 6, orderBy: created_at, orderMode: desc, filters: { mode: and, filters: [], filterGroups: [] }) { edges { node { id name description published entity_type objectLabel { edges { node { value color } } } } } } }'
      })
    });
    var ocData = await resp.json();
    if (ocData && ocData.data && ocData.data.reports && ocData.data.reports.edges && ocData.data.reports.edges.length > 0) {
      threats = ocData.data.reports.edges.map(function(e) { return e.node; });
    }
  } catch (e) {
    console.warn('[EmergingThreats] OpenCTI unavailable, falling back to rulesData', e);
  }
  var html = '';
  if (threats && threats.length > 0) {
    // Render OpenCTI threat reports as cards
    threats.forEach(function(t) {
      var labels = (t.objectLabel && t.objectLabel.edges) ? t.objectLabel.edges.map(function(l) { return l.node.value; }) : [];
      var labelHtml = labels.slice(0, 4).map(function(lv) {
        return '<span class="mitre-tag" style="font-size:9px;">' + lv + '</span>';
      }).join('');
      var pubDate = t.published ? new Date(t.published).toLocaleDateString('en-SG', { day:'2-digit', month:'short', year:'numeric' }) : '';
      html += '<div class="et-threat-card" data-et-status="new">';
      html += '<div class="et-tc-header"><div style="flex:1;">';
      html += '<div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;"><span class="et-status-badge new">New</span>' + labelHtml + '</div>';
      html += '<div class="et-tc-title">' + t.name + '</div>';
      html += '<div class="et-tc-date">Published: ' + pubDate + ' &middot; Source: OpenCTI TIP</div>';
      html += '</div></div>';
      if (t.description) {
        html += '<div class="et-tc-desc">' + t.description.substring(0, 300) + (t.description.length > 300 ? '...' : '') + '</div>';
      }
      html += '<div class="et-tc-actions">';
      html += '<button class="btn btn-secondary btn-xs" onclick="showToast(\'Opening threat report...\')">View Report</button>';
      html += '<button class="btn btn-primary btn-xs" onclick="showToast(\'Generating detection rules from threat intel...\')">Generate Rules</button>';
      html += '</div></div>';
    });
  } else {
    // Fallback: show recently active rules grouped by severity as threat signals
    var sevOrder = ['Critical', 'High', 'Medium'];
    var shown = 0;
    sevOrder.forEach(function(sev) {
      if (shown >= 6) return;
      var rules = rulesData.filter(function(r) { return r.severity === sev && r.hits > 0; }).slice(0, 3);
      rules.forEach(function(r) {
        if (shown >= 6) return;
        shown++;
        var sevBadge = sev === 'Critical' ? 'badge-red' : (sev === 'High' ? 'badge-amber' : 'badge-blue');
        var statusClass = r.status === 'Production' ? 'validated' : (r.status === 'Testing' ? 'testing' : 'new');
        html += '<div class="et-threat-card" data-et-status="' + statusClass + '">';
        html += '<div class="et-tc-header"><div style="flex:1;">';
        html += '<div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">';
        html += '<span class="et-status-badge ' + statusClass + '">' + r.status + '</span>';
        html += '<span class="badge ' + sevBadge + '" style="font-size:9px;">' + sev + '</span>';
        html += '<span class="mitre-tag" style="font-size:9px;">' + r.mitre + '</span>';
        html += '</div>';
        html += '<div class="et-tc-title">' + r.name + '</div>';
        html += '<div class="et-tc-date">Rule ID: ' + r.id + ' &middot; Hits (7d): ' + r.hits + ' &middot; Source: Elastic SIEM</div>';
        html += '</div></div>';
        html += '<div class="et-tc-desc">Active detection rule with ' + r.hits + ' hits in the last 7 days. Rule type: ' + r.type + '. Log sources: ' + (r.logSources || []).join(', ') + '.</div>';
        html += '<div class="et-tc-rules">';
        html += '<div class="rule-row">';
        html += '<span class="rule-type-badge ' + r.type.toLowerCase() + '" style="font-size:9px;">' + r.type + '</span>';
        html += '<span style="font-size:11px;color:var(--text-primary);flex:1;">' + r.name + '</span>';
        html += '<span class="mitre-tag" style="font-size:9px;">' + r.mitre + '</span>';
        html += '</div></div>';
        html += '<div class="et-tc-actions">';
        html += '<button class="btn btn-secondary btn-xs" onclick="switchDrTab(\'builder\');showToast(\'Loading ' + r.id + ' in editor...\')">Edit Rule</button>';
        html += '<button class="btn btn-primary btn-xs" onclick="navigate(\'rulelab\');showToast(\'Testing ' + r.id + '...\')">Test Rule</button>';
        html += '</div></div>';
      });
    });
    if (shown === 0) {
      html = '<div style="text-align:center;padding:20px;color:var(--text-muted);font-size:12px;">No active threat signals detected. Connect OpenCTI or wait for Elastic data.</div>';
    }
  }
  container.innerHTML = html;
}

function renderMitre() {
  const grid = document.getElementById('mitreGrid');
  if (!grid) return;
  grid.innerHTML = mitreTactics.map(tac => `
    <div class="mitre-tactic">
      <div class="tac-name">${tac.name}</div>
      ${tac.techs.map(t => t ? `
        <div class="mitre-tech ${mitreStatus[t] || 'empty'}" data-tooltip="${t}">${t.replace('T', '')}</div>
      ` : `<div style="height:4px;"></div>`).join('')}
    </div>
  `).join('');
  // Also render ICS grid
  renderMitreIcs();
}

var mitreIcsTactics = [
  { name: 'Init Access', techs: ['T0819', 'T0886', 'T0847', 'T0848'] },
  { name: 'Execution', techs: ['T0858', 'T0807', 'T0871', ''] },
  { name: 'Persistence', techs: ['T0839', 'T0857', '', ''] },
  { name: 'Priv Esc', techs: ['T0890', '', '', ''] },
  { name: 'Evasion', techs: ['T0820', 'T0872', 'T0849', ''] },
  { name: 'Discovery', techs: ['T0840', 'T0846', '', ''] },
  { name: 'Lateral Mv', techs: ['T0867', 'T0812', 'T0866', ''] },
  { name: 'Collection', techs: ['T0802', 'T0811', '', ''] },
  { name: 'C2', techs: ['T0869', 'T0885', '', ''] },
  { name: 'Inhibit Resp', techs: ['T0800', 'T0838', '', ''] },
  { name: 'Impair Proc', techs: ['T0836', '', '', ''] },
  { name: 'Impact', techs: ['T0826', 'T0831', '', ''] },
];
var mitreIcsStatus = {
  'T0819':'covered','T0886':'partial','T0847':'partial','T0848':'empty',
  'T0858':'covered','T0807':'partial','T0871':'empty',
  'T0839':'partial','T0857':'empty',
  'T0890':'empty',
  'T0820':'covered','T0872':'partial','T0849':'empty',
  'T0840':'partial','T0846':'partial',
  'T0867':'covered','T0812':'partial','T0866':'empty',
  'T0802':'partial','T0811':'empty',
  'T0869':'partial','T0885':'partial',
  'T0800':'empty','T0838':'empty',
  'T0836':'empty',
  'T0826':'empty','T0831':'empty',
};
function renderMitreIcs() {
  var grid = document.getElementById('mitreIcsGrid');
  if (!grid) return;
  grid.innerHTML = mitreIcsTactics.map(function(tac) {
    return '<div class="mitre-tactic">' +
      '<div class="tac-name">' + tac.name + '</div>' +
      tac.techs.map(function(t) {
        if (!t) return '<div style="height:4px;"></div>';
        var st = mitreIcsStatus[t] || 'empty';
        return '<div class="mitre-tech ' + st + '" data-tooltip="' + t + '">' + t.replace('T0','') + '</div>';
      }).join('') +
    '</div>';
  }).join('');
}

function renderLogSources() {
  if (window._dactaMode === 'production') return;
  const tbody = document.getElementById('logSourcesBody');
  if (!tbody) return;
  const statusLabel = { 'green': 'Healthy', 'amber': 'Degraded', 'red': 'Silent' };
  tbody.innerHTML = logSourcesData.map(s => `
    <tr>
      <td><div style="display:flex;align-items:center;gap:6px;"><div class="status-dot ${s.status}"></div><span style="font-size:10px;color:var(--text-muted);">${statusLabel[s.status]}</span></div></td>
      <td style="color:var(--text-primary);font-weight:500;">${s.name}</td>
      <td style="font-size:11px;">${s.vendor} / ${s.siem}</td>
      <td>${s.siem}</td>
      <td class="mono" style="font-size:10px;">${s.index}</td>
      <td style="font-size:11px;">${s.org}</td>
      <td style="font-family:var(--font-mono);font-weight:600;">${s.eventsDay}</td>
      <td style="font-family:var(--font-mono);font-size:11px;">${s.volume}</td>
      <td><span class="badge badge-${parseFloat(s.parse) >= 98 ? 'green' : parseFloat(s.parse) >= 90 ? 'amber' : 'red'}">${s.parse}</span></td>
      <td class="mono">${s.last}</td>
    </tr>
  `).join('');
}

function renderAssets() {
  if (window._dactaMode === 'production') return;
  const tbody = document.getElementById('assetsTableBody');
  if (!tbody) return;
  tbody.innerHTML = assetsData.map(a => `
    <tr>
      <td class="mono" style="color:var(--cyan);font-size:11px;">${a.host}</td>
      <td style="font-size:11px;">${a.type}</td>
      <td style="font-size:11px;">${a.os}</td>
      <td class="mono" style="font-size:11px;">${a.ip}</td>
      <td style="font-size:11px;">${a.org}</td>
      <td>
        <div style="display:flex;align-items:center;gap:6px;">
          <div style="flex:1;height:5px;background:var(--bg-elevated);border-radius:2px;overflow:hidden;width:60px;">
            <div style="height:100%;width:${a.risk}%;background:${a.risk > 80 ? 'var(--red)' : a.risk > 50 ? 'var(--amber)' : 'var(--green)'};border-radius:2px;"></div>
          </div>
          <span style="font-family:var(--font-mono);font-size:11px;color:${a.risk > 80 ? 'var(--red-bright)' : a.risk > 50 ? 'var(--amber)' : 'var(--green)'};">${a.risk}</span>
        </div>
      </td>
      <td><div style="display:flex;align-items:center;gap:5px;"><div class="status-dot ${a.agent}"></div><span style="font-size:10px;color:var(--text-muted);">${a.agent === 'green' ? 'Active' : a.agent === 'amber' ? 'Stale' : 'Offline'}</span></div></td>
      <td class="mono">${a.last}</td>
      <td><button class="btn btn-xs btn-secondary">Details</button></td>
    </tr>
  `).join('');
}

function renderIntegrations() {
  const grid = document.getElementById('integrationsGrid');
  if (!grid) return;
  const catLabels = { Core: 'Core Platform \u2014 SIEM, ITSM & Threat Intel', Comms: 'Communication & Notifications', Workflow: 'Workflow & Operations' };
  const cats = ['Core', 'Comms', 'Workflow'];
  let html = '';
  // Only render integrations that are live (actually configured)
  cats.forEach(cat => {
    const items = integrationsData.filter(i => i.category === cat && (i.live === true || i.connected === true));
    if (!items.length) return;
    html += `<div style="grid-column:1/-1;margin:${cat==='Core'?'0':'12px'} 0 6px 0;display:flex;align-items:center;gap:10px;"><span style="font-family:var(--font-display);font-size:12px;font-weight:600;color:var(--text-secondary);letter-spacing:0.5px;text-transform:uppercase;white-space:nowrap;">${catLabels[cat]}</span><div style="flex:1;height:1px;background:var(--border-subtle);"></div></div>`;
    items.forEach(i => {
      html += `
    <div class="integration-card ${i.connected ? 'connected' : ''}">
      <div class="integration-header">
        <div class="integration-icon" style="background:${i.color}20;color:${i.color};font-size:22px;">${i.icon}</div>
        <div>
          <div class="integration-name">${i.name}</div>
          <div class="integration-vendor">${i.vendor}</div>
        </div>
        <div class="status-dot ${i.connected ? 'green' : 'red'}" style="margin-left:auto;" title="${i.connected ? 'Connected' : 'Disconnected'}"></div>
      </div>
      <div class="integration-stats">
        <div class="int-stat"><div class="int-stat-val">${i.version}</div><div class="int-stat-lbl">Version</div></div>
        <div class="int-stat"><div class="int-stat-val" style="color:var(--cyan);">${i.alerts}</div><div class="int-stat-lbl">Activity</div></div>
        <div class="int-stat"><div class="int-stat-val" style="color:var(--green);">${i.uptime}</div><div class="int-stat-lbl">Uptime</div></div>
      </div>
      <div style="margin-top:12px;display:flex;gap:6px;">
        <button class="btn btn-secondary btn-sm" style="flex:1;">\u2699 Configure</button>
        <button class="btn btn-${i.connected ? 'success' : 'danger'} btn-sm">${i.connected ? '\u2713 Connected' : '\u2717 Disconnected'}</button>
      </div>
    </div>`;
    });
  });
  // Summary footer
  var notConfigured = integrationsData.filter(i => !i.live).length;
  html += `<div style="grid-column:1/-1;margin-top:16px;padding:14px 18px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:8px;display:flex;align-items:center;gap:16px;flex-wrap:wrap;"><span style="font-size:11px;color:var(--text-muted);font-style:italic;">${notConfigured} additional integrations available â€” client-specific connectors (EDR, XDR, Firewall, Identity) configured per tenant under Settings.</span><button class="btn btn-secondary btn-sm" onclick="showAddIntegrationModal()" style="font-size:11px;">+ Add Integration (${notConfigured} available)</button></div>`;
  grid.innerHTML = html;
}

function renderAuditLog() {
  if (window._dactaMode === 'production') return;
  const tbody = document.getElementById('auditLogBody');
  if (!tbody) return;
  const typeColors = { 'AI': 'purple', 'Response': 'red', 'Ticket': 'cyan', 'Config': 'amber', 'Auth': 'green' };
  tbody.innerHTML = auditData.map(a => `
    <tr class="audit-row">
      <td class="mono" style="color:var(--text-muted);">2026-02-27 ${a.ts}</td>
      <td style="color:var(--text-primary);font-size:11px;">${a.user}</td>
      <td><span class="badge badge-${typeColors[a.type] || 'blue'}" style="font-size:9px;">${a.type}</span></td>
      <td style="color:var(--text-secondary);font-size:11px;">${a.action}</td>
      <td class="mono" style="color:var(--cyan);font-size:10px;">${a.target}</td>
      <td style="color:var(--text-muted);font-size:11px;">${a.details}</td>
      <td class="mono" style="color:var(--text-muted);font-size:10px;">${a.ip}</td>
    </tr>
  `).join('');
}

// ============================================================
//  ASSET MANAGEMENT â€” LIVE DATA
// ============================================================
async function loadAssetManagement() {
  var page = document.getElementById('page-assets');
  if (!page) return;
  var tbody = document.getElementById('assetsTableBody');
  if (!tbody) return;

  // Show loading spinner
  tbody.innerHTML = '<tr><td colspan="9" style="text-align:center;padding:24px;"><div class="jira-spinner" style="margin:0 auto;"></div><div style="font-size:10px;color:var(--text-muted);margin-top:8px;">Loading asset inventory from CrowdStrike...</div></td></tr>';

  try {
    var data = await fetch('/api/elastic', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        action: 'search',
        index: 'logs-crowdstrike.host-*',
        body: {
          size: 0,
          aggs: {
            hosts: {
              terms: { field: 'host.hostname', size: 100 },
              aggs: {
                latest: { top_hits: { size: 1, sort: [{ '@timestamp': 'desc' }], _source: ['host.hostname', 'host.ip', 'host.os.name', 'host.os.platform', 'crowdstrike.host.hostname', 'crowdstrike.host.local_ip', 'crowdstrike.host.os_version', 'crowdstrike.host.product_type_desc', 'crowdstrike.host.status', 'crowdstrike.host.last_seen', 'data_stream.namespace'] } }
              }
            },
            total_hosts: { cardinality: { field: 'host.hostname' } },
            os_dist: { terms: { field: 'host.os.platform', size: 10 } },
            namespace_dist: { terms: { field: 'data_stream.namespace', size: 10 } }
          }
        }
      })
    });
    var result = await data.json();
    if (!result || !result.aggregations) throw new Error('No data returned from Elastic');

    var hosts = result.aggregations.hosts ? result.aggregations.hosts.buckets : [];
    var totalHosts = result.aggregations.total_hosts ? result.aggregations.total_hosts.value : hosts.length;
    var nsDist = result.aggregations.namespace_dist ? result.aggregations.namespace_dist.buckets : [];

    // Update metric cards (Total Assets card)
    var metricVals = page.querySelectorAll('.metric-value');
    if (metricVals.length >= 1) metricVals[0].textContent = totalHosts;

    // Count statuses for other metrics
    var activeCount = 0, offlineCount = 0, criticalCount = 0;
    hosts.forEach(function(b) {
      var hit = (b.latest && b.latest.hits && b.latest.hits.hits && b.latest.hits.hits[0]) ? b.latest.hits.hits[0]._source : {};
      var cs = hit.crowdstrike ? hit.crowdstrike.host || {} : {};
      var status = cs.status || 'normal';
      if (status === 'normal') activeCount++;
      else if (status === 'contained' || status === 'offline') offlineCount++;
      if (status === 'contained') criticalCount++;
    });
    if (metricVals.length >= 2) metricVals[1].textContent = criticalCount;
    if (metricVals.length >= 3) metricVals[2].textContent = activeCount;
    if (metricVals.length >= 4) metricVals[3].textContent = offlineCount;

    // Build table rows
    var rowsHTML = '';
    hosts.forEach(function(bucket) {
      var hit = (bucket.latest && bucket.latest.hits && bucket.latest.hits.hits && bucket.latest.hits.hits[0]) ? bucket.latest.hits.hits[0]._source : {};
      var cs = hit.crowdstrike ? hit.crowdstrike.host || {} : {};
      var hostObj = hit.host || {};
      var hostname = cs.hostname || hostObj.hostname || bucket.key || 'â€”';
      var ip = cs.local_ip || (hostObj.ip && hostObj.ip[0]) || 'â€”';
      var os = cs.os_version || (hostObj.os ? hostObj.os.name : '') || 'â€”';
      var deviceType = cs.product_type_desc || 'Workstation';
      var status = cs.status || 'normal';
      var lastSeen = cs.last_seen || '';
      var ns = (hit.data_stream && hit.data_stream.namespace) || 'unknown';
      var orgMap = { nagaworld: 'Naga World', dacta: 'Dacta Global', foxwood: 'Foxwood', silverkey: 'Silver Key', hla: 'HLA', demo: 'Demo' };
      var org = orgMap[ns] || ns;
      var statusColor = status === 'normal' ? '#10b981' : status === 'contained' ? '#f59e0b' : '#ef4444';
      var statusLabel = status.charAt(0).toUpperCase() + status.slice(1);
      var agentColor = status === 'normal' ? '#10b981' : '#ef4444';
      var agentLabel = status === 'normal' ? 'Active' : 'Offline';
      var lastSeenFmt = lastSeen ? new Date(lastSeen).toLocaleString('en-SG', { timeZone: 'Asia/Singapore', day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' }) : 'â€”';
      // Synthetic risk score based on status
      var riskScore = status === 'contained' ? Math.floor(Math.random() * 30) + 60 : status === 'normal' ? Math.floor(Math.random() * 30) + 5 : Math.floor(Math.random() * 20) + 30;
      var riskColor = riskScore >= 80 ? 'var(--red-bright)' : riskScore >= 50 ? 'var(--amber)' : 'var(--green)';

      rowsHTML += '<tr>' +
        '<td><span class="mono" style="color:var(--cyan);font-size:11px;">' + hostname + '</span></td>' +
        '<td style="font-size:11px;">' + deviceType + '</td>' +
        '<td style="font-size:11px;">' + os + '</td>' +
        '<td style="font-size:11px;font-family:var(--font-mono);">' + ip + '</td>' +
        '<td style="font-size:11px;">' + org + '</td>' +
        '<td><span style="font-size:11px;font-weight:600;color:' + riskColor + ';">' + riskScore + '</span></td>' +
        '<td><span style="display:inline-flex;align-items:center;gap:4px;"><span style="width:6px;height:6px;border-radius:50%;background:' + agentColor + ';"></span><span style="font-size:10px;color:' + agentColor + ';">' + agentLabel + '</span></span></td>' +
        '<td style="font-size:10px;font-family:var(--font-mono);color:var(--text-muted);">' + lastSeenFmt + '</td>' +
        '<td><button class="btn btn-secondary btn-sm" style="font-size:9px;padding:2px 8px;" onclick="navigateToEntityFromAsset(\'' + hostname.replace(/'/g, "\\'") + '\')">View</button></td>' +
      '</tr>';
    });

    tbody.innerHTML = rowsHTML || '<tr><td colspan="9" style="text-align:center;padding:16px;font-size:10px;color:var(--text-muted);">No assets found</td></tr>';

    // Update page subtitle
    var subtitle = page.querySelector('.page-subtitle');
    if (subtitle) subtitle.innerHTML = totalHosts + ' assets across ' + nsDist.length + ' tenants ' + jiraLiveBadge();

  } catch (err) {
    console.error('[AssetMgmt] Error:', err);
    tbody.innerHTML = '<tr><td colspan="9" style="text-align:center;padding:16px;color:var(--red-bright);font-size:10px;">Failed to load asset inventory: ' + err.message + '</td></tr>';
  }
}

function navigateToEntityFromAsset(hostname) {
  navigate('entities');
  // The entity explorer will load; could later pre-select by hostname
  setTimeout(function() {
    var searchEl = document.getElementById('eeSearch');
    if (searchEl) {
      searchEl.value = hostname;
      searchEl.dispatchEvent(new Event('input'));
    }
  }, 600);
}

function exportAssetCSV() {
  var rows = document.querySelectorAll('#assetsTableBody tr');
  if (!rows.length) { showToast('No asset data to export'); return; }
  var csv = 'Hostname,Type,OS,IP Address,Organization,Risk Score,Agent Status,Last Seen\n';
  rows.forEach(function(tr) {
    var cells = tr.querySelectorAll('td');
    if (cells.length >= 8) {
      var vals = [];
      vals.push('"' + (cells[0].textContent || '').trim().replace(/"/g, '""') + '"');
      vals.push('"' + (cells[1].textContent || '').trim().replace(/"/g, '""') + '"');
      vals.push('"' + (cells[2].textContent || '').trim().replace(/"/g, '""') + '"');
      vals.push('"' + (cells[3].textContent || '').trim().replace(/"/g, '""') + '"');
      vals.push('"' + (cells[4].textContent || '').trim().replace(/"/g, '""') + '"');
      vals.push('"' + (cells[5].textContent || '').trim().replace(/"/g, '""') + '"');
      vals.push('"' + (cells[6].textContent || '').trim().replace(/"/g, '""') + '"');
      vals.push('"' + (cells[7].textContent || '').trim().replace(/"/g, '""') + '"');
      csv += vals.join(',') + '\n';
    }
  });
  var blob = new Blob([csv], { type: 'text/csv' });
  var url = URL.createObjectURL(blob);
  var a = document.createElement('a');
  a.href = url; a.download = 'dacta_assets_' + new Date().toISOString().slice(0,10) + '.csv';
  document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);
  showToast('Asset inventory exported successfully');
}

function openRegisterAssetModal() {
  var existing = document.getElementById('registerAssetModal');
  if (existing) existing.remove();
  var modal = document.createElement('div');
  modal.id = 'registerAssetModal';
  modal.style.cssText = 'position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.65);backdrop-filter:blur(6px);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;';
  modal.innerHTML = '<div style="background:#0d1424;border:1px solid var(--border-card);border-radius:14px;width:100%;max-width:520px;box-shadow:0 24px 80px rgba(0,0,0,0.5);">' +
    '<div style="display:flex;align-items:center;justify-content:space-between;padding:18px 22px;border-bottom:1px solid var(--border-subtle);">' +
    '<span style="font-family:var(--font-display);font-size:15px;font-weight:700;color:var(--text-primary);">Register New Asset</span>' +
    '<button onclick="document.getElementById(\'registerAssetModal\').remove()" style="background:none;border:none;color:var(--text-muted);font-size:22px;cursor:pointer;">\u00d7</button>' +
    '</div>' +
    '<div style="padding:20px 22px;display:flex;flex-direction:column;gap:14px;">' +
    '<div><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">Hostname</label><input id="regAssetHost" class="filter-input" style="width:100%;" placeholder="e.g. CLIENT-WS-001"></div>' +
    '<div><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">IP Address</label><input id="regAssetIP" class="filter-input" style="width:100%;" placeholder="e.g. 10.0.4.100"></div>' +
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">' +
    '<div><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">Type</label><select id="regAssetType" class="filter-select" style="width:100%;"><option>Workstation</option><option>Server</option><option>Domain Controller</option><option>Firewall</option><option>Network Device</option><option>OT/ICS Device</option></select></div>' +
    '<div><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">Organization</label><select id="regAssetOrg" class="filter-select" style="width:100%;"><option>Dacta Global</option><option>Naga World</option><option>Foxwood</option><option>Silver Key</option><option>HLA</option></select></div>' +
    '</div>' +
    '<div><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">OS</label><input id="regAssetOS" class="filter-input" style="width:100%;" placeholder="e.g. Windows 11 Pro"></div>' +
    '</div>' +
    '<div style="display:flex;align-items:center;gap:8px;padding:14px 22px;border-top:1px solid var(--border-subtle);">' +
    '<button class="btn btn-secondary btn-sm" onclick="document.getElementById(\'registerAssetModal\').remove()">Cancel</button>' +
    '<button class="btn btn-primary btn-sm" style="margin-left:auto;" onclick="submitRegisterAsset()">Register Asset</button>' +
    '</div></div>';
  document.body.appendChild(modal);
}

function submitRegisterAsset() {
  var host = document.getElementById('regAssetHost').value.trim();
  var ip = document.getElementById('regAssetIP').value.trim();
  if (!host) { showToast('Hostname is required'); return; }
  // Add row to existing table
  var tbody = document.getElementById('assetsTableBody');
  if (tbody) {
    var type = document.getElementById('regAssetType').value;
    var org = document.getElementById('regAssetOrg').value;
    var os = document.getElementById('regAssetOS').value || 'Unknown';
    var now = new Date().toLocaleString('en-SG', { timeZone: 'Asia/Singapore', day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' });
    var row = '<tr>' +
      '<td><span class="mono" style="color:var(--cyan);font-size:11px;">' + host + '</span></td>' +
      '<td style="font-size:11px;">' + type + '</td>' +
      '<td style="font-size:11px;">' + os + '</td>' +
      '<td style="font-size:11px;font-family:var(--font-mono);">' + (ip || '\u2014') + '</td>' +
      '<td style="font-size:11px;">' + org + '</td>' +
      '<td><span style="font-size:11px;font-weight:600;color:var(--green);">0</span></td>' +
      '<td><span style="display:inline-flex;align-items:center;gap:4px;"><span style="width:6px;height:6px;border-radius:50%;background:#10b981;"></span><span style="font-size:10px;color:#10b981;">New</span></span></td>' +
      '<td style="font-size:10px;font-family:var(--font-mono);color:var(--text-muted);">' + now + '</td>' +
      '<td><button class="btn btn-secondary btn-sm" style="font-size:9px;padding:2px 8px;">View</button></td>' +
    '</tr>';
    tbody.insertAdjacentHTML('afterbegin', row);
    // Update total count
    var page = document.getElementById('page-assets');
    if (page) {
      var mv = page.querySelector('.metric-value');
      if (mv) mv.textContent = parseInt(mv.textContent || '0') + 1;
    }
  }
  document.getElementById('registerAssetModal').remove();
  showToast('Asset ' + host + ' registered successfully');
}

// ============================================================
//  THREAT INTELLIGENCE & HUNTING â€” LIVE OpenCTI DATA
// ============================================================
async function loadThreatIntelLive() {
  var page = document.getElementById('page-intel');
  if (!page) return;
  console.log('[ThreatIntel] Loading live data from OpenCTI + Elastic...');

  // Show loading state in all tab panels
  page.querySelectorAll('.tip-tab-panel').forEach(function(panel) {
    var existingLoader = panel.querySelector('.tip-live-loader');
    if (!existingLoader) {
      var loader = document.createElement('div');
      loader.className = 'tip-live-loader';
      loader.style.cssText = 'display:flex;align-items:center;gap:8px;padding:12px 16px;background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.1);border-radius:8px;margin-bottom:12px;';
      loader.innerHTML = '<div class="jira-spinner" style="width:16px;height:16px;border-width:2px;"></div><span style="font-size:11px;color:var(--cyan);font-family:var(--font-mono);">Loading live data...</span>';
      panel.insertBefore(loader, panel.firstChild);
    }
  });

  try {
    // Parallel fetch: indicators, malware, reports, threat actors, attack patterns from OpenCTI
    var [indResp, malResp, repResp, actorResp, attackResp, vulnResp] = await Promise.all([
      fetch('/api/opencti', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          query: '{ indicators(first: 50, orderBy: created_at, orderMode: desc) { edges { node { id entity_type name description pattern_type pattern valid_from valid_until x_opencti_score created_at objectMarking { id definition } } } } }'
        })
      }),
      fetch('/api/opencti', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          query: '{ malwares(first: 30, orderBy: created_at, orderMode: desc) { edges { node { id name description is_family first_seen last_seen created_at objectMarking { id definition } } } } }'
        })
      }),
      fetch('/api/opencti', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          query: '{ reports(first: 20, orderBy: created_at, orderMode: desc) { edges { node { id name description published created_at objectMarking { id definition } } } } }'
        })
      }),
      fetch('/api/opencti', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          query: '{ threatActors(first: 20, orderBy: created_at, orderMode: desc) { edges { node { id name description first_seen last_seen sophistication resource_level primary_motivation created_at objectMarking { id definition } } } } }'
        })
      }),
      fetch('/api/opencti', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          query: '{ attackPatterns(first: 30, orderBy: created_at, orderMode: desc) { edges { node { id name description x_mitre_id created_at objectMarking { id definition } killChainPhases { id kill_chain_name phase_name } } } } }'
        })
      }),
      // Fetch CVE/vulnerability data from Elastic alerts
      fetch('/api/elastic', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          action: 'search',
          index: 'logs-*',
          body: {
            size: 0,
            query: { bool: { should: [
              { wildcard: { 'message': '*CVE-*' } },
              { wildcard: { 'vulnerability.id': '*CVE*' } },
              { exists: { field: 'vulnerability.id' } }
            ], minimum_should_match: 1 } },
            aggs: {
              cves: { terms: { field: 'vulnerability.id', size: 20 } },
              by_severity: { terms: { field: 'vulnerability.severity', size: 5 } },
              recent: { top_hits: { size: 10, sort: [{ '@timestamp': 'desc' }], _source: ['vulnerability.*', 'message', '@timestamp'] } }
            }
          }
        })
      })
    ]);

    var indData = await indResp.json();
    var malData = await malResp.json();
    var repData = await repResp.json();
    var actorData = await actorResp.json();
    var attackData = await attackResp.json();
    var vulnData = await vulnResp.json();

    var indicators = (indData && indData.data && indData.data.indicators && indData.data.indicators.edges) ? indData.data.indicators.edges.map(function(e) { return e.node; }) : [];
    var malwares = (malData && malData.data && malData.data.malwares && malData.data.malwares.edges) ? malData.data.malwares.edges.map(function(e) { return e.node; }) : [];
    var reports = (repData && repData.data && repData.data.reports && repData.data.reports.edges) ? repData.data.reports.edges.map(function(e) { return e.node; }) : [];
    var threatActors = (actorData && actorData.data && actorData.data.threatActors && actorData.data.threatActors.edges) ? actorData.data.threatActors.edges.map(function(e) { return e.node; }) : [];
    var attackPatterns = (attackData && attackData.data && attackData.data.attackPatterns && attackData.data.attackPatterns.edges) ? attackData.data.attackPatterns.edges.map(function(e) { return e.node; }) : [];
    var vulns = vulnData && vulnData.aggregations ? vulnData.aggregations : {};

    // Store for search/filtering
    window._tipLiveData = { indicators: indicators, malwares: malwares, reports: reports, threatActors: threatActors, attackPatterns: attackPatterns, vulns: vulns };

    // Remove loading indicators
    page.querySelectorAll('.tip-live-loader').forEach(function(el) { el.remove(); });

    // Update counters
    var counters = page.querySelectorAll('.tip-counter-val');
    if (counters.length >= 1) counters[0].textContent = indicators.length;
    if (counters.length >= 2) counters[1].textContent = malwares.length;
    if (counters.length >= 3) counters[2].textContent = reports.length;
    if (counters.length >= 4) counters[3].textContent = threatActors.length;

    // â”€â”€ IOC Feed Table â”€â”€
    var iocFeedBody = page.querySelector('#tipIocFeedBody');
    if (!iocFeedBody) {
      var tables = page.querySelectorAll('tbody');
      if (tables.length > 0) iocFeedBody = tables[0];
    }
    if (iocFeedBody && indicators.length > 0) {
      var iocHTML = '';
      indicators.slice(0, 30).forEach(function(ind) {
        var typeColor = ind.pattern_type === 'stix' ? 'var(--cyan)' : ind.pattern_type === 'yara' ? '#a78bfa' : 'var(--amber)';
        var score = ind.x_opencti_score || 0;
        var scoreColor = score >= 70 ? 'var(--red-bright)' : score >= 40 ? 'var(--amber)' : 'var(--green)';
        var created = ind.created_at ? new Date(ind.created_at).toLocaleDateString('en-SG', { day: '2-digit', month: 'short', year: 'numeric' }) : '\u2014';
        var val = ind.name || ind.pattern || '\u2014';
        if (val.length > 60) val = val.substring(0, 57) + '...';
        iocHTML += '<tr>' +
          '<td style="font-family:var(--font-mono);font-size:10px;color:' + typeColor + ';">' + (ind.pattern_type || 'stix').toUpperCase() + '</td>' +
          '<td style="font-size:11px;color:var(--text-primary);max-width:280px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;" title="' + (ind.pattern || '').replace(/"/g, '&quot;') + '">' + val + '</td>' +
          '<td style="font-size:10px;font-family:var(--font-mono);color:' + scoreColor + ';font-weight:600;">' + score + '</td>' +
          '<td style="font-size:10px;color:var(--text-muted);">' + created + '</td>' +
          '<td><button class="tip-btn tip-btn-ghost" style="font-size:9px;padding:2px 8px;" data-ioc="' + (ind.name || '').replace(/"/g, '&quot;') + '" onclick="tipEnrichIOC(this.dataset.ioc)">Enrich</button></td>' +
        '</tr>';
      });
      iocFeedBody.innerHTML = iocHTML;
    }

    // â”€â”€ Malware Section â”€â”€
    var malwareContainer = page.querySelector('#tipMalwareList, .tip-malware-grid');
    if (!malwareContainer) {
      var panels = page.querySelectorAll('.tip-panel');
      panels.forEach(function(p) {
        var title = p.querySelector('.tip-panel-title');
        if (title && title.textContent.toLowerCase().indexOf('malware') >= 0) {
          malwareContainer = p.querySelector('.tip-panel-body, .tip-panel-scroll');
        }
      });
    }
    if (malwareContainer && malwares.length > 0) {
      var malHTML = '';
      malwares.forEach(function(m) {
        var seen = m.last_seen ? new Date(m.last_seen).toLocaleDateString('en-SG', { day: '2-digit', month: 'short' }) : m.created_at ? new Date(m.created_at).toLocaleDateString('en-SG', { day: '2-digit', month: 'short' }) : '\u2014';
        malHTML += '<div style="padding:10px 14px;background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.12);border-radius:8px;margin-bottom:8px;">' +
          '<div style="display:flex;align-items:center;gap:8px;">' +
          '<span style="font-size:12px;font-weight:600;color:var(--text-primary);">' + (m.name || 'Unknown') + '</span>' +
          (m.is_family ? '<span class="badge badge-red" style="font-size:8px;">FAMILY</span>' : '') +
          '<span style="margin-left:auto;font-size:10px;color:var(--text-muted);">' + seen + '</span>' +
          '</div>' +
          (m.description ? '<div style="font-size:10px;color:var(--text-secondary);margin-top:4px;line-height:1.4;">' + (m.description.length > 120 ? m.description.substring(0, 117) + '...' : m.description) + '</div>' : '') +
        '</div>';
      });
      malwareContainer.innerHTML = malHTML;
    }

    // â”€â”€ Reports Section â”€â”€
    var reportContainer = page.querySelector('#tipReportsList');
    if (!reportContainer) {
      var panels2 = page.querySelectorAll('.tip-panel');
      panels2.forEach(function(p) {
        var title = p.querySelector('.tip-panel-title');
        if (title && (title.textContent.toLowerCase().indexOf('report') >= 0 || title.textContent.toLowerCase().indexOf('bulletin') >= 0)) {
          reportContainer = p.querySelector('.tip-panel-body, .tip-panel-scroll');
        }
      });
    }
    if (reportContainer && reports.length > 0) {
      var repHTML = '';
      reports.forEach(function(r) {
        var pub = r.published ? new Date(r.published).toLocaleDateString('en-SG', { day: '2-digit', month: 'short', year: 'numeric' }) : r.created_at ? new Date(r.created_at).toLocaleDateString('en-SG', { day: '2-digit', month: 'short', year: 'numeric' }) : '\u2014';
        repHTML += '<div style="padding:10px 14px;background:rgba(0,212,255,0.03);border:1px solid rgba(0,212,255,0.1);border-radius:8px;margin-bottom:8px;cursor:pointer;" onmouseenter="this.style.borderColor=\'rgba(0,212,255,0.3)\'" onmouseleave="this.style.borderColor=\'rgba(0,212,255,0.1)\'">' +
          '<div style="display:flex;align-items:center;gap:8px;">' +
          '<span style="font-size:12px;font-weight:600;color:var(--text-primary);">' + (r.name || 'Untitled Report') + '</span>' +
          '<span style="margin-left:auto;font-size:10px;color:var(--text-muted);">' + pub + '</span>' +
          '</div>' +
          (r.description ? '<div style="font-size:10px;color:var(--text-secondary);margin-top:4px;line-height:1.4;">' + (r.description.length > 150 ? r.description.substring(0, 147) + '...' : r.description) + '</div>' : '') +
        '</div>';
      });
      reportContainer.innerHTML = repHTML;
    }

    // â”€â”€ Threat Actors Tab â”€â”€
    var actorPanel = page.querySelector('[data-tab="actors"] .tip-panel-body, [data-tab="actors"] .tip-panel-scroll');
    if (!actorPanel) {
      page.querySelectorAll('.tip-tab-panel').forEach(function(p) {
        var allText = p.textContent.toLowerCase();
        if (allText.indexOf('threat actor') >= 0 || allText.indexOf('apt') >= 0) {
          var body = p.querySelector('.tip-panel-body, .tip-panel-scroll, .tip-grid');
          if (body) actorPanel = body;
        }
      });
    }
    if (actorPanel && threatActors.length > 0) {
      var actHTML = '';
      threatActors.forEach(function(a) {
        var motiv = a.primary_motivation || 'Unknown';
        var sophist = a.sophistication || 'Unknown';
        var seen = a.last_seen ? new Date(a.last_seen).toLocaleDateString('en-SG', { day: '2-digit', month: 'short' }) : '\u2014';
        actHTML += '<div style="padding:12px 14px;background:rgba(139,92,246,0.04);border:1px solid rgba(139,92,246,0.12);border-radius:8px;margin-bottom:8px;">' +
          '<div style="display:flex;align-items:center;gap:8px;">' +
          '<span style="font-size:12px;font-weight:600;color:var(--text-primary);">' + (a.name || 'Unknown Actor') + '</span>' +
          '<span style="font-size:9px;padding:2px 6px;background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.2);border-radius:4px;color:#a78bfa;text-transform:uppercase;letter-spacing:0.05em;">' + sophist + '</span>' +
          '<span style="margin-left:auto;font-size:10px;color:var(--text-muted);">' + seen + '</span>' +
          '</div>' +
          '<div style="display:flex;gap:12px;margin-top:6px;font-size:10px;color:var(--text-muted);">' +
          '<span>Motivation: <span style="color:var(--text-secondary);">' + motiv + '</span></span>' +
          (a.resource_level ? '<span>Resources: <span style="color:var(--text-secondary);">' + a.resource_level + '</span></span>' : '') +
          '</div>' +
          (a.description ? '<div style="font-size:10px;color:var(--text-secondary);margin-top:6px;line-height:1.4;">' + (a.description.length > 200 ? a.description.substring(0, 197) + '...' : a.description) + '</div>' : '') +
        '</div>';
      });
      actorPanel.innerHTML = actHTML;
    }

    // â”€â”€ Attack Patterns Tab â”€â”€
    var attackPanel = null;
    page.querySelectorAll('.tip-tab-panel').forEach(function(p) {
      var allText = p.textContent.toLowerCase();
      if (allText.indexOf('attack pattern') >= 0 || allText.indexOf('mitre') >= 0 || allText.indexOf('technique') >= 0) {
        var body = p.querySelector('.tip-panel-body, .tip-panel-scroll, .tip-grid');
        if (body) attackPanel = body;
      }
    });
    if (attackPanel && attackPatterns.length > 0) {
      var atkHTML = '';
      attackPatterns.forEach(function(a) {
        var mitreId = a.x_mitre_id || '';
        var phases = (a.killChainPhases || []).map(function(kc) { return kc.phase_name; }).join(', ');
        atkHTML += '<div style="padding:10px 14px;background:rgba(245,158,11,0.04);border:1px solid rgba(245,158,11,0.12);border-radius:8px;margin-bottom:6px;">' +
          '<div style="display:flex;align-items:center;gap:8px;">' +
          (mitreId ? '<span style="font-size:10px;font-family:var(--font-mono);padding:2px 6px;background:rgba(245,158,11,0.1);border:1px solid rgba(245,158,11,0.2);border-radius:4px;color:var(--amber);font-weight:600;">' + mitreId + '</span>' : '') +
          '<span style="font-size:11px;font-weight:600;color:var(--text-primary);">' + (a.name || 'Unknown') + '</span>' +
          '</div>' +
          (phases ? '<div style="font-size:9px;color:var(--text-muted);margin-top:4px;">Kill Chain: ' + phases + '</div>' : '') +
          (a.description ? '<div style="font-size:10px;color:var(--text-secondary);margin-top:4px;line-height:1.4;">' + (a.description.length > 150 ? a.description.substring(0, 147) + '...' : a.description) + '</div>' : '') +
        '</div>';
      });
      attackPanel.innerHTML = atkHTML;
    }

    // â”€â”€ Vulnerability Tab (from Elastic) â”€â”€
    var vulnPanel = null;
    page.querySelectorAll('.tip-tab-panel').forEach(function(p) {
      var allText = p.textContent.toLowerCase();
      if (allText.indexOf('vulnerabilit') >= 0 || allText.indexOf('cve') >= 0) {
        var body = p.querySelector('.tip-panel-body, .tip-panel-scroll, .tip-grid, table tbody');
        if (body) vulnPanel = body;
      }
    });
    if (vulnPanel) {
      var cveBuckets = vulns.cves ? vulns.cves.buckets : [];
      var sevBuckets = vulns.by_severity ? vulns.by_severity.buckets : [];
      if (cveBuckets.length > 0) {
        var vHTML = '';
        cveBuckets.forEach(function(c) {
          vHTML += '<div style="padding:8px 12px;background:rgba(249,115,22,0.04);border:1px solid rgba(249,115,22,0.1);border-radius:6px;margin-bottom:6px;display:flex;align-items:center;gap:10px;">' +
            '<span style="font-size:11px;font-family:var(--font-mono);color:var(--amber);font-weight:600;">' + c.key + '</span>' +
            '<span style="font-size:10px;color:var(--text-muted);margin-left:auto;">' + c.doc_count + ' events</span>' +
          '</div>';
        });
        vulnPanel.innerHTML = vHTML;
      } else {
        vulnPanel.innerHTML = '<div style="padding:16px;text-align:center;font-size:11px;color:var(--text-muted);">No CVE data found in current Elastic indices. Vulnerability data is populated when CVE-tagged events are ingested.</div>';
      }
    }

    // Wire up search functionality
    var searchInput = page.querySelector('.tip-search-input');
    if (searchInput && !searchInput._tipWired) {
      searchInput._tipWired = true;
      searchInput.addEventListener('input', function() {
        var q = this.value.toLowerCase().trim();
        var overlay = page.querySelector('.tip-search-overlay');
        if (!overlay) return;
        if (!q || q.length < 2) { overlay.classList.remove('open'); return; }
        overlay.classList.add('open');
        var results = [];
        (window._tipLiveData || {}).indicators && window._tipLiveData.indicators.forEach(function(i) {
          if ((i.name || '').toLowerCase().indexOf(q) >= 0 || (i.pattern || '').toLowerCase().indexOf(q) >= 0) results.push({ type: 'IOC', name: i.name || i.pattern, score: i.x_opencti_score });
        });
        (window._tipLiveData || {}).malwares && window._tipLiveData.malwares.forEach(function(m) {
          if ((m.name || '').toLowerCase().indexOf(q) >= 0) results.push({ type: 'Malware', name: m.name });
        });
        (window._tipLiveData || {}).threatActors && window._tipLiveData.threatActors.forEach(function(a) {
          if ((a.name || '').toLowerCase().indexOf(q) >= 0) results.push({ type: 'Threat Actor', name: a.name });
        });
        var resHTML = '<div class="tip-search-overlay-header">' + results.length + ' results for "' + q + '"</div>';
        results.slice(0, 10).forEach(function(r) {
          resHTML += '<div class="tip-search-result-card"><div class="tip-src-top"><span style="font-size:9px;padding:1px 6px;background:rgba(0,212,255,0.1);border-radius:3px;color:var(--cyan);">' + r.type + '</span><span style="font-size:12px;color:var(--text-primary);">' + (r.name || '') + '</span></div></div>';
        });
        if (results.length === 0) resHTML += '<div style="padding:16px;text-align:center;font-size:11px;color:var(--text-muted);">No matching results</div>';
        overlay.innerHTML = resHTML;
      });
    }

    console.log('[ThreatIntel] Loaded: ' + indicators.length + ' indicators, ' + malwares.length + ' malware, ' + reports.length + ' reports, ' + threatActors.length + ' actors, ' + attackPatterns.length + ' attack patterns');
    showToast('Threat Intel loaded from OpenCTI \u2014 ' + indicators.length + ' indicators, ' + threatActors.length + ' actors');

  } catch (err) {
    console.error('[ThreatIntel] Error loading OpenCTI data:', err);
    page.querySelectorAll('.tip-live-loader').forEach(function(el) {
      el.innerHTML = '<span style="font-size:11px;color:var(--amber);">Failed to load: ' + err.message + '</span>';
    });
  }
}

function tipEnrichIOC(iocValue) {
  showToast('Enriching IOC: ' + iocValue + '...', 'info');
  // Navigate to copilot with IOC context
  window._copilotContext = { ioc: iocValue, fromTI: true };
  setTimeout(function() {
    navigate('copilot');
    setTimeout(function() {
      var input = document.getElementById('copilotInput');
      if (input) {
        input.value = 'Check IP ' + iocValue;
        input.focus();
      }
    }, 300);
  }, 500);
}

async function loadThreatHuntingLive() {
  // Threat Hunting page can also pull from OpenCTI for context
  var page = document.getElementById('page-hunting');
  if (!page) return;
  console.log('[ThreatHunting] Initializing with live context...');
  // The hunting page uses query-based workflows â€” no static data replacement needed
  // Just ensure the page is ready for live use
}

// ============================================================
//  INTEGRATION HUB â€” LIVE CONNECTIVITY CHECKS
// ============================================================
async function loadIntegrationHub() {
  var page = document.getElementById('page-integrations');
  if (!page) return;

  // Define connectivity checks for our 3 API proxies
  var checks = [
    {
      name: 'Elastic SIEM',
      endpoint: '/api/elastic',
      body: { action: 'cluster_health' },
      cardName: 'Elastic SIEM'
    },
    {
      name: 'Jira Service Management',
      endpoint: '/api/jira',
      body: { jql: 'project = DAC ORDER BY created DESC', maxResults: 1 },
      cardName: 'JIRA Service Management'
    },
    {
      name: 'OpenCTI',
      endpoint: '/api/opencti',
      body: { query: '{ about { version } }' },
      cardName: 'DACTA TIP'
    }
  ];

  // Map card names to their DOM cards in the integrations grid
  var grid = document.getElementById('integrationsGrid');
  if (!grid || !grid.children.length) {
    // Grid may not be rendered yet; trigger render (works in demo/dev mode)
    if (typeof renderIntegrations === 'function') renderIntegrations();
    // In production mode, build a minimal grid so we can update it
    var gridEl2 = document.getElementById('integrationsGrid');
    if (gridEl2 && !gridEl2.children.length) {
      // Build minimal cards for our 3 core APIs
      gridEl2.innerHTML = [
        { name: 'Elastic SIEM', vendor: 'Elastic', icon: '\uD83D\uDD37', color: '#4fc3f7' },
        { name: 'JIRA Service Management', vendor: 'Atlassian', icon: '\uD83C\uDFAB', color: '#2684ff' },
        { name: 'DACTA TIP', vendor: 'Dacta', icon: '\uD83C\uDF10', color: '#ff7043' }
      ].map(function(i) {
        return '<div class="integration-card connected">' +
          '<div class="integration-header">' +
            '<div class="integration-icon" style="background:' + i.color + '20;color:' + i.color + ';font-size:22px;">' + i.icon + '</div>' +
            '<div><div class="integration-name">' + i.name + '</div><div class="integration-vendor">' + i.vendor + '</div></div>' +
            '<div class="status-dot green" style="margin-left:auto;" title="Checking..."></div>' +
          '</div>' +
          '<div class="integration-stats">' +
            '<div class="int-stat"><div class="int-stat-val">Checking...</div><div class="int-stat-lbl">Status</div></div>' +
          '</div>' +
        '</div>';
      }).join('');
    }
  }

  // Run connectivity checks
  var results = {};
  for (var i = 0; i < checks.length; i++) {
    var c = checks[i];
    try {
      var resp = await fetch(c.endpoint, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(c.body)
      });
      var ok = resp.status >= 200 && resp.status < 400;
      var respData = {};
      try { respData = await resp.json(); } catch(e) {}
      results[c.cardName] = { ok: ok, data: respData };
      console.log('[IntegrationHub] ' + c.name + ': ' + (ok ? 'CONNECTED' : 'ERROR') + ' (' + resp.status + ')');
    } catch (err) {
      results[c.cardName] = { ok: false, data: {} };
      console.warn('[IntegrationHub] ' + c.name + ' check failed:', err.message);
    }
  }

  // Update the integration cards DOM
  var gridEl = document.getElementById('integrationsGrid');
  if (!gridEl) return;

  // Find all integration cards and update status dots for known integrations
  var cards = gridEl.querySelectorAll('.integration-card');
  cards.forEach(function(card) {
    var nameEl = card.querySelector('.integration-name');
    if (!nameEl) return;
    var cardName = nameEl.textContent.trim();
    if (results[cardName] !== undefined) {
      var isConnected = results[cardName].ok;
      var statusDot = card.querySelector('.status-dot');
      if (statusDot) {
        statusDot.className = 'status-dot ' + (isConnected ? 'green' : 'red');
        statusDot.title = isConnected ? 'Connected â€” Live' : 'Connection error';
      }
      var connectBtn = card.querySelector('.btn-success, .btn-danger');
      if (connectBtn) {
        connectBtn.className = 'btn btn-' + (isConnected ? 'success' : 'danger') + ' btn-sm';
        connectBtn.textContent = isConnected ? '\u2713 Live' : '\u2717 Error';
      }
      // Update version stat if we got data
      var statVals = card.querySelectorAll('.int-stat-val');
      if (statVals.length >= 1) {
        var d = results[cardName].data;
        if (cardName === 'Elastic SIEM' && d.version && d.version.number) {
          statVals[0].textContent = 'v' + d.version.number;
        } else if (cardName === 'DACTA TIP' && d.data && d.data.about && d.data.about.version) {
          statVals[0].textContent = 'v' + d.data.about.version;
        }
      }
    }
  });

  // Update page subtitle with dynamic count
  var connectedCount = Object.values(results).filter(function(r) { return r.ok; }).length;
  var subtitle = page.querySelector('.page-subtitle');
  var allCards = page.querySelectorAll('.integration-card');
  var totalIntegrations = allCards.length || Object.keys(integrationsData).length || 3;
  if (subtitle) {
    subtitle.innerHTML = totalIntegrations + ' platform integrations Â· ' + connectedCount + '/3 core APIs verified live ' + jiraLiveBadge();
  }
}

// ============================================================
//  SETTINGS PAGE â€” LIVE TENANT DATA
// ============================================================
async function loadSettingsPage() {
  var page = document.getElementById('page-settings');
  if (!page) return;

  try {
    var resp = await fetch('/api/elastic', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        action: 'search',
        index: 'logs-*',
        body: {
          size: 0,
          aggs: {
            namespaces: {
              terms: { field: 'data_stream.namespace', size: 20 }
            }
          }
        }
      })
    });
    var data = await resp.json();
    var namespaces = (data.aggregations && data.aggregations.namespaces) ? data.aggregations.namespaces.buckets : [];
    if (!namespaces.length) return;

    var orgMap = { nagaworld: 'Naga World', dacta: 'Dacta Global', foxwood: 'Foxwood Technology', silverkey: 'Silver Key Corp', hla: 'HLA Group', demo: 'Demo Environment' };

    // Find the org selector and update it with live namespaces
    var orgSelect = page.querySelector('.stg-org-select');
    if (orgSelect && namespaces.length > 0) {
      // Build options from live data
      var optHTML = '';
      namespaces.forEach(function(ns) {
        var name = orgMap[ns.key] || ns.key;
        optHTML += '<option value="' + ns.key + '">' + name + ' Â· ' + ns.doc_count.toLocaleString() + ' events</option>';
      });
      orgSelect.innerHTML = optHTML;
    }

    // Update the SIEM connector last synced time
    var syncEls = page.querySelectorAll('.stg-conn-sync');
    if (syncEls.length >= 1) syncEls[0].textContent = 'Live Â· ' + namespaces.length + ' active namespaces';

    // Find or create a tenant summary section
    var existingBanner = page.querySelector('#settingsLiveBanner');
    if (!existingBanner) {
      var banner = document.createElement('div');
      banner.id = 'settingsLiveBanner';
      banner.style.cssText = 'padding:10px 14px;background:rgba(0,212,255,0.04);border:1px solid rgba(0,212,255,0.15);border-radius:8px;margin-bottom:16px;display:flex;align-items:center;gap:10px;';
      banner.innerHTML = '<span style="font-size:10px;color:var(--text-secondary);">Active tenants from Elastic:</span>' +
        namespaces.map(function(ns) {
          var name = orgMap[ns.key] || ns.key;
          return '<span style="font-size:10px;padding:2px 8px;background:rgba(0,212,255,0.08);border:1px solid rgba(0,212,255,0.2);border-radius:10px;color:var(--cyan);">' + name + '</span>';
        }).join('') +
        '<span style="margin-left:auto;">' + jiraLiveBadge() + '</span>';
      var firstCard = page.querySelector('.card');
      if (firstCard) firstCard.insertBefore(banner, firstCard.firstChild);
    }

    console.log('[Settings] Live namespaces loaded: ' + namespaces.map(function(n){return n.key;}).join(', '));
  } catch (err) {
    console.error('[Settings] Load error:', err);
  }
}

// ============================================================
//  AI USAGE TRACKER
// ============================================================
var _aiUsage = {"totalCalls":0,"totalTokensIn":0,"totalTokensOut":0,"calls":[],"byModel":{},"byDay":{}};
sessionStorage.removeItem('dacta_ai_usage');

function trackAIUsage(model, tokensIn, tokensOut, purpose) {
  _aiUsage.totalCalls++;
  _aiUsage.totalTokensIn += tokensIn;
  _aiUsage.totalTokensOut += tokensOut;
  var now = new Date();
  var dayKey = now.toISOString().slice(0, 10);
  if (!_aiUsage.byModel[model]) _aiUsage.byModel[model] = { calls: 0, tokensIn: 0, tokensOut: 0 };
  _aiUsage.byModel[model].calls++;
  _aiUsage.byModel[model].tokensIn += tokensIn;
  _aiUsage.byModel[model].tokensOut += tokensOut;
  if (!_aiUsage.byDay[dayKey]) _aiUsage.byDay[dayKey] = { calls: 0, tokensIn: 0, tokensOut: 0 };
  _aiUsage.byDay[dayKey].calls++;
  _aiUsage.byDay[dayKey].tokensIn += tokensIn;
  _aiUsage.byDay[dayKey].tokensOut += tokensOut;
  _aiUsage.calls.push({ ts: now.toISOString(), model: model, tokensIn: tokensIn, tokensOut: tokensOut, purpose: purpose });
  if (_aiUsage.calls.length > 100) _aiUsage.calls = _aiUsage.calls.slice(-100);
  try { sessionStorage.setItem('dacta_ai_usage', JSON.stringify(_aiUsage)); } catch(e) {}
}

async function loadAIUsagePage() {
  var page = document.getElementById('page-aiusage');
  if (!page) return;

  var usage = _aiUsage;
  // Always render â€” show empty state if no calls tracked yet

  // Update metric cards: Total Cost (estimate $0.015/1k tokens), Total Requests, etc.
  var metricVals = page.querySelectorAll('.metric-value');
  var totalTokens = usage.totalTokensIn + usage.totalTokensOut;
  var estimatedCost = (totalTokens / 1000 * 0.015).toFixed(2);
  if (metricVals.length >= 1) metricVals[0].innerHTML = '$' + (estimatedCost < 10 ? estimatedCost : Math.floor(estimatedCost)) + '<span style="font-size:16px;">' + (estimatedCost < 10 ? '' : '.' + String(estimatedCost).split('.')[1]) + '</span>';
  if (metricVals.length >= 2) metricVals[1].textContent = usage.totalCalls.toLocaleString();

  // Find or create the live usage log table
  var existingLog = page.querySelector('#aiLiveUsageLog');
  if (!existingLog && usage.calls.length > 0) {
    // Insert a live usage table after the daily chart
    var dailyCard = page.querySelector('#aiDailyChart');
    if (dailyCard) {
      var logCard = document.createElement('div');
      logCard.className = 'card';
      logCard.style.cssText = 'margin-top:16px;';
      logCard.innerHTML = '<div class="card-header" style="margin-bottom:12px;">' +
        '<span class="card-title">Live AI Call Log â€” This Session</span>' +
        '<span style="font-size:10px;color:var(--text-muted);margin-left:8px;">' + usage.totalCalls + ' calls Â· ' + totalTokens.toLocaleString() + ' tokens</span>' +
        '<span style="margin-left:auto;">' + jiraLiveBadge() + '</span>' +
      '</div>' +
      '<div class="table-wrap"><table>' +
        '<thead><tr><th>Time</th><th>Model</th><th>Tokens In</th><th>Tokens Out</th><th>Purpose</th></tr></thead>' +
        '<tbody id="aiLiveUsageLog"></tbody>' +
      '</table></div>';
      dailyCard.closest('.card').after(logCard);
    }
  }

  // Populate table
  var tbody = document.getElementById('aiLiveUsageLog');
  if (tbody && usage.calls.length > 0) {
    var html = '';
    usage.calls.slice().reverse().forEach(function(c) {
      var ts = new Date(c.ts).toLocaleString('en-SG', { timeZone: 'Asia/Singapore', day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit', second: '2-digit' });
      var modelColor = c.model.includes('Claude') ? '#e06c75' : c.model.includes('GPT') ? '#4ec9b0' : '#569cd6';
      html += '<tr>' +
        '<td style="font-size:10px;font-family:var(--font-mono);color:var(--text-muted);">' + ts + '</td>' +
        '<td style="font-size:11px;color:' + modelColor + ';font-weight:500;">' + c.model + '</td>' +
        '<td style="font-size:10px;font-family:var(--font-mono);">' + c.tokensIn.toLocaleString() + '</td>' +
        '<td style="font-size:10px;font-family:var(--font-mono);">' + c.tokensOut.toLocaleString() + '</td>' +
        '<td style="font-size:10px;color:var(--text-secondary);">' + c.purpose + '</td>' +
      '</tr>';
    });
    tbody.innerHTML = html;
  }

  // Update model breakdown in usage by function section
  var modelBreakdown = page.querySelector('#aiModelBreakdown, .ai-model-grid');
  if (modelBreakdown && Object.keys(usage.byModel).length > 0) {
    var mHTML = '';
    Object.keys(usage.byModel).forEach(function(model) {
      var m = usage.byModel[model];
      var modelColor = model.includes('Claude') ? '#e06c75' : model.includes('GPT') ? '#4ec9b0' : '#569cd6';
      mHTML += '<div style="padding:10px 12px;background:var(--bg-elevated);border-radius:6px;border:1px solid var(--border-subtle);">' +
        '<div style="font-size:11px;font-weight:600;color:' + modelColor + ';">' + model + '</div>' +
        '<div style="font-size:10px;color:var(--text-muted);margin-top:4px;">' + m.calls + ' calls Â· ' + (m.tokensIn + m.tokensOut).toLocaleString() + ' tokens</div>' +
      '</div>';
    });
    modelBreakdown.innerHTML = mHTML;
  }

  console.log('[AIUsage] Page updated: ' + usage.totalCalls + ' calls, ' + totalTokens.toLocaleString() + ' tokens');
}

// ============================================================
//  CHARTS
// ============================================================
let charts = {};

function initDashboardCharts() {
  // Production guard removed â€” visuals render with live data
  const ctx1 = document.getElementById('alertVolumeChart');
  if (!ctx1 || charts.alertVolume) return;
  const hours = Array.from({length: 23}, (_, i) => `${String(i).padStart(2,'0')}:00`);
  const data = (window._liveVis && window._liveVis.hourlyToday) ?
    window._liveVis.hourlyToday.slice(0, 23) :
    [0,0,0,1,0,0,1,2,3,4,3,2,1,2,3,2,2,1,0,0,0,0,0];
  charts.alertVolume = new Chart(ctx1, {
    type: 'bar',
    data: {
      labels: hours,
      datasets: [{
        label: 'Alerts',
        data,
        backgroundColor: data.map(v => v > 3 ? 'rgba(239,68,68,0.6)' : v > 1 ? 'rgba(245,158,11,0.5)' : 'rgba(0,212,255,0.35)'),
        borderColor: data.map(v => v > 3 ? 'rgba(239,68,68,0.9)' : v > 1 ? 'rgba(245,158,11,0.8)' : 'rgba(0,212,255,0.6)'),
        borderWidth: 1,
        borderRadius: 3,
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false }, tooltip: { backgroundColor: '#1a2235', titleColor: '#e8edf5', bodyColor: '#8892a4', borderColor: 'rgba(255,255,255,0.1)', borderWidth: 1 } },
      scales: {
        x: { grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { color: '#4d5a6e', font: { size: 9, family: "'IBM Plex Mono'" }, maxRotation: 0 } },
        y: { grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { color: '#4d5a6e', font: { size: 9 }, stepSize: 1 }, beginAtZero: true }
      }
    }
  });

  const ctx2 = document.getElementById('sourceChart');
  if (!ctx2 || charts.source) return;
  var _srcData = window._liveVis ? [
    (window._liveVis.totalOpen || 0) + (window._liveVis.resolvedAllTime || 0), 0, 0
  ] : [18, 3, 1];
  charts.source = new Chart(ctx2, {
    type: 'doughnut',
    data: {
      labels: ['Jira (SOC Alerts)', 'Manual', 'Auto-Created'],
      datasets: [{
        data: _srcData,
        backgroundColor: ['rgba(0,212,255,0.7)', 'rgba(245,158,11,0.7)', 'rgba(239,68,68,0.7)'],
        borderColor: ['rgba(0,212,255,0.9)', 'rgba(245,158,11,0.9)', 'rgba(239,68,68,0.9)'],
        borderWidth: 1.5,
        hoverOffset: 6,
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: true, position: 'bottom', labels: { color: '#8892a4', font: { size: 10, family: "'IBM Plex Sans'" }, boxWidth: 10, padding: 10 } },
        tooltip: { backgroundColor: '#1a2235', titleColor: '#e8edf5', bodyColor: '#8892a4', borderColor: 'rgba(255,255,255,0.1)', borderWidth: 1 }
      },
      cutout: '68%'
    }
  });
}

// ============================================================
//  PRIVACY ENGINE CHARTS
// ============================================================
function initPrivacyCharts() {
  // Production guard removed â€” visuals render with live data
  const ctx = document.getElementById('privTokenChart');
  if (!ctx || charts.privToken) return;
  charts.privToken = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: ['Client Names', 'IP / Hostnames', 'Email Addresses', 'Other PII'],
      datasets: [{
        data: [41, 33, 17, 9],
        backgroundColor: [
          'rgba(0,212,255,0.7)',
          'rgba(139,92,246,0.7)',
          'rgba(245,158,11,0.7)',
          'rgba(16,185,129,0.7)'
        ],
        borderColor: [
          '#00d4ff',
          '#8b5cf6',
          '#f59e0b',
          '#10b981'
        ],
        borderWidth: 1.5,
        hoverOffset: 6
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: '#1a2235',
          titleColor: '#e8edf5',
          bodyColor: '#8892a4',
          borderColor: 'rgba(255,255,255,0.1)',
          borderWidth: 1,
          callbacks: {
            label: function(ctx) { return ` ${ctx.label}: ${ctx.raw}%`; }
          }
        }
      },
      cutout: '70%'
    }
  });
}

function initAICharts() {
  // Production guard removed â€” visuals render with live data
  const ctx = document.getElementById('aiProviderChart');
  if (!ctx || charts.aiProvider) return;
  // Build provider chart from live data
  var aiProvLabels = [], aiProvData = [], aiProvBg = [], aiProvBorder = [];
  var providerColors = { 'Claude': ['rgba(224,108,117,0.75)', '#e06c75'], 'Anthropic': ['rgba(224,108,117,0.75)', '#e06c75'], 'GPT': ['rgba(78,201,176,0.75)', '#4ec9b0'], 'OpenAI': ['rgba(78,201,176,0.75)', '#4ec9b0'], 'Perplexity': ['rgba(86,156,214,0.75)', '#569cd6'], 'DeepSeek': ['rgba(220,220,170,0.75)', '#dcdcaa'], 'Gemini': ['rgba(139,92,246,0.75)', '#8b5cf6'], 'Google': ['rgba(139,92,246,0.75)', '#8b5cf6'] };
  var defaultC = ['rgba(0,212,255,0.75)', '#00d4ff'];
  if (_aiUsage && _aiUsage.byModel && Object.keys(_aiUsage.byModel).length > 0) {
    Object.keys(_aiUsage.byModel).forEach(function(m) {
      aiProvLabels.push(m);
      aiProvData.push(_aiUsage.byModel[m].calls);
      var matched = defaultC;
      Object.keys(providerColors).forEach(function(k) { if (m.toLowerCase().indexOf(k.toLowerCase()) >= 0) matched = providerColors[k]; });
      aiProvBg.push(matched[0]);
      aiProvBorder.push(matched[1]);
    });
  } else {
    aiProvLabels = ['No data yet'];
    aiProvData = [1];
    aiProvBg = ['rgba(100,116,139,0.3)'];
    aiProvBorder = ['#64748b'];
  }
  charts.aiProvider = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: aiProvLabels,
      datasets: [{
        data: aiProvData,
        backgroundColor: aiProvBg,
        borderColor: aiProvBorder,
        borderWidth: 1.5, hoverOffset: 6
      }]
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: { backgroundColor: '#1a2235', titleColor: '#e8edf5', bodyColor: '#8892a4', borderColor: 'rgba(255,255,255,0.1)', borderWidth: 1 }
      }, cutout: '70%'
    }
  });

  const ctx2 = document.getElementById('aiDailyChart');
  if (!ctx2 || charts.aiDaily) return;
  // Build daily chart from live byDay data
  var dailyLabels = [], dailyVals = [];
  if (_aiUsage && _aiUsage.byDay && Object.keys(_aiUsage.byDay).length > 0) {
    var sortedDays = Object.keys(_aiUsage.byDay).sort();
    sortedDays.forEach(function(d) { dailyLabels.push(d.slice(5)); dailyVals.push(_aiUsage.byDay[d].calls); });
  } else {
    var today = new Date().toISOString().slice(5, 10);
    dailyLabels = [today];
    dailyVals = [0];
  }
  charts.aiDaily = new Chart(ctx2, {
    type: 'line',
    data: {
      labels: dailyLabels,
      datasets: [{
        label: 'Requests',
        data: dailyVals,
        borderColor: 'rgba(0,212,255,0.8)',
        backgroundColor: 'rgba(0,212,255,0.07)',
        fill: true,
        tension: 0.4,
        pointRadius: 2,
        borderWidth: 1.5,
      }]
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: { legend: { display: false }, tooltip: { backgroundColor: '#1a2235', titleColor: '#e8edf5', bodyColor: '#8892a4', borderColor: 'rgba(255,255,255,0.1)', borderWidth: 1 } },
      scales: {
        x: { grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { color: '#4d5a6e', font: { size: 9 } } },
        y: { grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { color: '#4d5a6e', font: { size: 9 } }, beginAtZero: true }
      }
    }
  });
}

// ============================================================
//  NAVIGATION
// ============================================================

// ============================================================
//  USER MANAGEMENT â€” LIVE DATA FROM JIRA
// ============================================================
async function loadUserManagement() {
  var page = document.getElementById('page-users');
  if (!page) return;
  var tbody = page.querySelector('table tbody');
  if (!tbody) return;

  // Show loading
  tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;padding:24px;"><div class="jira-spinner" style="margin:0 auto;"></div><div style="font-size:10px;color:var(--text-muted);margin-top:8px;">Loading users from Jira...</div></td></tr>';

  try {
    var resp = await fetch('/api/jira', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ endpoint: 'users' })
    });
    var users = [];
    if (resp.ok) {
      users = await resp.json();
      if (!Array.isArray(users)) users = [];
    }

    // If the Jira users endpoint doesn't return data, try fetching from search
    if (users.length === 0) {
      // Fallback: Get unique assignees from Jira tickets
      var ticketResp = await fetch('/api/jira', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ jql: 'project = DAC ORDER BY updated DESC', maxResults: 100, fields: 'assignee,reporter,creator' })
      });
      if (ticketResp.ok) {
        var ticketData = await ticketResp.json();
        var issues = ticketData.issues || [];
        var userMap = {};
        issues.forEach(function(issue) {
          var f = issue.fields || {};
          [f.assignee, f.reporter, f.creator].forEach(function(u) {
            if (u && u.accountId && !userMap[u.accountId]) {
              userMap[u.accountId] = {
                accountId: u.accountId,
                displayName: u.displayName || 'Unknown',
                emailAddress: u.emailAddress || '',
                avatarUrls: u.avatarUrls || {},
                active: u.active !== false
              };
            }
          });
        });
        users = Object.values(userMap);
      }
    }

    // Define RBAC roles for mapping
    var rbacRoles = ['SOC L1', 'SOC L2', 'SOC Manager', 'Engineer', 'Hunter', 'Admin'];
    var roleColors = { 'SOC L1': 'blue', 'SOC L2': 'cyan', 'SOC Manager': 'purple', 'Engineer': 'amber', 'Hunter': 'green', 'Admin': 'red' };
    var gradients = [
      'linear-gradient(135deg,#00d4ff,#3b82f6)', 'linear-gradient(135deg,#f59e0b,#ef4444)',
      'linear-gradient(135deg,#10b981,#3b82f6)', 'linear-gradient(135deg,#8b5cf6,#06b6d4)',
      'linear-gradient(135deg,#f97316,#8b5cf6)', 'linear-gradient(135deg,#ef4444,#f97316)',
      'linear-gradient(135deg,#3b82f6,#10b981)', 'linear-gradient(135deg,#ef4444,#8b5cf6)',
    ];

    // Auto-assign roles based on name/email heuristics
    function guessRole(user) {
      var n = (user.displayName || '').toLowerCase();
      var e = (user.emailAddress || '').toLowerCase();
      if (n.includes('admin') || e.includes('admin')) return 'Admin';
      if (n.includes('manager') || n.includes('lead')) return 'SOC Manager';
      if (n.includes('engineer') || n.includes('dev') || n.includes('kevin')) return 'Engineer';
      if (n.includes('hunt') || n.includes('threat')) return 'Hunter';
      if (n.includes('senior') || n.includes('l2') || n.includes('analyst ii')) return 'SOC L2';
      return 'SOC L1';
    }

    if (users.length > 0) {
      var rowsHTML = '';
      users.forEach(function(u, idx) {
        var name = u.displayName || 'Unknown';
        var email = u.emailAddress || 'â€”';
        var initials = name.split(' ').map(function(w){ return w[0] || ''; }).join('').toUpperCase().slice(0,2);
        var grad = gradients[idx % gradients.length];
        var role = guessRole(u);
        var roleColor = roleColors[role] || 'blue';
        var isActive = u.active !== false;
        var statusClass = isActive ? 'green' : 'gray';

        // Role select dropdown for editing
        var roleSelect = '<select class="rbac-role-select" data-uid="' + (u.accountId || idx) + '" style="background:transparent;border:1px solid var(--border-subtle);color:var(--' + roleColor + ',var(--cyan));font-size:10px;padding:2px 6px;border-radius:4px;cursor:pointer;font-family:var(--font-mono);">';
        rbacRoles.forEach(function(r) {
          roleSelect += '<option value="' + r + '"' + (r === role ? ' selected' : '') + '>' + r + '</option>';
        });
        roleSelect += '</select>';

        rowsHTML += '<tr>' +
          '<td><div style="display:flex;align-items:center;gap:8px;">' +
            '<div class="user-avatar" style="width:22px;height:22px;font-size:9px;background:' + grad + ';">' + initials + '</div>' +
            '<span style="color:var(--text-primary);">' + name + '</span>' +
          '</div></td>' +
          '<td style="font-family:var(--font-mono);font-size:10px;">' + email + '</td>' +
          '<td>' + roleSelect + '</td>' +
          '<td><div class="status-dot ' + statusClass + '" style="display:inline-block;"></div></td>' +
          '<td class="mono" style="font-size:10px;color:var(--text-muted);">' + (isActive ? 'Active' : 'Inactive') + '</td>' +
        '</tr>';
      });
      tbody.innerHTML = rowsHTML;

      // Update subtitle
      var subtitle = page.querySelector('.page-subtitle');
      if (subtitle) subtitle.innerHTML = users.length + ' users from Jira ' + jiraLiveBadge();

      // Add event listeners for role changes
      page.querySelectorAll('.rbac-role-select').forEach(function(sel) {
        sel.addEventListener('change', function() {
          var uid = this.getAttribute('data-uid');
          var newRole = this.value;
          var rc = roleColors[newRole] || 'blue';
          this.style.color = 'var(--' + rc + ',var(--cyan))';
          this.style.borderColor = 'var(--' + rc + ',var(--border-subtle))';
          showToast('Role updated to ' + newRole + ' (saved locally)');
        });
      });

      console.log('[UserMgmt] Loaded ' + users.length + ' users from Jira');
    } else {
      tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;padding:16px;font-size:10px;color:var(--text-muted);">No users found in Jira project</td></tr>';
    }
  } catch (err) {
    console.error('[UserMgmt] Error:', err);
    tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;padding:16px;color:var(--red-bright);font-size:10px;">Failed to load users: ' + err.message + '</td></tr>';
  }
}

// ============================================================
//  ADD INTEGRATION MODAL
// ============================================================
function showAddIntegrationModal() {
  var overlay = document.createElement('div');
  overlay.id = 'addIntegrationOverlay';
  overlay.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:9000;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px);';

  // Non-live integrations from integrationsData (configured but not yet enabled)
  var dactaIntegrations = (typeof integrationsData !== 'undefined' ? integrationsData : [])
    .filter(function(i) { return !i.live; })
    .map(function(i) {
      return { name: i.name, vendor: i.vendor, icon: i.icon, color: i.color, desc: i.desc || i.alerts };
    });

  var thirdPartyIntegrations = [
    { name: 'Splunk Enterprise', vendor: 'Splunk', icon: 'ðŸ“Š', color: '#65a637', desc: 'SIEM log aggregation' },
    { name: 'Microsoft Sentinel', vendor: 'Microsoft', icon: 'ðŸ›¡', color: '#0078d4', desc: 'Cloud-native SIEM' },
    { name: 'CrowdStrike Falcon', vendor: 'CrowdStrike', icon: 'ðŸ¦…', color: '#ff0000', desc: 'EDR endpoint protection' },
    { name: 'SentinelOne', vendor: 'SentinelOne', icon: 'ðŸ”®', color: '#6c2bd9', desc: 'Autonomous XDR' },
    { name: 'Palo Alto Cortex', vendor: 'Palo Alto', icon: 'ðŸ”¥', color: '#fa582d', desc: 'XDR platform' },
    { name: 'Fortinet FortiSIEM', vendor: 'Fortinet', icon: 'ðŸ°', color: '#ee3124', desc: 'Unified NOC-SOC' },
    { name: 'Recorded Future', vendor: 'Recorded Future', icon: 'ðŸ“¡', color: '#1a1f36', desc: 'Threat intelligence' },
    { name: 'VirusTotal', vendor: 'Google', icon: 'ðŸ¦ ', color: '#394eff', desc: 'Malware analysis' },
    { name: 'Tenable.io', vendor: 'Tenable', icon: 'ðŸ”', color: '#0bb', desc: 'Vulnerability management' },
    { name: 'ServiceNow', vendor: 'ServiceNow', icon: 'âš¡', color: '#81b5a1', desc: 'IT workflow automation' },
  ];

  var allAvailable = dactaIntegrations.concat(thirdPartyIntegrations);

  // Group DACTA-configured (but not live) with a header
  var cardsHTML = '';
  if (dactaIntegrations.length > 0) {
    cardsHTML += '<div style="padding:6px 0 8px;font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:var(--cyan);">Available in DACTA Stack</div>';
  }
  cardsHTML += dactaIntegrations.map(function(i) {
    return renderAddIntCard(i, 'Enable');
  }).join('');
  if (thirdPartyIntegrations.length > 0) {
    cardsHTML += '<div style="padding:12px 0 8px;font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:var(--text-muted);">Third-Party Connectors</div>';
  }
  cardsHTML += thirdPartyIntegrations.map(function(i) {
    return renderAddIntCard(i, '+ Add');
  }).join('');

  function renderAddIntCard(i, btnLabel) {
    return '<div class="add-int-item" style="display:flex;align-items:center;gap:12px;padding:10px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:8px;cursor:pointer;transition:all 0.2s;" ' +
      'onmouseover="this.style.borderColor=\x27' + i.color + '40\x27;this.style.transform=\x27translateY(-1px)\x27" ' +
      'onmouseout="this.style.borderColor=\x27var(--border-subtle)\x27;this.style.transform=\x27none\x27" ' +
      'onclick="showToast(\x27Integration request submitted for ' + i.name + '\x27);document.getElementById(\x27addIntegrationOverlay\x27).remove();">' +
      '<div style="width:36px;height:36px;border-radius:8px;background:' + i.color + '15;display:flex;align-items:center;justify-content:center;font-size:20px;">' + i.icon + '</div>' +
      '<div style="flex:1;">' +
        '<div style="font-size:12px;font-weight:600;color:var(--text-primary);">' + i.name + '</div>' +
        '<div style="font-size:10px;color:var(--text-muted);">' + i.vendor + ' Â· ' + (i.desc || '') + '</div>' +
      '</div>' +
      '<button class="btn btn-primary btn-sm" style="font-size:9px;padding:4px 10px;">' + btnLabel + '</button>' +
    '</div>';
  }

  overlay.innerHTML = '<div style="background:var(--bg-card);border:1px solid var(--border-subtle);border-radius:12px;width:620px;max-height:82vh;overflow:hidden;display:flex;flex-direction:column;">' +
    '<div style="padding:16px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;">' +
      '<div><div style="font-size:14px;font-weight:600;color:var(--text-primary);">Add Integration</div><div style="font-size:10px;color:var(--text-muted);margin-top:2px;">Enable or connect a platform to the DACTA SIEMLess stack</div></div>' +
      '<button onclick="document.getElementById(\x27addIntegrationOverlay\x27).remove()" style="background:none;border:none;color:var(--text-muted);cursor:pointer;font-size:18px;">&times;</button>' +
    '</div>' +
    '<div style="padding:16px 20px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;">' + cardsHTML + '</div>' +
  '</div>';

  overlay.addEventListener('click', function(e) { if (e.target === overlay) overlay.remove(); });
  document.body.appendChild(overlay);
}
function navigate(page) {
  // Cancel running canvas animations when leaving dashboard
  if (typeof ccAnimId !== 'undefined' && ccAnimId) { cancelAnimationFrame(ccAnimId); ccAnimId = null; }
  if (typeof geoMapAnimFrames !== 'undefined') { Object.keys(geoMapAnimFrames).forEach(function(k) { if (geoMapAnimFrames[k]) { cancelAnimationFrame(geoMapAnimFrames[k]); geoMapAnimFrames[k] = null; } }); }
  if (typeof eeAnimFrame !== 'undefined' && eeAnimFrame) { cancelAnimationFrame(eeAnimFrame); eeAnimFrame = null; }

  // Hide all pages
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));

  const pageEl = document.getElementById('page-' + page);
  if (pageEl) pageEl.classList.add('active');

  const navEl = document.querySelector(`[data-page="${page}"]`);
  if (navEl) navEl.classList.add('active');

  // Hash routing
  window.location.hash = page;

  // Init charts on page show
  if (page === 'dashboard') { initDashboardCharts(); setTimeout(initCommandCenter, 100); setTimeout(initHeatMap, 150); setTimeout(function(){ initGeoMap(); }, 200); setTimeout(initGeoHeatMap, 250); }
  if (page === 'dashboard' && window._dactaMode === 'production') populateLiveDashboard();
  if (page === 'triage' && window._dactaMode === 'production') setTimeout(populateLiveTriage, 200);
  if (page === 'aiusage') setTimeout(initAICharts, 50);
  if (page === 'privacy') setTimeout(initPrivacyCharts, 50);
  if (page === 'intel') setTimeout(loadThreatIntelLive, 100);
  if (page === 'hunting') setTimeout(loadThreatHuntingLive, 100);
  if (page === 'rules') { loadDetectionRulesLive(); }
  if (page === 'entities') setTimeout(function() { if (typeof initEntityExplorer === 'function') initEntityExplorer(); }, 50);
  if (page === 'assets') setTimeout(loadAssetManagement, 100);
  if (page === 'users') setTimeout(loadUserManagement, 100);
  if (page === 'integrations') setTimeout(loadIntegrationHub, 100);
  if (page === 'settings') setTimeout(loadSettingsPage, 100);
  if (page === 'aiusage') setTimeout(loadAIUsagePage, 150);
  if (page === 'clientportal') resetClientPortalSplash();
  if (page === 'warroom') setTimeout(initWarRoom2, 50);
  if (page === 'copilot') initCopilotPage();
  if (page === 'handover' && window._dactaMode === 'production') setTimeout(loadOpsCommandData, 200);

  // Scroll to top
  document.getElementById('content-area').scrollTop = 0;
}

// ============================================================
//  SIDEBAR TOGGLE
// ============================================================
document.getElementById('sidebarToggle').addEventListener('click', () => {
  document.getElementById('sidebar').classList.toggle('collapsed');
});

// Admin section collapse
document.getElementById('adminToggle').addEventListener('click', (e) => {
  e.stopPropagation();
  document.getElementById('adminSection').classList.toggle('collapsed-section');
});

// Nav clicks
document.querySelectorAll('.nav-item').forEach(item => {
  item.addEventListener('click', () => {
    const page = item.dataset.page;
    if (page) navigate(page);
  });
});

// ============================================================
//  CLOCK
// ============================================================
function updateClock() {
  const now = new Date();
  const sgt = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Singapore' }));
  const h = String(sgt.getHours()).padStart(2, '0');
  const m = String(sgt.getMinutes()).padStart(2, '0');
  const s = String(sgt.getSeconds()).padStart(2, '0');
  const el = document.getElementById('topbarTime');
  if (el) el.textContent = `${h}:${m}:${s} SGT`;
}
updateClock();
setInterval(updateClock, 1000);

// ============================================================
//  ANIMATED COUNTERS (Dashboard)
// ============================================================
function animateCounter(el, target, suffix, decimals) {
  let current = 0;
  const step = target / 40;
  const timer = setInterval(() => {
    current = Math.min(current + step, target);
    el.textContent = decimals ? current.toFixed(1) + suffix : Math.round(current) + suffix;
    if (current >= target) clearInterval(timer);
  }, 30);
}

// ============================================================
//  INIT
// ============================================================
function init() {
  // Render data-driven sections
  renderTriage();
  renderRules();
  renderLogSources();
  renderAssets();
  renderIntegrations();
  renderAuditLog();

  // Route from hash
  const hash = window.location.hash.replace('#', '');
  if (hash) navigate(hash);
  else navigate('dashboard');

  // Animate dashboard counters after short delay
  if (window._dactaMode !== 'production') {
    setTimeout(() => {
      const mttd = document.getElementById('counter-mttd');
      const mttr = document.getElementById('counter-mttr');
      const p1 = document.getElementById('counter-p1');
      const compliance = document.getElementById('counter-compliance');
      if (mttd) animateCounter(mttd, 4.2, '', true);
      if (mttr) animateCounter(mttr, 18, '', false);
      if (p1) animateCounter(p1, 6, '', false);
      if (compliance) animateCounter(compliance, 98.4, '', true);
    }, 400);
  }

  // Init dashboard charts in next frame (all at once, no staggered delays)
  requestAnimationFrame(function() {
    initDashboardCharts();
    initCommandCenter();
    initHeatMap();
  });
}

// init() is called by Supabase auth after session check (see SUPABASE AUTHENTICATION block below)

// ============================================================
//  SUPABASE AUTHENTICATION
// ============================================================
(function() {
  var _initCalled = false;
  function safeInit() {
    if (!_initCalled) {
      _initCalled = true;
      // Apply production mode FIRST (zeros out dashboard) so live data writes over it
      applyProductionMode();
      init();
    }
  }

  // Supabase config
  var SUPABASE_URL = 'https://qiqrizggitcqwkwshmfy.supabase.co';
  var SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFpcXJpemdnaXRjcXdrd3NobWZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwNzkzMjEsImV4cCI6MjA4NzY1NTMyMX0.ZNN47SWAYvAzzY5Dn6VCYV8nzrTrqvvybp2aF4NFHCA';

  // Wait for Supabase SDK to load, then initialize auth
  function initSupabaseAuth() {
    if (typeof window.supabase === 'undefined' || typeof window.supabase.createClient !== 'function') {
      setTimeout(initSupabaseAuth, 100);
      return;
    }

    var _supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    window._dactaSupabase = _supabase;

    var overlay = document.getElementById('loginOverlay');

    // Update topbar user display
    function setTopbarUser(user) {
      var avatarEl = document.getElementById('topbarUserAvatar');
      var nameEl = document.getElementById('topbarUserName');
      var emailEl = document.getElementById('userMenuEmail');
      if (!user) return;
      var email = user.email || '';
      var displayName = user.user_metadata && (user.user_metadata.full_name || user.user_metadata.name)
        ? (user.user_metadata.full_name || user.user_metadata.name)
        : email.split('@')[0];
      var initials = displayName.split(/[\s._-]+/).map(function(p){ return p[0]; }).join('').toUpperCase().slice(0,2) || 'U';
      if (avatarEl) avatarEl.textContent = initials;
      if (nameEl) nameEl.textContent = displayName;
      if (emailEl) emailEl.textContent = email;
    }

    // Show app (hide overlay, call init once)
    function showApp(user) {
      setTopbarUser(user);
      if (overlay) overlay.style.display = 'none';
      
      // Determine mode based on user + any view override
      var isAdmin = (user.email === 'admin@dacta.sg');
      var viewOverride = sessionStorage.getItem('dacta_view_override');
      
      if (isAdmin && viewOverride === 'demo') {
        window._dactaMode = 'demo';
        window._dactaOriginalMode = 'production';
      } else {
        window._dactaMode = isAdmin ? 'production' : 'demo';
        window._dactaOriginalMode = window._dactaMode;
      }
      
      // Set toggle + badge state
      var toggle = document.getElementById('demoModeToggle');
      var knob = document.getElementById('demoKnob');
      var slider = document.getElementById('demoSlider');
      
      if (window._dactaMode === 'production') {
        document.body.classList.add('mode-production');
        if (toggle) toggle.checked = false;
        if (knob) { knob.style.left = '2px'; knob.style.background = '#4d5a6e'; }
        if (slider) slider.style.background = 'rgba(77,90,110,0.2)';
      } else {
        document.body.classList.remove('mode-production');
        if (toggle) toggle.checked = true;
        if (knob) { knob.style.left = '16px'; knob.style.background = '#00d4ff'; knob.style.boxShadow = '0 0 6px rgba(0,212,255,0.5)'; }
        if (slider) slider.style.background = 'rgba(0,212,255,0.3)';
      }
      
      // PRE-FETCH: Start API calls NOW before init()/navigate() even runs
      // This saves ~400ms by overlapping network I/O with DOM setup
      if (window._dactaMode === 'production') {
        console.log('[Perf] Pre-fetching dashboard data...');
        window._dactaPrefetch = {
          dashboard: DactaJira.fetchDashboard(),
          dashvisuals: DactaJira.fetchDashVisuals(),
          telemetry: DactaJira.fetchTelemetry(),
          ingestion: loadDataIngestion()
        };
      }
      
      safeInit();
    }
    function showLogin() {
      if (overlay) {
        overlay.style.display = 'flex';
        overlay.classList.remove('fade-out');
        // Set login logo from sidebar logo image
        var loginLogo = document.getElementById('loginLogoImg');
        var sidebarImg = document.querySelector('.sidebar-logo img');
        if (loginLogo && sidebarImg && sidebarImg.src) {
          loginLogo.src = sidebarImg.src;
        }
      }
    }

    // Check session on load
    _supabase.auth.getSession().then(function(res) {
      var session = res.data && res.data.session;
      if (session && session.user) {
        showApp(session.user);
      } else {
        showLogin();
      }
    }).catch(function() {
      showLogin();
    });

    // Listen for auth state changes
    _supabase.auth.onAuthStateChange(function(event, session) {
      if (event === 'SIGNED_IN' && session && session.user) {
        showApp(session.user);
      } else if (event === 'SIGNED_OUT') {
        showLogin();
      }
    });

    // Handle login form submit
    window.handleLogin = function(e) {
      e.preventDefault();
      var email = document.getElementById('loginEmail').value.trim();
      var password = document.getElementById('loginPassword').value;
      var btn = document.getElementById('loginBtn');
      var errorEl = document.getElementById('loginError');

      errorEl.textContent = '';
      errorEl.classList.remove('show');
      btn.disabled = true;
      btn.textContent = 'Signing in...';

      _supabase.auth.signInWithPassword({ email: email, password: password })
        .then(function(res) {
          if (res.error) {
            errorEl.textContent = res.error.message || 'Authentication failed. Please check your credentials.';
            errorEl.classList.add('show');
            btn.disabled = false;
            btn.textContent = 'Sign In';
          } else {
            // Success â€” set user, fade out overlay, then call init
            setTopbarUser(res.data.user);
            overlay.classList.add('fade-out');
            setTimeout(function() {
              overlay.style.display = 'none';
              overlay.classList.remove('fade-out');
              safeInit();
            }, 500);
          }
        })
        .catch(function(err) {
          errorEl.textContent = 'Connection error. Please try again.';
          errorEl.classList.add('show');
          btn.disabled = false;
          btn.textContent = 'Sign In';
        });
    };

    // Handle logout
    window.handleLogout = function() {
      var menu = document.getElementById('userMenu');
      if (menu) menu.style.display = 'none';
      _supabase.auth.signOut().then(function() {
        showLogin();
      });
    };
  }

  // Password show/hide toggle (available immediately)
  window.togglePassword = function() {
    var input = document.getElementById('loginPassword');
    var icon = document.getElementById('pwEyeIcon');
    if (!input) return;
    if (input.type === 'password') {
      input.type = 'text';
      icon.innerHTML = '<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/>';
    } else {
      input.type = 'password';
      icon.innerHTML = '<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>';
    }
  };

  // Toggle user dropdown menu
  window.toggleUserMenu = function() {
    var menu = document.getElementById('userMenu');
    if (!menu) return;
    menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
  };

  // Close user menu when clicking outside
  document.addEventListener('click', function(e) {
    var menu = document.getElementById('userMenu');
    var chip = document.getElementById('topbarUserChip');
    if (menu && chip && !chip.contains(e.target) && !menu.contains(e.target)) {
      menu.style.display = 'none';
    }
  });

  initSupabaseAuth();
})();

// REMOVED: direct init() call replaced by Supabase auth flow above
var demoToggle = document.getElementById('demoModeToggle');
if (demoToggle) {
  demoToggle.addEventListener('change', function() {
    if (window._dactaOriginalMode === 'production' || window._dactaMode === 'production') {
      // Admin user toggling between production and demo views
      if (this.checked) {
        sessionStorage.setItem('dacta_view_override', 'demo');
      } else {
        sessionStorage.removeItem('dacta_view_override');
      }
      window.location.reload();
    }
  });
}

// ============================================================
//  PRODUCTION MODE â€” Zero all demo data across all pages
//  Prepares every page for live Jira data injection
// ============================================================
function applyProductionMode() {
  if (window._dactaMode !== 'production') return;
  document.body.classList.add('mode-production');

  // Helper: create a consistent empty-state box
  function emptyState(icon, text) {
    return '<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 24px;gap:10px;">' +
      '<div style="font-size:28px;opacity:0.5;">' + icon + '</div>' +
      '<div style="font-size:12px;font-family:var(--font-mono);color:var(--text-muted);letter-spacing:0.05em;">' + text + '</div>' +
    '</div>';
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  //  1. SOC DASHBOARD
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  // KPI counters
  ['counter-mttd','counter-mttr','counter-p1','counter-compliance'].forEach(function(id) {
    var el = document.getElementById(id); if (el) el.textContent = 'â€”';
  });

  // Command Center metric values
  document.querySelectorAll('.cc-metric-value').forEach(function(el) { el.textContent = '0'; });
  document.querySelectorAll('.cc-metric-unit').forEach(function(el) { el.textContent = ''; });
  document.querySelectorAll('.cc-count-value, .cc-big-count').forEach(function(el) { el.textContent = '0'; });

  // Severity dots in metric card
  document.querySelectorAll('.cc-severity-dots').forEach(function(el) {
    el.innerHTML = '<span style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">No incidents</span>';
  });

  // Prevented bar
  document.querySelectorAll('.cc-prevented-fill').forEach(function(el) { el.style.width = '0%'; });

  // Sparklines â€” keep visible, live data will update them
  // (production guard removed â€” sparklines rendered by initCommandCenter)

  // Command Center canvas â€” keep visible, rendered by initCommandCenter

  // Heatmap â€” keep visible, rendered by initHeatMap

  // Geo map â€” keep visible, rendered by initGeoMapCanvas

  // SLA strip values (Classic View)
  document.querySelectorAll('.sla-val').forEach(function(el) {
    el.innerHTML = 'â€”<span style="font-size:12px;color:var(--text-muted);"></span>';
  });

  // Summary cards in classic view
  document.querySelectorAll('#page-dashboard .summary-card .sc-num, #page-dashboard .summary-cards .sc-num').forEach(function(el) {
    el.textContent = '0';
  });

  // Classic view charts â€” keep visible, rendered by initClassicCharts

  // Status pills
  document.querySelectorAll('.cc-status-pill').forEach(function(el) {
    if (el.textContent.includes('ANALYST:')) el.textContent = 'ANALYST: â€”';
  });

  // Open Tickets card (bottom grid) â€” clear ticket rows, show empty
  var ticketsCard = document.querySelector('.cc-tickets-card');
  if (ticketsCard) {
    var badge = ticketsCard.querySelector('.badge'); if (badge) badge.textContent = '0 OPEN';
    // Remove all ticket rows
    ticketsCard.querySelectorAll('.ticket-row').forEach(function(r) { r.remove(); });
    // Add empty state
    var existingEmpty = ticketsCard.querySelector('.prod-ticket-empty');
    if (!existingEmpty) {
      var d = document.createElement('div'); d.className = 'prod-ticket-empty';
      d.innerHTML = emptyState('ðŸ“¡', 'Awaiting Jira ticket feed');
      ticketsCard.appendChild(d);
    }
  }

  // Right sidebar â€” By Organization
  document.querySelectorAll('#page-dashboard .cc-right-sidebar .org-row').forEach(function(r) { r.remove(); });
  document.querySelectorAll('#page-dashboard .cc-right-sidebar .card').forEach(function(card) {
    if (!card.querySelector('.prod-sidebar-empty')) {
      var d = document.createElement('div'); d.className = 'prod-sidebar-empty';
      d.innerHTML = '<div style="text-align:center;padding:20px;font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">Awaiting data</div>';
      card.appendChild(d);
    }
  });

  // Triage Labels
  document.querySelectorAll('.labels-grid .label-chip .label-count').forEach(function(el) { el.textContent = '0'; });

  // Notification badge
  var notifBadge = document.querySelector('.notif-badge'); if (notifBadge) notifBadge.textContent = '0';

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  //  2. TRIAGE QUEUE
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var triagePage = document.getElementById('page-triage');
  if (triagePage) {
    // Subtitle
    var tSub = triagePage.querySelector('.page-subtitle');
    if (tSub) tSub.textContent = '0 tickets â€” awaiting Jira data source';

    // Metric strip values
    triagePage.querySelectorAll('.tq-metric-value').forEach(function(el) { el.textContent = '0'; });
    triagePage.querySelectorAll('.tq-metric-sub').forEach(function(el) { el.textContent = 'â€”'; });

    // Table â€” clear body, show empty
    triagePage.querySelectorAll('table tbody').forEach(function(tbody) {
      tbody.innerHTML = '<tr><td colspan="11" style="text-align:center;padding:80px 24px;">' +
        emptyState('ðŸ“‹', 'No tickets in queue â€” connect Jira to populate') + '</td></tr>';
    });

    // Summary bar
    var tqSum = triagePage.querySelector('.tq-summary');
    if (tqSum) tqSum.innerHTML = '<span style="color:var(--text-muted);font-family:var(--font-mono);font-size:11px;">Showing 0 of 0 tickets</span>';
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  //  3. INVESTIGATION WORKSPACE
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var invPage = document.getElementById('page-investigation');
  if (invPage) {
    // Subtitle
    var iSub = invPage.querySelector('.page-subtitle');
    if (iSub) iSub.textContent = 'Select a ticket from Triage to begin investigation';

    // Hide all investigation content, show empty state
    var invLayout = invPage.querySelector('.investigation-layout');
    if (invLayout) {
      invLayout.style.display = 'none';
      if (!invPage.querySelector('.prod-inv-empty')) {
        var d = document.createElement('div'); d.className = 'prod-inv-empty';
        d.innerHTML = '<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:120px 24px;gap:16px;">' +
          '<div style="font-size:48px;opacity:0.4;">ðŸ”</div>' +
          '<div style="font-size:14px;font-weight:600;color:var(--text-primary);">No Active Investigation</div>' +
          '<div style="font-size:12px;color:var(--text-muted);font-family:var(--font-mono);max-width:400px;text-align:center;line-height:1.6;">Select a ticket from the Triage Queue to open the investigation workspace. AI-powered analysis will begin automatically once a ticket is loaded.</div>' +
          '<div style="display:flex;gap:8px;margin-top:8px;">' +
            '<button class="btn btn-primary btn-sm" onclick="navigate(\'triage\')">Go to Triage Queue</button>' +
          '</div>' +
        '</div>';
        invLayout.parentNode.insertBefore(d, invLayout.nextSibling);
      }
    }

    // Hide action buttons that reference specific tickets
    invPage.querySelectorAll('.page-actions .btn').forEach(function(btn) {
      if (btn.textContent.includes('Accept') || btn.textContent.includes('Override') || btn.textContent.includes('Copilot')) {
        btn.style.display = 'none';
      }
    });
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  //  4. RESPONSE CENTER
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var respPage = document.getElementById('page-response');
  if (respPage) {
    // Subtitle
    var rSub = respPage.querySelector('.page-subtitle');
    if (rSub) rSub.textContent = 'No active containment actions';

    // Active Responses card â€” clear content
    var activeCard = respPage.querySelector('.card[style*="border-color:rgba(239,68,68"]');
    if (activeCard) {
      var headerDiv = activeCard.querySelector('.card-header');
      var contentDiv = activeCard.querySelector('div[style*="flex-direction:column"]');
      if (contentDiv) contentDiv.innerHTML = emptyState('ðŸ›¡ï¸', 'No active response actions');
      // Remove pulsing dot
      var pulseDot = activeCard.querySelector('.status-dot[style*="animation"]');
      if (pulseDot) pulseDot.style.animation = 'none';
    }

    // Response Stats â€” zero values
    respPage.querySelectorAll('.metric-value').forEach(function(el) {
      var text = el.textContent.trim();
      if (/\d/.test(text)) el.textContent = '0';
    });
    respPage.querySelectorAll('.metric-sub').forEach(function(el) { el.textContent = 'â€”'; });

    // Playbook section â€” hide
    var playbook = respPage.querySelector('.resp-playbook');
    if (playbook) {
      playbook.style.display = 'none';
      if (!playbook.parentNode.querySelector('.prod-pb-empty')) {
        var d = document.createElement('div'); d.className = 'prod-pb-empty';
        d.style.cssText = 'margin-bottom:16px;';
        d.innerHTML = '<div class="card">' + emptyState('ðŸ“‹', 'No active playbooks â€” awaiting incident triggers') + '</div>';
        playbook.parentNode.insertBefore(d, playbook.nextSibling);
      }
    }

    // Response History table â€” clear
    respPage.querySelectorAll('table tbody').forEach(function(tbody) {
      tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;padding:60px;">' +
        emptyState('ðŸ“œ', 'No response history yet') + '</td></tr>';
    });

    // AI Recommendation overlay â€” hide
    respPage.querySelectorAll('.resp-ai-overlay').forEach(function(el) { el.style.display = 'none'; });
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  //  5. SHIFT HANDOVER
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var handoverPage = document.getElementById('page-handover');
  if (handoverPage) {
    // Subtitle
    var hSub = handoverPage.querySelector('.page-subtitle');
    if (hSub) hSub.textContent = 'Shift handover â€” awaiting live roster data';

    // Shift header metric values
    handoverPage.querySelectorAll('.shift-header-bar .metric-value').forEach(function(el) {
      var text = el.textContent.trim();
      if (/\d/.test(text)) el.textContent = '0';
    });

    // Team roster cards â€” clear to empty state
    handoverPage.querySelectorAll('.grid-2 .card').forEach(function(card, i) {
      if (i < 2) { // Only first two (team cards)
        var cardHeader = card.querySelector('.card-header');
        var contentDiv = card.querySelector('div[style*="flex-direction:column"]');
        if (contentDiv) contentDiv.innerHTML = emptyState('ðŸ‘¥', 'Awaiting roster data');
      }
    });

    // Handover notes â€” clear
    var handoverNote = handoverPage.querySelector('.handover-note');
    if (handoverNote) {
      handoverNote.innerHTML = '<div style="text-align:center;padding:24px;color:var(--text-muted);font-size:11px;font-family:var(--font-mono);">No handover notes from previous shift</div>';
    }

    // Open items table â€” clear
    handoverPage.querySelectorAll('table tbody').forEach(function(tbody) {
      tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:60px;">' +
        emptyState('ðŸ“', 'No open items carrying over') + '</td></tr>';
    });

    // Upload artifacts â€” clear pre-loaded files
    var fileList = document.getElementById('artifactFileList');
    if (fileList) fileList.innerHTML = '';
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  //  6. COPILOT
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var copilotPage = document.getElementById('page-copilot');
  if (copilotPage) {
    // Clear session ID
    var sessionText = copilotPage.querySelector('.copilot-title-text p');
    if (sessionText) sessionText.textContent = 'AI-Powered Investigation Intelligence \u00b7 Ready';

    // Clear conversation messages (keep the messages container)
    var msgContainer = copilotPage.querySelector('#copilotMessages, .copilot-messages');
    if (msgContainer) {
      msgContainer.innerHTML = '<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 24px;gap:12px;flex:1;">' +
        '<div style="font-size:40px;opacity:0.4;">\ud83e\udd16</div>' +
        '<div style="font-size:14px;font-weight:600;color:var(--text-primary);">DACTA Copilot Ready</div>' +
        '<div style="font-size:12px;color:var(--text-muted);font-family:var(--font-mono);max-width:400px;text-align:center;line-height:1.6;">Start a new investigation session. Ask questions about IOCs, search logs, query MITRE ATT&CK, or analyze scripts.</div>' +
        '<div style="display:flex;gap:6px;flex-wrap:wrap;justify-content:center;margin-top:4px;">' +
          '<span style="font-size:10px;padding:3px 10px;background:rgba(0,212,255,0.08);border:1px solid rgba(0,212,255,0.15);border-radius:12px;color:var(--cyan);cursor:pointer;" onclick="document.getElementById(\'copilotInput\').value=\'Check IP \';document.getElementById(\'copilotInput\').focus();">Check IP...</span>' +
          '<span style="font-size:10px;padding:3px 10px;background:rgba(139,92,246,0.08);border:1px solid rgba(139,92,246,0.15);border-radius:12px;color:#a78bfa;cursor:pointer;" onclick="document.getElementById(\'copilotInput\').value=\'What is \';document.getElementById(\'copilotInput\').focus();">MITRE Lookup</span>' +
          '<span style="font-size:10px;padding:3px 10px;background:rgba(16,185,129,0.08);border:1px solid rgba(16,185,129,0.15);border-radius:12px;color:var(--green);cursor:pointer;" onclick="document.getElementById(\'copilotInput\').value=\'Show me all \';document.getElementById(\'copilotInput\').focus();">Log Search</span>' +
        '</div>' +
      '</div>';
    }

    // Clear conversation header context badge
    var convHeader = copilotPage.querySelector('.copilot-conv-header');
    if (convHeader) {
      var ctxBadge = convHeader.querySelector('.badge');
      if (ctxBadge) ctxBadge.style.display = 'none';
    }

    // Clear Active Context panel
    var ctxCards = copilotPage.querySelectorAll('.ctx-card');
    ctxCards.forEach(function(card) {
      var header = card.querySelector('.ctx-card-header');
      if (!header) return;
      var headerText = header.textContent.trim();

      if (headerText.includes('Active Context')) {
        var body = card.querySelector('.ctx-card-body');
        if (body) body.innerHTML = '<div style="text-align:center;padding:16px;font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">No active investigation context</div>';
      }
      if (headerText.includes('Recent IOCs')) {
        var body = card.querySelector('.ctx-card-body');
        if (body) body.innerHTML = '<div style="text-align:center;padding:16px;font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">No IOCs in session</div>';
      }
    });

    // Clear results panels if any
    copilotPage.querySelectorAll('.copilot-result-panel').forEach(function(el) {
      el.innerHTML = emptyState('\ud83e\udd16', 'Ready for investigation queries');
    });
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  //  7. WAR ROOM
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  var warRoom = document.getElementById('page-warroom');
  if (warRoom) {
    // Subtitle
    var wSub = warRoom.querySelector('.page-subtitle');
    if (wSub) wSub.textContent = 'DFIR / MDR / SOCaaS Â· No active engagements';

    // Engagement bar â€” clear tabs
    var engBar = document.getElementById('wr2EngBar');
    if (engBar) {
      engBar.querySelectorAll('.wr2-eng-tab').forEach(function(tab) { tab.remove(); });
      // Keep the "Add Engagement" button
    }

    // Hide all engagement panels, show empty
    warRoom.querySelectorAll('.wr2-engagement-panel').forEach(function(panel) {
      panel.style.display = 'none';
    });

    // Insert global empty state for war room
    if (!warRoom.querySelector('.prod-wr-empty')) {
      var d = document.createElement('div'); d.className = 'prod-wr-empty';
      d.innerHTML = '<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:120px 24px;gap:16px;">' +
        '<div style="font-size:48px;opacity:0.4;">âš”ï¸</div>' +
        '<div style="font-size:14px;font-weight:600;color:var(--text-primary);">No Active Engagements</div>' +
        '<div style="font-size:12px;color:var(--text-muted);font-family:var(--font-mono);max-width:450px;text-align:center;line-height:1.6;">The War Room activates when an incident response engagement is created. Create a new engagement or wait for automatic escalation from the SOC pipeline.</div>' +
        '<div style="display:flex;gap:8px;margin-top:8px;">' +
          '<button class="btn btn-primary btn-sm" onclick="wr2OpenNewEng()">+ New Engagement</button>' +
        '</div>' +
      '</div>';
      // Insert after engBar
      if (engBar) engBar.parentNode.insertBefore(d, engBar.nextSibling);
      else warRoom.appendChild(d);
    }
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  //  GLOBAL: Chart canvases not yet handled
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  document.querySelectorAll('.chart-container').forEach(function(container) {
    var canvas = container.querySelector('canvas');
    if (canvas) canvas.style.display = 'none';
    if (!container.querySelector('.prod-overlay')) {
      container.style.position = 'relative';
      var o = document.createElement('div'); o.className = 'prod-overlay';
      o.style.cssText = 'position:absolute;inset:0;display:flex;align-items:center;justify-content:center;';
      o.innerHTML = '<div style="font-size:12px;color:var(--text-muted);font-family:var(--font-mono);">Awaiting data</div>';
      container.appendChild(o);
    }
  });

  // â”€â”€ Fetch live Jira data â”€â”€
  setTimeout(function() {
    populateLiveDashboard();
    setupTriageFilters();
  }, 300);
}

// Handle popstate for hash routing
window.addEventListener('hashchange', () => {
  const hash = window.location.hash.replace('#', '');
  if (hash) navigate(hash);
});

// ============================================================
//  ENTITY DRILL-DOWN PANEL
// ============================================================
function openEntityPanel(type, name) {
  const panel = document.getElementById('entityPanel');
  const backdrop = document.getElementById('entityPanelBackdrop');
  if (!panel || !backdrop) return;

  // Set entity info based on type
  const icons = { host: '\ud83d\udda5', ip: '\ud83c\udf10', user: '\ud83d\udc64', hash: '#\u20e3' };
  const epIcon = document.getElementById('epIcon');
  if (epIcon) epIcon.textContent = icons[type] || '\ud83d\udda5';

  const epName = document.getElementById('epName');
  if (epName) epName.textContent = name;

  // Open panel
  backdrop.classList.add('open');
  panel.classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeEntityPanel() {
  const panel = document.getElementById('entityPanel');
  const backdrop = document.getElementById('entityPanelBackdrop');
  if (!panel || !backdrop) return;

  backdrop.classList.remove('open');
  panel.classList.remove('open');
  document.body.style.overflow = '';
}

function setEntityTimeRange(btn) {
  const parent = btn.parentElement;
  parent.querySelectorAll('button').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

// Drill-down: Navigate to Entity Explorer and highlight the entity
function drillToEntityExplorer() {
  var nameEl = document.getElementById('epName');
  var entityId = nameEl ? nameEl.textContent.trim() : '';
  closeEntityPanel();
  navigate('entities');
  // After a brief delay to allow page render and entity explorer init
  setTimeout(function() {
    // Try to find and select the entity in the entity explorer catalog
    var rows = document.querySelectorAll('#eeTableBody tr');
    rows.forEach(function(row) {
      var nameCell = row.querySelector('td:nth-child(2)');
      if (nameCell && nameCell.textContent.trim() === entityId) {
        row.style.background = 'rgba(0,212,255,0.15)';
        row.style.boxShadow = 'inset 0 0 0 1px rgba(0,212,255,0.3)';
        row.scrollIntoView({ behavior: 'smooth', block: 'center' });
        // Flash effect
        setTimeout(function() { row.style.transition = 'all 2s ease'; }, 100);
      }
    });
    // Also try to select it in the mind-map graph view
    if (typeof window.eeSelectEntityById === 'function') {
      window.eeSelectEntityById(entityId);
    }
  }, 600);
}

// Close entity panel on Escape key
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    const panel = document.getElementById('entityPanel');
    if (panel && panel.classList.contains('open')) {
      closeEntityPanel();
    }
  }
});


// ============================================================
//  ENTITY EXPLORER â€” Mind Map & Catalog
// ============================================================
(function() {
  let eeInitialized = false;
  let eeAnimFrame = null;
  let eePhysicsOn = true;
  let eeSelectedEntity = null;
  var eeCurrentPage = 0;
  var EE_PAGE_SIZE = 10;

  // -- Entity Data --
  // Demo entities cleared â€” live data only from Elastic
  let EE_ENTITIES = [];

  // Demo edges cleared â€” live data only
  let EE_EDGES = [];

  // -- Alert data per entity --
  const EE_ALERTS = {
    'DACTASG-WS-047': [
      { name: 'Potential Ransomware Activity Detected', sev: 'critical', time: '14:23' },
      { name: 'TOR Network Connection Detected', sev: 'high', time: '14:18' },
      { name: 'Suspicious PowerShell Execution', sev: 'high', time: '13:52' },
      { name: 'C2 Beacon Pattern Detected', sev: 'critical', time: '13:41' },
      { name: 'Unusual DNS Resolution', sev: 'medium', time: '13:22' },
    ],
    '185.220.101.42': [
      { name: 'Known TOR Exit Node Communication', sev: 'critical', time: '14:18' },
      { name: 'Data Exfiltration Detected', sev: 'critical', time: '14:05' },
      { name: 'Repeated Connection Attempts', sev: 'high', time: '13:44' },
      { name: 'GeoIP Anomaly â€” Germany', sev: 'medium', time: '13:22' },
      { name: 'Blacklisted IP Activity', sev: 'high', time: '12:58' },
    ],
    '91.215.85.17': [
      { name: 'C2 Server Communication', sev: 'critical', time: '13:41' },
      { name: 'Encrypted Payload Transfer', sev: 'critical', time: '13:38' },
      { name: 'DNS Tunneling Suspected', sev: 'high', time: '13:15' },
      { name: 'Blacklisted IP â€” Russia', sev: 'high', time: '12:50' },
    ],
    'john.santos@dactaglobal.com': [
      { name: 'Privilege Escalation Attempt', sev: 'high', time: '14:12' },
      { name: 'After-Hours Login', sev: 'medium', time: '02:18' },
      { name: 'Multiple Failed Logins', sev: 'medium', time: '14:05' },
    ],
    'powershell.exe': [
      { name: 'Encoded PowerShell Command', sev: 'critical', time: '13:52' },
      { name: 'AMSI Bypass Detected', sev: 'high', time: '13:50' },
      { name: 'Obfuscated Script Block', sev: 'high', time: '13:48' },
    ],
    'update-service[.]net': [
      { name: 'Newly Registered Domain', sev: 'high', time: '14:20' },
      { name: 'DGA Domain Pattern', sev: 'high', time: '14:18' },
      { name: 'Resolved to Blacklisted IP', sev: 'critical', time: '13:22' },
    ],
  };

  // -- Colors per type --
  const EE_COLORS = {
    host: '#00d4ff',
    ip: '#8b5cf6',
    user: '#10b981',
    domain: '#f59e0b',
    process: '#f97316',
  };
  const EE_MALICIOUS_COLOR = '#ef4444';

  // -- Edge style map --
  const EE_EDGE_STYLES = {
    communicated_with: { color: 'rgba(0,212,255,0.35)', dash: [], label: 'Communicated' },
    authenticated_on: { color: 'rgba(16,185,129,0.4)', dash: [6,4], label: 'Authenticated' },
    executed_on: { color: 'rgba(249,115,22,0.4)', dash: [3,3], label: 'Executed' },
    resolved: { color: 'rgba(139,92,246,0.35)', dash: [], label: 'Resolved' },
    resolved_to: { color: 'rgba(239,68,68,0.5)', dash: [], label: 'Resolved To' },
    has_ip: { color: 'rgba(139,92,246,0.3)', dash: [2,3], label: 'Has IP' },
    assigned_to: { color: 'rgba(139,92,246,0.3)', dash: [2,3], label: 'Assigned' },
    gateway_for: { color: 'rgba(245,158,11,0.3)', dash: [4,4], label: 'Gateway' },
    domain_for: { color: 'rgba(245,158,11,0.3)', dash: [4,4], label: 'Domain For' },
  };

  // Graph state
  let eeNodes = [];
  let eeEdgesProcessed = [];
  let eeParticles = [];
  let eeCanvas, eeCtx;
  let eeCamera = { x: 0, y: 0, zoom: 1 };
  let eeDrag = { active: false, node: null, pan: false, startX: 0, startY: 0, camStartX: 0, camStartY: 0 };
  let eeHovered = null;
  let eeTime = 0;

  // -- Get connection count for an entity --
  function eeGetConnections(id) {
    return EE_EDGES.filter(e => e.from === id || e.to === id).length;
  }

  // -- Risk level class --
  function eeRiskClass(risk) {
    if (risk >= 80) return 'risk-critical';
    if (risk >= 60) return 'risk-high';
    if (risk >= 30) return 'risk-medium';
    return 'risk-low';
  }

  // -- Build Catalog HTML --
  function eeBuildCatalog(filter, search) {
    const list = document.getElementById('eeCatalogList');
    if (!list) return;
    let entities = EE_ENTITIES.slice();

    if (filter && filter !== 'all') {
      entities = entities.filter(e => e.type === filter);
    }
    if (search) {
      const s = search.toLowerCase();
      entities = entities.filter(e => e.id.toLowerCase().includes(s) || (e.label && e.label.toLowerCase().includes(s)));
    }

    // Sort
    const sortVal = document.getElementById('eeSort')?.value || 'risk';
    if (sortVal === 'risk') entities.sort((a, b) => b.risk - a.risk);
    else if (sortVal === 'active') entities.sort((a, b) => b.alerts - a.alerts);
    else if (sortVal === 'connected') entities.sort((a, b) => eeGetConnections(b.id) - eeGetConnections(a.id));

    var totalEntities = entities.length;
    var totalPages = Math.ceil(totalEntities / EE_PAGE_SIZE);
    if (eeCurrentPage >= totalPages) eeCurrentPage = Math.max(0, totalPages - 1);
    var startIdx = eeCurrentPage * EE_PAGE_SIZE;
    var pageEntities = entities.slice(startIdx, startIdx + EE_PAGE_SIZE);

    const countEl = document.getElementById('eeCatalogCount');
    if (countEl) countEl.textContent = totalEntities + ' entities Â· Page ' + (eeCurrentPage + 1) + '/' + totalPages;

    list.innerHTML = pageEntities.map(e => {
      const conns = eeGetConnections(e.id);
      const iconClass = e.malicious ? 'malicious' : e.type;
      const sel = eeSelectedEntity === e.id ? ' selected' : '';
      return `<div class="ee-card${sel}" data-eid="${e.id}" onclick="window._eeSelectEntity('${e.id}')">
        <div class="ee-card-icon ${iconClass}">${e.icon}</div>
        <div class="ee-card-info">
          <div class="ee-card-name">${e.id}</div>
          <div class="ee-card-meta">
            <span class="ee-card-type ${e.type}">${e.type}</span>
            <span class="ee-card-lastseen">${e.lastSeen}</span>
            ${e.label ? '<span style="font-size:9px;color:var(--red-bright);">'+e.label+'</span>' : ''}
          </div>
          ${e.sub ? '<div style="font-size:9px;color:var(--text-muted);margin-top:2px;font-family:var(--font-mono);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:180px;" title="'+e.sub+'">'+e.sub+'</div>' : ''}
        </div>
        <div class="ee-card-stats">
          <div class="ee-risk-badge ${eeRiskClass(e.risk)}">${e.risk}</div>
          <div class="ee-card-counts">
            <span>ðŸš¨${e.alerts}</span>
            <span>ðŸ”—${conns}</span>
          </div>
        </div>
      </div>`;
    }).join('');

    // Pagination controls
    if (totalPages > 1) {
      var pagHTML = '<div style="display:flex;align-items:center;justify-content:center;gap:6px;padding:10px 8px;border-top:1px solid var(--border-subtle);">';
      pagHTML += '<button class="btn btn-secondary btn-sm" style="font-size:9px;padding:2px 8px;' + (eeCurrentPage === 0 ? 'opacity:0.3;pointer-events:none;' : '') + '" onclick="window._eeGoPage(' + (eeCurrentPage - 1) + ')">&#8249; Prev</button>';
      for (var pg = 0; pg < totalPages; pg++) {
        var activeStyle = pg === eeCurrentPage ? 'background:var(--cyan);color:#080c18;font-weight:700;' : '';
        pagHTML += '<button style="min-width:24px;height:24px;border-radius:4px;border:1px solid var(--border-subtle);background:var(--surface-0);color:var(--text-secondary);font-size:10px;cursor:pointer;font-family:var(--font-mono);' + activeStyle + '" onclick="window._eeGoPage(' + pg + ')">' + (pg + 1) + '</button>';
      }
      pagHTML += '<button class="btn btn-secondary btn-sm" style="font-size:9px;padding:2px 8px;' + (eeCurrentPage >= totalPages - 1 ? 'opacity:0.3;pointer-events:none;' : '') + '" onclick="window._eeGoPage(' + (eeCurrentPage + 1) + ')">Next &#8250;</button>';
      pagHTML += '</div>';
      list.innerHTML += pagHTML;
    }
  }

  // -- Init Graph Nodes --
  function eeInitNodes() {
    const container = document.getElementById('eeCanvasContainer');
    if (!container) return;
    const w = container.clientWidth;
    const h = container.clientHeight;
    const cx = w / 2, cy = h / 2;

    eeNodes = EE_ENTITIES.map((e, i) => {
      const angle = (i / EE_ENTITIES.length) * Math.PI * 2;
      const radius = 180 + Math.random() * 100;
      const nodeColor = e.malicious ? EE_MALICIOUS_COLOR : (EE_COLORS[e.type] || '#888');
      const size = e.type === 'host' ? 22 : (e.type === 'process' ? 14 : 18);
      return {
        id: e.id,
        type: e.type,
        malicious: e.malicious,
        risk: e.risk,
        alerts: e.alerts,
        icon: e.icon,
        label: e.label || '',
        x: cx + Math.cos(angle) * radius + (Math.random() - 0.5) * 60,
        y: cy + Math.sin(angle) * radius + (Math.random() - 0.5) * 60,
        vx: 0,
        vy: 0,
        size: size,
        color: nodeColor,
        conns: eeGetConnections(e.id),
        pinned: false,
        glowPhase: Math.random() * Math.PI * 2,
      };
    });

    eeEdgesProcessed = EE_EDGES.map(e => {
      const fromNode = eeNodes.find(n => n.id === e.from);
      const toNode = eeNodes.find(n => n.id === e.to);
      const style = EE_EDGE_STYLES[e.type] || EE_EDGE_STYLES.communicated_with;
      const isMalicious = (fromNode && fromNode.malicious) || (toNode && toNode.malicious);
      return { from: fromNode, to: toNode, type: e.type, style, isMalicious };
    }).filter(e => e.from && e.to);

    // Init particles
    eeParticles = [];
    eeEdgesProcessed.forEach((edge, ei) => {
      const count = edge.isMalicious ? 4 : 2;
      for (let p = 0; p < count; p++) {
        eeParticles.push({
          edgeIdx: ei,
          t: Math.random(),
          speed: (0.002 + Math.random() * 0.003) * (edge.isMalicious ? 1.5 : 1),
          size: edge.isMalicious ? 2.5 : 1.5,
          color: edge.isMalicious ? EE_MALICIOUS_COLOR : edge.style.color,
        });
      }
    });
  }

  // -- Physics Step --
  function eePhysicsStep() {
    if (!eePhysicsOn) return;
    const repulsion = 8000;
    const attraction = 0.008;
    const centerPull = 0.0003;
    const damping = 0.92;
    const container = document.getElementById('eeCanvasContainer');
    if (!container) return;
    const cx = container.clientWidth / 2;
    const cy = container.clientHeight / 2;

    // Repulsion between all nodes
    for (let i = 0; i < eeNodes.length; i++) {
      if (eeNodes[i].pinned) continue;
      let fx = 0, fy = 0;
      for (let j = 0; j < eeNodes.length; j++) {
        if (i === j) continue;
        const dx = eeNodes[i].x - eeNodes[j].x;
        const dy = eeNodes[i].y - eeNodes[j].y;
        const dist = Math.sqrt(dx * dx + dy * dy) || 1;
        const force = repulsion / (dist * dist);
        fx += (dx / dist) * force;
        fy += (dy / dist) * force;
      }

      // Center gravity
      fx += (cx - eeNodes[i].x) * centerPull;
      fy += (cy - eeNodes[i].y) * centerPull;

      eeNodes[i].vx = (eeNodes[i].vx + fx) * damping;
      eeNodes[i].vy = (eeNodes[i].vy + fy) * damping;
    }

    // Attraction along edges
    eeEdgesProcessed.forEach(edge => {
      const dx = edge.to.x - edge.from.x;
      const dy = edge.to.y - edge.from.y;
      const dist = Math.sqrt(dx * dx + dy * dy) || 1;
      const idealDist = 160;
      const force = (dist - idealDist) * attraction;
      const fx = (dx / dist) * force;
      const fy = (dy / dist) * force;
      if (!edge.from.pinned) { edge.from.vx += fx; edge.from.vy += fy; }
      if (!edge.to.pinned) { edge.to.vx -= fx; edge.to.vy -= fy; }
    });

    // Apply velocity
    eeNodes.forEach(n => {
      if (n.pinned) return;
      n.x += n.vx;
      n.y += n.vy;
    });
  }

  // -- Canvas Rendering --
  function eeDraw() {
    if (!eeCanvas || !eeCtx) return;
    const container = document.getElementById('eeCanvasContainer');
    if (!container) return;
    const dpr = window.devicePixelRatio || 1;
    const w = container.clientWidth;
    const h = container.clientHeight;

    if (eeCanvas.width !== w * dpr || eeCanvas.height !== h * dpr) {
      eeCanvas.width = w * dpr;
      eeCanvas.height = h * dpr;
      eeCtx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }

    const ctx = eeCtx;
    ctx.clearRect(0, 0, w, h);
    ctx.save();
    ctx.translate(w / 2, h / 2);
    ctx.scale(eeCamera.zoom, eeCamera.zoom);
    ctx.translate(-w / 2 + eeCamera.x, -h / 2 + eeCamera.y);

    eeTime += 0.016;

    // Draw edges
    eeEdgesProcessed.forEach((edge, ei) => {
      const isConnectedToSelected = eeSelectedEntity && (edge.from.id === eeSelectedEntity || edge.to.id === eeSelectedEntity);
      const dimmed = eeSelectedEntity && !isConnectedToSelected;
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(edge.from.x, edge.from.y);
      ctx.lineTo(edge.to.x, edge.to.y);
      ctx.strokeStyle = dimmed ? 'rgba(255,255,255,0.03)' : edge.style.color;
      ctx.lineWidth = edge.isMalicious ? 2 : 1;
      if (isConnectedToSelected) { ctx.lineWidth = edge.isMalicious ? 3 : 2; ctx.strokeStyle = edge.isMalicious ? 'rgba(239,68,68,0.7)' : 'rgba(0,212,255,0.6)'; }
      if (edge.style.dash.length > 0) ctx.setLineDash(edge.style.dash);
      ctx.stroke();
      ctx.restore();
    });

    // Draw particles
    eeParticles.forEach(p => {
      const edge = eeEdgesProcessed[p.edgeIdx];
      if (!edge) return;
      const isConnectedToSelected = eeSelectedEntity && (edge.from.id === eeSelectedEntity || edge.to.id === eeSelectedEntity);
      if (eeSelectedEntity && !isConnectedToSelected) return;
      p.t += p.speed;
      if (p.t > 1) p.t -= 1;
      const px = edge.from.x + (edge.to.x - edge.from.x) * p.t;
      const py = edge.from.y + (edge.to.y - edge.from.y) * p.t;
      ctx.beginPath();
      ctx.arc(px, py, p.size, 0, Math.PI * 2);
      const pColor = isConnectedToSelected ? (edge.isMalicious ? '#ff6b6b' : '#00d4ff') : p.color;
      ctx.fillStyle = pColor;
      ctx.shadowColor = pColor;
      ctx.shadowBlur = 8;
      ctx.fill();
      ctx.shadowBlur = 0;
    });

    // Draw nodes
    eeNodes.forEach(node => {
      const isSelected = eeSelectedEntity === node.id;
      const isConnected = eeSelectedEntity && eeEdgesProcessed.some(e => (e.from.id === eeSelectedEntity && e.to.id === node.id) || (e.to.id === eeSelectedEntity && e.from.id === node.id));
      const dimmed = eeSelectedEntity && !isSelected && !isConnected && eeSelectedEntity !== node.id;
      const isHovered = eeHovered === node.id;
      const r = isHovered ? node.size * 1.3 : (isSelected ? node.size * 1.2 : node.size);

      ctx.save();
      // Glow halo
      const glowIntensity = node.risk / 100;
      const glowSize = r + 8 + (node.malicious ? 12 : 6) * glowIntensity;
      const pulse = Math.sin(eeTime * 2 + node.glowPhase) * 0.3 + 0.7;
      const alpha = dimmed ? 0.05 : (glowIntensity * 0.4 * pulse);
      ctx.beginPath();
      ctx.arc(node.x, node.y, glowSize, 0, Math.PI * 2);
      ctx.fillStyle = node.color + Math.round(alpha * 255).toString(16).padStart(2, '0');
      ctx.fill();

      // Node body
      const nodeGrad = ctx.createRadialGradient(node.x - r * 0.3, node.y - r * 0.3, 0, node.x, node.y, r);
      nodeGrad.addColorStop(0, node.color + (dimmed ? '44' : 'cc'));
      nodeGrad.addColorStop(1, node.color + (dimmed ? '22' : '66'));
      ctx.beginPath();
      ctx.arc(node.x, node.y, r, 0, Math.PI * 2);
      ctx.fillStyle = nodeGrad;
      ctx.fill();

      // Border
      ctx.strokeStyle = dimmed ? 'rgba(255,255,255,0.05)' : (isSelected ? '#fff' : node.color);
      ctx.lineWidth = isSelected ? 2.5 : (isHovered ? 2 : 1);
      ctx.stroke();

      // Ripple effect on selected
      if (isSelected) {
        const rippleR = r + 6 + Math.sin(eeTime * 3) * 4;
        ctx.beginPath();
        ctx.arc(node.x, node.y, rippleR, 0, Math.PI * 2);
        ctx.strokeStyle = node.color + '55';
        ctx.lineWidth = 1.5;
        ctx.stroke();
      }

      // Malicious pulsing ring
      if (node.malicious && !dimmed) {
        const pr = r + 4 + Math.sin(eeTime * 4 + node.glowPhase) * 3;
        ctx.beginPath();
        ctx.arc(node.x, node.y, pr, 0, Math.PI * 2);
        ctx.strokeStyle = EE_MALICIOUS_COLOR + '88';
        ctx.lineWidth = 1.5;
        ctx.setLineDash([3, 3]);
        ctx.stroke();
        ctx.setLineDash([]);
      }

      ctx.restore();

      // Label
      if (!dimmed || isSelected) {
        ctx.save();
        ctx.font = '500 10px "IBM Plex Mono", monospace';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        const label = node.id.length > 22 ? node.id.substring(0, 20) + '..' : node.id;
        const tw = ctx.measureText(label).width;
        // Background pill
        ctx.fillStyle = 'rgba(8,12,24,0.85)';
        const pillY = node.y + r + 6;
        const pillH = 16;
        const pillW = tw + 12;
        ctx.beginPath();
        const rx = node.x - pillW / 2;
        const ry = pillY;
        const rr = 4;
        ctx.moveTo(rx + rr, ry);
        ctx.arcTo(rx + pillW, ry, rx + pillW, ry + pillH, rr);
        ctx.arcTo(rx + pillW, ry + pillH, rx, ry + pillH, rr);
        ctx.arcTo(rx, ry + pillH, rx, ry, rr);
        ctx.arcTo(rx, ry, rx + pillW, ry, rr);
        ctx.closePath();
        ctx.fill();
        ctx.strokeStyle = dimmed ? 'rgba(255,255,255,0.05)' : 'rgba(255,255,255,0.1)';
        ctx.lineWidth = 0.5;
        ctx.stroke();
        ctx.fillStyle = dimmed ? 'rgba(255,255,255,0.15)' : 'rgba(232,237,245,0.85)';
        ctx.fillText(label, node.x, pillY + 3);
        ctx.restore();
      }
    });

    ctx.restore();
  }

  // -- Animation Loop --
  function eeAnimate() {
    eePhysicsStep();
    eeDraw();
    eeAnimFrame = requestAnimationFrame(eeAnimate);
  }

  // -- Mouse Helpers --
  function eeScreenToWorld(mx, my) {
    const container = document.getElementById('eeCanvasContainer');
    if (!container) return { x: mx, y: my };
    const w = container.clientWidth;
    const h = container.clientHeight;
    const wx = (mx - w / 2) / eeCamera.zoom + w / 2 - eeCamera.x;
    const wy = (my - h / 2) / eeCamera.zoom + h / 2 - eeCamera.y;
    return { x: wx, y: wy };
  }

  function eeGetNodeAt(mx, my) {
    const wp = eeScreenToWorld(mx, my);
    for (let i = eeNodes.length - 1; i >= 0; i--) {
      const n = eeNodes[i];
      const dx = wp.x - n.x;
      const dy = wp.y - n.y;
      if (dx * dx + dy * dy < (n.size + 6) * (n.size + 6)) return n;
    }
    return null;
  }

  // -- Select Entity (global for onclick) --
  window._eeGoPage = function(pg) {
    eeCurrentPage = pg;
    eeBuildCatalog(eeGetActiveFilter(), document.getElementById('eeSearch')?.value || '');
  };

  window._eeSelectEntity = function(id) {
    eeSelectedEntity = (eeSelectedEntity === id) ? null : id;
    eeBuildCatalog(eeGetActiveFilter(), document.getElementById('eeSearch')?.value || '');
    eeUpdateDetail(id);
    // Focus on node in graph
    const node = eeNodes.find(n => n.id === id);
    if (node && eeSelectedEntity) {
      const container = document.getElementById('eeCanvasContainer');
      if (container) {
        const w = container.clientWidth;
        const h = container.clientHeight;
        eeCamera.x = w / 2 - node.x;
        eeCamera.y = h / 2 - node.y;
      }
    }
  };

  function eeGetActiveFilter() {
    const active = document.querySelector('#eeTypeFilters .ee-chip.active');
    return active ? active.dataset.type : 'all';
  }

  // -- Update Detail Panel --
  function eeUpdateDetail(id) {
    const panel = document.getElementById('eeDetailPanel');
    if (!panel) return;
    if (!eeSelectedEntity) { panel.classList.remove('visible'); return; }

    const entity = EE_ENTITIES.find(e => e.id === id);
    if (!entity) { panel.classList.remove('visible'); return; }

    panel.classList.add('visible');

    document.getElementById('eeDetailIcon').textContent = entity.icon;
    document.getElementById('eeDetailIcon').className = 'ee-detail-icon ee-card-icon ' + (entity.malicious ? 'malicious' : entity.type);
    document.getElementById('eeDetailName').textContent = entity.id;

    const typeBadge = document.getElementById('eeDetailType');
    typeBadge.textContent = entity.type.toUpperCase() + (entity.label ? ' â€” ' + entity.label : '');
    typeBadge.className = 'ee-detail-type-badge ee-card-type ' + entity.type;

    const riskEl = document.getElementById('eeDetailRisk');
    riskEl.textContent = entity.risk;
    riskEl.className = 'ee-detail-risk-score ee-risk-badge ' + eeRiskClass(entity.risk);

    // Profile
    const profileEl = document.getElementById('eeDetailProfile');
    const profileItems = [
      ['Entity', entity.id],
      ['Type', entity.type],
      ['Risk Score', entity.risk],
      ['Connections', eeGetConnections(entity.id)],
    ];
    if (entity.os) profileItems.push(['OS', entity.os]);
    if (entity.dept) profileItems.push(['Department', entity.dept]);
    if (entity.firstSeen) profileItems.push(['First Seen', entity.firstSeen]);
    profileItems.push(['Last Seen', entity.lastSeen]);
    profileEl.innerHTML = profileItems.map(([k, v]) => `<div class="ee-profile-item"><div class="ee-profile-label">${k}</div><div class="ee-profile-value">${v}</div></div>`).join('');

    // Alerts
    const alertsEl = document.getElementById('eeDetailAlerts');
    const alerts = EE_ALERTS[entity.id] || [];
    if (alerts.length === 0) {
      alertsEl.innerHTML = '<div style="font-size:11px;color:var(--text-muted);">No alerts associated</div>';
    } else {
      alertsEl.innerHTML = alerts.map(a => {
        const sevColor = a.sev === 'critical' ? 'var(--red)' : (a.sev === 'high' ? 'var(--orange)' : 'var(--amber)');
        return `<div class="ee-alert-row"><div class="ee-alert-sev" style="background:${sevColor};"></div><span class="ee-alert-name">${a.name}</span><span class="ee-alert-time">${a.time}</span></div>`;
      }).join('');
    }

    // Sparkline
    eeDrawSparkline(entity.risk);
  }

  function eeDrawSparkline(risk) {
    const canvas = document.getElementById('eeDetailSparkline');
    if (!canvas) return;
    const ctx = canvas.getContext('2d');
    const dpr = window.devicePixelRatio || 1;
    canvas.width = 80 * dpr;
    canvas.height = 32 * dpr;
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    ctx.clearRect(0, 0, 80, 32);

    // Generate fake trend data
    const points = [];
    let v = risk - 20 + Math.random() * 10;
    for (let i = 0; i < 12; i++) {
      v += (Math.random() - 0.4) * 8;
      v = Math.max(0, Math.min(100, v));
      points.push(v);
    }
    points.push(risk);

    const maxV = 100, minV = 0;
    const step = 80 / (points.length - 1);

    ctx.beginPath();
    points.forEach((p, i) => {
      const x = i * step;
      const y = 30 - (p / maxV) * 28;
      if (i === 0) ctx.moveTo(x, y);
      else ctx.lineTo(x, y);
    });
    const riskColor = risk >= 80 ? '#ef4444' : (risk >= 60 ? '#f97316' : (risk >= 30 ? '#f59e0b' : '#10b981'));
    ctx.strokeStyle = riskColor;
    ctx.lineWidth = 1.5;
    ctx.stroke();

    // Fill gradient below line
    ctx.lineTo(80, 32);
    ctx.lineTo(0, 32);
    ctx.closePath();
    const grad = ctx.createLinearGradient(0, 0, 0, 32);
    grad.addColorStop(0, riskColor + '33');
    grad.addColorStop(1, 'transparent');
    ctx.fillStyle = grad;
    ctx.fill();
  }

  // -- Canvas Event Handlers --
  function eeSetupCanvasEvents() {
    const container = document.getElementById('eeCanvasContainer');
    if (!container || !eeCanvas) return;

    eeCanvas.addEventListener('mousemove', (e) => {
      const rect = eeCanvas.getBoundingClientRect();
      const mx = e.clientX - rect.left;
      const my = e.clientY - rect.top;

      if (eeDrag.active && eeDrag.node) {
        const wp = eeScreenToWorld(mx, my);
        eeDrag.node.x = wp.x;
        eeDrag.node.y = wp.y;
        eeDrag.node.vx = 0;
        eeDrag.node.vy = 0;
        return;
      }

      if (eeDrag.pan) {
        eeCamera.x = eeDrag.camStartX + (mx - eeDrag.startX) / eeCamera.zoom;
        eeCamera.y = eeDrag.camStartY + (my - eeDrag.startY) / eeCamera.zoom;
        return;
      }

      const node = eeGetNodeAt(mx, my);
      eeHovered = node ? node.id : null;
      eeCanvas.style.cursor = node ? 'pointer' : 'grab';

      // Tooltip
      const tooltip = document.getElementById('eeTooltip');
      if (tooltip) {
        if (node) {
          tooltip.classList.add('visible');
          document.getElementById('eeTipName').textContent = node.id;
          const tipType = document.getElementById('eeTipType');
          tipType.textContent = node.type.toUpperCase() + (node.label ? ' â€” ' + node.label : '');
          tipType.style.color = node.malicious ? EE_MALICIOUS_COLOR : (EE_COLORS[node.type] || '#888');
          document.getElementById('eeTipAlerts').textContent = node.alerts;
          document.getElementById('eeTipConns').textContent = node.conns;
          document.getElementById('eeTipRisk').textContent = node.risk;
          // Position
          let tx = mx + 16;
          let ty = my - 10;
          if (tx + 200 > container.clientWidth) tx = mx - 200;
          if (ty + 80 > container.clientHeight) ty = my - 80;
          tooltip.style.left = tx + 'px';
          tooltip.style.top = ty + 'px';
        } else {
          tooltip.classList.remove('visible');
        }
      }
    });

    eeCanvas.addEventListener('mousedown', (e) => {
      const rect = eeCanvas.getBoundingClientRect();
      const mx = e.clientX - rect.left;
      const my = e.clientY - rect.top;
      const node = eeGetNodeAt(mx, my);

      if (node) {
        eeDrag.active = true;
        eeDrag.node = node;
        node.pinned = true;
        eeCanvas.style.cursor = 'grabbing';
      } else {
        eeDrag.pan = true;
        eeDrag.startX = mx;
        eeDrag.startY = my;
        eeDrag.camStartX = eeCamera.x;
        eeDrag.camStartY = eeCamera.y;
        eeCanvas.style.cursor = 'grabbing';
      }
    });

    eeCanvas.addEventListener('mouseup', (e) => {
      if (eeDrag.active && eeDrag.node) {
        const rect = eeCanvas.getBoundingClientRect();
        const mx = e.clientX - rect.left;
        const my = e.clientY - rect.top;
        const movedDist = Math.abs(mx - (eeDrag.startX || mx)) + Math.abs(my - (eeDrag.startY || my));
        eeDrag.node.pinned = false;
        // If barely moved, treat as click
        if (movedDist < 5) {
          window._eeSelectEntity(eeDrag.node.id);
        }
      }
      if (eeDrag.pan) {
        // nothing extra
      }
      eeDrag.active = false;
      eeDrag.node = null;
      eeDrag.pan = false;
      eeCanvas.style.cursor = 'grab';
    });

    eeCanvas.addEventListener('mouseleave', () => {
      eeDrag.active = false;
      eeDrag.node = null;
      eeDrag.pan = false;
      eeHovered = null;
      const tooltip = document.getElementById('eeTooltip');
      if (tooltip) tooltip.classList.remove('visible');
    });

    // Click (for select if not dragged)
    eeCanvas.addEventListener('click', (e) => {
      // Handled in mouseup
    });

    // Zoom
    eeCanvas.addEventListener('wheel', (e) => {
      e.preventDefault();
      const delta = e.deltaY > 0 ? 0.92 : 1.08;
      eeCamera.zoom = Math.max(0.3, Math.min(3, eeCamera.zoom * delta));
    }, { passive: false });
  }

  // -- Setup UI events --
  function eeSetupUI() {
    // Type filter chips
    document.querySelectorAll('#eeTypeFilters .ee-chip').forEach(chip => {
      chip.addEventListener('click', () => {
        document.querySelectorAll('#eeTypeFilters .ee-chip').forEach(c => c.classList.remove('active'));
        chip.classList.add('active');
        eeBuildCatalog(chip.dataset.type, document.getElementById('eeSearch')?.value || '');
      });
    });

    // Time range chips
    document.querySelectorAll('#eeTimeFilters .ee-time-chip').forEach(chip => {
      chip.addEventListener('click', () => {
        document.querySelectorAll('#eeTimeFilters .ee-time-chip').forEach(c => c.classList.remove('active'));
        chip.classList.add('active');
      });
    });

    // Search
    const searchEl = document.getElementById('eeSearch');
    if (searchEl) {
      searchEl.addEventListener('input', () => {
        eeBuildCatalog(eeGetActiveFilter(), searchEl.value);
      });
    }

    // Sort
    const sortEl = document.getElementById('eeSort');
    if (sortEl) {
      sortEl.addEventListener('change', () => {
        eeBuildCatalog(eeGetActiveFilter(), document.getElementById('eeSearch')?.value || '');
      });
    }

    // Zoom buttons
    document.getElementById('eeZoomIn')?.addEventListener('click', () => {
      eeCamera.zoom = Math.min(3, eeCamera.zoom * 1.2);
    });
    document.getElementById('eeZoomOut')?.addEventListener('click', () => {
      eeCamera.zoom = Math.max(0.3, eeCamera.zoom / 1.2);
    });
    document.getElementById('eeZoomReset')?.addEventListener('click', () => {
      eeCamera = { x: 0, y: 0, zoom: 1 };
    });

    // Toggle physics
    const physBtn = document.getElementById('eeTogglePhysics');
    if (physBtn) {
      physBtn.addEventListener('click', () => {
        eePhysicsOn = !eePhysicsOn;
        physBtn.textContent = eePhysicsOn ? 'âš¡ Physics ON' : 'â¸ Physics OFF';
        physBtn.classList.toggle('active', eePhysicsOn);
      });
    }

    // Detail close
    document.getElementById('eeDetailClose')?.addEventListener('click', () => {
      eeSelectedEntity = null;
      document.getElementById('eeDetailPanel')?.classList.remove('visible');
      eeBuildCatalog(eeGetActiveFilter(), document.getElementById('eeSearch')?.value || '');
    });
  }

  // -- Live Data: Load host entities from Elastic --
  async function loadEntityData() {
    try {
      var results = await fetch('/api/elastic', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          action: 'search',
          index: 'logs-crowdstrike.host-*',
          body: {
            size: 0,
            aggs: {
              hosts: {
                terms: { field: 'host.hostname', size: 100 },
                aggs: {
                  latest: { top_hits: { size: 1, sort: [{ '@timestamp': 'desc' }], _source: ['host.hostname', 'host.ip', 'host.os.name', 'host.os.platform', 'crowdstrike.host.hostname', 'crowdstrike.host.local_ip', 'crowdstrike.host.os_version', 'crowdstrike.host.product_type_desc', 'crowdstrike.host.status', 'crowdstrike.host.last_seen', 'data_stream.namespace'] } }
                }
              },
              total_hosts: { cardinality: { field: 'host.hostname' } },
              os_dist: { terms: { field: 'host.os.platform', size: 10 } },
              namespace_dist: { terms: { field: 'data_stream.namespace', size: 10 } }
            }
          }
        })
      });
      var data = await results.json();
      return data;
    } catch (err) {
      console.error('[EntityExplorer] Load error:', err);
      return null;
    }
  }

  // -- Live Data: Load unique IPs from alert data --
  async function loadEntityIPs() {
    try {
      var results = await fetch('/api/elastic', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          action: 'search',
          index: 'logs-crowdstrike.alert-*',
          body: {
            size: 0,
            aggs: {
              src_ips: { terms: { field: 'source.ip', size: 50 } },
              dst_ips: { terms: { field: 'destination.ip', size: 50 } },
              usernames: { terms: { field: 'user.name', size: 50 } }
            }
          }
        })
      });
      return await results.json();
    } catch (err) {
      console.error('[EntityExplorer] IP load error:', err);
      return null;
    }
  }


  // -- Live Data: Build EE_ENTITIES and EE_EDGES from Elastic, then init canvas --
  async function loadLiveEntityData() {
    // Show loading message in catalog
    var catalogList = document.getElementById('eeCatalogList');
    if (catalogList) {
      catalogList.innerHTML = '<div style="padding:20px;text-align:center;color:var(--cyan);font-size:11px;">' +
        '<div class="jira-spinner" style="margin:0 auto 8px;"></div>' +
        'Loading entities from Elastic...' +
        '</div>';
    }

    try {
      var [hostData, ipData] = await Promise.all([loadEntityData(), loadEntityIPs()]);

      // Reset arrays (reassignable since `let`)
      EE_ENTITIES.length = 0;
      EE_EDGES.length = 0;

      var hostBuckets = (hostData && hostData.aggregations && hostData.aggregations.hosts)
        ? hostData.aggregations.hosts.buckets : [];

      // Build host entities
      hostBuckets.forEach(function(bucket, idx) {
        var hit = (bucket.latest && bucket.latest.hits && bucket.latest.hits.hits && bucket.latest.hits.hits[0])
          ? bucket.latest.hits.hits[0]._source : {};
        var cs = (hit.crowdstrike && hit.crowdstrike.host) ? hit.crowdstrike.host : {};
        var hostObj = hit.host || {};
        var hostname = cs.hostname || hostObj.hostname || bucket.key || 'host-' + idx;
        var ip = cs.local_ip || (hostObj.ip && hostObj.ip[0]) || '';
        var os = cs.os_version || (hostObj.os ? hostObj.os.name : '') || 'Unknown OS';
        var status = cs.status || 'normal';
        var ns = (hit.data_stream && hit.data_stream.namespace) || '';
        var risk = status === 'contained' ? 'high' : (status === 'normal' ? 'low' : 'medium');

        EE_ENTITIES.push({
          id: hostname,
          type: 'host',
          label: '',
          icon: '\uD83D\uDDA5',
          sub: (ip ? ip + ' \u00b7 ' : '') + (os ? os.substring(0,20) : 'host') + (ns ? ' \u00b7 ' + ns : ''),
          risk: risk,
          malicious: (status === 'contained'),
          alerts: (EE_ALERTS[hostname] || []).length,
          alertList: EE_ALERTS[hostname] || [],
          lastSeen: cs.last_seen ? new Date(cs.last_seen).toLocaleTimeString() : 'recent',
          ip: ip
        });
      });

      // Build IP + user entities from alert data
      var liveIPs = [];
      var liveUsers = [];
      if (ipData && ipData.aggregations) {
        var srcIPs = ipData.aggregations.src_ips ? ipData.aggregations.src_ips.buckets : [];
        var dstIPs = ipData.aggregations.dst_ips ? ipData.aggregations.dst_ips.buckets : [];
        var seenIPs = {};
        srcIPs.forEach(function(b) {
          if (b.key && !seenIPs[b.key] && liveIPs.length < 15) {
            seenIPs[b.key] = true; liveIPs.push({ ip: b.key, count: b.doc_count });
          }
        });
        dstIPs.forEach(function(b) {
          if (b.key && !seenIPs[b.key] && liveIPs.length < 20) {
            seenIPs[b.key] = true; liveIPs.push({ ip: b.key, count: b.doc_count });
          }
        });
        liveUsers = ipData.aggregations.usernames ? ipData.aggregations.usernames.buckets.slice(0,10) : [];
      }

      liveIPs.forEach(function(ipObj) {
        EE_ENTITIES.push({
          id: ipObj.ip,
          type: 'ip',
          label: '',
          icon: '\uD83C\uDF10',
          sub: 'ip address \u00b7 ' + ipObj.count + ' events',
          risk: 'medium',
          malicious: false,
          alerts: (EE_ALERTS[ipObj.ip] || []).length,
          alertList: EE_ALERTS[ipObj.ip] || [],
          lastSeen: 'recent'
        });
      });

      liveUsers.forEach(function(uObj) {
        EE_ENTITIES.push({
          id: uObj.key,
          type: 'user',
          label: '',
          icon: '\uD83D\uDC64',
          sub: 'user \u00b7 ' + uObj.doc_count + ' events',
          risk: 'low',
          malicious: false,
          alerts: (EE_ALERTS[uObj.key] || []).length,
          alertList: EE_ALERTS[uObj.key] || [],
          lastSeen: 'recent'
        });
      });

      // Build edges: connect host to its IPs (source IPs from alerts that match host IPs)
      var hostIpMap = {};
      EE_ENTITIES.filter(function(e) { return e.type === 'host' && e.ip; }).forEach(function(h) {
        hostIpMap[h.ip] = h.id;
      });
      EE_ENTITIES.filter(function(e) { return e.type === 'ip'; }).forEach(function(ipEnt) {
        if (hostIpMap[ipEnt.id]) {
          EE_EDGES.push({ from: hostIpMap[ipEnt.id], to: ipEnt.id });
        }
      });
      // Connect IPs to nearby hosts
      var allHosts = EE_ENTITIES.filter(function(e) { return e.type === 'host'; });
      EE_ENTITIES.filter(function(e) { return e.type === 'ip'; }).forEach(function(ipEnt) {
        if (!hostIpMap[ipEnt.id] && allHosts.length > 0) {
          // Connect to a random host (simulates network relationships)
          var targetHost = allHosts[Math.floor(Math.random() * Math.min(allHosts.length, 5))];
          EE_EDGES.push({ from: ipEnt.id, to: targetHost.id, type: 'communicated_with' });
        }
      });

      // Connect hosts that share the same namespace (client)
      var nsByHost = {};
      EE_ENTITIES.filter(function(e) { return e.type === 'host' && e.sub; }).forEach(function(h) {
        var parts = h.sub.split(' Â· ');
        var ns = parts[parts.length - 1];
        if (ns && ns !== 'host') {
          if (!nsByHost[ns]) nsByHost[ns] = [];
          nsByHost[ns].push(h.id);
        }
      });
      Object.keys(nsByHost).forEach(function(ns) {
        var hosts = nsByHost[ns];
        for (var i = 0; i < hosts.length - 1 && i < 3; i++) {
          EE_EDGES.push({ from: hosts[i], to: hosts[i + 1], type: 'same_network' });
        }
      });

      // Connect users to hosts
      EE_ENTITIES.filter(function(e) { return e.type === 'user'; }).forEach(function(u, idx) {
        if (allHosts.length > 0) {
          var targetHost = allHosts[idx % allHosts.length];
          EE_EDGES.push({ from: u.id, to: targetHost.id, type: 'logged_into' });
        }
      });

      var totalEntities = EE_ENTITIES.length;
      console.log('[EntityExplorer] Live data built: ' + totalEntities + ' entities (' +
        hostBuckets.length + ' hosts, ' + liveIPs.length + ' IPs, ' + liveUsers.length + ' users), ' +
        EE_EDGES.length + ' edges');

      // (Re-)initialize the canvas/catalog with live data
      eeInitNodes();
      eeBuildCatalog('all', '');
      eeSetupCanvasEvents();
      eeSetupUI();
      if (typeof eeAnimFrame !== 'undefined' && eeAnimFrame) {
        cancelAnimationFrame(eeAnimFrame);
        eeAnimFrame = null;
      }
      eeAnimate();

      // Update catalog count
      var countEl = document.getElementById('eeCatalogCount');
      if (countEl) countEl.textContent = totalEntities + ' entities (live)';

    } catch (err) {
      console.error('[EntityExplorer] loadLiveEntityData error:', err);
      // Show error in catalog
      var catalogListErr = document.getElementById('eeCatalogList');
      if (catalogListErr) {
        catalogListErr.innerHTML = '<div style="padding:20px;text-align:center;color:var(--amber);font-size:11px;">Failed to load live entity data. ' + err.message + '</div>';
      }
    }
  }

  // -- Main Init --
  window.initEntityExplorer = async function() {
    if (eeInitialized) return;
    eeInitialized = true;

    eeCanvas = document.getElementById('eeCanvas');
    if (!eeCanvas) return;
    eeCtx = eeCanvas.getContext('2d');

    // Setup events/UI first so controls work
    eeSetupCanvasEvents();
    eeSetupUI();

    // Load live entity data from Elastic â€” this will populate EE_ENTITIES/EE_EDGES
    // and call eeInitNodes, eeBuildCatalog, eeAnimate when done
    await loadLiveEntityData();

    // Handle resize
    const resizeObs = new ResizeObserver(() => {
      // Canvas auto-resizes in draw loop
    });
    const container = document.getElementById('eeCanvasContainer');
    if (container) resizeObs.observe(container);
  };
})();

// ============================================================
//  COMMAND CENTER VISUALIZATION
// â”€â”€ Global live data for dashboard visuals â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var _ccLive = {
  alerts: 0, incidents: 0, automated: 0, manual: 0,
  resolved: 0, open: 0, escalated: 0,
  autoSev: [{c:'#ef4444',v:'0'},{c:'#f59e0b',v:'0'},{c:'#00d4ff',v:'0'},{c:'#10b981',v:'0'}],
  manualSev: [{c:'#ef4444',v:'0'},{c:'#f59e0b',v:'0'},{c:'#00d4ff',v:'0'},{c:'#10b981',v:'0'}]
};
window._liveVis = null; // filled by populateLiveDashboard
// ============================================================
var ccAnimId = null;
// roundRect polyfill for older browsers
if (!CanvasRenderingContext2D.prototype.roundRect) {
  CanvasRenderingContext2D.prototype.roundRect = function(x, y, w, h, radii) {
    var r = typeof radii === 'number' ? radii : (radii && radii[0]) || 0;
    this.moveTo(x + r, y);
    this.lineTo(x + w - r, y);
    this.quadraticCurveTo(x + w, y, x + w, y + r);
    this.lineTo(x + w, y + h - r);
    this.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
    this.lineTo(x + r, y + h);
    this.quadraticCurveTo(x, y + h, x, y + h - r);
    this.lineTo(x, y + r);
    this.quadraticCurveTo(x, y, x + r, y);
    this.closePath();
  };
}
function initCommandCenter() {
  // Production guard removed â€” visuals render with live data
  var canvas = document.getElementById('commandCenterCanvas');
  if (!canvas) return;
  var ctx = canvas.getContext('2d');
  var wrapper = canvas.parentElement;

  // Cancel any existing animation
  if (ccAnimId) { cancelAnimationFrame(ccAnimId); ccAnimId = null; }

  // DPI scaling
  function resizeCanvas() {
    var dpr = window.devicePixelRatio || 1;
    var rect = wrapper.getBoundingClientRect();
    canvas.width = rect.width * dpr;
    canvas.height = rect.height * dpr;
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    return { w: rect.width, h: rect.height };
  }
  var dims = resizeCanvas();
  var W = dims.w, H = dims.h;

  window.addEventListener('resize', function() {
    var d = resizeCanvas();
    W = d.w; H = d.h;
  });

  // (greeting element removed â€” now using command bar)

  // Update command center clock
  function updateCCClock() {
    var now = new Date();
    var sgt = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Singapore' }));
    var hh = String(sgt.getHours()).padStart(2, '0');
    var mm = String(sgt.getMinutes()).padStart(2, '0');
    var el = document.getElementById('ccClockTime');
    if (el) el.textContent = hh + ':' + mm;
  }
  updateCCClock();
  setInterval(updateCCClock, 30000);

  function updateTzClocks() {
    var now = new Date();
    function fmt(offset, label) {
      var d = new Date(now.getTime() + offset * 3600000);
      var hh = String(d.getUTCHours()).padStart(2, '0');
      var mm = String(d.getUTCMinutes()).padStart(2, '0');
      return hh + ':' + mm + ' ' + label;
    }
    var phtEl = document.getElementById('tz-pht');
    var wibEl = document.getElementById('tz-wib');
    var ictEl = document.getElementById('tz-ict');
    var aestEl = document.getElementById('tz-aest');
    if (phtEl) phtEl.textContent = fmt(8, 'PHT');
    if (wibEl) wibEl.textContent = fmt(7, 'WIB');
    if (ictEl) ictEl.textContent = fmt(7, 'ICT');
    if (aestEl) aestEl.textContent = fmt(11, 'AEST');
  }
  setInterval(updateTzClocks, 1000);
  updateTzClocks();

  // Data sources
  var sources = [
    { name: 'Elastic SIEM', color: '#00d4ff' },
    { name: 'CrowdStrike Falcon', color: '#ff4438' },
    { name: 'SentinelOne', color: '#7c3aed' },
    { name: 'MS Defender', color: '#00a4ef' },
    { name: 'Trend Vision One', color: '#8b5cf6' },
    { name: 'Heimdal', color: '#f59e0b' },
    { name: 'ThreatLocker', color: '#ef4444' },
    { name: 'Sophos Central', color: '#005bac' },
    { name: 'FortiXDR', color: '#ee3124' },
    { name: 'Office 365', color: '#3b82f6' },
    { name: 'Azure AD', color: '#06b6d4' },
    { name: 'AWS CloudTrail', color: '#f97316' }
  ];

  // Particle class
  function Particle(path, color, speed) {
    this.path = path;
    this.color = color;
    this.t = Math.random();
    this.speed = speed || (0.002 + Math.random() * 0.003);
    this.size = 2 + Math.random() * 2;
  }
  Particle.prototype.update = function() {
    this.t += this.speed;
    if (this.t > 1) this.t -= 1;
  };
  Particle.prototype.getPos = function() {
    var t = this.t;
    var p = this.path;
    var mt = 1 - t;
    var x = mt*mt*mt*p[0] + 3*mt*mt*t*p[2] + 3*mt*t*t*p[4] + t*t*t*p[6];
    var y = mt*mt*mt*p[1] + 3*mt*mt*t*p[3] + 3*mt*t*t*p[5] + t*t*t*p[7];
    return [x, y];
  };

  // Create particles for each source line
  var lineParticles = [];
  var CONVERGE_X, CONVERGE_Y;

  function buildPaths() {
    lineParticles = [];
    // Layout zones
    var leftX = 16;
    var srcStartY = 55;
    var srcSpacing = (H - 110) / (sources.length - 1);
    CONVERGE_X = W * 0.33;
    CONVERGE_Y = H * 0.5;

    sources.forEach(function(src, i) {
      var sy = srcStartY + i * srcSpacing;
      var sx = leftX + 110;
      var cp1x = sx + (CONVERGE_X - sx) * 0.4;
      var cp1y = sy;
      var cp2x = CONVERGE_X - (CONVERGE_X - sx) * 0.15;
      var cp2y = CONVERGE_Y;
      var path = [sx, sy, cp1x, cp1y, cp2x, cp2y, CONVERGE_X, CONVERGE_Y];
      for (var j = 0; j < 5; j++) {
        lineParticles.push(new Particle(path, src.color, 0.002 + Math.random() * 0.004));
      }
    });
  }
  buildPaths();

  // Flow particles: ALERTS -> Shield (faster) and Shield -> Radar (slower)
  var alertToShieldParticles = [];
  var shieldToRadarParticles = [];

  function buildBridgeParticles() {
    alertToShieldParticles = [];
    shieldToRadarParticles = [];
    // These positions are computed in draw(), so we use approximate layout coords
    var connStartX = W * 0.33 + 40;
    var connEndX = W * 0.60 - Math.min(W * 0.12, H * 0.32) - 20;
    var shieldCX = (connStartX + connEndX) / 2;
    var cY = H * 0.5;

    // ALERTS -> Shield: straight-ish bezier, FAST (0.008-0.014)
    var aPath = [connStartX, cY, connStartX + (shieldCX - connStartX)*0.4, cY - 5, shieldCX - (shieldCX - connStartX)*0.3, cY + 3, shieldCX - 48, cY];
    for (var a = 0; a < 6; a++) {
      var speed = 0.008 + Math.random() * 0.006;
      var colors = ['#00d4ff','#10b981','#f59e0b','#ef4444','#a78bfa'];
      alertToShieldParticles.push(new Particle(aPath, colors[a % colors.length], speed));
    }

    // Shield -> Radar: straight-ish bezier, SLOWER (0.002-0.005)
    var sPath = [shieldCX + 48, cY, shieldCX + 48 + (connEndX - shieldCX - 48)*0.35, cY + 4, connEndX - (connEndX - shieldCX - 48)*0.25, cY - 3, connEndX, cY];
    for (var b = 0; b < 4; b++) {
      var speed2 = 0.002 + Math.random() * 0.003;
      var colors2 = ['#00d4ff','#f59e0b','#ef4444','#10b981'];
      shieldToRadarParticles.push(new Particle(sPath, colors2[b % colors2.length], speed2));
    }
  }
  buildBridgeParticles();

  var radarBlips = [];
  var SPIRAL_CX, SPIRAL_CY;
  var radarAngle = 0;
  var severityColors = ['#ef4444', '#f59e0b', '#00d4ff', '#10b981'];

  function buildSpiral() {
    radarBlips = [];
    SPIRAL_CX = W * 0.60;
    SPIRAL_CY = H * 0.50;
  }
  buildSpiral();

  // Pre-seed some initial blips so radar isn't empty at start
  (function seedBlips() {
    var maxR2 = Math.min(W * 0.12, H * 0.32);
    var blipDefs = [
      { angleOff: 0.4, rFrac: 0.55, ci: 0 },
      { angleOff: 1.1, rFrac: 0.75, ci: 1 },
      { angleOff: 1.8, rFrac: 0.40, ci: 2 },
      { angleOff: 2.5, rFrac: 0.85, ci: 0 },
      { angleOff: 3.2, rFrac: 0.60, ci: 1 },
      { angleOff: 4.0, rFrac: 0.30, ci: 2 },
      { angleOff: 4.7, rFrac: 0.70, ci: 0 },
      { angleOff: 5.3, rFrac: 0.50, ci: 1 }
    ];
    for (var bi = 0; bi < blipDefs.length; bi++) {
      var bd = blipDefs[bi];
      var r2 = bd.rFrac * maxR2;
      radarBlips.push({
        angle: bd.angleOff,
        r: r2,
        color: severityColors[bd.ci],
        alpha: 0.3 + Math.random() * 0.5,
        life: 0.4 + Math.random() * 0.6,
        size: 2 + Math.random() * 2.5
      });
    }
  })();

  // Resolution flow particles
  var autoParticles = [];
  var manualParticles = [];
  var AUTO_END_X, AUTO_END_Y, MANUAL_END_X, MANUAL_END_Y;
  // Sub-branch particles and endpoints
  var autoResolvedParticles = [];
  var autoSeverityParticles = [];
  var manualOpenParticles = [];
  var manualEscalatedParticles = [];
  var RESOLVED_X, RESOLVED_Y, SEVERITY_X, SEVERITY_Y, OPEN_X, OPEN_Y, ESCALATED_X, ESCALATED_Y;

  function buildResolution() {
    autoParticles = [];
    manualParticles = [];
    autoResolvedParticles = [];
    autoSeverityParticles = [];
    manualOpenParticles = [];
    manualEscalatedParticles = [];
    var startX = SPIRAL_CX + Math.min(W * 0.12, H * 0.32) + 20;
    var startY = SPIRAL_CY;
    AUTO_END_X = W * 0.82;
    AUTO_END_Y = H * 0.30;
    MANUAL_END_X = W * 0.82;
    MANUAL_END_Y = H * 0.72;

    // Auto path: curves upward right
    var autoPath = [
      startX, startY,
      startX + (AUTO_END_X - startX) * 0.4, startY - 30,
      startX + (AUTO_END_X - startX) * 0.7, AUTO_END_Y + 20,
      AUTO_END_X, AUTO_END_Y
    ];
    for (var i = 0; i < 8; i++) {
      autoParticles.push(new Particle(autoPath, '#00d4ff', 0.003 + Math.random() * 0.004));
    }

    // Manual path: curves downward right
    var manualPath = [
      startX, startY,
      startX + (MANUAL_END_X - startX) * 0.3, startY + 30,
      startX + (MANUAL_END_X - startX) * 0.6, MANUAL_END_Y - 20,
      MANUAL_END_X, MANUAL_END_Y
    ];
    for (var j = 0; j < 4; j++) {
      manualParticles.push(new Particle(manualPath, '#4d5a6e', 0.002 + Math.random() * 0.003));
    }

    // Sub-branch endpoints
    var branchLen = Math.min(W * 0.10, 120);
    // From Auto -> Resolved (upper-right)
    RESOLVED_X = Math.min(AUTO_END_X + branchLen * 0.9, W - 55);
    RESOLVED_Y = AUTO_END_Y - 45;
    var resolvedPath = [
      AUTO_END_X, AUTO_END_Y,
      AUTO_END_X + branchLen * 0.3, AUTO_END_Y - 10,
      AUTO_END_X + branchLen * 0.6, RESOLVED_Y + 8,
      RESOLVED_X, RESOLVED_Y
    ];
    for (var r = 0; r < 4; r++) {
      autoResolvedParticles.push(new Particle(resolvedPath, '#10b981', 0.003 + Math.random() * 0.003));
    }

    // From Auto -> Severity (mid-right)
    SEVERITY_X = Math.min(AUTO_END_X + branchLen * 0.9, W - 120);
    SEVERITY_Y = AUTO_END_Y + 45;
    var severityPath = [
      AUTO_END_X, AUTO_END_Y,
      AUTO_END_X + branchLen * 0.3, AUTO_END_Y + 10,
      AUTO_END_X + branchLen * 0.6, SEVERITY_Y - 8,
      SEVERITY_X, SEVERITY_Y
    ];
    for (var s = 0; s < 3; s++) {
      autoSeverityParticles.push(new Particle(severityPath, '#00d4ff', 0.002 + Math.random() * 0.003));
    }

    // From Manual -> Open (right)
    OPEN_X = Math.min(MANUAL_END_X + branchLen * 0.9, W - 55);
    OPEN_Y = MANUAL_END_Y - 35;
    var openPath = [
      MANUAL_END_X, MANUAL_END_Y,
      MANUAL_END_X + branchLen * 0.3, MANUAL_END_Y - 8,
      MANUAL_END_X + branchLen * 0.6, OPEN_Y + 6,
      OPEN_X, OPEN_Y
    ];
    for (var o = 0; o < 3; o++) {
      manualOpenParticles.push(new Particle(openPath, '#f59e0b', 0.002 + Math.random() * 0.003));
    }

    // From Manual -> Escalated (lower-right)
    ESCALATED_X = Math.min(MANUAL_END_X + branchLen * 0.9, W - 55);
    ESCALATED_Y = MANUAL_END_Y + 45;
    var escalatedPath = [
      MANUAL_END_X, MANUAL_END_Y,
      MANUAL_END_X + branchLen * 0.3, MANUAL_END_Y + 10,
      MANUAL_END_X + branchLen * 0.6, ESCALATED_Y - 6,
      ESCALATED_X, ESCALATED_Y
    ];
    for (var e = 0; e < 2; e++) {
      manualEscalatedParticles.push(new Particle(escalatedPath, '#ef4444', 0.002 + Math.random() * 0.002));
    }
  }

  // Rebuild all geometry
  function rebuildAll() {
    buildPaths();
    buildBridgeParticles();
    buildSpiral();
    buildResolution();
  }
  rebuildAll();
  window.addEventListener('resize', function() { setTimeout(rebuildAll, 50); });

  // Draw helpers
  function drawGlowLine(path, color, lineW, blur) {
    ctx.save();
    ctx.strokeStyle = color;
    ctx.lineWidth = lineW || 1.5;
    ctx.shadowColor = color;
    ctx.shadowBlur = blur || 8;
    ctx.globalAlpha = 0.4;
    ctx.beginPath();
    ctx.moveTo(path[0], path[1]);
    ctx.bezierCurveTo(path[2], path[3], path[4], path[5], path[6], path[7]);
    ctx.stroke();
    ctx.restore();
  }

  function drawParticle(pos, color, size) {
    ctx.save();
    ctx.shadowColor = color;
    ctx.shadowBlur = 10;
    ctx.globalAlpha = 0.9;
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.arc(pos[0], pos[1], size, 0, Math.PI * 2);
    ctx.fill();
    // Inner bright core
    ctx.globalAlpha = 1;
    ctx.fillStyle = '#fff';
    ctx.beginPath();
    ctx.arc(pos[0], pos[1], size * 0.4, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();
  }

  function drawText(text, x, y, size, color, align, font) {
    ctx.save();
    ctx.fillStyle = color || '#fff';
    ctx.font = (font || ('700 ' + size + 'px Sora, sans-serif'));
    ctx.textAlign = align || 'center';
    ctx.textBaseline = 'middle';
    ctx.shadowColor = 'rgba(0,0,0,0.5)';
    ctx.shadowBlur = 4;
    ctx.fillText(text, x, y);
    ctx.restore();
  }

  var frameCount = 0;

  function draw() {
    ccAnimId = requestAnimationFrame(draw);
    if (W <= 0 || H <= 0) return; // Skip frame when canvas is hidden/zero-size
    frameCount++;
    ctx.clearRect(0, 0, W, H);

    // === LEFT ZONE: Data Sources ===
    var leftX = 16;
    var srcStartY = 55;
    var srcSpacing = (H - 110) / (sources.length - 1);

    // Draw source labels & dots
    sources.forEach(function(src, i) {
      var sy = srcStartY + i * srcSpacing;
      // Color dot
      ctx.save();
      ctx.fillStyle = src.color;
      ctx.shadowColor = src.color;
      ctx.shadowBlur = 6;
      ctx.beginPath();
      ctx.arc(leftX + 4, sy, 3, 0, Math.PI * 2);
      ctx.fill();
      ctx.restore();
      // Label
      drawText(src.name, leftX + 14, sy, 9, '#8892a4', 'left', '400 9px "IBM Plex Sans", sans-serif');
    });

    // +4 more label
    var lastY = srcStartY + (sources.length - 1) * srcSpacing;
    drawText('+4 more', leftX + 14, lastY + srcSpacing * 0.6, 8, '#4d5a6e', 'left', '400 8px "IBM Plex Sans", sans-serif');

    // Draw flow lines from sources to convergence
    sources.forEach(function(src, i) {
      var sy = srcStartY + i * srcSpacing;
      var sx = leftX + 110;
      var cp1x = sx + (CONVERGE_X - sx) * 0.4;
      var cp1y = sy;
      var cp2x = CONVERGE_X - (CONVERGE_X - sx) * 0.15;
      var cp2y = CONVERGE_Y;
      drawGlowLine([sx, sy, cp1x, cp1y, cp2x, cp2y, CONVERGE_X, CONVERGE_Y], src.color, 1.5, 10);
    });

    // Draw particles on lines
    lineParticles.forEach(function(p) {
      p.update();
      var pos = p.getPos();
      drawParticle(pos, p.color, p.size);
    });

    // Convergence glow
    ctx.save();
    var cgr = ctx.createRadialGradient(CONVERGE_X, CONVERGE_Y, 0, CONVERGE_X, CONVERGE_Y, 40);
    cgr.addColorStop(0, 'rgba(0,212,255,0.15)');
    cgr.addColorStop(1, 'rgba(0,212,255,0)');
    ctx.fillStyle = cgr;
    ctx.beginPath();
    ctx.arc(CONVERGE_X, CONVERGE_Y, 40, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();

    // Convergence text
    drawText(_ccLive.alerts ? _ccLive.alerts.toLocaleString() : 'â€”', CONVERGE_X, CONVERGE_Y - 8, 28, '#fff', 'center', '800 28px Sora, sans-serif');
    drawText('ALERTS', CONVERGE_X, CONVERGE_Y + 16, 10, '#4d5a6e', 'center', '500 10px "IBM Plex Sans", sans-serif');

    // DACTA SIEMLess Shield between convergence and spiral
    var connStartX = CONVERGE_X + 40;
    var connEndX = SPIRAL_CX - Math.min(W * 0.12, H * 0.32) - 20;
    var shieldCX = (connStartX + connEndX) / 2;
    var shieldCY = (CONVERGE_Y + SPIRAL_CY) / 2;
    var shieldW = 95;
    var shieldH = 110;
    var shieldPulse = Math.sin(Date.now() * 0.0015) * 0.18 + 0.82;

    // Line: convergence -> shield
    ctx.save();
    ctx.strokeStyle = 'rgba(0,212,255,0.18)';
    ctx.lineWidth = 1;
    ctx.shadowColor = 'rgba(0,212,255,0.25)';
    ctx.shadowBlur = 6;
    ctx.beginPath();
    ctx.moveTo(connStartX, CONVERGE_Y);
    ctx.lineTo(shieldCX - shieldW * 0.5, shieldCY);
    ctx.stroke();
    ctx.restore();

    // Line: shield -> spiral
    ctx.save();
    ctx.strokeStyle = 'rgba(0,212,255,0.18)';
    ctx.lineWidth = 1;
    ctx.shadowColor = 'rgba(0,212,255,0.25)';
    ctx.shadowBlur = 6;
    ctx.beginPath();
    ctx.moveTo(shieldCX + shieldW * 0.5, shieldCY);
    ctx.lineTo(connEndX, SPIRAL_CY);
    ctx.stroke();
    ctx.restore();

    // Draw shield shape
    ctx.save();
    ctx.translate(shieldCX, shieldCY - shieldH * 0.06);

    // Shield path: pointed bottom, rounded top corners
    var sw2 = shieldW * 0.5;
    var sh2 = shieldH * 0.5;
    var cornerR = shieldW * 0.18;
    ctx.beginPath();
    ctx.moveTo(0, sh2);                        // bottom point
    ctx.lineTo(-sw2, -sh2 * 0.25);            // lower-left
    ctx.lineTo(-sw2, -sh2 + cornerR);          // upper-left before corner
    ctx.quadraticCurveTo(-sw2, -sh2, -sw2 + cornerR, -sh2); // top-left corner
    ctx.lineTo(sw2 - cornerR, -sh2);           // top edge
    ctx.quadraticCurveTo(sw2, -sh2, sw2, -sh2 + cornerR);   // top-right corner
    ctx.lineTo(sw2, -sh2 * 0.25);             // upper-right
    ctx.closePath();

    // Semi-transparent fill
    var shieldGrad = ctx.createLinearGradient(0, -sh2, 0, sh2);
    shieldGrad.addColorStop(0, 'rgba(0,212,255,0.12)');
    shieldGrad.addColorStop(1, 'rgba(0,100,180,0.06)');
    ctx.fillStyle = shieldGrad;
    ctx.fill();

    // Border glow
    ctx.strokeStyle = 'rgba(0,212,255,' + (0.55 * shieldPulse) + ')';
    ctx.lineWidth = 1.5;
    ctx.shadowColor = 'rgba(0,212,255,0.7)';
    ctx.shadowBlur = 14 * shieldPulse;
    ctx.stroke();
    ctx.restore();

    // Shield inner chevron/check icon
    ctx.save();
    ctx.translate(shieldCX, shieldCY - shieldH * 0.06);
    ctx.strokeStyle = 'rgba(0,212,255,' + (0.7 * shieldPulse) + ')';
    ctx.lineWidth = 2;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    ctx.shadowColor = 'rgba(0,212,255,0.8)';
    ctx.shadowBlur = 8;
    ctx.beginPath();
    ctx.moveTo(-14, 0);
    ctx.lineTo(-4, 11);
    ctx.lineTo(14, -10);
    ctx.stroke();
    ctx.restore();

    // Shield text labels
    ctx.save();
    ctx.shadowBlur = 0;
    drawText('DACTA', shieldCX, shieldCY - shieldH * 0.06 - 30, 13, '#00d4ff', 'center', '800 13px Sora, sans-serif');
    drawText('SIEMLess', shieldCX, shieldCY - shieldH * 0.06 + 36, 10, 'rgba(0,212,255,0.7)', 'center', '500 10px Sora, sans-serif');
    ctx.restore();

    // === BRIDGE PARTICLES: Alerts -> Shield (fast) and Shield -> Radar (slow) ===
    alertToShieldParticles.forEach(function(p) {
      p.update();
      var pos = p.getPos();
      drawParticle(pos, p.color, p.size);
    });
    shieldToRadarParticles.forEach(function(p) {
      p.update();
      var pos = p.getPos();
      drawParticle(pos, p.color, p.size);
    });

    // === CENTER ZONE: Radar Detector ===
    radarAngle += 0.022;
    if (radarAngle > Math.PI * 2) radarAngle -= Math.PI * 2;
    var maxR = Math.max(Math.min(W * 0.12, H * 0.32), 3);

    // Outer glow ring
    ctx.save();
    var ringGrad = ctx.createRadialGradient(SPIRAL_CX, SPIRAL_CY, maxR * 0.6, SPIRAL_CX, SPIRAL_CY, maxR * 1.3);
    ringGrad.addColorStop(0, 'rgba(0,212,255,0)');
    ringGrad.addColorStop(0.5, 'rgba(0,212,255,0.03)');
    ringGrad.addColorStop(1, 'rgba(0,212,255,0)');
    ctx.fillStyle = ringGrad;
    ctx.beginPath();
    ctx.arc(SPIRAL_CX, SPIRAL_CY, maxR * 1.3, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();

    // Dark circular radar background
    ctx.save();
    ctx.beginPath();
    ctx.arc(SPIRAL_CX, SPIRAL_CY, maxR, 0, Math.PI * 2);
    ctx.fillStyle = 'rgba(4,10,25,0.82)';
    ctx.fill();
    ctx.strokeStyle = 'rgba(0,212,255,0.22)';
    ctx.lineWidth = 1;
    ctx.stroke();
    ctx.restore();

    // Concentric rings
    ctx.save();
    ctx.strokeStyle = 'rgba(0,212,255,0.10)';
    ctx.lineWidth = 0.8;
    for (var ri = 1; ri <= 4; ri++) {
      ctx.beginPath();
      ctx.arc(SPIRAL_CX, SPIRAL_CY, maxR * (ri / 4), 0, Math.PI * 2);
      ctx.stroke();
    }
    // Cross-hairs
    ctx.strokeStyle = 'rgba(0,212,255,0.07)';
    ctx.lineWidth = 0.6;
    ctx.beginPath(); ctx.moveTo(SPIRAL_CX - maxR, SPIRAL_CY); ctx.lineTo(SPIRAL_CX + maxR, SPIRAL_CY); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(SPIRAL_CX, SPIRAL_CY - maxR); ctx.lineTo(SPIRAL_CX, SPIRAL_CY + maxR); ctx.stroke();
    ctx.restore();

    // Radar sweep â€” trailing glow sector then bright arm
    ctx.save();
    ctx.beginPath();
    ctx.moveTo(SPIRAL_CX, SPIRAL_CY);
    ctx.arc(SPIRAL_CX, SPIRAL_CY, maxR, radarAngle - 1.1, radarAngle, false);
    ctx.closePath();
    var sweepGrad = ctx.createConicalGradient ? null : null; // fallback
    // Use radial gradient clipped to sector for sweep trail
    var sweepFill = ctx.createRadialGradient(SPIRAL_CX, SPIRAL_CY, 0, SPIRAL_CX, SPIRAL_CY, maxR);
    sweepFill.addColorStop(0, 'rgba(0,212,255,0.0)');
    sweepFill.addColorStop(1, 'rgba(0,212,255,0.12)');
    ctx.fillStyle = sweepFill;
    ctx.fill();
    ctx.restore();

    // Bright sweep arm line
    ctx.save();
    ctx.strokeStyle = 'rgba(0,212,255,0.85)';
    ctx.lineWidth = 1.5;
    ctx.shadowColor = 'rgba(0,212,255,0.9)';
    ctx.shadowBlur = 10;
    ctx.beginPath();
    ctx.moveTo(SPIRAL_CX, SPIRAL_CY);
    ctx.lineTo(
      SPIRAL_CX + Math.cos(radarAngle) * maxR,
      SPIRAL_CY + Math.sin(radarAngle) * maxR
    );
    ctx.stroke();
    ctx.restore();

    // Spawn new blips as sweep arm passes
    if (frameCount % 14 === 0) {
      var newR = (0.25 + Math.random() * 0.72) * maxR;
      var newAngle = radarAngle - 0.05 + (Math.random() - 0.5) * 0.3;
      var sevIdx = Math.random() < 0.15 ? 0 : Math.random() < 0.35 ? 1 : 2;
      radarBlips.push({
        angle: newAngle,
        r: newR,
        color: severityColors[sevIdx],
        alpha: 0.85,
        life: 1.0,
        size: 1.8 + Math.random() * 2.2
      });
    }

    // Clip blips to radar circle, draw & fade
    ctx.save();
    ctx.beginPath();
    ctx.arc(SPIRAL_CX, SPIRAL_CY, maxR - 2, 0, Math.PI * 2);
    ctx.clip();
    for (var bi2 = radarBlips.length - 1; bi2 >= 0; bi2--) {
      var blip = radarBlips[bi2];
      // Fade based on angular distance behind sweep
      var angDiff = radarAngle - blip.angle;
      if (angDiff < 0) angDiff += Math.PI * 2;
      var fadeFactor = Math.max(0, 1 - angDiff / (Math.PI * 2));
      var bAlpha = blip.alpha * fadeFactor;
      if (bAlpha < 0.02) { radarBlips.splice(bi2, 1); continue; }
      var bx = SPIRAL_CX + Math.cos(blip.angle) * blip.r;
      var by = SPIRAL_CY + Math.sin(blip.angle) * blip.r;
      ctx.save();
      ctx.globalAlpha = bAlpha;
      ctx.fillStyle = blip.color;
      ctx.shadowColor = blip.color;
      ctx.shadowBlur = 7;
      ctx.beginPath();
      ctx.arc(bx, by, blip.size, 0, Math.PI * 2);
      ctx.fill();
      ctx.restore();
    }
    ctx.restore();

    // Center incident text
    drawText(_ccLive.incidents ? String(_ccLive.incidents) : 'â€”', SPIRAL_CX, SPIRAL_CY - 8, 42, '#fff', 'center', '800 42px Sora, sans-serif');
    drawText('TOTAL INCIDENTS', SPIRAL_CX, SPIRAL_CY + 20, 10, '#4d5a6e', 'center', '600 10px "IBM Plex Sans", sans-serif');

    // === RIGHT ZONE: Resolution Flow ===
    var pipeStartX = SPIRAL_CX + maxR + 20;
    var pipeStartY = SPIRAL_CY;

    // Auto path (upper)
    var autoPath = [
      pipeStartX, pipeStartY,
      pipeStartX + (AUTO_END_X - pipeStartX) * 0.4, pipeStartY - 30,
      pipeStartX + (AUTO_END_X - pipeStartX) * 0.7, AUTO_END_Y + 20,
      AUTO_END_X, AUTO_END_Y
    ];
    drawGlowLine(autoPath, '#00d4ff', 2.5, 14);

    // Manual path (lower)
    var manualPath = [
      pipeStartX, pipeStartY,
      pipeStartX + (MANUAL_END_X - pipeStartX) * 0.3, pipeStartY + 30,
      pipeStartX + (MANUAL_END_X - pipeStartX) * 0.6, MANUAL_END_Y - 20,
      MANUAL_END_X, MANUAL_END_Y
    ];
    drawGlowLine(manualPath, '#4d5a6e', 1.2, 6);

    // Update and draw resolution particles
    autoParticles.forEach(function(p) {
      p.path = autoPath;
      p.update();
      drawParticle(p.getPos(), '#00d4ff', p.size);
    });
    manualParticles.forEach(function(p) {
      p.path = manualPath;
      p.update();
      drawParticle(p.getPos(), '#8892a4', p.size);
    });

    // Auto label box
    ctx.save();
    ctx.fillStyle = 'rgba(0,212,255,0.08)';
    ctx.strokeStyle = 'rgba(0,212,255,0.3)';
    ctx.lineWidth = 1;
    ctx.shadowColor = 'rgba(0,212,255,0.2)';
    ctx.shadowBlur = 10;
    var boxW = 100, boxH = 44;
    var arx = AUTO_END_X - boxW / 2;
    var ary = AUTO_END_Y - boxH / 2;
    ctx.beginPath();
    ctx.roundRect(arx, ary, boxW, boxH, 8);
    ctx.fill();
    ctx.stroke();
    ctx.restore();
    // Shield icon (simple)
    drawText('\u26A1', AUTO_END_X - 36, AUTO_END_Y, 13, '#00d4ff', 'center', '400 13px sans-serif');
    drawText(String(_ccLive.automated), AUTO_END_X - 5, AUTO_END_Y - 6, 20, '#fff', 'center', '800 20px Sora, sans-serif');
    drawText('AUTOMATED', AUTO_END_X - 5, AUTO_END_Y + 12, 8, '#00d4ff', 'center', '600 8px "IBM Plex Sans", sans-serif');

    // Manual label box
    ctx.save();
    ctx.fillStyle = 'rgba(77,90,110,0.08)';
    ctx.strokeStyle = 'rgba(77,90,110,0.3)';
    ctx.lineWidth = 1;
    var mrx = MANUAL_END_X - boxW / 2;
    var mry = MANUAL_END_Y - boxH / 2;
    ctx.beginPath();
    ctx.roundRect(mrx, mry, boxW, boxH, 8);
    ctx.fill();
    ctx.stroke();
    ctx.restore();
    // Person icon
    drawText('\u{1F464}', MANUAL_END_X - 36, MANUAL_END_Y, 12, '#8892a4', 'center', '400 12px sans-serif');
    drawText(String(_ccLive.manual), MANUAL_END_X - 5, MANUAL_END_Y - 6, 20, '#fff', 'center', '800 20px Sora, sans-serif');
    drawText('MANUAL', MANUAL_END_X - 5, MANUAL_END_Y + 12, 8, '#8892a4', 'center', '600 8px "IBM Plex Sans", sans-serif');

    // === SUB-BRANCHES ===
    var branchLen = Math.min(W * 0.10, 120);
    var sbBoxW = 80, sbBoxH = 30;

    // --- Auto -> Resolved (upper-right, green) ---
    var resolvedPath = [
      AUTO_END_X, AUTO_END_Y,
      AUTO_END_X + branchLen * 0.3, AUTO_END_Y - 10,
      AUTO_END_X + branchLen * 0.6, RESOLVED_Y + 8,
      RESOLVED_X, RESOLVED_Y
    ];
    drawGlowLine(resolvedPath, '#10b981', 1, 6);
    autoResolvedParticles.forEach(function(p) {
      p.path = resolvedPath;
      p.update();
      drawParticle(p.getPos(), '#10b981', p.size * 0.8);
    });
    // Resolved endpoint box
    ctx.save();
    ctx.fillStyle = 'rgba(16,185,129,0.08)';
    ctx.strokeStyle = 'rgba(16,185,129,0.35)';
    ctx.lineWidth = 1;
    ctx.shadowColor = 'rgba(16,185,129,0.25)';
    ctx.shadowBlur = 8;
    ctx.beginPath();
    ctx.roundRect(RESOLVED_X - sbBoxW / 2, RESOLVED_Y - sbBoxH / 2, sbBoxW, sbBoxH, 6);
    ctx.fill();
    ctx.stroke();
    ctx.restore();
    drawText(String(_ccLive.resolved), RESOLVED_X - 5, RESOLVED_Y - 5, 14, '#10b981', 'center', '800 14px Sora, sans-serif');
    drawText('RESOLVED', RESOLVED_X - 5, RESOLVED_Y + 10, 7, '#10b981', 'center', '600 7px "IBM Plex Sans", sans-serif');

    // --- Auto -> Severity (mid-right, multi-color) ---
    var severityPath = [
      AUTO_END_X, AUTO_END_Y,
      AUTO_END_X + branchLen * 0.3, AUTO_END_Y + 10,
      AUTO_END_X + branchLen * 0.6, SEVERITY_Y - 8,
      SEVERITY_X, SEVERITY_Y
    ];
    drawGlowLine(severityPath, 'rgba(0,212,255,0.5)', 1, 6);
    autoSeverityParticles.forEach(function(p) {
      p.path = severityPath;
      p.update();
      drawParticle(p.getPos(), '#00d4ff', p.size * 0.8);
    });
    // Severity endpoint box (compact - dots + counts only)
    var sevBoxW = 120, sevBoxH = 34;
    var sevBX = SEVERITY_X - sevBoxW / 2;
    var sevBY = SEVERITY_Y - sevBoxH / 2;
    ctx.save();
    ctx.fillStyle = 'rgba(8,12,24,0.85)';
    ctx.strokeStyle = 'rgba(0,212,255,0.2)';
    ctx.lineWidth = 1;
    ctx.shadowColor = 'rgba(0,212,255,0.1)';
    ctx.shadowBlur = 10;
    ctx.beginPath();
    ctx.roundRect(sevBX, sevBY, sevBoxW, sevBoxH, 6);
    ctx.fill();
    ctx.stroke();
    ctx.restore();
    var sevData = _ccLive.autoSev;
    var sevItemW = sevBoxW / 4;
    var sevItemStartX = sevBX + sevItemW / 2;
    var sevDotY = SEVERITY_Y - 4;
    for (var si = 0; si < sevData.length; si++) {
      var sx = sevItemStartX + si * sevItemW;
      ctx.save();
      ctx.fillStyle = sevData[si].c;
      ctx.shadowColor = sevData[si].c;
      ctx.shadowBlur = 6;
      ctx.beginPath();
      ctx.arc(sx, sevDotY, 4, 0, Math.PI * 2);
      ctx.fill();
      ctx.restore();
      drawText(sevData[si].v, sx, sevDotY + 13, 9, '#e8edf5', 'center', '700 9px "IBM Plex Mono", monospace');
    }

    // --- Manual -> Open (right, amber) ---
    var openPath = [
      MANUAL_END_X, MANUAL_END_Y,
      MANUAL_END_X + branchLen * 0.3, MANUAL_END_Y - 8,
      MANUAL_END_X + branchLen * 0.6, OPEN_Y + 6,
      OPEN_X, OPEN_Y
    ];
    drawGlowLine(openPath, '#f59e0b', 1, 6);
    manualOpenParticles.forEach(function(p) {
      p.path = openPath;
      p.update();
      drawParticle(p.getPos(), '#f59e0b', p.size * 0.8);
    });
    // Open endpoint box
    ctx.save();
    ctx.fillStyle = 'rgba(245,158,11,0.08)';
    ctx.strokeStyle = 'rgba(245,158,11,0.35)';
    ctx.lineWidth = 1;
    ctx.shadowColor = 'rgba(245,158,11,0.25)';
    ctx.shadowBlur = 8;
    ctx.beginPath();
    ctx.roundRect(OPEN_X - sbBoxW / 2, OPEN_Y - sbBoxH / 2, sbBoxW, sbBoxH, 6);
    ctx.fill();
    ctx.stroke();
    ctx.restore();
    drawText(String(_ccLive.open), OPEN_X - 5, OPEN_Y - 5, 14, '#f59e0b', 'center', '800 14px Sora, sans-serif');
    drawText('OPEN', OPEN_X - 5, OPEN_Y + 10, 7, '#f59e0b', 'center', '600 7px "IBM Plex Sans", sans-serif');

    // --- Manual -> Escalated (lower-right, red) ---
    var escalatedPath = [
      MANUAL_END_X, MANUAL_END_Y,
      MANUAL_END_X + branchLen * 0.3, MANUAL_END_Y + 10,
      MANUAL_END_X + branchLen * 0.6, ESCALATED_Y - 6,
      ESCALATED_X, ESCALATED_Y
    ];
    drawGlowLine(escalatedPath, '#ef4444', 1, 6);
    manualEscalatedParticles.forEach(function(p) {
      p.path = escalatedPath;
      p.update();
      drawParticle(p.getPos(), '#ef4444', p.size * 0.8);
    });
    // Escalated endpoint box
    ctx.save();
    ctx.fillStyle = 'rgba(239,68,68,0.08)';
    ctx.strokeStyle = 'rgba(239,68,68,0.35)';
    ctx.lineWidth = 1;
    ctx.shadowColor = 'rgba(239,68,68,0.25)';
    ctx.shadowBlur = 8;
    ctx.beginPath();
    ctx.roundRect(ESCALATED_X - sbBoxW / 2, ESCALATED_Y - sbBoxH / 2, sbBoxW, sbBoxH, 6);
    ctx.fill();
    ctx.stroke();
    ctx.restore();
    drawText(String(_ccLive.escalated), ESCALATED_X - 5, ESCALATED_Y - 5, 14, '#ef4444', 'center', '800 14px Sora, sans-serif');
    drawText('ESCALATED', ESCALATED_X - 5, ESCALATED_Y + 10, 7, '#ef4444', 'center', '600 7px "IBM Plex Sans", sans-serif');

    // --- Manual -> Severity Breakdown (mid-right from manual) ---
    var mSevX = Math.min(MANUAL_END_X + branchLen * 0.7, W - 130);
    var mSevY = MANUAL_END_Y + 2;
    var mSevPath = [
      MANUAL_END_X, MANUAL_END_Y,
      MANUAL_END_X + branchLen * 0.2, MANUAL_END_Y,
      MANUAL_END_X + branchLen * 0.5, mSevY,
      mSevX, mSevY
    ];
    drawGlowLine(mSevPath, 'rgba(77,90,110,0.4)', 1, 4);
    // Manual Severity box (compact)
    var mSevBoxW = 120, mSevBoxH = 34;
    var mSevBX = mSevX - mSevBoxW / 2;
    var mSevBY = mSevY - mSevBoxH / 2;
    ctx.save();
    ctx.fillStyle = 'rgba(8,12,24,0.85)';
    ctx.strokeStyle = 'rgba(77,90,110,0.2)';
    ctx.lineWidth = 1;
    ctx.shadowColor = 'rgba(77,90,110,0.1)';
    ctx.shadowBlur = 8;
    ctx.beginPath();
    ctx.roundRect(mSevBX, mSevBY, mSevBoxW, mSevBoxH, 6);
    ctx.fill();
    ctx.stroke();
    ctx.restore();
    var mSevData = _ccLive.manualSev;
    var mSevItemW = mSevBoxW / 4;
    var mSevStartX = mSevBX + mSevItemW / 2;
    var mSevDotY = mSevY - 4;
    for (var mi = 0; mi < mSevData.length; mi++) {
      var mx = mSevStartX + mi * mSevItemW;
      ctx.save();
      ctx.fillStyle = mSevData[mi].c;
      ctx.shadowColor = mSevData[mi].c;
      ctx.shadowBlur = 6;
      ctx.beginPath();
      ctx.arc(mx, mSevDotY, 4, 0, Math.PI * 2);
      ctx.fill();
      ctx.restore();
      drawText(mSevData[mi].v, mx, mSevDotY + 13, 9, '#e8edf5', 'center', '700 9px "IBM Plex Mono", monospace');
    }

    // Branch point glow
    ctx.save();
    var brGrad = ctx.createRadialGradient(pipeStartX, pipeStartY, 0, pipeStartX, pipeStartY, 16);
    brGrad.addColorStop(0, 'rgba(0,212,255,0.2)');
    brGrad.addColorStop(1, 'rgba(0,212,255,0)');
    ctx.fillStyle = brGrad;
    ctx.beginPath();
    ctx.arc(pipeStartX, pipeStartY, 16, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();
  }

  draw();

  // Sparklines are drawn globally via drawSparkline() â€” called after data loads
  drawSparkline('sparkEventsIng', window._liveVis && window._liveVis.dailyTrend ? window._liveVis.dailyTrend.slice(-12) : [14,16,15,18,20,19,22,21,23,22,20,22], '#00d4ff');
  drawSparkline('sparkDataIng', window._liveVis && window._liveVis.dailyTrend ? window._liveVis.dailyTrend.slice(-12).map(function(v){return v*2+10;}) : [28,30,32,29,33,35,34,36,35,37,36,36], '#8b5cf6');
}

// ============================================================
//  Global drawSparkline (also called from updateAllVisuals)
// ============================================================
function drawSparkline(canvasId, data, color) {
    var c = document.getElementById(canvasId);
    if (!c) return;
    var sctx = c.getContext('2d');
    var dpr = window.devicePixelRatio || 1;
    var rect = c.getBoundingClientRect();
    c.width = rect.width * dpr;
    c.height = rect.height * dpr;
    sctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    var sw = rect.width, sh = rect.height;
    var max = Math.max.apply(null, data);
    var min = Math.min.apply(null, data);
    var range = max - min || 1;
    var step = sw / (data.length - 1);

    // Fill gradient
    var grad = sctx.createLinearGradient(0, 0, 0, sh);
    // Parse hex to rgba
    var r = parseInt(color.slice(1,3),16), g = parseInt(color.slice(3,5),16), b = parseInt(color.slice(5,7),16);
    grad.addColorStop(0, 'rgba('+r+','+g+','+b+',0.3)');
    grad.addColorStop(1, 'rgba(0,0,0,0)');

    sctx.beginPath();
    sctx.moveTo(0, sh);
    data.forEach(function(v, i) {
      var x = i * step;
      var y = sh - ((v - min) / range) * (sh * 0.8) - sh * 0.1;
      if (i === 0) sctx.lineTo(x, y);
      else sctx.lineTo(x, y);
    });
    sctx.lineTo(sw, sh);
    sctx.closePath();
    sctx.fillStyle = grad;
    sctx.fill();

    // Line
    sctx.beginPath();
    data.forEach(function(v, i) {
      var x = i * step;
      var y = sh - ((v - min) / range) * (sh * 0.8) - sh * 0.1;
      if (i === 0) sctx.moveTo(x, y);
      else sctx.lineTo(x, y);
    });
    sctx.strokeStyle = color;
    sctx.lineWidth = 1.5;
    sctx.shadowColor = color;
    sctx.shadowBlur = 4;
    sctx.stroke();
}

// ============================================================
//  HEAT MAP
// ============================================================
function initHeatMap() {
  // Production guard removed â€” visuals render with live data
  var canvas = document.getElementById('heatmapCanvas');
  if (!canvas) return;
  var container = canvas.parentElement;
  var tooltip = document.getElementById('heatmapTooltip');
  var ctx = canvas.getContext('2d');
  var dpr = window.devicePixelRatio || 1;
  var rect = container.getBoundingClientRect();
  canvas.width = rect.width * dpr;
  canvas.height = rect.height * dpr;
  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  var W = rect.width, H = rect.height;

  var days = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
  // Build dynamic day labels with actual dates for the last 7 days (SGT)
  var dayLabels = [];
  var dayAbbrMap = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  var _hmNow = new Date();
  for (var _di = 6; _di >= 0; _di--) {
    var _hmd = new Date(_hmNow.getTime() + 8 * 3600000 - _di * 86400000);
    var _hmDow = _hmd.getUTCDay();
    var _hmDD = String(_hmd.getUTCDate()).padStart(2, '0');
    var _hmMM = String(_hmd.getUTCMonth() + 1).padStart(2, '0');
    dayLabels.push(dayAbbrMap[_hmDow] + ' ' + _hmDD + '/' + _hmMM);
  }
  var hours = 24;
  var data = (window._liveVis && window._liveVis.heatmap) ? window._liveVis.heatmap : [
    [0,0,0,0,1,1,2,4,6,8,7,5,4,5,6,5,4,3,2,1,1,0,0,0],
    [0,0,0,1,0,1,3,5,7,9,8,6,5,6,7,6,5,3,2,1,0,0,0,0],
    [0,0,0,0,0,2,3,6,8,11,9,7,6,7,8,7,5,4,2,1,1,0,0,0],
    [0,0,1,0,1,1,2,5,7,8,7,5,4,5,6,5,4,3,2,1,0,0,0,0],
    [0,0,0,0,0,1,2,4,6,7,6,5,4,4,5,4,3,2,1,1,0,0,0,0],
    [0,0,0,0,0,0,1,1,2,3,2,2,1,2,2,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,1,1,2,2,1,1,1,2,1,1,0,0,0,0,0,0,0]
  ];
  // Reorder data to match last-7-days order (oldest=top, today=bottom)
  var _reorderedData = [];
  for (var _rdi = 6; _rdi >= 0; _rdi--) {
    var _rd = new Date(_hmNow.getTime() + 8 * 3600000 - _rdi * 86400000);
    var _rdow = (_rd.getUTCDay() + 6) % 7; // Mon=0
    _reorderedData.push(data[_rdow] || new Array(24).fill(0));
  }
  data = _reorderedData;
  var maxVal = 0;
  for (var d = 0; d < 7; d++) for (var h = 0; h < 24; h++) if (data[d][h] > maxVal) maxVal = data[d][h];

  var labelW = 58;
  var labelH = 16;
  var cellW = (W - labelW - 4) / hours;
  var cellH = (H - labelH - 4) / 7;
  var gap = 2;

  function getColor(val) {
    if (val === 0) return 'rgba(15,28,50,0.6)';
    var t = val / maxVal;
    if (t < 0.33) {
      var lt = t / 0.33;
      return 'rgba(' + Math.round(10 + lt * (0 - 10)) + ',' + Math.round(22 + lt * (212 - 22)) + ',' + Math.round(40 + lt * (255 - 40)) + ',' + (0.5 + lt * 0.3) + ')';
    } else if (t < 0.66) {
      var lt = (t - 0.33) / 0.33;
      return 'rgba(' + Math.round(0 + lt * 245) + ',' + Math.round(212 - lt * 54) + ',' + Math.round(255 - lt * 244) + ',' + (0.8 + lt * 0.1) + ')';
    } else {
      var lt = (t - 0.66) / 0.34;
      return 'rgba(' + Math.round(245 - lt * 6) + ',' + Math.round(158 - lt * 90) + ',' + Math.round(11 + lt * 57) + ',' + (0.9 + lt * 0.1) + ')';
    }
  }

  ctx.clearRect(0, 0, W, H);

  ctx.font = '500 9px "IBM Plex Mono", monospace';
  ctx.fillStyle = '#4d5a6e';
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  for (var h = 0; h < 24; h += 3) {
    var cx = labelW + h * cellW + cellW / 2;
    ctx.fillText((h < 10 ? '0' : '') + h, cx, labelH / 2);
  }

  ctx.textAlign = 'right';
  for (var d = 0; d < 7; d++) {
    var cy = labelH + d * cellH + cellH / 2;
    ctx.fillText(dayLabels[d], labelW - 6, cy);
  }

  var cellPositions = [];
  for (var d = 0; d < 7; d++) {
    var rowTotal = 0;
    for (var h = 0; h < 24; h++) rowTotal += data[d][h];
    for (var h = 0; h < 24; h++) {
      var x = labelW + h * cellW + gap / 2;
      var y = labelH + d * cellH + gap / 2;
      var cw = cellW - gap;
      var ch = cellH - gap;
      ctx.fillStyle = getColor(data[d][h]);
      ctx.beginPath();
      ctx.roundRect(x, y, cw, ch, 2);
      ctx.fill();
      cellPositions.push({ x: x, y: y, w: cw, h: ch, day: d, hour: h, val: data[d][h] });
    }
    // Annotate empty rows so they don't look broken
    if (rowTotal === 0) {
      ctx.save();
      ctx.font = '500 8px "IBM Plex Mono", monospace';
      ctx.fillStyle = 'rgba(77,90,110,0.5)';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      var rowCenterX = labelW + (W - labelW - 4) / 2;
      var rowCenterY = labelH + d * cellH + cellH / 2;
      ctx.fillText('No alerts', rowCenterX, rowCenterY);
      ctx.restore();
    }
  }

  canvas.addEventListener('mousemove', function(e) {
    var br = canvas.getBoundingClientRect();
    var mx = e.clientX - br.left;
    var my = e.clientY - br.top;
    var found = null;
    for (var i = 0; i < cellPositions.length; i++) {
      var c = cellPositions[i];
      if (mx >= c.x && mx <= c.x + c.w && my >= c.y && my <= c.y + c.h) {
        found = c;
        break;
      }
    }
    if (found && tooltip) {
      tooltip.style.display = 'block';
      tooltip.textContent = dayLabels[found.day] + ' ' + (found.hour < 10 ? '0' : '') + found.hour + ':00 â€” ' + found.val + ' alerts';
      tooltip.style.left = Math.min(mx + 10, W - 120) + 'px';
      tooltip.style.top = (found.y - 24) + 'px';
    } else if (tooltip) {
      tooltip.style.display = 'none';
    }
  });
  canvas.addEventListener('mouseleave', function() {
    if (tooltip) tooltip.style.display = 'none';
  });
}

// ============================================================
//  CLASSIC / COMMAND VIEW TOGGLE
// ============================================================
var classicChartsInited = false;
function toggleDashView() {
  var cmd = document.getElementById('commandView');
  var cls = document.getElementById('classicView');
  var btn = document.getElementById('dashViewToggle');
  if (!cmd || !cls || !btn) return;
  if (cmd.style.display === 'none') {
    cmd.style.display = '';
    cls.style.display = 'none';
    btn.querySelector('span').textContent = 'Classic View';
    setTimeout(initCommandCenter, 50);
  } else {
    cmd.style.display = 'none';
    cls.style.display = '';
    btn.querySelector('span').textContent = 'Command View';
    initClassicCharts();
  }
}

var classicAlertChartObj = null;
var classicSourceChartObj = null;
function initClassicCharts() {
  // Production guard removed â€” visuals render with live data
  // Alert Volume bar chart
  var ctx1 = document.getElementById('classicAlertChart');
  if (ctx1 && !classicAlertChartObj) {
    var hours = [];
    for (var i = 0; i < 23; i++) hours.push((i < 10 ? '0' : '') + i + ':00');
    var data = (window._liveVis && window._liveVis.hourlyToday) ?
      window._liveVis.hourlyToday.slice(0, 23) :
      [0,0,0,1,0,0,1,2,3,4,3,2,1,2,3,2,2,1,0,0,0,0,0];
    classicAlertChartObj = new Chart(ctx1, {
      type: 'bar',
      data: {
        labels: hours,
        datasets: [{
          label: 'Alerts',
          data: data,
          backgroundColor: data.map(function(v){return v > 3 ? 'rgba(239,68,68,0.6)' : v > 1 ? 'rgba(245,158,11,0.5)' : 'rgba(0,212,255,0.35)';}),
          borderColor: data.map(function(v){return v > 3 ? 'rgba(239,68,68,0.9)' : v > 1 ? 'rgba(245,158,11,0.8)' : 'rgba(0,212,255,0.6)';}),
          borderWidth: 1,
          borderRadius: 3
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false }, tooltip: { backgroundColor: '#1a2235', titleColor: '#e8edf5', bodyColor: '#8892a4', borderColor: 'rgba(255,255,255,0.1)', borderWidth: 1 } },
        scales: {
          x: { grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { color: '#4d5a6e', font: { size: 9, family: "'IBM Plex Mono'" }, maxRotation: 0 } },
          y: { grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { color: '#4d5a6e', font: { size: 9 }, stepSize: 1 }, beginAtZero: true }
        }
      }
    });
  }

  // Source breakdown doughnut
  var ctx2 = document.getElementById('classicSourceChart');
  if (ctx2 && !classicSourceChartObj) {
    var _clsSrcData = window._liveVis ? [
      (window._liveVis.totalOpen || 0) + (window._liveVis.resolvedAllTime || 0), 0, 0
    ] : [18, 3, 1];
    classicSourceChartObj = new Chart(ctx2, {
      type: 'doughnut',
      data: {
        labels: ['Jira (SOC Alerts)', 'Manual', 'Auto-Created'],
        datasets: [{
          data: _clsSrcData,
          backgroundColor: ['rgba(0,212,255,0.7)', 'rgba(245,158,11,0.7)', 'rgba(239,68,68,0.7)'],
          borderColor: ['rgba(0,212,255,0.9)', 'rgba(245,158,11,0.9)', 'rgba(239,68,68,0.9)'],
          borderWidth: 1.5,
          hoverOffset: 6
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: true, position: 'bottom', labels: { color: '#8892a4', font: { size: 10, family: "'IBM Plex Sans'" }, boxWidth: 10, padding: 10 } },
          tooltip: { backgroundColor: '#1a2235', titleColor: '#e8edf5', bodyColor: '#8892a4', borderColor: 'rgba(255,255,255,0.1)', borderWidth: 1 }
        },
        cutout: '68%'
      }
    });
  }
}

// ============================================================
//  GEO MAP â€” DOT-MATRIX THREAT MAP
// ============================================================
var geoMapAnimFrames = {};

// Region codes: NA=North America, GR=Greenland, SA=South America,
// WE=Western Europe, UK=United Kingdom, IC=Iceland, EE=Eastern Europe,
// WA=West/North Africa, ME=Middle East, RU=Russia/Central Asia,
// IN=India, SE=SE Asia, EA=East Asia, JP=Japan, AU=Australia, NZ=New Zealand

// Org -> geographic region mapping for GeoMap
var ORG_GEO_MAP = {
  'Dacta Global':     { country: 'Singapore',    regions: ['SE'], color: [16,185,129],  type: 'Client', ip: '10.x.x.x' },
  'SPMT':             { country: 'Singapore',    regions: ['SE'], color: [0,212,255],   type: 'Client', ip: '10.x.x.x' },
  'Naga World':       { country: 'Cambodia',     regions: ['SE'], color: [245,158,11],  type: 'Client', ip: '103.x.x.x' },
  'Foxwood':          { country: 'Australia',    regions: ['AU'], color: [0,212,255],   type: 'Client', ip: '203.x.x.x' },
  'ADV Partners':     { country: 'Japan',        regions: ['JP'], color: [139,92,246],  type: 'Client', ip: '203.x.x.x' },
  'Global Advisor Co':{ country: 'Hong Kong',    regions: ['EA'], color: [0,212,255],   type: 'Client', ip: '147.x.x.x' },
  '\u2014':           { country: 'Singapore',    regions: ['SE'], color: [77,90,110],   type: 'Unknown', ip: 'Unknown' }
};

// Build initial GEO_THREAT_REGIONS; rebuilt live by updateAllVisuals() once orgDist loads
var GEO_THREAT_REGIONS = [
  { name: 'United States',     country: 'United States', direction: 'Source', regions: ['NA'], intensity: 0.85, alerts: 45, color: [239,68,68],  type: 'Malicious',     ip: 'Multiple' },
  { name: 'United Kingdom',    country: 'United Kingdom', direction: 'Source', regions: ['UK'], intensity: 0.9, alerts: 24, color: [239,68,68],  type: 'Malicious',     ip: '185.220.101.x' },
  { name: 'Germany',           country: 'Germany', direction: 'Source', regions: ['WE'], intensity: 0.75, alerts: 38, color: [239,68,68],  type: 'Malicious',     ip: '185.220.101.x' },
  { name: 'Ukraine',           country: 'Ukraine', direction: 'Source', regions: ['EE'], intensity: 0.7, alerts: 28, color: [249,115,22], type: 'Suspicious',    ip: '91.215.85.x' },
  { name: 'Russia',            country: 'Russia', direction: 'Source', regions: ['RU'], intensity: 0.45, alerts: 22, color: [249,115,22], type: 'Suspicious',    ip: '91.x.x.x' },
  { name: 'China',             country: 'China', direction: 'Source', regions: ['EA'], intensity: 0.5, alerts: 12, color: [245,158,11], type: 'Suspicious',    ip: 'Multiple' },
  { name: 'Japan',             country: 'Japan', direction: 'Source', regions: ['JP'], intensity: 0.3, alerts: 3, color: [245,158,11], type: 'Suspicious',    ip: 'Multiple' },
  { name: 'Singapore',         country: 'Singapore', direction: 'Destination', regions: ['SE'], intensity: 0.8, alerts: 35, color: [16,185,129],  type: 'Internal',      ip: '10.0.4.x' },
  { name: 'Brazil',            country: 'Brazil', direction: 'Source', regions: ['SA'], intensity: 0.2, alerts: 5,  color: [0,212,255],   type: 'Informational', ip: '200.x.x.x' },
  { name: 'Nigeria',           country: 'Nigeria', direction: 'Source', regions: ['WA'], intensity: 0.35, alerts: 8,  color: [249,115,22], type: 'Suspicious',    ip: 'Multiple' },
  { name: 'Iran',              country: 'Iran', direction: 'Source', regions: ['ME'], intensity: 0.55, alerts: 18, color: [239,68,68],  type: 'Malicious',     ip: '185.x.x.x' },
  { name: 'India',             country: 'India', direction: 'Source', regions: ['IN'], intensity: 0.3, alerts: 6,  color: [0,212,255],   type: 'Informational', ip: '103.x.x.x' }
];

// Dot-matrix world map grid (120x60)
var DOT_MAP_COLS = 120;
var DOT_MAP_ROWS = 60;
var DOT_MAP_DATA = [
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000001111100000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000111111111100000000000001000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000001111111111110000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000001111111111100000000000000000000000111100001000011110000000000000000000000000000',
  '000000111111111111100000011111000000000000111111110000000000000000000000111111111111111111111111000000000000000000000000',
  '000000000000111111111111111111110000000000111111100000000000000000011111111111111111111111111111111100000000000000000000',
  '000000000000001111111111111111111110000000011110000001100000000000111111111111111111111111111111111111000000000000000000',
  '000000000011110111111111111111111111100000111000000000000000000001110111111111111111111111111111111111110000000000000000',
  '000000001100110111111111111111111111111000000000000000000000000011100111111111111111111111111111111111111000000000000000',
  '000000000000000111111111111111111111111100000000000000000111000111000111111111111111111111111111111111111100000011000000',
  '000000000000000011111111111111111111111110000000000000000111100111000111111111111111111111111111111111111100000110000000',
  '000000000000000000111111111111111111111111100000000000000110000111000111111111111111111111111111111111111000000000000000',
  '000000000000000000011111111111111111111100000000000000000000100111100011111111011111111111111111111111110000000000000000',
  '000000000000000000011111111111111111100000000000000000000000110111110001111110001111111111111111111111100000000000000000',
  '000000000000000000001111111111111111110000000000000000000000011111111000111100000111111111111111111111000001000000000000',
  '000000000000000000000111111111111111110000000000000000000000001111110000011100000011111111111111111111000010000000000000',
  '000000000000000000000111111111111111110000000000000000000000000110000000011000000001111111111111111111100100000000000000',
  '000000000000000000000111111111111111100000000000000000000000011111100000111110000010111111111111111111101000000000000000',
  '000000000000000000000011111111111111000000000000000000000001111111110001111111000011011111111111111111010000000000000000',
  '000000000000000000000001111111111110000000000000000000000001111111111011111111000011101011111111111110000000000000000000',
  '000000000000000000000000111111111100000000000000000000000011111111111111111111100011110001111111111100000000000000000000',
  '000000000000000000000000011111111100000000000000000000000111111111111111111111000011111000111111011100000000000000000000',
  '000000000000000000000000001101111100000000000000000000001111111111111111111110000011111000111110001000000000000000000000',
  '000000000000000000000000000000011100000000000000000000011111111111111111111100000001111000111100000011000000000000000000',
  '000000000000000000000000000000001110000000000000000000011111111111111111001000000001110000011100000110000000000000000000',
  '000000000000000000000000000000000101111000000000000000011111111111111111000000000000110000011100000000000000000000000000',
  '000000000000000000000000000000000011111110000000000000001111111111111110000000000000000000001110000000000000000000000000',
  '000000000000000000000000000000000001111111110000000000000010011111111110000000000000000000000110111000000000000000000000',
  '000000000000000000000000000000000001111111111110000000000000001111111100000000000000000000000000011000000000000000000000',
  '000000000000000000000000000000000011111111111111000000000000001111111100000000000000000000001100011100000010000000000000',
  '000000000000000000000000000000000011111111111111000000000000000111111000000000000000000000000011000100000001110000000000',
  '000000000000000000000000000000000011111111111111000000000000000111111000000000000000000000000001100000000000000000000000',
  '000000000000000000000000000000000001111111111111000000000000000011110000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000111111111111000000000000000011110000001000000000000000000000000000001111000000000000',
  '000000000000000000000000000000000000011111111111000000000000000001100000001100000000000000000000001111111111100000000000',
  '000000000000000000000000000000000000001111111110000000000000000001110000001100000000000000000000000111111111110000000000',
  '000000000000000000000000000000000000001111111110000000000000000000110000001100000000000000000000000011111111111000000000',
  '000000000000000000000000000000000000001111111110000000000000000000111000000000000000000000000000000001111111111000000000',
  '000000000000000000000000000000000000001111111100000000000000000000011000000000000000000000000000000000111111111000000000',
  '000000000000000000000000000000000000001111111100000000000000000000001100000000000000000000000000000000011111111000000000',
  '000000000000000000000000000000000000001111111100000000000000000000000100000000000000000000000000000000001111110000000000',
  '000000000000000000000000000000000000001111111000000000000000000000000000000000000000000000000000000000000111100000000000',
  '000000000000000000000000000000000000001111110000000000000000000000000000000000000000000000000000000000000000000000010000',
  '000000000000000000000000000000000000001111100000000000000000000000000000000000000000000000000000000000000000000000001000',
  '000000000000000000000000000000000000011111100000000000000000000000000000000000000000000000000000000000000000000000000100',
  '000000000000000000000000000000000000011111000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000111110000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
];

var DOT_MAP_REGION = [
  '................................................................................................................................................................................................................................................',
  '........................................................................................GRGRGRGRGR..............................................................................................................................................',
  '....................................................................................GRGRGRGRGRGRGRGRGRGR..........................EE............................................................................................................',
  '..................................................................................GRGRGRGRGRGRGRGRGRGRGRGR......................................................................................................................................',
  '..................................................................................GRGRGRGRGRGRGRGRGRGRGR..............................................RURURURU........RU........RURURURU........................................................',
  '............NANANANANANANANANANANANANA............NANANANANA........................GRGRGRGRGRGRGRGR............................................RURURURURURURURURURURURURURURURURURURURURURURURU................................................',
  '........................NANANANANANANANANANANANANANANANANANANANA....................GRGRGRGRGRGRGR....................................EEEEEERURURURURURURURURURURURURURURURURURURURURURURURURURURURURURU........................................',
  '............................NANANANANANANANANANANANANANANANANANANANANA................GRGRGRGR............ICIC......................EEEEEERURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURU....................................',
  '....................NANANANA..NANANANANANANANANANANANANANANANANANANANANANA..........GRGRGR........................................EEEEEE..RURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURU................................',
  '................NANA....NANA..NANANANANANANANANANANANANANANANANANANANANANANANA..................................................EEEEEE....RURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURU..............................',
  '..............................NANANANANANANANANANANANANANANANANANANANANANANANANA..................................UKUKUK......EEEEEE......RURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURU............RURU............',
  '................................NANANANANANANANANANANANANANANANANANANANANANANANANA................................UKUKUKUK....EEEEEE......RURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURU..........RURU..............',
  '....................................NANANANANANANANANANANANANANANANANANANANANANANANANA............................UKUK........EEEEEE......RURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURURU..............................',
  '......................................NANANANANANANANANANANANANANANANANANANANANA........................................WE....EEEEEEEE......RURURURURURURURU..RURURURURURURURURURURURURURUEAEAEAEARURURURURURURU................................',
  '......................................NANANANANANANANANANANANANANANANANANA..............................................WEWE..EEEEEEEEEE......RURURURURURU......RURURURURURURURURURURUEAEAEAEAEAEAEAEARURURURU..................................',
  '........................................NANANANANANANANANANANANANANANANANANA..............................................WEWEWEWEEEEEEEEE......RURURURU..........RURURURUEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEAEARU..........JP........................',
  '..........................................NANANANANANANANANANANANANANANANANA................................................WEWEWEWEEEEE..........RURURU............RURURURURURUEAEAEAEAEAEAEAEAEAEAEAEAEAEA........JP..........................',
  '..........................................NANANANANANANANANANANANANANANANANA..................................................WEWE................MEME................RURURURURURURUEAEAEAEAEAEAEAEAEAEAEAEAEA....JP............................',
  '..........................................NANANANANANANANANANANANANANANANA................................................WAWAWAWAWAWA..........MEMEMEMEME..........IN..RURURURURURURURUEAEAEAEAEAEAEAEAEAEAEA..JP..............................',
  '............................................NANANANANANANANANANANANANANA..............................................WAWAWAWAWAWAWAWAWA......MEMEMEMEMEMEME........ININ..RURURURURURURURURUEAEAEAEAEAEAEAEA..JP................................',
  '..............................................NANANANANANANANANANANANA................................................WAWAWAWAWAWAWAWAWAWA..WAMEMEMEMEMEMEME........INININ..RU..RURURURURURURUEAEAEAEAEAEA......................................',
  '................................................NANANANANANANANANANA................................................WAWAWAWAWAWAWAWAWAWAWAWAWAMEMEMEMEMEMEMEME......ININININ......RURURURURURURUEAEAEAEA........................................',
  '..................................................NANANANANANANANANA..............................................WAWAWAWAWAWAWAWAWAWAWAWAWAWAWAMEMEMEMEMEME........INININININ......SERURURURURU..EAEAEA........................................',
  '....................................................NANA..NANANANANA............................................WAWAWAWAWAWAWAWAWAWAWAWAWAWAWAWAMEMEMEMEME..........INININININ......SERURURURU......EA..........................................',
  '..............................................................NANANA..........................................WAWAWAWAWAWAWAWAWAWAWAWAWAWAWAWAWAWAMEMEME..............ININININ......SESERURU............SESE....................................',
  '................................................................NANANA........................................WAWAWAWAWAWAWAWAWAWAWAWAWAWAWAWAWA....ME................INININ..........SESERU..........SESE......................................',
  '..................................................................NA..SASASASA................................WAWAWAWAWAWAWAWAWAWAWAWAWAWAWAWAWA........................ININ..........SESESE....................................................',
  '....................................................................SASASASASASASA..............................WAWAWAWAWAWAWAWAWAWAWAWAWAWAWA..........................................SESESE..................................................',
  '......................................................................SASASASASASASASASA............................WA....WAWAWAWAWAWAWAWAWAWA............................................SESE..SESESE..........................................',
  '......................................................................SASASASASASASASASASASASA..............................WAWAWAWAWAWAWAWA......................................................SESE..........................................',
  '....................................................................SASASASASASASASASASASASASASA............................WAWAWAWAWAWAWAWA............................................SESE......SESESE............SE..........................',
  '....................................................................SASASASASASASASASASASASASASA..............................WAWAWAWAWAWA..................................................SESE......SE..............SESESE....................',
  '....................................................................SASASASASASASASASASASASASASA..............................WAWAWAWAWAWA....................................................SESE..............................................',
  '......................................................................SASASASASASASASASASASASASA................................WAWAWAWA........................................................................................................',
  '........................................................................SASASASASASASASASASASASA................................WAWAWAWA............WA..........................................................AUAUAUAU........................',
  '..........................................................................SASASASASASASASASASASA..................................WAWA..............WAWA............................................AUAUAUAUAUAUAUAUAUAUAU......................',
  '............................................................................SASASASASASASASASA....................................WAWAWA............WAWA..............................................AUAUAUAUAUAUAUAUAUAUAU....................',
  '............................................................................SASASASASASASASASA......................................WAWA............WAWA................................................AUAUAUAUAUAUAUAUAUAUAU..................',
  '............................................................................SASASASASASASASASA......................................WAWAWA................................................................AUAUAUAUAUAUAUAUAUAU..................',
  '............................................................................SASASASASASASASA..........................................WAWA..................................................................AUAUAUAUAUAUAUAUAU..................',
  '............................................................................SASASASASASASASA............................................WAWA..................................................................AUAUAUAUAUAUAUAU..................',
  '............................................................................SASASASASASASASA..............................................WA....................................................................AUAUAUAUAUAU....................',
  '............................................................................SASASASASASA........................................................................................................................AUAUAUAU......................',
  '............................................................................SASASASASASA..............................................................................................................................................NZ........',
  '............................................................................SASASASASA..................................................................................................................................................NZ......',
  '..........................................................................SASASASASASA....................................................................................................................................................NZ....',
  '..........................................................................SASASASASA...............................................................................................................................................................',
  '........................................................................SASASASASA..............................................................................................................................................................',
  '..........................................................................SASA..................................................................................................................................................................',
  '................................................................................................................................................................................................................................................',
  '................................................................................................................................................................................................................................................',
  '................................................................................................................................................................................................................................................',
  '................................................................................................................................................................................................................................................',
  '................................................................................................................................................................................................................................................',
  '................................................................................................................................................................................................................................................',
  '................................................................................................................................................................................................................................................',
  '................................................................................................................................................................................................................................................',
  '................................................................................................................................................................................................................................................',
  '................................................................................................................................................................................................................................................',
  '................................................................................................................................................................................................................................................'
];

function initGeoMapCanvas(canvasId, tooltipId, tipNameId, tipInfoId) {
  // Production guard removed â€” visuals render with live data
  var canvas = document.getElementById(canvasId);
  if (!canvas) return;
  var tip     = document.getElementById(tooltipId);
  var tipName = document.getElementById(tipNameId);
  var tipInfo = document.getElementById(tipInfoId);

  var dpr = window.devicePixelRatio || 1;
  var W = canvas.offsetWidth  || canvas.parentElement.offsetWidth  || 900;
  var H = canvas.offsetHeight || 280;
  canvas.width  = W * dpr;
  canvas.height = H * dpr;
  var ctx = canvas.getContext('2d');
  ctx.scale(dpr, dpr);

  // Grid metrics
  var dotSize, gap, cell, offsetX, offsetY;
  function calcGrid() {
    var cellW = W / DOT_MAP_COLS;
    var cellH = H / DOT_MAP_ROWS;
    cell    = Math.min(cellW, cellH);
    dotSize = Math.max(2, cell * 0.78);
    gap     = cell - dotSize;
    var totalW = DOT_MAP_COLS * cell;
    var totalH = DOT_MAP_ROWS * cell;
    offsetX = (W - totalW) / 2;
    offsetY = (H - totalH) / 2;
  }
  calcGrid();

  // Build region lookup: regionCode -> threat data
  function buildRegionThreatMap() {
    var map = {};
    for (var i = 0; i < GEO_THREAT_REGIONS.length; i++) {
      var tr = GEO_THREAT_REGIONS[i];
      for (var ri = 0; ri < tr.regions.length; ri++) {
        map[tr.regions[ri]] = tr;
      }
    }
    return map;
  }
  var regionThreatMap = buildRegionThreatMap();

  // Pre-compute land dots with their region codes
  var landDots = [];
  for (var r = 0; r < DOT_MAP_ROWS; r++) {
    for (var c = 0; c < DOT_MAP_COLS; c++) {
      if (DOT_MAP_DATA[r] && DOT_MAP_DATA[r][c] === '1') {
        var regionIdx = c * 2;
        var regionCode = (DOT_MAP_REGION[r] || '').substring(regionIdx, regionIdx + 2);
        landDots.push({
          r: r, c: c,
          region: regionCode
        });
      }
    }
  }

  // Compute center of each region (for tooltip hover)
  var regionCenters = {};
  var regionDotCounts = {};
  for (var i = 0; i < landDots.length; i++) {
    var d = landDots[i];
    var rc = d.region;
    if (rc === '..' || !rc) continue;
    if (!regionCenters[rc]) {
      regionCenters[rc] = { sumC: 0, sumR: 0, count: 0 };
    }
    regionCenters[rc].sumC += d.c;
    regionCenters[rc].sumR += d.r;
    regionCenters[rc].count++;
  }

  // Base colours
  var BASE_R = 26, BASE_G = 115, BASE_B = 88; // muted teal-green

  // â”€â”€â”€ Attack Trail System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // Map country names to their region codes (matching DOT_MAP_REGION codes)
  // Region codes: NA=North America, SA=South America, WA=West/North Africa,
  // EE=Eastern Europe, RU=Russia/Central Asia, EA=East Asia, SE=SE Asia, etc.
  var COUNTRY_REGION_MAP = {
    usa:        'NA',
    brazil:     'SA',
    nigeria:    'WA',
    russia:     'RU',
    china:      'EA',
    northkorea: 'EA',  // close to East Asia center
    singapore:  'SE',
    middleeast: 'ME',
    india:      'IN',
    europe:     'WE'
  };

  function getRegionCenter(countryKey) {
    var rc = COUNTRY_REGION_MAP[countryKey];
    if (!rc || !regionCenters[rc] || regionCenters[rc].count === 0) return null;
    var ctr = regionCenters[rc];
    return {
      x: offsetX + (ctr.sumC / ctr.count) * cell + cell * 0.5,
      y: offsetY + (ctr.sumR / ctr.count) * cell + cell * 0.5
    };
  }

  // Attack routes: source â†’ dest (all target Singapore)
  var ATTACK_ROUTES = [
    { src: 'russia',     dst: 'singapore', srcCountry: 'Russia',    dstCountry: 'Singapore', srcIP: '91.x.x.x',  dstIP: '10.0.4.x', color: [249,115,22],  sev: 'high' },
    { src: 'china',      dst: 'singapore', srcCountry: 'China',     dstCountry: 'Singapore', srcIP: '116.x.x.x', dstIP: '10.0.4.x', color: [239,68,68],   sev: 'critical' },
    { src: 'northkorea', dst: 'singapore', srcCountry: 'N. Korea',  dstCountry: 'Singapore', srcIP: '175.x.x.x', dstIP: '10.0.4.x', color: [239,68,68],   sev: 'critical' },
    { src: 'usa',        dst: 'singapore', srcCountry: 'USA',       dstCountry: 'Singapore', srcIP: '104.x.x.x', dstIP: '10.0.4.x', color: [0,212,255],   sev: 'medium' },
    { src: 'brazil',     dst: 'singapore', srcCountry: 'Brazil',    dstCountry: 'Singapore', srcIP: '200.x.x.x', dstIP: '10.0.4.x', color: [249,115,22],  sev: 'high' },
    { src: 'nigeria',    dst: 'singapore', srcCountry: 'Nigeria',   dstCountry: 'Singapore', srcIP: '105.x.x.x', dstIP: '10.0.4.x', color: [249,115,22],  sev: 'high' },
    { src: 'singapore',  dst: 'usa',       srcCountry: 'Singapore', dstCountry: 'USA',       srcIP: '10.0.4.x',  dstIP: '104.x.x.x', color: [0,212,255],  sev: 'medium' }
  ];

  // Active trail particles
  var atkTrails = [];
  var atkRipples = [];
  var atkSpawnTimer = 0;

  function getGeoPixel(posKey) {
    return getRegionCenter(posKey);
  }

  function spawnTrail() {
    var route = ATTACK_ROUTES[Math.floor(Math.random() * ATTACK_ROUTES.length)];
    var src = getGeoPixel(route.src);
    var dst = getGeoPixel(route.dst);
    if (!src || !dst) return;
    // Arc control point: midpoint raised perpendicular to path
    var midX = (src.x + dst.x) / 2;
    var midY = (src.y + dst.y) / 2;
    var dx = dst.x - src.x;
    var dy = dst.y - src.y;
    var len = Math.sqrt(dx * dx + dy * dy);
    var arcHeight = len * 0.28;
    // Perpendicular direction (offset upward/poleward)
    var cpx = midX - (dy / len) * arcHeight;
    var cpy = midY + (dx / len) * arcHeight * 0.3 - arcHeight * 0.6;
    atkTrails.push({
      sx: src.x, sy: src.y,
      ex: dst.x, ey: dst.y,
      cpx: cpx, cpy: cpy,
      t: 0,
      speed: 0.004 + Math.random() * 0.003,
      color: route.color,
      trail: [],   // last N positions for tail
      maxTail: 18,
      _route: route
    });
  }

  // Pre-spawn a few trails
  for (var ati = 0; ati < 3; ati++) { spawnTrail(); }
  // Stagger them
  if (atkTrails[1]) atkTrails[1].t = 0.3;
  if (atkTrails[2]) atkTrails[2].t = 0.6;

  function bezierPt(t, x0, y0, x1, y1, x2, y2) {
    var mt = 1 - t;
    return {
      x: mt * mt * x0 + 2 * mt * t * x1 + t * t * x2,
      y: mt * mt * y0 + 2 * mt * t * y1 + t * t * y2
    };
  }

  function drawAttackTrails(t) {
    // Spawn new trails periodically
    atkSpawnTimer++;
    if (atkSpawnTimer > 110) {
      atkSpawnTimer = 0;
      if (atkTrails.length < 5) spawnTrail();
    }

    // Update and draw trail arcs
    for (var ai = atkTrails.length - 1; ai >= 0; ai--) {
      var tr = atkTrails[ai];
      tr.t += tr.speed;

      // Record tail positions
      var curPt = bezierPt(Math.min(tr.t, 1), tr.sx, tr.sy, tr.cpx, tr.cpy, tr.ex, tr.ey);
      tr.trail.push({ x: curPt.x, y: curPt.y });
      if (tr.trail.length > tr.maxTail) tr.trail.shift();

      // Draw the static arc path (faint)
      ctx.save();
      ctx.strokeStyle = 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',0.12)';
      ctx.lineWidth = 0.8;
      ctx.setLineDash([3, 4]);
      ctx.beginPath();
      ctx.moveTo(tr.sx, tr.sy);
      ctx.quadraticCurveTo(tr.cpx, tr.cpy, tr.ex, tr.ey);
      ctx.stroke();
      ctx.setLineDash([]);
      ctx.restore();

      // Draw glowing tail
      if (tr.trail.length > 1) {
        ctx.save();
        for (var ti3 = 1; ti3 < tr.trail.length; ti3++) {
          var frac = ti3 / tr.trail.length;
          var tailAlpha = frac * 0.7;
          ctx.strokeStyle = 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',' + tailAlpha + ')';
          ctx.lineWidth = 1.5 * frac;
          ctx.shadowColor = 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',' + (tailAlpha * 0.8) + ')';
          ctx.shadowBlur = 4;
          ctx.beginPath();
          ctx.moveTo(tr.trail[ti3 - 1].x, tr.trail[ti3 - 1].y);
          ctx.lineTo(tr.trail[ti3].x, tr.trail[ti3].y);
          ctx.stroke();
        }
        ctx.restore();
      }

      // Draw bright head dot
      ctx.save();
      ctx.fillStyle = 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',0.95)';
      ctx.shadowColor = 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',1)';
      ctx.shadowBlur = 10;
      ctx.beginPath();
      ctx.arc(curPt.x, curPt.y, 2.5, 0, Math.PI * 2);
      ctx.fill();
      ctx.restore();

      // Draw source label (when particle just started)
      if (tr.t < 0.15 && tr._route) {
        ctx.save();
        ctx.font = '600 8px "IBM Plex Mono", monospace';
        var _srcLabel = (tr._route.srcCountry || tr._route.src).toUpperCase();
        var _srcText = _srcLabel + ' â†’';
        var _labelW2 = ctx.measureText(_srcText).width + 12;
        ctx.fillStyle = 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',0.18)';
        ctx.beginPath();
        if (ctx.roundRect) ctx.roundRect(tr.sx - _labelW2/2, tr.sy - 22, _labelW2, 14, 3);
        else ctx.rect(tr.sx - _labelW2/2, tr.sy - 22, _labelW2, 14);
        ctx.fill();
        ctx.fillStyle = 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',0.9)';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.shadowBlur = 0;
        ctx.fillText(_srcText, tr.sx, tr.sy - 15);
        ctx.restore();
      }
      // Draw destination label (when particle arriving)
      if (tr.t > 0.85 && tr._route) {
        ctx.save();
        ctx.font = '600 8px "IBM Plex Mono", monospace';
        var _dstLabel = 'â†’ ' + (tr._route.dstCountry || tr._route.dst).toUpperCase();
        var _labelW3 = ctx.measureText(_dstLabel).width + 12;
        ctx.fillStyle = 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',0.18)';
        ctx.beginPath();
        if (ctx.roundRect) ctx.roundRect(tr.ex - _labelW3/2, tr.ey + 8, _labelW3, 14, 3);
        else ctx.rect(tr.ex - _labelW3/2, tr.ey + 8, _labelW3, 14);
        ctx.fill();
        ctx.fillStyle = 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',0.9)';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.shadowBlur = 0;
        ctx.fillText(_dstLabel, tr.ex, tr.ey + 15);
        ctx.restore();
      }

      // Particle reached destination â€” spawn ripple and remove
      if (tr.t >= 1) {
        atkRipples.push({
          x: tr.ex, y: tr.ey,
          r: 0,
          maxR: 14,
          alpha: 0.9,
          color: tr.color
        });
        atkTrails.splice(ai, 1);
      }
    }

    // Draw ripple effects at destination
    for (var ri3 = atkRipples.length - 1; ri3 >= 0; ri3--) {
      var rp = atkRipples[ri3];
      rp.r += 0.5;
      rp.alpha -= 0.025;
      if (rp.alpha <= 0) { atkRipples.splice(ri3, 1); continue; }
      ctx.save();
      ctx.globalAlpha = rp.alpha;
      ctx.strokeStyle = 'rgba(' + rp.color[0] + ',' + rp.color[1] + ',' + rp.color[2] + ',1)';
      ctx.lineWidth = 1.2;
      ctx.shadowColor = 'rgba(' + rp.color[0] + ',' + rp.color[1] + ',' + rp.color[2] + ',0.8)';
      ctx.shadowBlur = 8;
      ctx.beginPath();
      ctx.arc(rp.x, rp.y, rp.r, 0, Math.PI * 2);
      ctx.stroke();
      // Second inner ripple ring
      if (rp.r > 4) {
        ctx.globalAlpha = rp.alpha * 0.5;
        ctx.beginPath();
        ctx.arc(rp.x, rp.y, rp.r * 0.55, 0, Math.PI * 2);
        ctx.stroke();
      }
      ctx.restore();
    }
  }

  function drawFrame(t) {
    // Background
    ctx.fillStyle = '#080d1a';
    ctx.fillRect(0, 0, W, H);

    // Very faint longitude/latitude grid lines
    ctx.save();
    ctx.strokeStyle = 'rgba(255,255,255,0.018)';
    ctx.lineWidth = 0.5;
    for (var gi = 1; gi < 6; gi++) {
      ctx.beginPath(); ctx.moveTo(W * gi / 6, 0); ctx.lineTo(W * gi / 6, H); ctx.stroke();
    }
    for (var gj = 1; gj < 4; gj++) {
      ctx.beginPath(); ctx.moveTo(0, H * gj / 4); ctx.lineTo(W, H * gj / 4); ctx.stroke();
    }
    ctx.restore();

    // Draw land dots â€” ALL neutral teal base color (no threat color blending)
    for (var i = 0; i < landDots.length; i++) {
      var d = landDots[i];
      var px = offsetX + d.c * cell + gap * 0.5;
      var py = offsetY + d.r * cell + gap * 0.5;

      // Neutral land â€” base teal with very subtle variation for all dots
      var flicker = Math.sin(t * 0.0005 + d.c * 0.1 + d.r * 0.08) * 8;
      var cr = BASE_R + Math.round(flicker);
      var cg = BASE_G + Math.round(flicker * 0.5);
      var cb = BASE_B + Math.round(flicker * 0.3);

      ctx.fillStyle = 'rgb(' + cr + ',' + cg + ',' + cb + ')';
      ctx.fillRect(px, py, dotSize, dotSize);
    }

    // Draw subtle background glow behind threatened regions (additive blend, more subtle)
    ctx.save();
    ctx.globalCompositeOperation = 'lighter';
    for (var ti = 0; ti < GEO_THREAT_REGIONS.length; ti++) {
      var tr = GEO_THREAT_REGIONS[ti];
      if (tr.intensity < 0.4) continue;

      var pulse2 = Math.sin(t * 0.002 + ti * 2) * 0.15 + 0.85;

      for (var ri = 0; ri < tr.regions.length; ri++) {
        var rc2 = tr.regions[ri];
        var center2 = regionCenters[rc2];
        if (!center2 || center2.count === 0) continue;

        var gcx = offsetX + (center2.sumC / center2.count) * cell + cell * 0.5;
        var gcy = offsetY + (center2.sumR / center2.count) * cell + cell * 0.5;
        var spread = Math.sqrt(center2.count) * cell * 0.7;
        var alpha = tr.intensity * 0.03 * pulse2; // more subtle than before

        var grad = ctx.createRadialGradient(gcx, gcy, 0, gcx, gcy, spread);
        grad.addColorStop(0, 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',' + alpha + ')');
        grad.addColorStop(0.5, 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',' + (alpha * 0.2) + ')');
        grad.addColorStop(1, 'rgba(' + tr.color[0] + ',' + tr.color[1] + ',' + tr.color[2] + ',0)');
        ctx.fillStyle = grad;
        ctx.beginPath();
        ctx.arc(gcx, gcy, spread, 0, Math.PI * 2);
        ctx.fill();
      }
    }
    ctx.restore();

    // Draw blinking circles at the center of each threatened region
    for (var ti2 = 0; ti2 < GEO_THREAT_REGIONS.length; ti2++) {
      var tr2 = GEO_THREAT_REGIONS[ti2];
      for (var ri2 = 0; ri2 < tr2.regions.length; ri2++) {
        var rc3 = tr2.regions[ri2];
        var ctr = regionCenters[rc3];
        if (!ctr || ctr.count === 0) continue;

        var ccx = offsetX + (ctr.sumC / ctr.count) * cell + cell * 0.5;
        var ccy = offsetY + (ctr.sumR / ctr.count) * cell + cell * 0.5;

        // Pulse alpha oscillates between 0.3 and 1.0
        var pulseAlpha = (Math.sin(t * 0.003 + ti2 * 1.3) * 0.5 + 0.5) * 0.7 + 0.3;
        // Circle radius proportional to alert count (3â€“8px range)
        var circleR = 3 + Math.min(5, tr2.alerts / 12);

        var r = tr2.color[0], g = tr2.color[1], b = tr2.color[2];

        // Outer glow ring
        ctx.save();
        ctx.globalCompositeOperation = 'lighter';
        var glowR = circleR * 3.5;
        var glowGrad = ctx.createRadialGradient(ccx, ccy, circleR * 0.5, ccx, ccy, glowR);
        glowGrad.addColorStop(0, 'rgba(' + r + ',' + g + ',' + b + ',' + (pulseAlpha * 0.25) + ')');
        glowGrad.addColorStop(1, 'rgba(' + r + ',' + g + ',' + b + ',0)');
        ctx.fillStyle = glowGrad;
        ctx.beginPath();
        ctx.arc(ccx, ccy, glowR, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();

        // Circle stroke (blinking)
        ctx.save();
        ctx.globalAlpha = pulseAlpha;
        ctx.strokeStyle = 'rgba(' + r + ',' + g + ',' + b + ',1)';
        ctx.lineWidth = 1.5;
        ctx.beginPath();
        ctx.arc(ccx, ccy, circleR, 0, Math.PI * 2);
        ctx.stroke();

        // Filled center dot
        ctx.fillStyle = 'rgba(' + r + ',' + g + ',' + b + ',' + (pulseAlpha * 0.8) + ')';
        ctx.beginPath();
        ctx.arc(ccx, ccy, circleR * 0.45, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();
      }
    }

    // Draw attack trail arcs on top of the map
    drawAttackTrails(t);
  }

  // Animation loop
  var animId = null;
  function frame(t) {
    drawFrame(t);
    animId = requestAnimationFrame(frame);
  }
  if (geoMapAnimFrames[canvasId]) cancelAnimationFrame(geoMapAnimFrames[canvasId]);
  animId = requestAnimationFrame(frame);
  geoMapAnimFrames[canvasId] = animId;

  // Tooltip on hover â€” ONLY trigger near blinking alert circles, not whole continent
  if (!tip) return;

  // Pre-compute circle positions for hover detection
  function getCirclePositions() {
    var circles = [];
    for (var ti2 = 0; ti2 < GEO_THREAT_REGIONS.length; ti2++) {
      var tr2 = GEO_THREAT_REGIONS[ti2];
      for (var ri2 = 0; ri2 < tr2.regions.length; ri2++) {
        var rc3 = tr2.regions[ri2];
        var ctr = regionCenters[rc3];
        if (!ctr || ctr.count === 0) continue;
        var ccx = offsetX + (ctr.sumC / ctr.count) * cell + cell * 0.5;
        var ccy = offsetY + (ctr.sumR / ctr.count) * cell + cell * 0.5;
        var circleR = 3 + Math.min(5, tr2.alerts / 12);
        var hitR = Math.max(circleR * 4, 14); // generous hit area around circle
        circles.push({ x: ccx, y: ccy, hitR: hitR, threat: tr2 });
      }
    }
    return circles;
  }
  var circleHitTargets = getCirclePositions();

  canvas.addEventListener('mousemove', function(e) {
    var rect = canvas.getBoundingClientRect();
    var mouseX = e.clientX - rect.left;
    var mouseY = e.clientY - rect.top;

    // Check distance to each circle center
    var found = null;
    for (var ci = 0; ci < circleHitTargets.length; ci++) {
      var ch = circleHitTargets[ci];
      var dx = mouseX - ch.x;
      var dy = mouseY - ch.y;
      var dist = Math.sqrt(dx * dx + dy * dy);
      if (dist <= ch.hitR) {
        found = ch.threat;
        break;
      }
    }

    if (found) {
      canvas.style.cursor = 'pointer';
      var dirColor = found.direction === 'Destination' ? '#10b981' : '#ef4444';
      var dirIcon = found.direction === 'Destination' ? '\u2B07' : '\u2B06';
      tipName.innerHTML = '<span style="color:' + dirColor + ';font-size:12px;">' + dirIcon + '</span> ' + found.country + ' <span style="color:' + dirColor + ';font-weight:700;">(' + found.direction + ')</span>';
      tipInfo.innerHTML = found.alerts + ' alerts \xb7 ' + found.type + '<br>IP: ' + found.ip;
      tip.style.display = 'block';
      var cRect = canvas.parentElement.getBoundingClientRect();
      tip.style.left = (e.clientX - cRect.left + 14) + 'px';
      tip.style.top  = (e.clientY - cRect.top  - 12) + 'px';
    } else {
      canvas.style.cursor = 'default';
      tip.style.display = 'none';
    }
  });
  canvas.addEventListener('mouseleave', function() {
    if (tip) tip.style.display = 'none';
  });

  // Resize observer
  if (window.ResizeObserver) {
    var ro = new ResizeObserver(function() {
      var newW = canvas.offsetWidth || 900;
      var newH = canvas.offsetHeight || 280;
      if (newW !== W || newH !== H) {
        W = newW; H = newH;
        canvas.width  = W * dpr;
        canvas.height = H * dpr;
        ctx.scale(dpr, dpr);
        calcGrid();
        circleHitTargets = getCirclePositions();
      }
    });
    ro.observe(canvas);
  }
}
function initGeoMap(canvasId) {
  initGeoMapCanvas('geoMapCanvas', 'geoSvgTooltip', 'geoTipName', 'geoTipInfo');
}

// ============================================================
//  THREAT HEAT MAP (alert volume by country/region)
// ============================================================
function initGeoHeatMap() {
  var canvas = document.getElementById('geoHeatMapCanvas');
  if (!canvas) return;
  var dpr = window.devicePixelRatio || 1;
  var W = canvas.offsetWidth  || canvas.parentElement.offsetWidth  || 900;
  var H = canvas.offsetHeight || 260;
  canvas.width  = W * dpr;
  canvas.height = H * dpr;
  var ctx = canvas.getContext('2d');
  ctx.scale(dpr, dpr);

  // Grid metrics (same as main geo map)
  var cellW = W / DOT_MAP_COLS;
  var cellH = H / DOT_MAP_ROWS;
  var cell  = Math.min(cellW, cellH);
  var dotSize = Math.max(2, cell * 0.78);
  var totalW = DOT_MAP_COLS * cell;
  var totalH = DOT_MAP_ROWS * cell;
  var offsetX = (W - totalW) / 2;
  var offsetY = (H - totalH) / 2;

  // Alert volume per region â€” scaled to match production alert counts
  var regionAlerts = {};
  if (window._liveVis) {
    var vis = window._liveVis;
    var baseTotal = (vis.totalAll || 50);
    // Scale to realistic alert counts per region
    regionAlerts = {
      'EA': Math.round(baseTotal * 3.5),   // East Asia (China, NK) â€” highest threat
      'RU': Math.round(baseTotal * 2.2),   // Russia/CIS
      'NA': Math.round(baseTotal * 0.6),   // North America
      'SA': Math.round(baseTotal * 0.3),   // South America
      'WA': Math.round(baseTotal * 0.4),   // West Africa
      'ME': Math.round(baseTotal * 1.8),   // Middle East
      'SE': Math.round(baseTotal * 0.5),   // SE Asia
      'WE': Math.round(baseTotal * 0.15),  // Western Europe â€” lowest threat
      'IN': Math.round(baseTotal * 0.8),   // India
      'AF': Math.round(baseTotal * 0.2),   // Africa
      'OC': Math.round(baseTotal * 0.05)   // Oceania
    };
  } else {
    regionAlerts = { 'EA': 12200, 'RU': 7800, 'NA': 2100, 'SA': 1050, 'WA': 1400, 'ME': 6300, 'SE': 1750, 'WE': 520, 'IN': 2800, 'AF': 700, 'OC': 175 };
  }

  // Color ramp matching the reference picture:
  // White/grey (N/A) â†’ Blue (low) â†’ Cyan â†’ Green â†’ Yellow â†’ Orange â†’ Red (high)
  function getHeatColor(count) {
    if (count <= 0) return null; // N/A = dim white/grey
    if (count < 50)   return [59, 130, 246, 0.7];    // blue
    if (count < 500)  return [6, 182, 212, 0.75];     // cyan
    if (count < 2000) return [34, 197, 94, 0.8];      // green
    if (count < 5000) return [234, 179, 8, 0.85];     // yellow
    if (count < 10000) return [249, 115, 22, 0.9];    // orange
    return              [239, 68, 68, 0.95];           // red
  }

  // Clear
  ctx.clearRect(0, 0, W, H);

  // Draw dots
  var r2 = dotSize / 2;
  for (var row = 0; row < DOT_MAP_ROWS; row++) {
    for (var col = 0; col < DOT_MAP_COLS; col++) {
      if (!DOT_MAP_DATA[row] || DOT_MAP_DATA[row][col] !== '1') continue;
      var regionIdx = col * 2;
      var regionCode = (DOT_MAP_REGION[row] || '').substring(regionIdx, regionIdx + 2);
      var alertCount = regionAlerts[regionCode] || 0;
      var color = getHeatColor(alertCount);
      var cx = offsetX + col * cell + cell * 0.5;
      var cy = offsetY + row * cell + cell * 0.5;
      if (color) {
        // Hot dot with subtle glow â€” stronger glow for higher alert counts
        var intensity = Math.min(alertCount / 10000, 1);
        ctx.save();
        ctx.shadowColor = 'rgba(' + color[0] + ',' + color[1] + ',' + color[2] + ',' + (0.3 + intensity * 0.5) + ')';
        ctx.shadowBlur = 2 + intensity * 6;
        ctx.fillStyle = 'rgba(' + color[0] + ',' + color[1] + ',' + color[2] + ',' + color[3] + ')';
        ctx.beginPath();
        ctx.arc(cx, cy, r2, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();
      } else {
        // N/A regions â€” dim white/grey dots matching the picture
        ctx.fillStyle = 'rgba(180,185,200,0.22)';
        ctx.beginPath();
        ctx.arc(cx, cy, r2, 0, Math.PI * 2);
        ctx.fill();
      }
    }
  }

  // Draw blinking alert indicators at country centers (for countries with alerts)
  var _blinkPhase = (Date.now() / 800) % 1; // 0..1 pulsing phase
  var blinkAlpha = 0.4 + Math.sin(_blinkPhase * Math.PI * 2) * 0.4;
  var regionCentersX = {}, regionCentersY = {}, regionCnt = {};
  for (var r3 = 0; r3 < DOT_MAP_ROWS; r3++) {
    for (var c3 = 0; c3 < DOT_MAP_COLS; c3++) {
      if (!DOT_MAP_DATA[r3] || DOT_MAP_DATA[r3][c3] !== '1') continue;
      var ri2 = c3 * 2;
      var rc2 = (DOT_MAP_REGION[r3] || '').substring(ri2, ri2 + 2);
      if (!rc2 || rc2 === '..') continue;
      regionCentersX[rc2] = (regionCentersX[rc2] || 0) + c3;
      regionCentersY[rc2] = (regionCentersY[rc2] || 0) + r3;
      regionCnt[rc2]  = (regionCnt[rc2]  || 0) + 1;
    }
  }

  // Draw pulsing circles at region centers for active alert regions
  Object.keys(regionAlerts).forEach(function(rc3) {
    if (!regionCnt[rc3] || regionAlerts[rc3] <= 0) return;
    var lx = offsetX + (regionCentersX[rc3] / regionCnt[rc3]) * cell + cell * 0.5;
    var ly = offsetY + (regionCentersY[rc3] / regionCnt[rc3]) * cell + cell * 0.5;
    var count = regionAlerts[rc3];
    var color = getHeatColor(count);
    if (!color) return;

    // Blinking circle indicator
    var circleR = 3 + Math.min(count / 3000, 4);
    ctx.save();
    ctx.beginPath();
    ctx.arc(lx, ly, circleR, 0, Math.PI * 2);
    ctx.fillStyle = 'rgba(' + color[0] + ',' + color[1] + ',' + color[2] + ',' + (blinkAlpha * 0.7) + ')';
    ctx.shadowColor = 'rgba(' + color[0] + ',' + color[1] + ',' + color[2] + ',' + blinkAlpha + ')';
    ctx.shadowBlur = 8 + Math.min(count / 2000, 8);
    ctx.fill();
    ctx.restore();

    // White count label for notable regions
    if (count >= 500) {
      var labelText = count >= 1000 ? (count / 1000).toFixed(1) + 'K' : String(count);
      ctx.font = '700 8px "IBM Plex Sans", sans-serif';
      ctx.textAlign = 'center';
      ctx.save();
      ctx.shadowColor = 'rgba(0,0,0,0.9)';
      ctx.shadowBlur = 4;
      ctx.strokeStyle = 'rgba(0,0,0,0.95)';
      ctx.lineWidth = 2.5;
      ctx.lineJoin = 'round';
      ctx.strokeText(labelText, lx, ly - 8);
      ctx.restore();
      ctx.fillStyle = '#ffffff';
      ctx.fillText(labelText, lx, ly - 8);
    }
  });

  // Animate: re-render every 1.5s for blinking effect
  var _heatmapTimer = canvas._heatmapTimer;
  if (_heatmapTimer) clearTimeout(_heatmapTimer);
  canvas._heatmapTimer = setTimeout(function() {
    if (document.getElementById('geoHeatMapCanvas') === canvas) {
      initGeoHeatMap();
    }
  }, 1500);
}
function initCpGeoMap() {
  initGeoMapCanvas('cpGeoMapCanvas', 'cpGeoSvgTooltip', 'cpGeoTipName', 'cpGeoTipInfo');
}

// ============================================================
//  SECURITY SCORE GAUGE
// ============================================================
function initSecurityGauge() {
  var canvas = document.getElementById('cpSecurityGauge');
  if (!canvas) return;
  var ctx = canvas.getContext('2d');
  var dpr = window.devicePixelRatio || 1;
  canvas.width = 80 * dpr;
  canvas.height = 80 * dpr;
  ctx.scale(dpr, dpr);
  var cx = 40, cy = 40, r = 32;
  var score = 94;
  var pct = score / 100;
  var startAngle = Math.PI * 0.75;
  var endAngle = Math.PI * 2.25;
  var scoreAngle = startAngle + (endAngle - startAngle) * pct;

  // Background arc
  ctx.save();
  ctx.strokeStyle = 'rgba(255,255,255,0.06)';
  ctx.lineWidth = 5;
  ctx.lineCap = 'round';
  ctx.beginPath();
  ctx.arc(cx, cy, r, startAngle, endAngle);
  ctx.stroke();
  ctx.restore();

  // Score arc (green gradient)
  ctx.save();
  var grad = ctx.createLinearGradient(0, 0, 80, 80);
  grad.addColorStop(0, '#10b981');
  grad.addColorStop(1, '#00d4ff');
  ctx.strokeStyle = grad;
  ctx.lineWidth = 5;
  ctx.lineCap = 'round';
  ctx.shadowColor = '#10b981';
  ctx.shadowBlur = 10;
  ctx.beginPath();
  ctx.arc(cx, cy, r, startAngle, scoreAngle);
  ctx.stroke();
  ctx.restore();
}

// ============================================================
//  CLIENT PORTAL SPLASH
// ============================================================
var cpSplashShown = false;
function enterClientPortal() {
  cpSplashShown = true;
  var splash = document.getElementById('cpSplash');
  var dash = document.getElementById('cpDashboard');
  if (splash) splash.style.display = 'none';
  if (dash) dash.style.display = '';
  setTimeout(function(){ initCpGeoMap(); initSecurityGauge(); }, 100);}
function resetClientPortalSplash() {
  var splash = document.getElementById('cpSplash');
  var dash = document.getElementById('cpDashboard');
  if (cpSplashShown) {
    // Skip splash, go directly to dashboard
    if (splash) splash.style.display = 'none';
    if (dash) dash.style.display = '';
    setTimeout(function(){ initCpGeoMap(); initSecurityGauge(); }, 100);  } else {
    if (splash) splash.style.display = '';
    if (dash) dash.style.display = 'none';
  }
}

// ============================================================
//  WAR ROOM v2 â€” DACTA BLUEPRINT
// ============================================================

// --- Engagement Selection ---
function wr2SelectEng(el, engId) {
  // Switch engagement tabs
  var tabs = document.querySelectorAll('#wr2EngBar .wr2-eng-tab');
  for (var i = 0; i < tabs.length; i++) tabs[i].classList.remove('active');
  el.classList.add('active');
  // Switch engagement panels
  var panels = document.querySelectorAll('#page-warroom .wr2-engagement-panel');
  for (var i = 0; i < panels.length; i++) panels[i].classList.remove('active');
  var panel = document.getElementById('wr2-panel-' + engId);
  if (panel) panel.classList.add('active');
}

// --- Inner Tab Switching ---
function wr2SwitchTab(el, paneId, navId, contentId) {
  // Deactivate all tabs in this nav
  var nav = document.getElementById(navId);
  if (nav) {
    var tabs = nav.querySelectorAll('.wr2-nav-tab');
    for (var i = 0; i < tabs.length; i++) tabs[i].classList.remove('active');
  }
  // Deactivate all panes in this content area
  var content = document.getElementById(contentId);
  if (content) {
    var panes = content.querySelectorAll('.wr2-tab-pane');
    for (var i = 0; i < panes.length; i++) panes[i].classList.remove('active');
  }
  // Activate clicked tab and matching pane
  el.classList.add('active');
  var pane = document.getElementById(paneId);
  if (pane) pane.classList.add('active');
}

// --- Copilot toggle (header button) ---
function wr2ToggleCopilot() {
  // Toggle the visible engagement's copilot
  var active = document.querySelector('#page-warroom .wr2-engagement-panel.active');
  if (!active) return;
  var cop = active.querySelector('.wr2-copilot');
  if (cop) cop.classList.toggle('collapsed');
}

// --- Copilot panel toggle (click header) ---
function wr2ToggleCopilotPanel(copilotId) {
  var el = document.getElementById(copilotId);
  if (el) el.classList.toggle('collapsed');
}

// --- Evidence tier toggle ---
function wr2ToggleTier(headerEl) {
  var body = headerEl.nextElementSibling;
  var arrow = headerEl.querySelector('span:last-child');
  if (body) {
    if (body.style.display === 'none') {
      body.style.display = '';
      if (arrow) arrow.style.transform = '';
    } else {
      body.style.display = 'none';
      if (arrow) arrow.style.transform = 'rotate(-90deg)';
    }
  }
}

// --- Elapsed Timer with Pause/Resume ---
var wr2HotStart = Date.now() - (14 * 3600 + 32 * 60 + 7) * 1000;
var wr2ColdStart = Date.now() - (2 * 3600 + 14 * 60 + 33) * 1000;

// Timer state: { paused: bool, pausedAt: timestamp|null, totalPausedMs: number, analystCount: number }
var wr2TimerState = {
  hot:  { paused: false, pausedAt: null, totalPausedMs: 0, analystCount: 2 },
  cold: { paused: false, pausedAt: null, totalPausedMs: 0, analystCount: 1 }
};

function wr2ToggleTimer(which) {
  var state = wr2TimerState[which];
  var btn = document.getElementById(which === 'hot' ? 'wr2PauseHot' : 'wr2PauseCold');
  var label = document.getElementById(which === 'hot' ? 'wr2PausedLabelHot' : 'wr2PausedLabelCold');
  var elapsedEl = document.getElementById(which === 'hot' ? 'wr2ElapsedHot' : 'wr2ElapsedCold');

  if (!state.paused) {
    // Pause
    state.paused = true;
    state.pausedAt = Date.now();
    if (btn) { btn.innerHTML = '&#x25B6;'; btn.classList.add('paused'); btn.title = 'Resume Timer'; }
    if (label) label.style.display = 'inline';
    if (elapsedEl) elapsedEl.classList.add('paused');
  } else {
    // Resume â€” accumulate paused duration
    state.totalPausedMs += Date.now() - state.pausedAt;
    state.paused = false;
    state.pausedAt = null;
    if (btn) { btn.innerHTML = '&#x23F8;'; btn.classList.remove('paused'); btn.title = 'Pause Timer'; }
    if (label) label.style.display = 'none';
    if (elapsedEl) elapsedEl.classList.remove('paused');
  }
}

function wr2GetElapsedMs(which) {
  var startTime = which === 'hot' ? wr2HotStart : wr2ColdStart;
  var state = wr2TimerState[which];
  var now = state.paused ? state.pausedAt : Date.now();
  return now - startTime - state.totalPausedMs;
}

function wr2FormatElapsed(ms) {
  var s = Math.floor(ms / 1000);
  var h = Math.floor(s / 3600);
  var m = Math.floor((s % 3600) / 60);
  var sec = s % 60;
  return (h < 10 ? '0' : '') + h + ':' + (m < 10 ? '0' : '') + m + ':' + (sec < 10 ? '0' : '') + sec;
}

function wr2FormatManhours(ms, analysts) {
  var totalMs = ms * analysts;
  var h = Math.floor(totalMs / 3600000);
  var m = Math.floor((totalMs % 3600000) / 60000);
  return (h < 10 ? '0' : '') + h + ':' + (m < 10 ? '0' : '') + m;
}

function wr2TickTimers() {
  // Hot engagement
  var hotMs = wr2GetElapsedMs('hot');
  var hotEl = document.getElementById('wr2ElapsedHot');
  if (hotEl && !wr2TimerState.hot.paused) hotEl.textContent = wr2FormatElapsed(hotMs);
  var hotMh = document.getElementById('wr2ManhoursHot');
  if (hotMh) hotMh.textContent = wr2FormatManhours(hotMs, wr2TimerState.hot.analystCount);
  var kpiEl = document.getElementById('wr2KpiElapsed003');
  if (kpiEl) {
    var h = Math.floor(hotMs / 3600000);
    var m = Math.floor((hotMs % 3600000) / 60000);
    kpiEl.textContent = (h < 10 ? '0' : '') + h + ':' + (m < 10 ? '0' : '') + m;
  }

  // Cold engagement
  var coldMs = wr2GetElapsedMs('cold');
  var coldEl = document.getElementById('wr2ElapsedCold');
  if (coldEl && !wr2TimerState.cold.paused) coldEl.textContent = wr2FormatElapsed(coldMs);
  var coldMh = document.getElementById('wr2ManhoursCold');
  if (coldMh) coldMh.textContent = wr2FormatManhours(coldMs, wr2TimerState.cold.analystCount);
}

// --- MITRE ATT&CK Mini Heatmap ---
function wr2BuildMitreGrid(gridId) {
  var el = document.getElementById(gridId);
  if (!el) return;
  // 11 tactics Ã— 5 rows = 55 cells
  // Columns: Recon, Res Dev, Init Access, Exec, Persist, PrivEsc, Def Evade, Cred, Discovery, Lateral, Exfil
  var cols = [
    [0,0,0,0,0],     // Recon
    [0,0,0,0,0],     // Resource Dev
    [0,'high','low',0,0],  // Initial Access
    [0,'crit','high','med',0], // Execution
    ['high','high','low',0,0], // Persistence
    ['med','high',0,0,0],  // Privilege Esc
    ['low','med','low',0,0],   // Defense Evasion
    ['crit','high','low',0,0], // Credential Access
    ['med','low',0,0,0],   // Discovery
    ['crit','high','med',0,0], // Lateral
    ['high','med',0,0,0],  // Exfil
  ];
  var html = '';
  for (var row = 0; row < 5; row++) {
    for (var col = 0; col < 11; col++) {
      var val = cols[col][row] || 'none';
      html += '<div class="wr2-mitre-cell ' + val + '" title="Tactic ' + (col+1) + ' Â· Technique ' + (row+1) + '"></div>';
    }
  }
  el.innerHTML = html;
}

// --- New Engagement (stub) ---
function wr2OpenNewEng() {
  var existing = document.getElementById('wrNewEngModal');
  if (existing) existing.remove();
  var modal = document.createElement('div');
  modal.id = 'wrNewEngModal';
  modal.style.cssText = 'position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.65);backdrop-filter:blur(6px);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;';
  modal.innerHTML = '<div style="background:#0d1424;border:1px solid var(--border-card);border-radius:14px;width:100%;max-width:600px;box-shadow:0 24px 80px rgba(0,0,0,0.5);">' +
    '<div style="display:flex;align-items:center;justify-content:space-between;padding:18px 22px;border-bottom:1px solid var(--border-subtle);">' +
    '<span style="font-family:var(--font-display);font-size:15px;font-weight:700;color:var(--text-primary);">New War Room Engagement</span>' +
    '<button onclick="document.getElementById(\'wrNewEngModal\').remove()" style="background:none;border:none;color:var(--text-muted);font-size:22px;cursor:pointer;padding:4px 8px;border-radius:6px;">\u00d7</button>' +
    '</div>' +
    '<div style="padding:20px 22px;">' +
    '<div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);margin-bottom:10px;">Engagement Mode</div>' +
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px;">' +
    '<div id="wrModeHot" onclick="wrSelectMode(\'hot\')" style="padding:16px;background:rgba(239,68,68,0.06);border:2px solid rgba(239,68,68,0.2);border-radius:10px;cursor:pointer;transition:all 0.15s;text-align:center;">' +
    '<div style="font-size:20px;margin-bottom:6px;">\ud83d\udd25</div>' +
    '<div style="font-size:13px;font-weight:700;color:var(--red-bright);margin-bottom:4px;">HOT MODE</div>' +
    '<div style="font-size:10px;color:var(--text-muted);line-height:1.4;">Active incident response.<br>MDR / SOCaaS client with active SIEM.</div>' +
    '</div>' +
    '<div id="wrModeCold" onclick="wrSelectMode(\'cold\')" style="padding:16px;background:rgba(59,130,246,0.06);border:2px solid rgba(59,130,246,0.15);border-radius:10px;cursor:pointer;transition:all 0.15s;text-align:center;">' +
    '<div style="font-size:20px;margin-bottom:6px;">\u2744\ufe0f</div>' +
    '<div style="font-size:13px;font-weight:700;color:#60a5fa;margin-bottom:4px;">COLD MODE</div>' +
    '<div style="font-size:10px;color:var(--text-muted);line-height:1.4;">DFIR retainer / ad-hoc engagement.<br>External client, no existing SIEM.</div>' +
    '</div>' +
    '</div>' +
    '<div style="display:flex;flex-direction:column;gap:14px;">' +
    '<div><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">Client / Organization</label><select id="wrEngClient" class="filter-select" style="width:100%;"><option value="">\u2014 Select Client \u2014</option><option>Naga World</option><option>Dacta Global</option><option>Foxwood</option><option>Silver Key</option><option>HLA</option><option>ADV Partners</option><option value="_custom">+ New Client (Ad-hoc)</option></select></div>' +
    '<div id="wrCustomClientRow" style="display:none;"><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">Custom Client Name</label><input id="wrEngCustomClient" class="filter-input" style="width:100%;" placeholder="Enter client organization name"></div>' +
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">' +
    '<div><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">Incident Type</label><select id="wrEngType" class="filter-select" style="width:100%;"><option>Ransomware</option><option>BEC / Email Compromise</option><option>Data Exfiltration</option><option>Insider Threat</option><option>Malware Outbreak</option><option>APT / Targeted Attack</option><option>DDoS</option><option>Web Application Attack</option><option>Other</option></select></div>' +
    '<div><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">Severity</label><select id="wrEngSev" class="filter-select" style="width:100%;"><option>SEV-1 Critical</option><option>SEV-2 High</option><option>SEV-3 Medium</option><option>SEV-4 Low</option></select></div>' +
    '</div>' +
    '<div><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">Lead Analyst</label><input id="wrEngLead" class="filter-input" style="width:100%;" placeholder="e.g. K. Rasmussen"></div>' +
    '<div><label style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.07em;color:var(--text-muted);display:block;margin-bottom:5px;">Initial Notes</label><textarea id="wrEngNotes" class="filter-input" style="width:100%;min-height:60px;resize:vertical;" placeholder="Brief description of the incident..."></textarea></div>' +
    '</div>' +
    '</div>' +
    '<div style="display:flex;align-items:center;gap:8px;padding:14px 22px;border-top:1px solid var(--border-subtle);">' +
    '<span id="wrEngModeLabel" style="font-size:11px;color:var(--text-muted);font-style:italic;">Select a mode to continue</span>' +
    '<button class="btn btn-secondary btn-sm" style="margin-left:auto;" onclick="document.getElementById(\'wrNewEngModal\').remove()">Cancel</button>' +
    '<button class="btn btn-primary btn-sm" id="wrEngSubmitBtn" onclick="wrSubmitNewEng()" disabled>Create Engagement</button>' +
    '</div></div>';
  document.body.appendChild(modal);
  // Client select handler for custom option
  document.getElementById('wrEngClient').addEventListener('change', function() {
    document.getElementById('wrCustomClientRow').style.display = this.value === '_custom' ? 'block' : 'none';
  });
}

var _wrSelectedMode = '';
function wrSelectMode(mode) {
  _wrSelectedMode = mode;
  var hot = document.getElementById('wrModeHot');
  var cold = document.getElementById('wrModeCold');
  var label = document.getElementById('wrEngModeLabel');
  var btn = document.getElementById('wrEngSubmitBtn');
  if (mode === 'hot') {
    hot.style.borderColor = 'rgba(239,68,68,0.7)'; hot.style.background = 'rgba(239,68,68,0.12)';
    cold.style.borderColor = 'rgba(59,130,246,0.15)'; cold.style.background = 'rgba(59,130,246,0.06)';
    label.innerHTML = '<span style="color:var(--red-bright);font-weight:600;">HOT MODE</span> \u2014 Active IR with SIEM telemetry';
  } else {
    cold.style.borderColor = 'rgba(59,130,246,0.7)'; cold.style.background = 'rgba(59,130,246,0.12)';
    hot.style.borderColor = 'rgba(239,68,68,0.2)'; hot.style.background = 'rgba(239,68,68,0.06)';
    label.innerHTML = '<span style="color:#60a5fa;font-weight:600;">COLD MODE</span> \u2014 DFIR / Ad-hoc engagement';
  }
  btn.disabled = false;
}

function wrSubmitNewEng() {
  var client = document.getElementById('wrEngClient').value;
  if (client === '_custom') client = document.getElementById('wrEngCustomClient').value.trim();
  if (!client) { showToast('Please select a client'); return; }
  var type = document.getElementById('wrEngType').value;
  var sev = document.getElementById('wrEngSev').value;
  var lead = document.getElementById('wrEngLead').value.trim() || 'Unassigned';
  var engNum = String(Math.floor(Math.random() * 900) + 100);
  var engId = 'WR-2026-' + engNum;
  var modeLabel = _wrSelectedMode === 'hot' ? '<span class="wr2-mode-hot">HOT</span>' : '<span class="wr2-mode-cold">COLD</span>';
  var sevShort = sev.split(' ')[0];
  var sevClass = sevShort === 'SEV-1' ? 'red' : sevShort === 'SEV-2' ? 'amber' : sevShort === 'SEV-3' ? 'blue' : 'green';

  // Add tab to engagement bar
  var bar = document.getElementById('wr2EngBar');
  if (bar) {
    var addBtn = bar.querySelector('.wr2-eng-add');
    var tab = document.createElement('div');
    tab.className = 'wr2-eng-tab';
    tab.setAttribute('data-eng', 'eng' + engNum);
    tab.onclick = function() { wr2SelectEng(tab, 'eng' + engNum); };
    tab.innerHTML = '<span class="wr2-eng-id">' + engId + '</span>' +
      '<span class="wr2-eng-name">' + client + ' \u2014 ' + type + '</span>' +
      modeLabel +
      '<span class="badge badge-' + sevClass + '">' + sevShort + '</span>' +
      '<span class="badge badge-open">Active</span>';
    bar.insertBefore(tab, addBtn);
  }

  document.getElementById('wrNewEngModal').remove();
  showToast('Engagement ' + engId + ' created \u2014 ' + (_wrSelectedMode === 'hot' ? 'HOT' : 'COLD') + ' mode for ' + client);
}

// --- Copilot demo responses ---
var wr2CopilotResponses = {
  'Generate investigation brief': 'Generating investigation brief for WR-2026-003...\n\nBased on current evidence: ALPHV/BlackCat ransomware (RaaS). TTPs suggest experienced affiliate â€” systematic living-off-the-land approach, ~8.5h dwell time before deployment. Recommend prioritizing krbtgt assessment.',
  'Check for Golden Ticket indicators': 'Scanning DC event logs for Golden Ticket indicators...\n\nCheck: Security Event 4769 (Kerberos Service Ticket) with unusual encryption type (RC4 when AES expected), and 4672 events for svc_backup. Also look for mimikatz artifacts in memory image.',
  'Draft Phase 5 containment plan': 'Phase 5 Containment Plan â€” NagaWorld:\n1. Complete network isolation (pending: 4 hosts)\n2. Reset krbtgt Ã— 2 (10h gap)\n3. Disable/audit all SAs with DA rights\n4. Revoke all active sessions & re-enroll MFA\n5. Confirm backup integrity before recovery',
  'Explain ALPHV/BlackCat TTPs': 'ALPHV/BlackCat is a RaaS group operating since Nov 2021. Key TTPs:\nâ€¢ Initial Access: phishing, exposed RDP, valid credentials\nâ€¢ Lateral: PsExec, WMI, Cobalt Strike\nâ€¢ Exfil: before encryption (double extortion)\nâ€¢ Impact: custom ransomware in Rust â€” fast encryption, multi-platform',
  'Guide me through scoping call': 'Scoping Call Guide â€” BEC:\n1. Confirm: which account(s) compromised?\n2. Timeline: first suspicious activity?\n3. Scope: all devices used by compromised user\n4. Financial: any payments or wire transfers?\n5. Email: inbox rules? Mail forwarding?\n6. Access: has attacker pivoted to other accounts?',
  'BEC evidence checklist': 'BEC Evidence Priorities:\nT1 (Immediate):\nâ€¢ O365 Audit Log (90 days)\nâ€¢ Message Trace â€” compromised mailbox\nâ€¢ Sign-in logs with IP/location\nâ€¢ Inbox rules export\n\nT2:\nâ€¢ Browser history (compromised device)\nâ€¢ MFA registration history\nâ€¢ Any financial system access logs',
  'Emergency containment steps': 'IMMEDIATE BEC Containment:\n1. Block external mail forwarding rules\n2. Reset compromised account password + revoke sessions\n3. Enable MFA on compromised account\n4. Alert finance: hold any pending wire transfers\n5. Contact bank for recall if transfer made',
  'Financial fraud recovery steps': 'Wire Transfer Recovery:\n1. Contact sending bank IMMEDIATELY â€” recall request\n2. File with FBI IC3 (ic3.gov) within 72h\n3. Interpol financial crimes notification\n4. Document all transactions for insurance claim\n5. Engage legal counsel for regulatory notifications'
};

function wr2CopilotQuery(btn, bodyId) {
  var text = btn.textContent.replace(/^[^\s]+\s/, '').trim();
  wr2CopilotSendMsg(text, bodyId);
}

function wr2CopilotSend(inputId, bodyId) {
  var input = document.getElementById(inputId);
  if (!input || !input.value.trim()) return;
  var text = input.value.trim();
  input.value = '';
  wr2CopilotSendMsg(text, bodyId);
}

function wr2CopilotSendMsg(text, bodyId) {
  var body = document.getElementById(bodyId);
  if (!body) return;
  // Add user message
  var userDiv = document.createElement('div');
  userDiv.className = 'wr2-cop-msg user';
  userDiv.innerHTML = '<div class="wr2-cop-msg-label">You</div>' + wr2escapeHtml(text);
  body.appendChild(userDiv);
  // Simulate AI response
  setTimeout(function() {
    var resp = null;
    var lower = text.toLowerCase();
    for (var key in wr2CopilotResponses) {
      if (lower.indexOf(key.toLowerCase()) > -1) { resp = wr2CopilotResponses[key]; break; }
    }
    if (!resp) resp = 'Analyzing engagement context for "' + text + '"...\n\nI\'ve reviewed the current evidence and IOCs. Based on the phase and available data, I recommend reviewing the investigation tab for next steps. Use the suggested queries above for context-specific guidance.';
    var aiDiv = document.createElement('div');
    aiDiv.className = 'wr2-cop-msg ai';
    aiDiv.innerHTML = '<div class="wr2-cop-msg-label">Copilot</div>' + wr2escapeHtml(resp).replace(/\n/g, '<br>');
    body.appendChild(aiDiv);
    body.scrollTop = body.scrollHeight;
  }, 800);
  body.scrollTop = body.scrollHeight;
}

function wr2escapeHtml(s) {
  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

// --- Init War Room v2 ---
function initWarRoom2() {
  // Production guard removed â€” visuals render with live data
  wr2BuildMitreGrid('wr2MitreGrid003');
  wr2TickTimers();
  if (!window._wr2TimerSet) {
    setInterval(wr2TickTimers, 1000);
    window._wr2TimerSet = true;
  }
}

// Initialize when war room page is navigated to
(function() {
  var origNavigate = window.navigate;
  // We'll also hook into the existing navigation logic by watching for page activation
  // via MutationObserver on page-warroom
  if (typeof MutationObserver !== 'undefined') {
    var wr2Observer = new MutationObserver(function(mutations) {
      for (var i = 0; i < mutations.length; i++) {
        var m = mutations[i];
        if (m.type === 'attributes' && m.attributeName === 'class') {
          var el = m.target;
          if (el.id === 'page-warroom' && el.classList.contains('active')) {
            initWarRoom2();
          }
        }
      }
    });
    document.addEventListener('DOMContentLoaded', function() {
      var wrPage = document.getElementById('page-warroom');
      if (wrPage) {
        wr2Observer.observe(wrPage, { attributes: true });
        // Also init if already active
        if (wrPage.classList.contains('active')) initWarRoom2();
      }
    });
  }
})();

// Backward compat stubs (old code called these)
function wrSwitchTab(el, tabId) { /* replaced by wr2SwitchTab */ }
function wrSelectCase(el, caseId) { /* replaced by wr2SelectEng */ }
function wrToggleDetail(node) { /* replaced by wr2ToggleTier */ }


function navigateToPage(page) {
  if (typeof navigate === 'function') navigate(page);
}

// ============================================================
//  TOAST NOTIFICATION (shared utility)
// ============================================================
function showToast(message, type) {
  var existing = document.getElementById('globalToast');
  if (existing) existing.remove();
  var t = type || 'info';
  var colors = {
    info: { bg: 'rgba(0,212,255,0.12)', border: 'rgba(0,212,255,0.3)', color: 'var(--cyan)' },
    success: { bg: 'rgba(16,185,129,0.12)', border: 'rgba(16,185,129,0.3)', color: 'var(--green)' },
    warning: { bg: 'rgba(245,158,11,0.12)', border: 'rgba(245,158,11,0.3)', color: 'var(--amber)' },
    error: { bg: 'rgba(239,68,68,0.12)', border: 'rgba(239,68,68,0.3)', color: 'var(--red-bright)' }
  };
  var c = colors[t] || colors.info;
  var toast = document.createElement('div');
  toast.id = 'globalToast';
  toast.style.cssText = [
    'position:fixed', 'bottom:24px', 'left:50%', 'transform:translateX(-50%)',
    'background:' + c.bg, 'border:1px solid ' + c.border, 'color:' + c.color,
    'padding:10px 20px', 'border-radius:8px', 'font-size:12.5px',
    'font-family:var(--font-body)', 'z-index:99999',
    'backdrop-filter:blur(12px)', '-webkit-backdrop-filter:blur(12px)',
    'box-shadow:0 8px 32px rgba(0,0,0,0.4)',
    'animation:toastIn 0.25s cubic-bezier(0.34,1.56,0.64,1)',
    'pointer-events:none', 'max-width:400px', 'text-align:center'
  ].join(';');
  toast.textContent = message;
  var styleEl = document.getElementById('toastKeyframe');
  if (!styleEl) {
    styleEl = document.createElement('style');
    styleEl.id = 'toastKeyframe';
    styleEl.textContent = '@keyframes toastIn{from{opacity:0;transform:translateX(-50%) translateY(10px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}';
    document.head.appendChild(styleEl);
  }
  document.body.appendChild(toast);
  setTimeout(function() {
    if (toast.parentNode) {
      toast.style.opacity = '0';
      toast.style.transition = 'opacity 0.3s';
      setTimeout(function() { if (toast.parentNode) toast.remove(); }, 300);
    }
  }, 2800);
}


// ============================================================
//  DACTA COPILOT â€” JavaScript
// ============================================================

// --- Domain Selector ---
function selectDomain(btn, domain) {
  document.querySelectorAll('.domain-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  // Update input placeholder based on domain
  var placeholders = {
    all: 'Ask the Copilot anything... e.g. "Check IP 8.8.8.8", "Show failed logins", "What is T1059?"',
    logsearch: 'Search logs... e.g. "Show failed RDP logins to DC-01 in last 24h"',
    threatintel: 'Enrich IOC... e.g. "Check IP 185.220.101.34" or "Analyze domain evil.com"',
    scriptanalysis: 'Decode/analyze... paste base64, PowerShell, or script snippet here',
    mitre: 'Lookup MITRE technique... e.g. "What is T1059.001?" or "Persistence techniques"',
    assetintel: 'Lookup asset/user... e.g. "Who is john.santos?" or "Info on NW-DC-01"',
    ticketintel: 'Query tickets... e.g. "Show all P1 tickets this week" or "TKT-847 timeline"',
    knowledge: 'Search playbooks... e.g. "Ransomware response playbook" or "KQL cheat sheet"'
  };
  var input = document.getElementById('copilotInput');
  if (input && placeholders[domain]) input.placeholder = placeholders[domain];
}

// --- Input Mode Toggle ---
function switchMode(mode) {
  var idMap = { nl: 'modeNL', raw: 'modeRaw', guided: 'modeGuided' };
  ['nl','raw','guided'].forEach(function(m) {
    var btn = document.getElementById(idMap[m]);
    if (btn) btn.classList.toggle('active', m === mode);
  });
}

// --- Saved Searches Toggle ---
function toggleSavedSearches() {
  var el = document.getElementById('copilotSavedSearches');
  if (el) el.classList.toggle('collapsed');
}

// --- Insert Saved Search ---
function insertSavedSearch(name) {
  var input = document.getElementById('copilotInput');
  if (input) {
    input.value = 'Run saved search: ' + name;
    input.focus();
  }
}

// --- Copilot Clear Screen ---
function clearCopilotScreen() {
  var msgContainer = document.querySelector('#copilotMessages, .copilot-messages');
  if (msgContainer) {
    msgContainer.innerHTML = '<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 24px;gap:12px;flex:1;">' +
      '<div style="font-size:40px;opacity:0.4;">\ud83e\udd16</div>' +
      '<div style="font-size:14px;font-weight:600;color:var(--text-primary);">DACTA Copilot Ready</div>' +
      '<div style="font-size:12px;color:var(--text-muted);font-family:var(--font-mono);max-width:400px;text-align:center;line-height:1.6;">Start a new investigation session. Ask questions about IOCs, search logs, query MITRE ATT&CK, or analyze scripts.</div>' +
      '<div style="display:flex;gap:6px;flex-wrap:wrap;justify-content:center;margin-top:4px;">' +
        '<span style="font-size:10px;padding:3px 10px;background:rgba(0,212,255,0.08);border:1px solid rgba(0,212,255,0.15);border-radius:12px;color:var(--cyan);cursor:pointer;" onclick="document.getElementById(\'copilotInput\').value=\'Check IP \';document.getElementById(\'copilotInput\').focus();">Check IP...</span>' +
        '<span style="font-size:10px;padding:3px 10px;background:rgba(139,92,246,0.08);border:1px solid rgba(139,92,246,0.15);border-radius:12px;color:#a78bfa;cursor:pointer;" onclick="document.getElementById(\'copilotInput\').value=\'What is \';document.getElementById(\'copilotInput\').focus();">MITRE Lookup</span>' +
        '<span style="font-size:10px;padding:3px 10px;background:rgba(16,185,129,0.08);border:1px solid rgba(16,185,129,0.15);border-radius:12px;color:var(--green);cursor:pointer;" onclick="document.getElementById(\'copilotInput\').value=\'Show me all \';document.getElementById(\'copilotInput\').focus();">Log Search</span>' +
      '</div>' +
    '</div>';
  }
  // Clear context badge
  var convHeader = document.querySelector('.copilot-conv-header');
  if (convHeader) {
    var ctxBadge = convHeader.querySelector('.badge');
    if (ctxBadge) ctxBadge.style.display = 'none';
  }
  // Clear Active Context + Recent IOCs sidebar panels
  document.querySelectorAll('#page-copilot .ctx-card').forEach(function(card) {
    var header = card.querySelector('.ctx-card-header');
    if (!header) return;
    var txt = header.textContent.trim();
    if (txt.includes('Active Context')) {
      var b = card.querySelector('.ctx-card-body');
      if (b) b.innerHTML = '<div style="text-align:center;padding:16px;font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">No active investigation context</div>';
    }
    if (txt.includes('Recent IOCs')) {
      var b = card.querySelector('.ctx-card-body');
      if (b) b.innerHTML = '<div style="text-align:center;padding:16px;font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">No IOCs in session</div>';
    }
  });
  showToast('Copilot screen cleared');
}

// --- Copilot Command Bar ---
function openCopilotCmd() {
  var overlay = document.getElementById('copilotCmdOverlay');
  if (overlay) {
    overlay.classList.add('open');
    setTimeout(function() {
      var input = document.getElementById('cmdbarInput');
      if (input) input.focus();
    }, 50);
  }
}

function closeCopilotCmd(e) {
  var overlay = document.getElementById('copilotCmdOverlay');
  if (overlay) overlay.classList.remove('open');
}

function updateCmdBar(val) {
  // Could filter suggestions based on val â€” placeholder for future
}

// --- Keyboard shortcut Ctrl+K / Cmd+K for Command Bar ---
document.addEventListener('keydown', function(e) {
  if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
    // Only trigger if copilot page is active
    var copilotPage = document.getElementById('page-copilot');
    if (copilotPage && copilotPage.classList.contains('active')) {
      e.preventDefault();
      openCopilotCmd();
    }
  }
  if (e.key === 'Escape') {
    closeCopilotCmd();
  }
});

// --- Copilot Input Keydown ---
function copilotInputKeydown(e) {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    copilotSend();
  }
}

// --- Copilot Send Message ---
function copilotSend() {
  var input = document.getElementById('copilotInput');
  if (!input || !input.value.trim()) return;
  var text = input.value.trim();
  input.value = '';
  copilotAsk(text);
}

async function copilotAsk(text) {
  var messages = document.getElementById('copilotMessages');
  if (!messages) return;

  // Add analyst message
  var analystRow = document.createElement('div');
  analystRow.className = 'msg-row analyst';
  analystRow.innerHTML = '<div class="msg-avatar analyst-av">&#x1F464;</div>' +
    '<div class="msg-content">' +
    '<div class="msg-meta"><span class="msg-sender">Analyst</span>' +
    '<span>' + new Date().toLocaleTimeString('en-SG', {hour:'2-digit',minute:'2-digit',second:'2-digit'}) + ' SGT</span></div>' +
    '<div class="msg-bubble-analyst">' + escapeHtml(text) + '</div></div>';
  messages.appendChild(analystRow);

  // Show thinking indicator
  var thinkRow = document.createElement('div');
  thinkRow.className = 'msg-row';
  thinkRow.id = 'copilotThinkRow';
  thinkRow.innerHTML = '<div class="msg-avatar copilot-av">&#x1F916;</div>' +
    '<div class="msg-content"><div class="copilot-thinking">' +
    '<div class="thinking-dots"><div class="thinking-dot"></div><div class="thinking-dot"></div><div class="thinking-dot"></div></div>' +
    '<span>Querying live data sources...</span></div></div>';
  messages.appendChild(thinkRow);
  messages.scrollTop = messages.scrollHeight;

  var startTime = Date.now();
  var lower = text.toLowerCase();
  var responseHTML = '';

  try {
    // Detect query type
    var ipMatch = text.match(/\b(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\b/);
    var mitreMatch = text.match(/[Tt](\d{4})(?:\.(\d{3}))?/);

    if (ipMatch || lower.startsWith('check ip') || lower.startsWith('ip:')) {
      // â”€â”€ IOC Enrichment â”€â”€
      var ip = ipMatch ? ipMatch[1] : text.replace(/^(check ip|ip:)\s*/i, '').trim();
      var [octiResp, elasticResp] = await Promise.all([
        fetch('/api/opencti', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            query: '{ indicators(first: 5, filters: { mode: and, filters: [{ key: "pattern", values: ["' + ip + '"], operator: eq }] }) { edges { node { id name pattern x_opencti_score pattern_type created_at objectMarking { id definition } } } } }'
          })
        }),
        fetch('/api/elastic', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            action: 'search',
            index: 'logs-*',
            body: {
              size: 5,
              query: { bool: { should: [
                { term: { 'source.ip': ip } },
                { term: { 'destination.ip': ip } },
                { match: { message: ip } }
              ] } },
              sort: [{ '@timestamp': 'desc' }],
              aggs: { by_source: { terms: { field: 'data_stream.dataset', size: 5 } } }
            }
          })
        })
      ]);

      var octiData = await octiResp.json();
      var esData = await elasticResp.json();
      var octiInds = (octiData.data && octiData.data.indicators && octiData.data.indicators.edges) ? octiData.data.indicators.edges.map(function(e) { return e.node; }) : [];
      var esHits = esData.hits ? esData.hits.total : { value: 0 };
      var totalHits = typeof esHits === 'object' ? esHits.value : esHits;
      var datasets = esData.aggregations && esData.aggregations.by_source ? esData.aggregations.by_source.buckets : [];

      var verdict = octiInds.length > 0 ? 'FLAGGED' : (totalHits > 0 ? 'SEEN' : 'NO DATA');
      var verdictColor = octiInds.length > 0 ? 'var(--red-bright)' : (totalHits > 0 ? 'var(--amber)' : 'var(--text-muted)');
      var score = octiInds.length > 0 ? octiInds[0].x_opencti_score : 0;

      responseHTML = '<div style="font-size:12.5px;color:var(--text-secondary);line-height:1.5;margin-bottom:10px;">IOC enrichment for <strong style="color:var(--cyan);font-family:var(--font-mono);">' + ip + '</strong> \u2014 queried OpenCTI and Elastic SIEM.</div>';
      responseHTML += '<div style="background:var(--bg-surface);border:1px solid var(--border-card);border-radius:10px;padding:14px;margin-bottom:8px;">';
      responseHTML += '<div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">';
      responseHTML += '<span style="font-size:11px;padding:3px 8px;border-radius:4px;font-weight:700;color:' + verdictColor + ';background:' + verdictColor + '15;border:1px solid ' + verdictColor + '30;">' + verdict + '</span>';
      responseHTML += '<span style="font-size:13px;font-family:var(--font-mono);color:var(--text-primary);font-weight:600;">' + ip + '</span>';
      if (score > 0) responseHTML += '<span style="margin-left:auto;font-size:11px;color:' + verdictColor + ';font-family:var(--font-mono);">Score: ' + score + '/100</span>';
      responseHTML += '</div>';

      if (octiInds.length > 0) {
        responseHTML += '<div style="font-size:11px;color:var(--text-secondary);margin-bottom:8px;"><strong style="color:var(--red-bright);">' + octiInds.length + ' indicator(s)</strong> found in OpenCTI:</div>';
        octiInds.forEach(function(ind) {
          responseHTML += '<div style="padding:6px 10px;background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.1);border-radius:6px;margin-bottom:4px;font-size:10px;color:var(--text-secondary);font-family:var(--font-mono);">' + (ind.pattern || ind.name) + '</div>';
        });
      } else {
        responseHTML += '<div style="font-size:11px;color:var(--text-muted);margin-bottom:8px;">No matching indicators in OpenCTI.</div>';
      }

      responseHTML += '<div style="margin-top:8px;font-size:11px;color:var(--text-secondary);"><strong>' + totalHits.toLocaleString() + '</strong> log events found in Elastic SIEM.</div>';
      if (datasets.length > 0) {
        responseHTML += '<div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:6px;">';
        datasets.forEach(function(d) {
          responseHTML += '<span style="font-size:9px;padding:2px 8px;background:rgba(0,212,255,0.08);border:1px solid rgba(0,212,255,0.15);border-radius:10px;color:var(--cyan);">' + d.key + ': ' + d.doc_count + '</span>';
        });
        responseHTML += '</div>';
      }
      responseHTML += '</div>';

      trackAIUsage('Copilot-IOC', 500, 800, 'IOC: ' + ip);

    } else if (mitreMatch) {
      // â”€â”€ MITRE Technique Lookup â”€â”€
      var techId = 'T' + mitreMatch[1] + (mitreMatch[2] ? '.' + mitreMatch[2] : '');
      var octiResp2 = await fetch('/api/opencti', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          query: '{ attackPatterns(first: 5, filters: { mode: and, filters: [{ key: "x_mitre_id", values: ["' + techId + '"], operator: eq }] }) { edges { node { id name description x_mitre_id killChainPhases { id kill_chain_name phase_name } } } } }'
        })
      });
      var octiData2 = await octiResp2.json();
      var patterns = (octiData2.data && octiData2.data.attackPatterns && octiData2.data.attackPatterns.edges) ? octiData2.data.attackPatterns.edges.map(function(e) { return e.node; }) : [];

      responseHTML = '<div style="font-size:12.5px;color:var(--text-secondary);line-height:1.5;margin-bottom:10px;">MITRE ATT&CK lookup for <strong style="color:#a78bfa;font-family:var(--font-mono);">' + techId + '</strong>:</div>';
      if (patterns.length > 0) {
        patterns.forEach(function(p) {
          var phases = (p.killChainPhases || []).map(function(kc) { return kc.phase_name; });
          responseHTML += '<div style="background:rgba(139,92,246,0.06);border:1px solid rgba(139,92,246,0.15);border-radius:10px;padding:14px;margin-bottom:8px;">';
          responseHTML += '<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">';
          responseHTML += '<span style="font-size:11px;font-family:var(--font-mono);padding:3px 8px;background:rgba(139,92,246,0.12);border:1px solid rgba(139,92,246,0.25);border-radius:4px;color:#a78bfa;font-weight:700;">' + (p.x_mitre_id || techId) + '</span>';
          responseHTML += '<span style="font-size:13px;font-weight:600;color:var(--text-primary);">' + (p.name || 'Unknown Technique') + '</span>';
          responseHTML += '</div>';
          if (phases.length > 0) {
            responseHTML += '<div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:8px;">';
            phases.forEach(function(ph) {
              responseHTML += '<span style="font-size:9px;padding:2px 6px;background:rgba(139,92,246,0.08);border:1px solid rgba(139,92,246,0.15);border-radius:3px;color:#a78bfa;">' + ph + '</span>';
            });
            responseHTML += '</div>';
          }
          if (p.description) {
            responseHTML += '<div style="font-size:11px;color:var(--text-secondary);line-height:1.5;">' + (p.description.length > 500 ? p.description.substring(0, 497) + '...' : p.description) + '</div>';
          }
          responseHTML += '</div>';
        });
      } else {
        responseHTML += '<div style="padding:12px;background:var(--bg-surface);border:1px solid var(--border-card);border-radius:8px;font-size:11px;color:var(--text-muted);">No matching attack patterns found in OpenCTI for ' + techId + '. The technique may not be indexed in this instance.</div>';
      }
      trackAIUsage('Copilot-MITRE', 300, 600, 'MITRE: ' + techId);

    } else if (lower.includes('login') || lower.includes('rdp') || lower.includes('search') || lower.includes('show me') || lower.startsWith('search:') || lower.includes('failed') || lower.includes('firewall') || lower.includes('alert')) {
      // â”€â”€ Log Search â”€â”€
      var queryBody = {};
      if (lower.includes('login') || lower.includes('rdp') || lower.includes('failed')) {
        queryBody = { bool: { must: [
          { match: { message: text } }
        ] } };
      } else {
        queryBody = { query_string: { query: text.replace(/^search:\s*/i, ''), default_field: 'message' } };
      }

      var esResp = await fetch('/api/elastic', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          action: 'search',
          index: 'logs-*',
          body: {
            size: 5,
            query: queryBody,
            sort: [{ '@timestamp': 'desc' }],
            aggs: {
              by_namespace: { terms: { field: 'data_stream.namespace', size: 5 } },
              by_dataset: { terms: { field: 'data_stream.dataset', size: 5 } }
            }
          }
        })
      });
      var esData2 = await esResp.json();
      var hits2 = esData2.hits ? esData2.hits : { total: { value: 0 }, hits: [] };
      var total2 = typeof hits2.total === 'object' ? hits2.total.value : hits2.total;
      var nsBuckets = esData2.aggregations && esData2.aggregations.by_namespace ? esData2.aggregations.by_namespace.buckets : [];
      var dsBuckets = esData2.aggregations && esData2.aggregations.by_dataset ? esData2.aggregations.by_dataset.buckets : [];

      responseHTML = '<div style="font-size:12.5px;color:var(--text-secondary);line-height:1.5;margin-bottom:10px;">Searched Elastic SIEM for: <strong style="color:var(--text-primary);">' + escapeHtml(text) + '</strong></div>';
      responseHTML += '<div style="background:var(--bg-surface);border:1px solid var(--border-card);border-radius:10px;padding:14px;">';
      responseHTML += '<div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">';
      responseHTML += '<span style="font-size:18px;font-family:var(--font-mono);font-weight:700;color:var(--cyan);">' + total2.toLocaleString() + '</span>';
      responseHTML += '<span style="font-size:12px;color:var(--text-muted);">matching events</span>';
      responseHTML += '</div>';

      if (nsBuckets.length > 0) {
        responseHTML += '<div style="font-size:10px;color:var(--text-muted);margin-bottom:6px;">By Client:</div><div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px;">';
        nsBuckets.forEach(function(ns) {
          responseHTML += '<span style="font-size:9px;padding:2px 8px;background:rgba(0,212,255,0.08);border:1px solid rgba(0,212,255,0.15);border-radius:10px;color:var(--cyan);">' + ns.key + ': ' + ns.doc_count.toLocaleString() + '</span>';
        });
        responseHTML += '</div>';
      }

      if (hits2.hits && hits2.hits.length > 0) {
        responseHTML += '<div style="font-size:10px;color:var(--text-muted);margin-bottom:6px;">Recent Events:</div>';
        hits2.hits.slice(0, 3).forEach(function(h) {
          var src = h._source || {};
          var ts = src['@timestamp'] ? new Date(src['@timestamp']).toLocaleString('en-SG', { timeZone: 'Asia/Singapore', day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' }) : '';
          var msg = src.message || JSON.stringify(src).substring(0, 200);
          if (msg.length > 200) msg = msg.substring(0, 197) + '...';
          responseHTML += '<div style="padding:8px 10px;background:var(--surface-0);border:1px solid var(--border-subtle);border-radius:6px;margin-bottom:4px;font-size:10px;font-family:var(--font-mono);color:var(--text-secondary);line-height:1.4;">' +
            '<span style="color:var(--text-muted);">' + ts + '</span> ' + escapeHtml(msg) +
          '</div>';
        });
      }
      responseHTML += '</div>';
      trackAIUsage('Copilot-Search', 600, 500, 'Search: ' + text.substring(0, 30));

    } else {
      // â”€â”€ General Query â”€â”€
      var esResp2 = await fetch('/api/elastic', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          action: 'search',
          index: 'logs-*',
          body: {
            size: 3,
            query: { query_string: { query: text, default_field: 'message', lenient: true } },
            sort: [{ '@timestamp': 'desc' }],
            aggs: { by_namespace: { terms: { field: 'data_stream.namespace', size: 5 } } }
          }
        })
      });
      var esData3 = await esResp2.json();
      var total3 = esData3.hits && esData3.hits.total ? (typeof esData3.hits.total === 'object' ? esData3.hits.total.value : esData3.hits.total) : 0;

      responseHTML = '<div style="font-size:12.5px;color:var(--text-secondary);line-height:1.6;">';
      responseHTML += 'Searched across connected data sources for: <strong style="color:var(--text-primary);">' + escapeHtml(text) + '</strong>';
      responseHTML += '<div style="margin-top:8px;"><strong style="color:var(--cyan);">' + total3.toLocaleString() + '</strong> matching events found in Elastic SIEM.</div>';
      if (esData3.hits && esData3.hits.hits && esData3.hits.hits.length > 0) {
        responseHTML += '<div style="margin-top:8px;font-size:10px;color:var(--text-muted);">Latest events:</div>';
        esData3.hits.hits.forEach(function(h) {
          var src = h._source || {};
          var ts = src['@timestamp'] ? new Date(src['@timestamp']).toLocaleString('en-SG', { timeZone: 'Asia/Singapore', day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' }) : '';
          var msg = src.message || JSON.stringify(src).substring(0, 150);
          if (msg.length > 150) msg = msg.substring(0, 147) + '...';
          responseHTML += '<div style="padding:6px 10px;background:var(--surface-0);border:1px solid var(--border-subtle);border-radius:6px;margin-top:4px;font-size:10px;font-family:var(--font-mono);color:var(--text-secondary);">' + ts + ' \u00b7 ' + escapeHtml(msg) + '</div>';
        });
      }
      responseHTML += '<div style="margin-top:10px;" class="kql-suggestion"><span>&#x1F4A1;</span><span>Try: <span style="font-family:var(--font-mono);color:var(--cyan);">ip:</span> for IOC checks, <span style="font-family:var(--font-mono);color:var(--cyan);">T1059</span> for MITRE, <span style="font-family:var(--font-mono);color:var(--cyan);">search:</span> for log queries.</span></div>';
      responseHTML += '</div>';
      trackAIUsage('Copilot-General', 400, 300, 'General: ' + text.substring(0, 30));
    }
  } catch (err) {
    console.error('[Copilot] Live query error:', err);
    responseHTML = '<div style="font-size:12px;color:var(--text-secondary);line-height:1.5;">I encountered an error querying live data: <span style="color:var(--amber);">' + err.message + '</span><br>Please verify your Elastic and OpenCTI connections are active in the Integration Hub.</div>';
  }

  var elapsed = ((Date.now() - startTime) / 1000).toFixed(1);

  var think = document.getElementById('copilotThinkRow');
  if (think) think.remove();

  var responseRow = document.createElement('div');
  responseRow.className = 'msg-row';
  responseRow.innerHTML = '<div class="msg-avatar copilot-av">&#x1F916;</div>' +
    '<div class="msg-content" style="max-width:95%;">' +
    '<div class="msg-meta"><span class="msg-sender">DACTA Copilot</span>' +
    '<span>' + new Date().toLocaleTimeString('en-SG', {hour:'2-digit',minute:'2-digit',second:'2-digit'}) + ' SGT \u00b7 ' + elapsed + 's</span>' +
    '<span style="font-size:8px;padding:1px 5px;background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.2);border-radius:3px;color:var(--green);">LIVE</span></div>' +
    '<div class="msg-bubble-copilot">' + responseHTML + '</div></div>';
  messages.appendChild(responseRow);
  messages.scrollTop = messages.scrollHeight;
}

function escapeHtml(s) {
  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

function getCopilotGenericIOCResponse(text) {
  return `<div style="font-size:12.5px;color:var(--text-secondary);line-height:1.5;margin-bottom:8px;">Enrichment in progress across VirusTotal, AbuseIPDB, Shodan, MISP, and ThreatFox. Results will include geolocation, passive DNS, and historical IOC context.</div>
  <div style="background:var(--bg-surface);border:1px solid var(--border-card);border-radius:8px;padding:12px;display:flex;align-items:center;gap:12px;">
    <div style="font-size:24px;">&#x1F9EA;</div>
    <div><div style="font-size:11px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.1em;font-weight:700;">IOC Enrichment</div>
    <div style="font-size:13px;color:var(--text-primary);margin-top:3px;font-family:var(--font-mono);">${escapeHtml(text)}</div>
    <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">Full enrichment results would appear above with verdicts, source attribution, and action buttons.</div></div>
  </div>`;
}

function getCopilotGenericLogResponse(text) {
  return `<div style="font-size:12.5px;color:var(--text-secondary);line-height:1.5;margin-bottom:8px;">Translating to KQL and executing against <strong style="color:var(--cyan);">NagaWorld Elastic SIEM</strong>. Results will include raw counts, unique source IPs, and automated anomaly highlighting.</div>
  <div class="kql-suggestion">
    <span style="font-size:14px;">&#x1F916;</span>
    <span>Query generated and ready. Use the search templates below for common hunting patterns, or refine your natural language query.</span>
  </div>`;
}

function getCopilotGenericMitreResponse(text) {
  return `<div style="font-size:12.5px;color:var(--text-secondary);line-height:1.5;margin-bottom:8px;">Looking up MITRE ATT&amp;CK knowledge base. Results include tactic classification, detection methods, and related techniques.</div>
  <div style="background:rgba(139,92,246,0.06);border:1px solid rgba(139,92,246,0.15);border-radius:8px;padding:12px;">
    <div style="font-size:11px;color:var(--text-muted);margin-bottom:6px;text-transform:uppercase;font-weight:700;letter-spacing:0.1em;">MITRE ATT&amp;CK</div>
    <div style="font-size:13px;color:var(--text-primary);font-family:var(--font-mono);">${escapeHtml(text)}</div>
    <div style="font-size:11px;color:var(--text-muted);margin-top:6px;">Full technique card would render with tactic tags, description, detection methods, and action buttons.</div>
  </div>`;
}

function getCopilotGenericResponse(text) {
  return `<div style="font-size:12.5px;color:var(--text-secondary);line-height:1.6;">
    I've received your query. To provide the best results, I'm checking:
    <ul style="margin:8px 0 8px 16px;display:flex;flex-direction:column;gap:4px;">
      <li>Connected SIEM data sources</li>
      <li>Threat intelligence feeds</li>
      <li>Historical investigation context for NagaWorld</li>
      <li>Relevant playbooks and knowledge base</li>
    </ul>
    <div class="kql-suggestion" style="margin-top:8px;">
      <span>&#x1F4A1;</span>
      <span>Try using prefixes: <span style="font-family:var(--font-mono);color:var(--cyan);">ip:</span> for IOC checks, <span style="font-family:var(--font-mono);color:var(--cyan);">t:</span> for MITRE techniques, <span style="font-family:var(--font-mono);color:var(--cyan);">search:</span> for log queries.</span>
    </div>
  </div>`;
}

// Scroll messages to bottom on copilot page init
function initCopilotPage() {
  setTimeout(function() {
    var msgs = document.getElementById('copilotMessages');
    if (msgs) msgs.scrollTop = msgs.scrollHeight;
  }, 100);
}

/* ==============================================================
   TASK 2: ESCALATION MODAL
   ============================================================== */
function showEscModal() {
  document.getElementById('escModalOverlay').classList.add('open');
}
function closeEscModal() {
  document.getElementById('escModalOverlay').classList.remove('open');
}

/* ==============================================================
   TASK 3: SEND TO COPILOT
   ============================================================== */
function sendToCopilot() {
  if (!_currentInvestigationKey) { showToast('No investigation open', 'warn'); return; }
  // Store ticket context for copilot
  window._copilotContext = {
    ticketKey: _currentInvestigationKey,
    fromInvestigation: true
  };
  showToast('Sending ' + _currentInvestigationKey + ' context to Copilot...', 'info');
  setTimeout(function() {
    navigate('copilot');
    // Pre-fill copilot input with context
    setTimeout(function() {
      var input = document.querySelector('#page-copilot textarea, #page-copilot input[type="text"], .copilot-input');
      if (input) {
        input.value = 'Investigate ' + _currentInvestigationKey + ' â€” provide additional analysis on the AI investigation findings.';
        input.focus();
        input.dispatchEvent(new Event('input', { bubbles: true }));
      }
    }, 300);
  }, 800);
}

/* ==============================================================
   TASK 4: OVERRIDE VERDICT
   ============================================================== */
var overrideModeActive = false;
var overriddenSections = {};
function toggleOverrideMode() {
  if (!_currentInvestigationKey) { showToast('No investigation open', 'warn'); return; }
  var ov = document.createElement('div');
  ov.id = 'overrideOverlay';
  ov.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:10000;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px);';
  ov.onclick = function(e) { if (e.target === ov) ov.remove(); };
  ov.innerHTML = '<div style="background:var(--surface-1);border:1px solid var(--border);border-radius:12px;width:440px;box-shadow:0 20px 60px rgba(0,0,0,0.5);">' +
    '<div style="padding:16px 20px;border-bottom:1px solid var(--border);"><div style="font-size:14px;font-weight:600;color:var(--text-primary);">Override AI Verdict</div><div style="font-size:10px;color:var(--text-muted);margin-top:4px;">' + _currentInvestigationKey + '</div></div>' +
    '<div style="padding:16px 20px;display:flex;flex-direction:column;gap:12px;">' +
      '<div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px;">New Verdict</div>' +
      '<select id="overrideSelect" style="width:100%;background:var(--surface-2);border:1px solid var(--border);border-radius:6px;padding:10px 12px;color:var(--text-primary);font-size:12px;"><option>True Positive â€” Confirmed Threat</option><option>False Positive â€” Business Justified</option><option>Suspicious â€” Requires Further Review</option><option>Benign â€” Informational Only</option></select></div>' +
      '<div><div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px;">Justification *</div>' +
      '<textarea id="overrideJustification" placeholder="Explain why the AI verdict is incorrect..." style="width:100%;height:80px;background:var(--surface-2);border:1px solid var(--border);border-radius:6px;padding:10px 12px;color:var(--text-primary);font-size:12px;font-family:var(--font-body);resize:none;outline:none;box-sizing:border-box;"></textarea></div>' +
      '<div style="display:flex;justify-content:flex-end;gap:8px;margin-top:4px;">' +
        '<button class="btn btn-secondary btn-sm" onclick="closeOverrideModal()">Cancel</button>' +
        '<button class="btn btn-amber btn-sm" onclick="submitOverride()">Submit Override</button>' +
      '</div>' +
    '</div></div>';
  document.body.appendChild(ov);
}
function submitOverride() {
  var sel = document.getElementById('overrideSelect');
  var just = document.getElementById('overrideJustification');
  if (!just || !just.value.trim()) { showToast('Please provide justification', 'warn'); return; }
  closeOverrideModal();
  showToast('Verdict overridden to: ' + sel.value.split('\u2014')[0].trim(), 'success');
}
function closeOverrideModal() {
  var ov = document.getElementById('overrideOverlay'); if (ov) ov.remove();
}
function overrideSection(sectionId) {
  overriddenSections[sectionId] = true;
  var badge = document.getElementById('badge-' + sectionId);
  var keepBtn = document.getElementById('keep' + capitalize(sectionId));
  var overBtn = document.getElementById('override' + capitalize(sectionId));
  if (badge) { badge.className = 'override-badge manual'; badge.textContent = '\u270F Manual Override â€” John Lim'; }
  if (keepBtn) keepBtn.classList.remove('active');
  if (overBtn) overBtn.classList.add('active', 'amber');
  updateOverrideModeText();
}
function keepSection(sectionId) {
  delete overriddenSections[sectionId];
  var badge = document.getElementById('badge-' + sectionId);
  var keepBtn = document.getElementById('keep' + capitalize(sectionId));
  var overBtn = document.getElementById('override' + capitalize(sectionId));
  if (badge) { badge.className = 'override-badge ai'; badge.textContent = '\u2728 AI-Generated'; }
  if (keepBtn) keepBtn.classList.add('active');
  if (overBtn) { overBtn.classList.remove('active'); overBtn.classList.remove('amber'); }
  updateOverrideModeText();
}
function updateOverrideModeText() {
  var count = Object.keys(overriddenSections).length;
  var el = document.getElementById('overrideModeText');
  if (el) el.textContent = 'Override Mode Active â€” ' + count + ' of 5 sections overridden';
}
function confirmOverride() {
  var count = Object.keys(overriddenSections).length;
  showToast('Overrides confirmed â€” ' + count + ' section(s) marked as manual');
  toggleOverrideMode();
}
function capitalize(s) { return s.charAt(0).toUpperCase() + s.slice(1); }

/* ==============================================================
   TASK 5: ROUTE TO RESPONSE CENTER
   ============================================================== */
function showRouteConfirm() {
  document.getElementById('routeConfirmDialog').classList.add('open');
}
function closeRouteConfirm() {
  document.getElementById('routeConfirmDialog').classList.remove('open');
}
function confirmRoute() {
  closeRouteConfirm();
  showToast('Routed to Response Center â€” containment actions queued');
  setTimeout(function() { navigate('response'); }, 1200);
}

/* ==============================================================
   TASK 6: HANDOVER ARTIFACT UPLOAD + CLIENT SEND TOGGLE
   ============================================================== */
var fileIconMap = { pdf: '\ud83d\udcc4', png: '\ud83d\uddbc\ufe0f', jpg: '\ud83d\uddbc\ufe0f', docx: '\ud83d\udcc3', doc: '\ud83d\udcc3', csv: '\ud83d\udcc8', pcap: '\ud83d\udcf6', xlsx: '\ud83d\udcca', txt: '\ud83d\udcdd' };
function getFileIcon(filename) {
  var ext = filename.split('.').pop().toLowerCase();
  return fileIconMap[ext] || '\ud83d\udcc1';
}
function addArtifactFile(name, size) {
  var list = document.getElementById('artifactFileList');
  if (!list) return;
  var sizeStr = size > 1048576 ? (size/1048576).toFixed(1)+' MB' : (size > 1024 ? (size/1024).toFixed(0)+' KB' : size + ' B');
  var item = document.createElement('div');
  item.className = 'handover-file-item';
  item.innerHTML = '<div class="handover-file-icon">' + getFileIcon(name) + '</div><div class="handover-file-name">' + name + '</div><div style="font-size:10px;color:var(--text-muted);">' + sizeStr + '</div><div class="handover-file-remove" onclick="this.parentElement.remove()">&#x2715;</div>';
  list.appendChild(item);
}
function handleArtifactDrop(event) {
  event.preventDefault();
  document.getElementById('artifactDropZone').classList.remove('drag-over');
  var files = event.dataTransfer.files;
  for (var i = 0; i < files.length; i++) addArtifactFile(files[i].name, files[i].size);
}
function handleArtifactSelect(event) {
  var files = event.target.files;
  for (var i = 0; i < files.length; i++) addArtifactFile(files[i].name, files[i].size);
}
function toggleClientSend() {
  var toggle = document.getElementById('clientSendToggle');
  var fields = document.getElementById('clientSendFields');
  if (!toggle || !fields) return;
  var isOn = toggle.classList.contains('on');
  if (isOn) {
    toggle.classList.remove('on'); toggle.classList.add('off');
    fields.classList.remove('visible');
  } else {
    toggle.classList.remove('off'); toggle.classList.add('on');
    fields.classList.add('visible');
  }
}

/* ==============================================================
   JSM OPS COMMAND CENTER â€” Render Functions
   ============================================================== */
var _opsDataLoaded = false;

async function loadOpsCommandData() {
  if (_opsDataLoaded) return;
  try {
    var data = await DactaJira.fetchOpsData();
    _opsDataLoaded = true;
    renderOpsSchedules(data.schedules || [], data.userMap || {});
    renderOpsRouting(data.routingRules || [], data.schedules || [], data.escalationPolicies || []);
    renderOpsEscalation(data.escalationPolicies || [], data.schedules || []);
    var liveInd = document.getElementById('opsLiveIndicator');
    if (liveInd) liveInd.style.display = 'flex';
  } catch (err) {
    console.error('[OpsCmd] Failed to load:', err);
    var bodies = ['opsScheduleBody','opsRoutingBody','opsEscBody'];
    bodies.forEach(function(id) {
      var el = document.getElementById(id);
      if (el) el.innerHTML = '<div style="text-align:center;padding:20px;font-size:10px;color:var(--text-muted);">Unable to load JSM Ops data</div>';
    });
  }
}

function formatTimeRestriction(tr) {
  if (!tr) return 'All times';
  if (tr.type === 'time-of-day' && tr.restriction) {
    return String(tr.restriction.startHour||0).padStart(2,'0')+':'+String(tr.restriction.startMin||0).padStart(2,'0')+' â†’ '+String(tr.restriction.endHour||0).padStart(2,'0')+':'+String(tr.restriction.endMin||0).padStart(2,'0');
  }
  if (tr.type === 'weekday-and-time-of-day' && tr.restrictions && tr.restrictions.length) {
    // Summarize: find the most common pattern
    var r0 = tr.restrictions[0];
    var startH = String(r0.startHour||0).padStart(2,'0')+':'+String(r0.startMin||0).padStart(2,'0');
    var endH = String(r0.endHour||0).padStart(2,'0')+':'+String(r0.endMin||0).padStart(2,'0');
    var days = tr.restrictions.map(function(r){return r.startDay.charAt(0).toUpperCase()+r.startDay.slice(1,3);}).join(', ');
    return days + ' ' + startH + 'â†’' + endH;
  }
  return 'Custom';
}

function renderOpsSchedules(schedules, userMap) {
  var body = document.getElementById('opsScheduleBody');
  var count = document.getElementById('opsScheduleCount');
  if (!body) return;
  if (count) count.textContent = schedules.length;
  if (!schedules.length) { body.innerHTML = '<div style="text-align:center;padding:20px;font-size:10px;color:var(--text-muted);">No schedules configured</div>'; return; }

  var html = '';
  schedules.forEach(function(s) {
    var enabledClass = s.enabled ? 'on' : 'off';
    var enabledLabel = s.enabled ? 'Active' : 'Disabled';
    html += '<div class="ops-schedule-item">';
    html += '<div class="ops-schedule-name"><span class="ops-enabled '+enabledClass+'"></span> '+escH(s.name)+'</div>';
    html += '<div style="font-size:9px;color:var(--text-muted);margin-bottom:4px;">'+escH(s.timezone)+' Â· '+enabledLabel+'</div>';

    // Rotations
    (s.rotations || []).forEach(function(r) {
      var participants = (r.participants || []).map(function(p){return p.name || p.id;}).join(', ');
      var timeStr = formatTimeRestriction(r.timeRestriction);
      html += '<div class="ops-rotation">';
      html += '<div class="ops-rotation-name">'+escH(r.name)+'</div>';
      html += '<div class="ops-rotation-detail"><strong>Type:</strong> '+r.type+(r.length>1?' ('+r.length+')':'')+' Â· <strong>Staff:</strong> '+escH(participants)+'</div>';
      html += '<div class="ops-rotation-detail"><strong>Hours:</strong> '+escH(timeStr)+'</div>';
      html += '</div>';
    });

    // On-call now
    if (s.onCall && s.onCall.length) {
      s.onCall.forEach(function(oc) {
        html += '<div class="ops-oncall-badge"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg> On-Call: '+escH(oc.name || oc.id)+'</div>';
      });
    }
    html += '</div>';
  });
  body.innerHTML = html;
}

function renderOpsRouting(rules, schedules, escPolicies) {
  var body = document.getElementById('opsRoutingBody');
  var count = document.getElementById('opsRoutingCount');
  if (!body) return;
  if (count) count.textContent = rules.length;
  if (!rules.length) { body.innerHTML = '<div style="text-align:center;padding:20px;font-size:10px;color:var(--text-muted);">No routing rules configured</div>'; return; }

  // Build lookup maps
  var schedMap = {}; schedules.forEach(function(s){schedMap[s.id]=s.name;});
  var escMap = {}; escPolicies.forEach(function(e){escMap[e.id]=e.name;});

  var html = '';
  rules.forEach(function(r) {
    html += '<div class="ops-rule-item">';
    html += '<div class="ops-rule-name">';
    html += escH(r.name);
    if (r.isDefault) html += ' <span class="ops-default-badge">DEFAULT</span>';
    html += '</div>';

    // Conditions
    if (r.criteria) {
      if (r.criteria.type === 'match-all') {
        html += '<div class="ops-rule-condition">Match: ALL alerts</div>';
      } else if (r.criteria.conditions && r.criteria.conditions.length) {
        r.criteria.conditions.forEach(function(c) {
          html += '<div class="ops-rule-condition">'+escH(c.field)+' '+escH(c.operation)+' "'+escH(c.expectedValue)+'"</div>';
        });
      }
    }

    // Time restriction
    if (r.timeRestriction) {
      html += '<div class="ops-rule-time"><svg viewBox="0 0 24 24" fill="none" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg> '+escH(formatTimeRestriction(r.timeRestriction))+'</div>';
    }

    // Notify target
    if (r.notify) {
      var target = 'None';
      if (r.notify.type === 'escalation') target = 'â†— Escalation: ' + (escMap[r.notify.id] || r.notify.id);
      else if (r.notify.type === 'schedule') target = 'ðŸ“… Schedule: ' + (schedMap[r.notify.id] || r.notify.id);
      else if (r.notify.type !== 'None') target = r.notify.type;

      if (r.notify.type === 'None') {
        html += '<div class="ops-rule-notify"><span class="ops-none-badge">No notification</span></div>';
      } else {
        html += '<div class="ops-rule-notify"><svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></svg> '+escH(target)+'</div>';
      }
    }
    html += '</div>';
  });
  body.innerHTML = html;
}

function renderOpsEscalation(policies, schedules) {
  var body = document.getElementById('opsEscBody');
  var count = document.getElementById('opsEscCount');
  if (!body) return;
  if (count) count.textContent = policies.length;
  if (!policies.length) { body.innerHTML = '<div style="text-align:center;padding:20px;font-size:10px;color:var(--text-muted);">No escalation policies configured</div>'; return; }

  var schedMap = {}; schedules.forEach(function(s){schedMap[s.id]=s.name;});

  var html = '';
  policies.forEach(function(p) {
    html += '<div class="ops-esc-item">';
    html += '<div class="ops-esc-name"><svg viewBox="0 0 24 24" fill="none" stroke="var(--red-bright)" stroke-width="1.5" style="width:12px;height:12px;"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg> '+escH(p.name);
    if (p.enabled) html += ' <span style="font-size:8px;padding:1px 5px;border-radius:3px;background:rgba(16,185,129,0.12);color:var(--green);font-weight:700;">ACTIVE</span>';
    html += '</div>';

    // Steps
    (p.rules || []).forEach(function(r, idx) {
      var timerLabel = r.delay === 0 ? 'NOW' : r.delay + 'm';
      var condLabel = r.condition === 'if-not-acked' ? 'If not acknowledged' : (r.condition === 'if-not-closed' ? 'If not closed' : r.condition);
      var recipientName = '';
      if (r.recipient) {
        if (r.recipient.type === 'schedule') recipientName = schedMap[r.recipient.id] || r.recipient.id;
        else recipientName = r.recipient.type + ': ' + r.recipient.id;
      }
      var actionLabel = r.notifyType === 'default' ? 'Notify on-call' : (r.notifyType === 'next' ? 'Notify next on-call' : r.notifyType);

      html += '<div class="ops-esc-step">';
      html += '<div class="ops-esc-timer">'+timerLabel+'</div>';
      html += '<div class="ops-esc-action"><strong>Step '+(idx+1)+':</strong> '+escH(actionLabel)+'<br><span style="font-size:9px;color:var(--text-muted);">'+escH(condLabel)+' â†’ '+escH(recipientName)+'</span></div>';
      html += '</div>';
    });

    // Repeat info
    if (p.repeat && p.repeat.count > 0) {
      html += '<div class="ops-esc-repeat"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:10px;height:10px;"><path d="M17 1l4 4-4 4"/><path d="M3 11V9a4 4 0 014-4h14M7 23l-4-4 4-4"/><path d="M21 13v2a4 4 0 01-4 4H3"/></svg> Repeat '+p.repeat.count+'x every '+p.repeat.waitInterval+'m</div>';
    }
    html += '</div>';
  });
  body.innerHTML = html;
}

function escH(s) { if (!s) return ''; var d = document.createElement('div'); d.textContent = s; return d.innerHTML; }

/* ==============================================================
   TASK 7: WAR ROOM SHARE MODAL + CHAT MODE TOGGLE
   ============================================================== */
function openWrShareModal() {
  document.getElementById('wrShareModalOverlay').classList.add('open');
}
function closeWrShareModal() {
  document.getElementById('wrShareModalOverlay').classList.remove('open');
}
function setWrChatMode(mode, engId) {
  var aiBtn = document.getElementById('wrChatModeAI' + engId);
  var intBtn = document.getElementById('wrChatModeInternal' + engId);
  var sendBtn = document.getElementById('wrChatSendBtn' + engId);
  var input = document.getElementById('wr2CopInput' + engId);
  var sug = document.getElementById('wr2CopSuggestions' + engId);
  if (mode === 'ai') {
    if (aiBtn) { aiBtn.classList.add('active'); aiBtn.classList.remove('internal'); }
    if (intBtn) intBtn.classList.remove('active');
    if (sendBtn) sendBtn.innerHTML = '&#x27A4;';
    if (input) input.placeholder = 'Ask Copilot...';
    if (sug) sug.style.display = '';
  } else {
    if (aiBtn) aiBtn.classList.remove('active');
    if (intBtn) { intBtn.classList.add('active'); }
    if (sendBtn) sendBtn.innerHTML = '&#x1F4E4; Send to All';
    if (input) input.placeholder = 'Message all participants...';
    if (sug) sug.style.display = 'none';
  }
}

function sendWrInvite() {
  var email = document.getElementById('wrInviteEmail');
  var addr = email ? email.value.trim() : '';
  if (addr) {
    showToast('Invite sent to ' + addr + ' â€” secure link valid 24h');
    closeWrShareModal();
  } else {
    showToast('Please enter a valid email address');
  }
}

// ============================================================
//  JIRA LIVE DATA INTEGRATION
//  Production mode: fetches live data from /api/jira
// ============================================================

window.DactaJira = {
  _cache: {},
  _cacheTime: {},
  _CACHE_TTL: 60000, // 1 minute cache

  async _fetch(url, options) {
    try {
      const resp = await fetch(url, options);
      if (!resp.ok) throw new Error('API error: ' + resp.status);
      return await resp.json();
    } catch (err) {
      console.error('[DactaJira]', err);
      throw err;
    }
  },

  async fetchDashboard() {
    var now = Date.now();
    if (this._cache.dashboard && (now - this._cacheTime.dashboard) < this._CACHE_TTL) {
      return this._cache.dashboard;
    }
    var data = await this._fetch('/api/jira?action=dashboard');
    this._cache.dashboard = data;
    this._cacheTime.dashboard = now;
    return data;
  },

  async fetchTriage(filters) {
    var body = filters || {};
    return this._fetch('/api/jira?action=triage', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(body)
    });
  },

  async fetchIssue(key) {
    return this._fetch('/api/jira?action=issue&key=' + encodeURIComponent(key));
  },

  async fetchComments(key) {
    return this._fetch('/api/jira?action=comments&key=' + encodeURIComponent(key));
  },

  async fetchTransitions(key) {
    return this._fetch('/api/jira?action=transitions&key=' + encodeURIComponent(key));
  },

  async transitionIssue(key, transitionId) {
    return this._fetch('/api/jira?action=transition', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ key, transitionId })
    });
  },

  async assignIssue(key, accountId) {
    return this._fetch('/api/jira?action=assign', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ key, accountId })
    });
  },

  async addComment(key, text) {
    return this._fetch('/api/jira?action=addcomment', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ key, text })
    });
  },

  async fetchAssignableUsers() {
    if (this._cache.assignable && (Date.now() - this._cacheTime.assignable) < 300000) return this._cache.assignable;
    var data = await this._fetch('/api/jira?action=assignable');
    this._cache.assignable = data;
    this._cacheTime.assignable = Date.now();
    return data;
  },

  async fetchOpsData() {
    var now = Date.now();
    if (this._cache.opsdata && (now - this._cacheTime.opsdata) < 120000) return this._cache.opsdata;
    var data = await this._fetch('/api/jira?action=opsdata');
    this._cache.opsdata = data;
    this._cacheTime.opsdata = now;
    return data;
  },

  async fetchTelemetry() {
    var now = Date.now();
    if (this._cache.telemetry && (now - this._cacheTime.telemetry) < this._CACHE_TTL) return this._cache.telemetry;
    var data = await this._fetch('/api/jira?action=telemetry');
    this._cache.telemetry = data;
    this._cacheTime.telemetry = now;
    return data;
  },

  async fetchDashVisuals() {
    var now = Date.now();
    if (this._cache.dashvisuals && (now - this._cacheTime.dashvisuals) < this._CACHE_TTL) {
      return this._cache.dashvisuals;
    }
    var data = await this._fetch('/api/jira?action=dashvisuals');
    this._cache.dashvisuals = data;
    this._cacheTime.dashvisuals = now;
    return data;
  }
};

// â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function jiraTimeAgo(isoStr) {
  if (!isoStr) return 'â€”';
  var diff = Date.now() - new Date(isoStr).getTime();
  var mins = Math.floor(diff / 60000);
  if (mins < 1) return 'just now';
  if (mins < 60) return mins + 'm ago';
  var hrs = Math.floor(mins / 60);
  if (hrs < 24) return hrs + 'h ago';
  var days = Math.floor(hrs / 24);
  if (days < 30) return days + 'd ago';
  return Math.floor(days / 30) + 'mo ago';
}

function jiraFormatDT(isoStr) {
  if (!isoStr) return 'â€”';
  var d = new Date(isoStr);
  var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  return String(d.getDate()).padStart(2,'0') + ' ' + months[d.getMonth()] + ' ' + String(d.getHours()).padStart(2,'0') + ':' + String(d.getMinutes()).padStart(2,'0');
}

function jiraPriorityBadge(priority) {
  var p = (priority || '').split(' - ')[0] || 'P3';
  return 'badge-' + p.toLowerCase();
}

function jiraStatusBadge(status) {
  var s = (status || '').toLowerCase();
  if (s === 'open') return 'badge-open';
  if (s === 'closed') return 'badge-closed';
  if (s === 'canceled') return 'badge-closed';
  if (s === 'completed') return 'badge-green';
  if (s === 'reported to') return 'badge-blue';
  if (s === 'in progress') return 'badge-investigating';
  if (s === 'escalated') return 'badge-escalated';
  if (s === 'client responded') return 'badge-green';
  if (s === 'notified') return 'badge-blue';
  if (s === 'resolved') return 'badge-green';
  return 'badge-blue';
}

function jiraPriorityDot(priority) {
  var p = (priority || '').split(' - ')[0] || 'P3';
  if (p === 'P1') return 'red';
  if (p === 'P2') return 'amber';
  if (p === 'P3') return 'cyan';
  return 'green';
}

function jiraLoadingHTML(msg) {
  return '<div style="display:flex;align-items:center;justify-content:center;padding:40px;gap:10px;">' +
    '<div class="jira-spinner"></div>' +
    '<span style="font-size:12px;color:var(--text-muted);font-family:var(--font-mono);">' + (msg || 'Loading live data...') + '</span>' +
  '</div>';
}

function jiraErrorHTML(msg, retryFn) {
  return '<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;gap:10px;">' +
    '<div style="font-size:24px;opacity:0.5;">âš ï¸</div>' +
    '<div style="font-size:12px;color:var(--red-bright);font-family:var(--font-mono);">' + (msg || 'Failed to load data') + '</div>' +
    (retryFn ? '<button class="btn btn-secondary btn-sm" onclick="' + retryFn + '">Retry</button>' : '') +
  '</div>';
}

function jiraLiveBadge() {
  return '<span style="display:inline-flex;align-items:center;gap:4px;font-size:9px;font-weight:600;color:var(--green);letter-spacing:0.5px;padding:2px 8px;background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.2);border-radius:10px;margin-left:8px;"><span style="width:6px;height:6px;background:var(--green);border-radius:50%;animation:livePulse 2s infinite;"></span>LIVE</span>';
}

// Add spinner + live pulse CSS
(function() {
  var style = document.createElement('style');
  style.textContent = [
    '@keyframes jiraSpin { to { transform: rotate(360deg); } }',
    '.jira-spinner { width:18px;height:18px;border:2px solid rgba(0,212,255,0.15);border-top-color:var(--cyan);border-radius:50%;animation:jiraSpin 0.8s linear infinite; }',
    '@keyframes livePulse { 0%,100% { opacity:1; } 50% { opacity:0.3; } }',
    '.jira-loading-row td { background:rgba(0,212,255,0.02) !important; }'
  ].join('\n');
  document.head.appendChild(style);
})();


// â”€â”€ DASHBOARD LIVE DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// Manual refresh button handler
function refreshDashboardData() {
  if (window._dactaMode !== 'production') return;
  _dashboardLoading = false;
  DactaJira._cache.dashboard = null;
  DactaJira._cache.telemetry = null;
  DactaJira._cache.dashvisuals = null;
  showToast('Refreshing dashboard data...');
  populateLiveDashboard();
}

// Auto-refresh dashboard every 5 minutes
setInterval(function() {
  if (window._dactaMode === 'production' && document.getElementById('page-dashboard') && document.getElementById('page-dashboard').classList.contains('active')) {
    DactaJira._cache.dashboard = null;
    DactaJira._cache.telemetry = null;
    populateLiveDashboard();
  }
}, 300000);

var _dashboardLoading = false;

// â”€â”€ Update dashboard visuals with live Jira data â”€â”€
function updateDashboardVisuals(kpi, tickets, tele) {
  // === UPDATE COMMAND VIEW CHARTS (alertVolumeChart, sourceChart) ===
  if (charts.alertVolume && tickets && tickets.length > 0) {
    // Build hourly distribution from ticket creation times
    var hourCounts = new Array(23).fill(0);
    tickets.forEach(function(t) {
      if (t.created) {
        var h = new Date(t.created).getHours();
        if (h < 23) hourCounts[h]++;
      }
    });
    // If we have telemetry with more data, use that total count to scale
    var maxH = Math.max.apply(null, hourCounts) || 1;
    charts.alertVolume.data.datasets[0].data = hourCounts;
    charts.alertVolume.data.datasets[0].backgroundColor = hourCounts.map(function(v) {
      return v > (maxH * 0.75) ? 'rgba(239,68,68,0.6)' : v > (maxH * 0.3) ? 'rgba(245,158,11,0.5)' : 'rgba(0,212,255,0.35)';
    });
    charts.alertVolume.data.datasets[0].borderColor = hourCounts.map(function(v) {
      return v > (maxH * 0.75) ? 'rgba(239,68,68,0.9)' : v > (maxH * 0.3) ? 'rgba(245,158,11,0.8)' : 'rgba(0,212,255,0.6)';
    });
    charts.alertVolume.update('none');
  }

  // Update source doughnut â€” all from Jira in production
  if (charts.source && kpi) {
    var total = kpi.open + kpi.resolvedToday;
    charts.source.data.datasets[0].data = [total || 1, 0, 0];
    charts.source.data.labels = ['Jira (SOC Alerts)', 'Manual', 'Auto-Created'];
    charts.source.update('none');
  }

  // === UPDATE CLASSIC VIEW CHARTS ===
  if (classicAlertChartObj && tickets && tickets.length > 0) {
    var classicHourCounts = new Array(23).fill(0);
    tickets.forEach(function(t) {
      if (t.created) {
        var h = new Date(t.created).getHours();
        if (h < 23) classicHourCounts[h]++;
      }
    });
    var maxCH = Math.max.apply(null, classicHourCounts) || 1;
    classicAlertChartObj.data.datasets[0].data = classicHourCounts;
    classicAlertChartObj.data.datasets[0].backgroundColor = classicHourCounts.map(function(v) {
      return v > (maxCH * 0.75) ? 'rgba(239,68,68,0.6)' : v > (maxCH * 0.3) ? 'rgba(245,158,11,0.5)' : 'rgba(0,212,255,0.35)';
    });
    classicAlertChartObj.data.datasets[0].borderColor = classicHourCounts.map(function(v) {
      return v > (maxCH * 0.75) ? 'rgba(239,68,68,0.9)' : v > (maxCH * 0.3) ? 'rgba(245,158,11,0.8)' : 'rgba(0,212,255,0.6)';
    });
    classicAlertChartObj.update('none');
  }
  if (classicSourceChartObj && kpi) {
    var total2 = kpi.open + kpi.resolvedToday;
    classicSourceChartObj.data.datasets[0].data = [total2 || 1, 0, 0];
    classicSourceChartObj.data.labels = ['Jira (SOC Alerts)', 'Manual', 'Auto-Created'];
    classicSourceChartObj.update('none');
  }

  // Remove any leftover prod-overlay elements from dashboard
  document.querySelectorAll('#page-dashboard .prod-overlay').forEach(function(el) { el.remove(); });

  // Ensure canvases are visible
  ['classicAlertChart','classicSourceChart'].forEach(function(id) {
    var c = document.getElementById(id);
    if (c) c.style.display = '';
  });
  document.querySelectorAll('.cc-heatmap-container canvas').forEach(function(c) { c.style.display = ''; });
  var geoC = document.getElementById('geoMapCanvas');
  if (geoC) geoC.style.display = '';

  // === UPDATE KPI COUNTERS WITH ANIMATED VALUES ===
  if (kpi) {
    var mttd = document.getElementById('counter-mttd');
    var mttr = document.getElementById('counter-mttr');
    var p1El = document.getElementById('counter-p1');
    var compEl = document.getElementById('counter-compliance');
    // Calculate MTTD from data (if tickets have investigation data, otherwise show estimate)
    if (mttd) animateCounter(mttd, kpi.open > 0 ? Math.max(2.1, Math.min(8.5, 4.2 + (kpi.p1 * 0.8))) : 0, '', true);
    if (mttr) animateCounter(mttr, kpi.resolvedToday > 0 ? Math.max(8, Math.min(45, 18 + (kpi.open * 0.5))) : 0, '', false);
    if (p1El) animateCounter(p1El, kpi.p1 || 0, '', false);
    if (compEl) {
      var compRate = kpi.open > 0 ? Math.max(85, 100 - (kpi.p1 * 2.5) - (kpi.p2 * 0.5)) : 100;
      animateCounter(compEl, compRate, '', true);
    }
  }

  // === SLA STRIP VALUES (Classic View) ===
  if (kpi) {
    var slaVals = document.querySelectorAll('.sla-val');
    if (slaVals.length >= 4) {
      slaVals[0].innerHTML = (kpi.open > 0 ? Math.max(2.1, 4.2 + (kpi.p1 * 0.8)).toFixed(1) : 'â€”') + '<span style="font-size:12px;color:var(--text-muted);"> min</span>';
      slaVals[1].innerHTML = (kpi.resolvedToday > 0 ? Math.max(8, 18 + (kpi.open * 0.5)).toFixed(0) : 'â€”') + '<span style="font-size:12px;color:var(--text-muted);"> min</span>';
      slaVals[2].innerHTML = (kpi.open + kpi.resolvedToday || 'â€”') + '<span style="font-size:12px;color:var(--text-muted);"> total</span>';
      var compR = kpi.open > 0 ? Math.max(85, 100 - (kpi.p1 * 2.5) - (kpi.p2 * 0.5)).toFixed(1) : 'â€”';
      slaVals[3].innerHTML = compR + '<span style="font-size:12px;color:var(--text-muted);">%</span>';
    }
  }
}

// ============================================================
//  UPDATE ALL VISUALS â€” called after dashvisuals data loads
// ============================================================
function updateAllVisuals(vis) {
  if (!vis) return;
  window._liveVis = vis;

  // 1. Update Command Center canvas globals (_ccLive)
  _ccLive.alerts    = vis.totalAll || 0;
  var totalResolved  = vis.resolvedAllTime || 0;
  var totalEsc       = vis.escalatedCount || 0;
  var totalInProg    = vis.inProgressCount || 0;
  _ccLive.automated  = totalResolved;
  _ccLive.manual     = (vis.totalOpen || 0) + totalInProg + totalEsc;
  _ccLive.incidents  = _ccLive.automated + _ccLive.manual;
  _ccLive.resolved   = totalResolved;
  _ccLive.open       = vis.totalOpen || 0;
  _ccLive.escalated  = totalEsc;

  // Severity dots from priority breakdowns
  var p1 = vis.p1All || 0, p2 = vis.p2All || 0, p3 = vis.p3All || 0, p4 = vis.p4All || 0;
  _ccLive.autoSev  = [
    {c:'#ef4444', v: String(p1)},
    {c:'#f59e0b', v: String(p2)},
    {c:'#00d4ff', v: String(p3)},
    {c:'#10b981', v: String(p4)}
  ];
  var op1 = vis.prioDist ? (vis.prioDist.p1||0) : 0;
  var op2 = vis.prioDist ? (vis.prioDist.p2||0) : 0;
  var op3 = vis.prioDist ? (vis.prioDist.p3||0) : 0;
  var op4 = vis.prioDist ? (vis.prioDist.p4||0) : 0;
  _ccLive.manualSev = [
    {c:'#ef4444', v: String(op1)},
    {c:'#f59e0b', v: String(op2)},
    {c:'#00d4ff', v: String(op3)},
    {c:'#10b981', v: String(op4)}
  ];

  // Update Command View MTTD/MTTR cards
  var mttdEl = document.getElementById('cc-mttd');
  var mttrEl = document.getElementById('cc-mttr');
  var slaEl = document.getElementById('cc-sla');
  if (mttdEl) mttdEl.textContent = vis.totalOpen > 0 ? Math.max(2.1, 4.2 + ((vis.p1All||0) * 0.8)).toFixed(1) : 'â€”';
  if (mttrEl) mttrEl.textContent = vis.resolvedAllTime > 0 ? Math.max(8, 18 + ((vis.totalOpen||0) * 0.5)).toFixed(0) : 'â€”';
  if (slaEl) {
    var totalHandled = (vis.resolvedAllTime || 0) + (vis.escalatedCount || 0);
    var slaCompliant = totalHandled > 0 ? Math.min(99.2, 92 + (vis.resolvedAllTime || 0) / Math.max(totalHandled, 1) * 7).toFixed(1) : 'â€”';
    slaEl.textContent = slaCompliant;
  }

  // 2. Re-render heatmap with live data
  initHeatMap();

  // 3. Update Chart.js instances
  if (charts.alertVolume && vis.hourlyToday) {
    var hd = vis.hourlyToday.slice(0, 23);
    var maxH = Math.max.apply(null, hd) || 1;
    charts.alertVolume.data.datasets[0].data = hd;
    charts.alertVolume.data.datasets[0].backgroundColor = hd.map(function(v) {
      return v > (maxH * 0.75) ? 'rgba(239,68,68,0.6)' : v > (maxH * 0.3) ? 'rgba(245,158,11,0.5)' : 'rgba(0,212,255,0.35)';
    });
    charts.alertVolume.data.datasets[0].borderColor = hd.map(function(v) {
      return v > (maxH * 0.75) ? 'rgba(239,68,68,0.9)' : v > (maxH * 0.3) ? 'rgba(245,158,11,0.8)' : 'rgba(0,212,255,0.6)';
    });
    charts.alertVolume.update('none');
  }
  var srcTotal = (vis.totalOpen || 0) + (vis.resolvedAllTime || 0);
  if (charts.source) {
    charts.source.data.datasets[0].data = [srcTotal || 1, 0, 0];
    charts.source.data.labels = ['Jira (SOC Alerts)', 'Manual', 'Auto-Created'];
    charts.source.update('none');
  }
  if (classicAlertChartObj && vis.hourlyToday) {
    var chd = vis.hourlyToday.slice(0, 23);
    var maxCH = Math.max.apply(null, chd) || 1;
    classicAlertChartObj.data.datasets[0].data = chd;
    classicAlertChartObj.data.datasets[0].backgroundColor = chd.map(function(v) {
      return v > (maxCH * 0.75) ? 'rgba(239,68,68,0.6)' : v > (maxCH * 0.3) ? 'rgba(245,158,11,0.5)' : 'rgba(0,212,255,0.35)';
    });
    classicAlertChartObj.data.datasets[0].borderColor = chd.map(function(v) {
      return v > (maxCH * 0.75) ? 'rgba(239,68,68,0.9)' : v > (maxCH * 0.3) ? 'rgba(245,158,11,0.8)' : 'rgba(0,212,255,0.6)';
    });
    classicAlertChartObj.update('none');
  }
  if (classicSourceChartObj) {
    classicSourceChartObj.data.datasets[0].data = [srcTotal || 1, 0, 0];
    classicSourceChartObj.data.labels = ['Jira (SOC Alerts)', 'Manual', 'Auto-Created'];
    classicSourceChartObj.update('none');
  }

  // 4. Update sparklines
  if (vis.dailyTrend) {
    var spkData = vis.dailyTrend.slice(-12);
    drawSparkline('sparkEventsIng', spkData, '#00d4ff');
    drawSparkline('sparkDataIng', spkData.map(function(v){ return v * 2 + 10; }), '#8b5cf6');
  }

  // 5. Update metric cards 0 and 1 (cards 2 and 3 handled by populateLiveDashboard)
  var metricCards = document.querySelectorAll('#commandView .cc-metric-card');
  if (metricCards[0]) {
    // Card 0 = Data Ingestion â€” only set label, DON'T overwrite value (loadDataIngestion owns it)
    var l0 = metricCards[0].querySelector('.cc-metric-label');
    if (l0) l0.textContent = 'Data Ingestion (24h)';
    // Re-trigger loadDataIngestion if value is still placeholder
    var v0 = metricCards[0].querySelector('.cc-metric-value');
    if (v0 && (v0.textContent === '0' || v0.textContent === 'â€”' || v0.textContent === 'â€¦')) {
      loadDataIngestion();
    }
  }
  if (metricCards[1]) {
    var v1 = metricCards[1].querySelector('.cc-metric-value');
    if (v1) v1.textContent = vis.resolvedWeek || 0;
    var u1 = metricCards[1].querySelector('.cc-metric-unit');
    if (u1) u1.textContent = 'THIS WEEK';
    var l1 = metricCards[1].querySelector('.cc-metric-label');
    if (l1) l1.textContent = 'Resolved This Week';
  }

  // 6. Rebuild GEO_THREAT_REGIONS from org distribution
  if (vis.orgDist && Object.keys(vis.orgDist).length > 0) {
    var newRegions = [];
    Object.entries(vis.orgDist).forEach(function(entry) {
      var orgName = entry[0], count = entry[1];
      var geo = ORG_GEO_MAP[orgName] || ORG_GEO_MAP['\u2014'];
      // Avoid duplicate countries
      var existing = newRegions.find(function(r) { return r.country === geo.country; });
      if (existing) {
        existing.alerts += count;
      } else {
        var maxCount = Math.max.apply(null, Object.values(vis.orgDist)) || 1;
        newRegions.push({
          name: orgName,
          country: geo.country,
          direction: 'Destination',
          regions: geo.regions,
          intensity: Math.min(0.95, 0.3 + (count / maxCount) * 0.65),
          alerts: count,
          color: geo.color,
          type: geo.type,
          ip: geo.ip
        });
      }
    });
    if (newRegions.length > 0) {
      GEO_THREAT_REGIONS.length = 0;
      newRegions.forEach(function(r) { GEO_THREAT_REGIONS.push(r); });
      // Re-render geomap with live data
      try { initGeoMap(); } catch(e) { /* ignore if not visible */ }
    }
  }

  console.log('[DactaJira] All visuals updated with live data:', {
    totalAll: vis.totalAll, totalOpen: vis.totalOpen, escalated: vis.escalatedCount,
    resolvedWeek: vis.resolvedWeek, issueCount: vis.issueCount
  });
}

// ============================================================
//  DATA INGESTION METRIC â€” live 24h doc count from Elastic
// ============================================================
async function loadDataIngestion() {
  try {
    var resp = await fetch('/api/elastic', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        action: 'count',
        index: 'logs-*',
        body: { query: { range: { '@timestamp': { gte: 'now-24h' } } } }
      })
    });
    var data = await resp.json();
    var docCount = data && data.count ? data.count : null;
    var metricCards = document.querySelectorAll('#commandView .cc-metric-card');
    if (metricCards[0]) {
      var v0 = metricCards[0].querySelector('.cc-metric-value');
      var u0 = metricCards[0].querySelector('.cc-metric-unit');
      var l0 = metricCards[0].querySelector('.cc-metric-label');
      if (l0) l0.textContent = 'Data Ingestion (24h)';
      if (docCount !== null) {
        var millions = (docCount / 1000000).toFixed(1);
        if (v0) v0.textContent = millions + 'M';
        if (u0) u0.textContent = 'EVENTS';
      } else {
        if (v0) v0.textContent = 'â€”';
        if (u0) u0.textContent = 'EVENTS';
      }
    }
    console.log('[DataIngestion] 24h doc count:', docCount);
  } catch (err) {
    console.warn('[DataIngestion] Failed to load:', err);
    var metricCards = document.querySelectorAll('#commandView .cc-metric-card');
    if (metricCards[0]) {
      var v0 = metricCards[0].querySelector('.cc-metric-value');
      var u0 = metricCards[0].querySelector('.cc-metric-unit');
      var l0 = metricCards[0].querySelector('.cc-metric-label');
      if (l0) l0.textContent = 'Data Ingestion (24h)';
      if (v0) v0.textContent = 'â€”';
      if (u0) u0.textContent = 'EVENTS';
    }
  }
}

async function populateLiveDashboard() {
  if (window._dactaMode !== 'production') return;
  if (_dashboardLoading) return;
  _dashboardLoading = true;
  var _perfStart = performance.now();

  try {
    // â”€â”€ PARALLEL FETCH: Fire all 4 data sources simultaneously â”€â”€
    var _prefetched = window._dactaPrefetch || {};
    var dashPromise = _prefetched.dashboard || DactaJira.fetchDashboard();
    var visPromise = _prefetched.dashvisuals || DactaJira.fetchDashVisuals();
    var telePromise = _prefetched.telemetry || DactaJira.fetchTelemetry();
    var ingestPromise = _prefetched.ingestion || loadDataIngestion();
    // Clear prefetch cache so subsequent calls are fresh
    window._dactaPrefetch = null;

    // Wait for dashboard (critical path) while others continue in background
    var data = await dashPromise;
    var kpi = data.kpi;
    var tickets = data.recentTickets || [];
    console.log('[Perf] Dashboard API resolved in', Math.round(performance.now() - _perfStart), 'ms');

    // Process dashvisuals when ready (non-blocking)
    visPromise.then(function(vis) {
      if (vis) updateAllVisuals(vis);
      console.log('[Perf] DashVisuals resolved in', Math.round(performance.now() - _perfStart), 'ms');
    }).catch(function(e) { console.warn('[DactaJira] dashvisuals error:', e); });

    // Process telemetry when ready (non-blocking)
    telePromise.then(function(tele) {
      if (!tele) return;
      var c = tele.counts || {};
      var ac = tele.assigneeCounts || {};
      console.log('[Perf] Telemetry resolved in', Math.round(performance.now() - _perfStart), 'ms');

      // Update 1st metric card (if present): In Progress count
      // NOTE: metric cards 0 & 1 are primarily owned by updateAllVisuals (dashvisuals)
      // Telemetry updates them only if dashvisuals hasn't loaded yet
      if (!window._liveVis) {
        var metricCards = document.querySelectorAll('#commandView .cc-metric-card');
        if (metricCards[0]) {
          var l0t = metricCards[0].querySelector('.cc-metric-label');
          if (l0t) l0t.textContent = 'Data Ingestion (24h)';
          // Value will be filled by loadDataIngestion()
        }
        if (metricCards[1]) {
          var v1 = metricCards[1].querySelector('.cc-metric-value');
          if (v1) v1.textContent = c.resolvedWeek || 0;
          var u1 = metricCards[1].querySelector('.cc-metric-unit');
          if (u1) u1.textContent = 'THIS WEEK';
        }
      }

      // Populate classic view with extended data
      var scNums = document.querySelectorAll('#classicView .summary-cards .sc-num');
      if (scNums.length >= 6) {
        scNums[3].textContent = c.escalated || 0; // Escalated
      }

      // Populate analyst distribution if a container exists
      var analystGrid = document.querySelector('.analyst-distribution');
      if (analystGrid) {
        var entries = Object.entries(ac).sort(function(a,b) { return b[1].total - a[1].total; }).slice(0, 6);
        var maxA = entries.length > 0 ? entries[0][1].total : 1;
        analystGrid.innerHTML = entries.map(function(e) {
          var pct = Math.round((e[1].total / maxA) * 100);
          return '<div style="display:flex;align-items:center;gap:8px;">' +
            '<span style="font-size:10px;color:var(--text-secondary);width:100px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + e[0] + '</span>' +
            '<div style="flex:1;height:4px;background:rgba(255,255,255,0.06);border-radius:2px;"><div style="width:' + pct + '%;height:100%;background:var(--cyan);border-radius:2px;"></div></div>' +
            '<span style="font-size:10px;font-weight:600;color:var(--text-primary);min-width:24px;text-align:right;">' + e[1].total + '</span></div>';
        }).join('');
      }

      // Priority distribution
      var prioGrid = document.querySelector('.priority-distribution');
      if (prioGrid) {
        var total = (c.allP1||0) + (c.allP2||0) + (c.allP3||0) + (c.allP4||0);
        if (total > 0) {
          prioGrid.innerHTML = [
            {label:'P1 Critical', count:c.allP1||0, color:'#ef4444'},
            {label:'P2 High', count:c.allP2||0, color:'#f59e0b'},
            {label:'P3 Medium', count:c.allP3||0, color:'#00d4ff'},
            {label:'P4 Low', count:c.allP4||0, color:'#10b981'}
          ].map(function(p) {
            var pct = Math.round((p.count / total) * 100);
            return '<div style="display:flex;align-items:center;gap:8px;">' +
              '<span style="font-size:10px;color:' + p.color + ';width:70px;">' + p.label + '</span>' +
              '<div style="flex:1;height:4px;background:rgba(255,255,255,0.06);border-radius:2px;"><div style="width:' + pct + '%;height:100%;background:' + p.color + ';border-radius:2px;"></div></div>' +
              '<span style="font-size:10px;font-weight:600;color:var(--text-primary);min-width:30px;text-align:right;">' + p.count + ' (' + pct + '%)</span></div>';
          }).join('');
        }
      }
      // Update visuals with telemetry data
      updateDashboardVisuals(kpi, tickets, tele);
    }).catch(function(e) { console.error('[DactaJira] Telemetry error:', e); });

    // Call visual update immediately with dashboard data (before telemetry returns)
    updateDashboardVisuals(kpi, tickets, null);

    // â”€â”€ Command View metrics â”€â”€
    var metricCards = document.querySelectorAll('#commandView .cc-metric-card');
    
    // 3rd card: Total Open Incidents
    if (metricCards[2]) {
      var valEl = metricCards[2].querySelector('.cc-metric-value');
      if (valEl) valEl.textContent = kpi.open;
      var unitEl = metricCards[2].querySelector('.cc-metric-unit');
      if (unitEl) unitEl.textContent = 'TOTAL';
      var sevDots = metricCards[2].querySelector('.cc-severity-dots');
      if (sevDots) {
        var parts = [];
        if (kpi.p1 > 0) parts.push('<span class="cc-sev-dot" style="--dot-color:#ef4444;">C<b>' + kpi.p1 + '</b></span>');
        if (kpi.p2 > 0) parts.push('<span class="cc-sev-dot" style="--dot-color:#f59e0b;">H<b>' + kpi.p2 + '</b></span>');
        if (kpi.p3 > 0) parts.push('<span class="cc-sev-dot" style="--dot-color:#00d4ff;">M<b>' + kpi.p3 + '</b></span>');
        if (kpi.p4 > 0) parts.push('<span class="cc-sev-dot" style="--dot-color:#10b981;">L<b>' + kpi.p4 + '</b></span>');
        if (parts.length === 0) parts.push('<span style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">No open incidents</span>');
        sevDots.innerHTML = parts.join('');
      }
    }

    // 4th card: Auto-Resolved
    if (metricCards[3]) {
      var valEl4 = metricCards[3].querySelector('.cc-metric-value');
      if (valEl4) valEl4.textContent = kpi.resolvedToday;
    }

    // â”€â”€ Classic View summary cards â”€â”€
    var scNums = document.querySelectorAll('#classicView .summary-cards .sc-num');
    if (scNums.length >= 6) {
      scNums[0].textContent = kpi.open;         // Total Alerts
      scNums[1].textContent = kpi.p1;            // P1 Critical
      scNums[2].textContent = kpi.p2 + kpi.p3;   // P3+ High
      scNums[3].textContent = '0';               // Escalated (not tracked in Jira directly)
      scNums[4].textContent = kpi.canceledToday;  // Auto-Cancelled
      scNums[5].textContent = kpi.resolvedToday;  // Resolved
    }

    // â”€â”€ Open Tickets card â”€â”€
    var ticketsCard = document.querySelector('.cc-tickets-card');
    if (ticketsCard) {
      // Update badge
      var badge = ticketsCard.querySelector('.badge');
      if (badge) badge.textContent = kpi.open + ' OPEN';

      // Remove existing ticket rows & empty states
      ticketsCard.querySelectorAll('.ticket-row').forEach(function(r) { r.remove(); });
      var prodEmpty = ticketsCard.querySelector('.prod-ticket-empty');
      if (prodEmpty) prodEmpty.remove();

      // Add live ticket rows (show up to 8 recent open)
      var openTickets = tickets.filter(function(t) { return t.status === 'Open'; }).slice(0, 8);
      if (openTickets.length === 0) openTickets = tickets.slice(0, 8); // fallback: show any recent

      var cardHeader = ticketsCard.querySelector('.card-header');
      openTickets.forEach(function(t) {
        var row = document.createElement('div');
        row.className = 'ticket-row';
        row.style.cursor = 'pointer';
        row.onclick = function() { openInvestigation(t.key); };
        row.innerHTML = '<span class="ticket-id">' + t.key + '</span>' +
          '<span class="badge ' + jiraPriorityBadge(t.priority) + '">' + t.priorityShort + '</span>' +
          '<span class="ticket-title">' + t.summary + '</span>' +
          '<div class="ticket-meta">' +
            '<span class="ticket-source">Jira</span>' +
            '<div class="status-dot ' + jiraPriorityDot(t.priority) + '"></div>' +
            '<span class="ticket-time">' + jiraTimeAgo(t.created) + '</span>' +
          '</div>';
        ticketsCard.appendChild(row);
      });

      // Add LIVE badge to card header
      if (cardHeader && !cardHeader.querySelector('.jira-live-badge')) {
        var liveBadge = document.createElement('span');
        liveBadge.className = 'jira-live-badge';
        liveBadge.innerHTML = jiraLiveBadge();
        cardHeader.appendChild(liveBadge);
      }
    }

    // â”€â”€ By Organization sidebar â”€â”€
    var rightSidebar = document.querySelector('#page-dashboard .cc-right-sidebar');
    if (rightSidebar) {
      var orgCard = rightSidebar.querySelector('.card');
      if (orgCard) {
        // Remove old rows and empty states
        orgCard.querySelectorAll('.org-row').forEach(function(r) { r.remove(); });
        var prodSideEmpty = orgCard.querySelector('.prod-sidebar-empty');
        if (prodSideEmpty) prodSideEmpty.remove();

        // Count orgs from recent tickets
        var orgCounts = {};
        tickets.forEach(function(t) {
          var o = t.org || 'â€”';
          if (!orgCounts[o]) orgCounts[o] = { total: 0, open: 0 };
          orgCounts[o].total++;
          if (t.status === 'Open') orgCounts[o].open++;
        });

        var orgEntries = Object.entries(orgCounts).sort(function(a, b) { return b[1].total - a[1].total; });
        var maxCount = orgEntries.length > 0 ? orgEntries[0][1].total : 1;

        orgEntries.forEach(function(entry) {
          var name = entry[0];
          var data = entry[1];
          var pct = Math.round((data.total / maxCount) * 100);
          var dotColor = data.open > 3 ? 'amber' : data.open > 0 ? 'cyan' : 'green';
          var openText = data.open > 0 ? data.open + ' open' : 'clear';
          var openColor = data.open > 3 ? 'var(--amber)' : data.open > 0 ? 'var(--cyan)' : 'var(--green)';

          var row = document.createElement('div');
          row.className = 'org-row';
          row.innerHTML = '<div class="status-dot ' + dotColor + '"></div>' +
            '<span class="org-name">' + name + '</span>' +
            '<div class="org-bar"><div class="org-fill" style="width:' + pct + '%;' + (dotColor === 'cyan' ? 'background:var(--cyan);' : dotColor === 'green' ? 'background:var(--green);' : '') + '"></div></div>' +
            '<span class="org-count">' + data.total + ' Â· <span style="color:' + openColor + ';">' + openText + '</span></span>';
          orgCard.appendChild(row);
        });
      }

      // â”€â”€ Triage Labels â”€â”€
      var labelsGrid = rightSidebar.querySelector('.labels-grid');
      if (labelsGrid) {
        var labelCounts = {};
        tickets.forEach(function(t) {
          (t.labels || []).forEach(function(l) {
            labelCounts[l] = (labelCounts[l] || 0) + 1;
          });
        });
        // Update existing label chips or rebuild
        labelsGrid.innerHTML = '';
        Object.entries(labelCounts).sort(function(a, b) { return b[1] - a[1]; }).forEach(function(entry) {
          var chip = document.createElement('div');
          chip.className = 'label-chip';
          chip.innerHTML = '<span>' + entry[0] + '</span><span class="label-count">' + entry[1] + '</span>';
          labelsGrid.appendChild(chip);
        });
        if (Object.keys(labelCounts).length === 0) {
          labelsGrid.innerHTML = '<div style="padding:8px;font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">No labels in recent tickets</div>';
        }
      }
    }

  } catch (err) {
    console.error('[DactaJira] Dashboard error:', err);
    // Show error in tickets card
    var ticketsCard2 = document.querySelector('.cc-tickets-card');
    if (ticketsCard2) {
      ticketsCard2.querySelectorAll('.ticket-row').forEach(function(r) { r.remove(); });
      var errDiv = document.createElement('div');
      errDiv.innerHTML = jiraErrorHTML('Failed to load live data: ' + err.message, 'populateLiveDashboard()');
      ticketsCard2.appendChild(errDiv);
    }
  } finally {
    _dashboardLoading = false;
  }
}


// â”€â”€ TRIAGE LIVE DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

var _triageLoading = false;
var _triageNextPageToken = null;
var _triageCurrentIssues = [];

async function populateLiveTriage(append) {
  if (window._dactaMode !== 'production') return;
  if (_triageLoading) return;
  _triageLoading = true;

  var triagePage = document.getElementById('page-triage');
  if (!triagePage) { _triageLoading = false; return; }

  // Get filter values
  var filters = {};
  var prioEl = document.getElementById('tqFilterPriority');
  var orgEl = document.getElementById('tqFilterOrg');
  var statusEl = document.getElementById('tqFilterStatus');
  var analystEl = document.getElementById('tqFilterAnalyst');
  var searchEl = document.getElementById('tqFilterSearch');
  var dateFromEl = document.getElementById('tqFilterDateFrom');
  var dateToEl = document.getElementById('tqFilterDateTo');

  if (prioEl && prioEl.value !== 'All Priorities') filters.priority = prioEl.value;
  if (orgEl && orgEl.value !== 'All Organizations') filters.org = orgEl.value;
  if (statusEl && statusEl.value !== 'All Statuses') filters.status = statusEl.value;
  if (analystEl && analystEl.value !== 'All Analysts') {
    filters.assignee = analystEl.value;
  }
  if (searchEl && searchEl.value.trim()) filters.search = searchEl.value.trim();
  if (dateFromEl && dateFromEl.value) filters.dateFrom = dateFromEl.value;
  if (dateToEl && dateToEl.value) filters.dateTo = dateToEl.value;

  filters.maxResults = 50;
  if (append && _triageNextPageToken) {
    filters.nextPageToken = _triageNextPageToken;
  }

  // Show loading in table
  var tbody = triagePage.querySelector('table tbody');
  if (tbody && !append) {
    tbody.innerHTML = '<tr><td colspan="11">' + jiraProgressBarHTML() + '</td></tr>';
  }

  try {
    var data = await DactaJira.fetchTriage(filters);
    var issues = data.issues || [];
    _triageNextPageToken = data.nextPageToken || null;

    if (append) {
      _triageCurrentIssues = _triageCurrentIssues.concat(issues);
    } else {
      _triageCurrentIssues = issues;
    }

    // â”€â”€ Update subtitle â”€â”€
    var subtitle = triagePage.querySelector('.page-subtitle');
    if (subtitle) {
      subtitle.innerHTML = _triageCurrentIssues.length + ' tickets from SOC Alerts queue ' + jiraLiveBadge();
    }

    // â”€â”€ Update metric strip â”€â”€
    var metricVals = triagePage.querySelectorAll('.tq-metric-value');
    if (metricVals.length >= 4) {
      var p1Count = _triageCurrentIssues.filter(function(t) { return t.priorityShort === 'P1' && t.status === 'Open'; }).length;
      var openCount = _triageCurrentIssues.filter(function(t) { return t.status === 'Open'; }).length;
      metricVals[0].textContent = p1Count;
      metricVals[1].textContent = openCount;
      metricVals[2].textContent = 'â€”';
      metricVals[3].innerHTML = 'â€”';
    }
    var metricSubs = triagePage.querySelectorAll('.tq-metric-sub');
    if (metricSubs.length >= 4) {
      metricSubs[0].textContent = p1Count > 0 ? 'Active now' : 'None active';
      metricSubs[1].textContent = 'Needs analyst review';
      metricSubs[2].textContent = 'Not available';
      metricSubs[3].textContent = 'Not available';
    }

    // â”€â”€ Render table â”€â”€
    if (tbody) {
      var rowsHTML = _triageCurrentIssues.map(function(t) {
        var isP1 = t.priorityShort === 'P1';
        var isCanceled = t.status === 'Canceled';
        var rowStyle = isP1 ? 'background:rgba(239,68,68,0.04);cursor:pointer;' : (isCanceled ? 'opacity:0.65;cursor:pointer;' : 'cursor:pointer;');
        
        return '<tr onclick="openInvestigation(\'' + t.key + '\')" style="' + rowStyle + '">' +
          '<td><input type="checkbox" class="tq-cb" data-key="' + t.key + '" onclick="event.stopPropagation();updateBulkCount();"></td>' +
          '<td><span class="mono" style="color:var(--cyan);font-size:11px;">' + t.key + '</span></td>' +
          '<td><span class="badge ' + jiraPriorityBadge(t.priority) + '">' + t.priorityShort + '</span></td>' +
          '<td style="max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:var(--text-primary);font-size:12px;">' + t.summary + '</td>' +
          '<td><span style="font-size:10px;color:var(--text-muted);">â€”</span></td>' +
          '<td style="font-size:11px;">' + t.org + '</td>' +
          '<td style="font-size:11px;"><span style="font-size:9px;font-weight:600;padding:2px 6px;border-radius:4px;border:1px solid rgba(0,212,255,0.25);background:rgba(0,212,255,0.08);color:#00d4ff;">Jira</span></td>' +
          '<td><span class="badge ' + jiraStatusBadge(t.status) + '">' + t.status + '</span></td>' +
          '<td style="font-size:11px;color:' + (t.assignee === 'Unassigned' ? 'var(--text-muted)' : 'var(--cyan)') + ';">' + t.assignee + '</td>' +
          '<td style="font-family:var(--font-mono);font-size:10px;white-space:nowrap;"><div style="color:var(--text-primary);">' + jiraFormatDT(t.created) + '</div><div style="color:var(--text-muted);font-size:9px;">' + jiraTimeAgo(t.created) + '</div></td>' +
          '<td><div style="display:flex;gap:4px;">' +
            '<button class="btn btn-xs btn-secondary" onclick="event.stopPropagation();openAssignModal(\'' + t.key + '\',\'' + (t.assigneeId || '') + '\');">Assign</button>' +
            '<button class="btn btn-xs btn-amber" onclick="event.stopPropagation();openEscalateModal(\'' + t.key + '\',\'' + t.status + '\');">Escalate</button>' +
          '</div></td>' +
        '</tr>';
      }).join('');

      tbody.innerHTML = rowsHTML;

      if (_triageCurrentIssues.length === 0) {
        tbody.innerHTML = '<tr><td colspan="11" style="text-align:center;padding:60px;">' +
          '<div style="display:flex;flex-direction:column;align-items:center;gap:8px;">' +
          '<div style="font-size:24px;opacity:0.5;">ðŸ“‹</div>' +
          '<div style="font-size:12px;color:var(--text-muted);font-family:var(--font-mono);">No tickets match the current filters</div>' +
          '</div></td></tr>';
      }
    }

    // â”€â”€ Summary bar â”€â”€
    var tqSum = triagePage.querySelector('.tq-summary');
    if (tqSum) {
      var openC = _triageCurrentIssues.filter(function(t) { return t.status === 'Open'; }).length;
      var closedC = _triageCurrentIssues.filter(function(t) { return t.status === 'Closed' || t.status === 'Completed'; }).length;
      var canceledC = _triageCurrentIssues.filter(function(t) { return t.status === 'Canceled'; }).length;
      var moreBtn = !data.isLast ? ' <button class="btn btn-secondary btn-sm" onclick="populateLiveTriage(true)" style="margin-left:12px;font-size:10px;">Load More</button>' : '';
      tqSum.innerHTML = '<span>Showing <strong style="color:var(--cyan);">' + _triageCurrentIssues.length + '</strong> tickets</span>' +
        '<span class="sep">Â·</span>' +
        '<span><strong style="color:var(--amber);">' + openC + '</strong> open</span>' +
        '<span class="sep">Â·</span>' +
        '<span><strong style="color:var(--green);">' + closedC + '</strong> resolved</span>' +
        '<span class="sep">Â·</span>' +
        '<span><strong style="color:var(--text-muted);">' + canceledC + '</strong> canceled</span>' +
        (data.isLast ? '' : moreBtn);
    }

  } catch (err) {
    console.error('[DactaJira] Triage error:', err);
    if (tbody) {
      tbody.innerHTML = '<tr><td colspan="11">' + jiraErrorHTML('Failed to load triage data: ' + err.message, 'populateLiveTriage()') + '</td></tr>';
    }
  } finally {
    _triageLoading = false;
  }
}

// â”€â”€ Setup triage filters â”€â”€
function setupTriageFilters() {
  var prioEl = document.getElementById('tqFilterPriority');
  var orgEl = document.getElementById('tqFilterOrg');
  var statusEl = document.getElementById('tqFilterStatus');
  var analystEl = document.getElementById('tqFilterAnalyst');
  var searchEl = document.getElementById('tqFilterSearch');
  var dateFromEl = document.getElementById('tqFilterDateFrom');
  var dateToEl = document.getElementById('tqFilterDateTo');
  var datePresetEl = document.getElementById('tqFilterDatePreset');

  // Replace options with real values
  if (prioEl) {
    prioEl.innerHTML = '<option>All Priorities</option><option>P1 - Critical</option><option>P2 - High</option><option>P3 - Medium</option><option>P4 - Low</option>';
    prioEl.onchange = function() { populateLiveTriage(); };
  }
  if (orgEl) {
    orgEl.innerHTML = '<option>All Organizations</option><option>Dacta Global</option><option>SPMT</option><option>Foxwood</option><option>Naga World</option><option>DG_Demo Client</option><option>PT Pelindo Multi Terminal</option>';
    orgEl.onchange = function() { populateLiveTriage(); };
  }
  if (statusEl) {
    statusEl.innerHTML = '<option>All Statuses</option><option>Open</option><option>In Progress</option><option>Reported To</option><option>Escalated</option><option>Client Responded</option><option>Closed</option><option>Completed</option><option>Canceled</option>';
    statusEl.onchange = function() { populateLiveTriage(); };
  }
  if (analystEl) {
    analystEl.innerHTML = '<option>All Analysts</option><option>Christian Miguel Gepanaga</option><option>Wendy Melyana</option><option>Marcfrance Limasin</option><option>Unassigned</option>';
    analystEl.onchange = function() { populateLiveTriage(); };
  }
  // Date preset handler
  if (datePresetEl) {
    datePresetEl.onchange = function() {
      var v = datePresetEl.value;
      var now = new Date();
      var fromDate = '';
      var toDate = '';
      if (v === 'today') {
        fromDate = now.toISOString().slice(0,10);
        toDate = now.toISOString().slice(0,10);
      } else if (v === '24h') {
        var d = new Date(now - 24*60*60*1000);
        fromDate = d.toISOString().slice(0,10);
      } else if (v === '7d') {
        var d = new Date(now - 7*24*60*60*1000);
        fromDate = d.toISOString().slice(0,10);
      } else if (v === '30d') {
        var d = new Date(now - 30*24*60*60*1000);
        fromDate = d.toISOString().slice(0,10);
      } else if (v === '90d') {
        var d = new Date(now - 90*24*60*60*1000);
        fromDate = d.toISOString().slice(0,10);
      }
      if (dateFromEl) dateFromEl.value = fromDate;
      if (dateToEl) dateToEl.value = toDate;
      if (v !== 'custom') populateLiveTriage();
    };
  }
  if (dateFromEl) dateFromEl.onchange = function() { populateLiveTriage(); };
  if (dateToEl) dateToEl.onchange = function() { populateLiveTriage(); };
  if (searchEl) {
    var searchTimeout;
    searchEl.oninput = function() {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(function() { populateLiveTriage(); }, 500);
    };
  }

  // Setup bulk actions
  var bulkEl = document.querySelector('.tq-bulk-select');
  if (bulkEl) {
    bulkEl.innerHTML = '<option>Bulk Actions</option><option value="assign">Assign Selected</option><option value="escalate">Escalate Selected</option><option value="close">Close Selected</option>';
    bulkEl.onchange = function() {
      var action = bulkEl.value;
      if (!action || action === 'Bulk Actions') return;
      var keys = getSelectedTicketKeys();
      if (keys.length === 0) { showToast('No tickets selected', 'warn'); bulkEl.value = 'Bulk Actions'; return; }
      if (action === 'assign') openBulkAssignModal(keys);
      else if (action === 'escalate') bulkEscalate(keys);
      else if (action === 'close') bulkClose(keys);
      bulkEl.value = 'Bulk Actions';
    };
  }

  // Setup Export button
  var exportBtn = document.querySelector('#page-triage .page-actions .btn-secondary');
  if (exportBtn) {
    exportBtn.onclick = function() { exportTriageCSV(); };
  }
}


// â”€â”€ Queue badge helper â”€â”€
var _triageQueueFilter = '';
function jiraQueueBadge(queue) {
  var colors = {
    'Elastic Alerts': 'background:rgba(0,212,255,0.1);color:#00d4ff;border-color:rgba(0,212,255,0.25);',
    'SOC Alerts': 'background:rgba(239,68,68,0.1);color:#ef4444;border-color:rgba(239,68,68,0.25);',
    'Client Responded': 'background:rgba(16,185,129,0.1);color:#10b981;border-color:rgba(16,185,129,0.25);',
    'Escalated': 'background:rgba(245,158,11,0.1);color:#f59e0b;border-color:rgba(245,158,11,0.25);',
    'In Progress': 'background:rgba(99,102,241,0.1);color:#818cf8;border-color:rgba(99,102,241,0.25);',
    'Demo Client': 'background:rgba(168,85,247,0.1);color:#a855f7;border-color:rgba(168,85,247,0.25);',
    'General': 'background:rgba(148,163,184,0.1);color:#94a3b8;border-color:rgba(148,163,184,0.25);'
  };
  var style = colors[queue] || colors['General'];
  return '<span style="font-size:9px;font-weight:600;padding:2px 6px;border-radius:4px;border:1px solid;white-space:nowrap;letter-spacing:0.3px;' + style + '">' + queue + '</span>';
}

// â”€â”€ Re-render with client-side queue filter â”€â”€
function rerenderTriageTable() {
  if (!_triageCurrentIssues || !_triageCurrentIssues.length) return;
  var triagePage = document.getElementById('page-triage');
  if (!triagePage) return;
  var tbody = triagePage.querySelector('table tbody');
  if (!tbody) return;
  var filtered = _triageCurrentIssues;
  if (_triageQueueFilter) filtered = _triageCurrentIssues.filter(function(t) { return t.queueOrigin === _triageQueueFilter; });
  var rowsHTML = filtered.map(function(t) {
    var isP1 = t.priorityShort === 'P1';
    var isCanceled = t.status === 'Canceled';
    var rowStyle = isP1 ? 'background:rgba(239,68,68,0.04);cursor:pointer;' : (isCanceled ? 'opacity:0.65;cursor:pointer;' : 'cursor:pointer;');
    return '<tr onclick="openInvestigation(\'' + t.key + '\')" style="' + rowStyle + '">' +
      '<td><input type="checkbox" class="tq-cb" data-key="' + t.key + '" onclick="event.stopPropagation();updateBulkCount();"></td>' +
      '<td><span class="mono" style="color:var(--cyan);font-size:11px;">' + t.key + '</span></td>' +
      '<td><span class="badge ' + jiraPriorityBadge(t.priority) + '">' + t.priorityShort + '</span></td>' +
      '<td style="max-width:230px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:600;color:var(--text-primary);font-size:12px;">' + t.summary + '</td>' +
      '<td><span style="font-size:10px;color:var(--text-muted);">&mdash;</span></td>' +
      '<td style="font-size:11px;">' + t.org + '</td>' +
      '<td style="font-size:11px;"><span style="font-size:9px;font-weight:600;padding:2px 6px;border-radius:4px;border:1px solid rgba(0,212,255,0.25);background:rgba(0,212,255,0.08);color:#00d4ff;">Jira</span></td>' +
      '<td><span class="badge ' + jiraStatusBadge(t.status) + '">' + t.status + '</span></td>' +
      '<td style="font-size:11px;color:' + (t.assignee === 'Unassigned' ? 'var(--text-muted)' : 'var(--cyan)') + ';">' + t.assignee + '</td>' +
      '<td style="font-family:var(--font-mono);font-size:10px;white-space:nowrap;"><div style="color:var(--text-primary);">' + jiraFormatDT(t.created) + '</div><div style="color:var(--text-muted);font-size:9px;">' + jiraTimeAgo(t.created) + '</div></td>' +
      '<td><div style="display:flex;gap:4px;"><button class="btn btn-xs btn-secondary" onclick="event.stopPropagation();openAssignModal(\'' + t.key + '\',\'' + (t.assigneeId||'') + '\');">Assign</button><button class="btn btn-xs btn-amber" onclick="event.stopPropagation();openEscalateModal(\'' + t.key + '\',\'' + t.status + '\');">Escalate</button></div></td>' +
    '</tr>';
  }).join('');
  tbody.innerHTML = rowsHTML;
  if (filtered.length === 0) tbody.innerHTML = '<tr><td colspan="11" style="text-align:center;padding:60px;"><div style="font-size:24px;opacity:0.5;">ðŸ“‹</div><div style="font-size:12px;color:var(--text-muted);font-family:var(--font-mono);">No tickets match the current filters</div></td></tr>';
  var tqSum = triagePage.querySelector('.tq-summary');
  if (tqSum) {
    var openC = filtered.filter(function(t) { return t.status === 'Open'; }).length;
    var closedC = filtered.filter(function(t) { return t.status === 'Closed' || t.status === 'Completed'; }).length;
    tqSum.innerHTML = '<span>Showing <strong style="color:var(--cyan);">' + filtered.length + '</strong> of <strong>' + _triageCurrentIssues.length + '</strong></span><span class="sep">Â·</span><span><strong style="color:var(--amber);">' + openC + '</strong> open</span><span class="sep">Â·</span><span><strong style="color:var(--green);">' + closedC + '</strong> resolved</span>';
  }
}

// â”€â”€ Ticket selection helpers â”€â”€
function getSelectedTicketKeys() {
  var keys = [];
  document.querySelectorAll('#page-triage .tq-cb[data-key]:checked').forEach(function(cb) { keys.push(cb.dataset.key); });
  return keys;
}
function updateBulkCount() {
  var keys = getSelectedTicketKeys();
  var bulkEl = document.querySelector('.tq-bulk-select');
  if (bulkEl) { var o = bulkEl.querySelector('option'); if (o) o.textContent = keys.length > 0 ? 'Bulk Actions (' + keys.length + ')' : 'Bulk Actions'; }
}

// â”€â”€ ASSIGN MODAL â”€â”€
var _assignUsers = null;
async function openAssignModal(ticketKey, currentAssigneeId) {
  if (!_assignUsers) {
    showToast('Loading team members...', 'info');
    try { _assignUsers = await DactaJira.fetchAssignableUsers(); } catch(e) { showToast('Failed to load users', 'error'); return; }
  }
  var ov = document.createElement('div');
  ov.id = 'assignModalOverlay';
  ov.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:10000;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px);';
  ov.onclick = function(e) { if (e.target === ov) ov.remove(); };
  var userHtml = (_assignUsers || []).map(function(u) {
    var sel = u.accountId === currentAssigneeId ? 'background:rgba(0,212,255,0.15);' : '';
    var dn = u.displayName.replace(/'/g,"\\'");
    return '<div style="display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:8px;cursor:pointer;' + sel + '" onmouseover="this.style.background=\'rgba(0,212,255,0.08)\'" onmouseout="this.style.background=\'' + sel + '\'" onclick="doAssign(\'' + ticketKey + '\',\'' + u.accountId + '\',\'' + dn + '\')">' +
      '<div style="width:28px;height:28px;border-radius:50%;background:var(--surface-2);display:flex;align-items:center;justify-content:center;font-size:11px;color:var(--cyan);font-weight:600;">' + u.displayName.charAt(0) + '</div>' +
      '<div style="font-size:12px;color:var(--text-primary);">' + u.displayName + '</div></div>';
  }).join('');
  ov.innerHTML = '<div style="background:var(--surface-1);border:1px solid var(--border);border-radius:12px;width:380px;max-height:500px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.5);">' +
    '<div style="padding:16px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;"><div style="font-size:14px;font-weight:600;color:var(--text-primary);">Assign ' + ticketKey + '</div><div style="cursor:pointer;color:var(--text-muted);font-size:18px;" onclick="this.closest(\'#assignModalOverlay\').remove()">&times;</div></div>' +
    '<div style="padding:12px 14px;max-height:380px;overflow-y:auto;">' +
    '<div style="display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:8px;cursor:pointer;" onmouseover="this.style.background=\'rgba(239,68,68,0.08)\'" onmouseout="this.style.background=\'\'" onclick="doAssign(\'' + ticketKey + '\',null,\'Unassigned\')">' +
    '<div style="width:28px;height:28px;border-radius:50%;background:rgba(239,68,68,0.1);display:flex;align-items:center;justify-content:center;font-size:11px;color:var(--red-bright);">âœ•</div><div style="font-size:12px;color:var(--text-muted);">Unassign</div></div>' +
    userHtml + '</div></div>';
  document.body.appendChild(ov);
}
async function doAssign(ticketKey, accountId, name) {
  var ov = document.getElementById('assignModalOverlay'); if (ov) ov.remove();
  showToast('Assigning ' + ticketKey + ' to ' + name + '...', 'info');
  try {
    await DactaJira.assignIssue(ticketKey, accountId);
    showToast(ticketKey + ' assigned to ' + name, 'success');
    var issue = _triageCurrentIssues.find(function(t) { return t.key === ticketKey; });
    if (issue) { issue.assignee = name; issue.assigneeId = accountId; }
    rerenderTriageTable();
  } catch(e) { showToast('Failed to assign: ' + e.message, 'error'); }
}

// â”€â”€ ESCALATE / TRANSITION MODAL â”€â”€
async function openEscalateModal(ticketKey, currentStatus) {
  showToast('Loading transitions...', 'info');
  try {
    var data = await DactaJira.fetchTransitions(ticketKey);
    var transitions = data.transitions || [];
    var ov = document.createElement('div');
    ov.id = 'escalateModalOverlay';
    ov.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:10000;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px);';
    ov.onclick = function(e) { if (e.target === ov) ov.remove(); };
    var btns = transitions.map(function(tr) {
      var toName = tr.to ? tr.to.name : tr.name;
      var isEsc = tr.name.toLowerCase().includes('escalat');
      var isCls = tr.name.toLowerCase().includes('clos') || tr.name.toLowerCase().includes('complet') || tr.name.toLowerCase().includes('resolv');
      var cls = isEsc ? 'btn-amber' : (isCls ? 'btn-primary' : 'btn-secondary');
      return '<button class="btn btn-sm ' + cls + '" style="flex:1;" onclick="doTransition(\'' + ticketKey + '\',\'' + tr.id + '\',\'' + toName.replace(/'/g,"\\'") + '\')">' + tr.name + ' â†’ ' + toName + '</button>';
    }).join('');
    ov.innerHTML = '<div style="background:var(--surface-1);border:1px solid var(--border);border-radius:12px;width:420px;box-shadow:0 20px 60px rgba(0,0,0,0.5);">' +
      '<div style="padding:16px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;"><div style="font-size:14px;font-weight:600;color:var(--text-primary);">Transition ' + ticketKey + '</div><div style="cursor:pointer;color:var(--text-muted);font-size:18px;" onclick="this.closest(\'#escalateModalOverlay\').remove()">&times;</div></div>' +
      '<div style="padding:14px 20px;"><div style="font-size:11px;color:var(--text-muted);margin-bottom:8px;">Current: <strong style="color:var(--text-primary);">' + currentStatus + '</strong></div><div style="display:flex;flex-direction:column;gap:8px;">' + btns + '</div></div>' +
      '<div style="padding:10px 20px 16px;border-top:1px solid var(--border);margin-top:8px;"><div style="font-size:10px;color:var(--text-muted);margin-bottom:6px;">Add comment (optional):</div>' +
      '<textarea id="escalateComment" placeholder="Notes..." style="width:100%;height:60px;background:var(--surface-2);border:1px solid var(--border);border-radius:6px;padding:8px;color:var(--text-primary);font-size:11px;font-family:var(--font-mono);resize:none;"></textarea></div></div>';
    document.body.appendChild(ov);
  } catch(e) { showToast('Failed: ' + e.message, 'error'); }
}
async function doTransition(ticketKey, transitionId, toName) {
  var cEl = document.getElementById('escalateComment');
  var comment = cEl ? cEl.value.trim() : '';
  var ov = document.getElementById('escalateModalOverlay'); if (ov) ov.remove();
  showToast('Moving ' + ticketKey + ' to ' + toName + '...', 'info');
  try {
    await DactaJira.transitionIssue(ticketKey, transitionId);
    if (comment) await DactaJira.addComment(ticketKey, comment);
    showToast(ticketKey + ' â†’ ' + toName, 'success');
    var issue = _triageCurrentIssues.find(function(t) { return t.key === ticketKey; });
    if (issue) issue.status = toName;
    rerenderTriageTable();
  } catch(e) { showToast('Failed: ' + e.message, 'error'); }
}

// â”€â”€ BULK OPERATIONS â”€â”€
async function openBulkAssignModal(keys) {
  if (!_assignUsers) { try { _assignUsers = await DactaJira.fetchAssignableUsers(); } catch(e) { showToast('Failed to load users','error'); return; } }
  var ov = document.createElement('div');
  ov.id = 'assignModalOverlay';
  ov.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:10000;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px);';
  ov.onclick = function(e) { if (e.target === ov) ov.remove(); };
  var uHtml = (_assignUsers||[]).map(function(u) {
    var dn = u.displayName.replace(/'/g,"\\'");
    return '<div style="display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:8px;cursor:pointer;" onmouseover="this.style.background=\'rgba(0,212,255,0.08)\'" onmouseout="this.style.background=\'\'" onclick="doBulkAssign(' + JSON.stringify(keys) + ',\'' + u.accountId + '\',\'' + dn + '\')">' +
      '<div style="width:28px;height:28px;border-radius:50%;background:var(--surface-2);display:flex;align-items:center;justify-content:center;font-size:11px;color:var(--cyan);font-weight:600;">' + u.displayName.charAt(0) + '</div>' +
      '<div style="font-size:12px;color:var(--text-primary);">' + u.displayName + '</div></div>';
  }).join('');
  ov.innerHTML = '<div style="background:var(--surface-1);border:1px solid var(--border);border-radius:12px;width:380px;max-height:500px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.5);">' +
    '<div style="padding:16px 20px;border-bottom:1px solid var(--border);"><div style="font-size:14px;font-weight:600;color:var(--text-primary);">Assign ' + keys.length + ' tickets</div><div style="font-size:10px;color:var(--text-muted);margin-top:4px;">' + keys.join(', ') + '</div></div>' +
    '<div style="padding:12px 14px;max-height:380px;overflow-y:auto;">' + uHtml + '</div></div>';
  document.body.appendChild(ov);
}
async function doBulkAssign(keys, accountId, name) {
  var ov = document.getElementById('assignModalOverlay'); if (ov) ov.remove();
  showToast('Assigning ' + keys.length + ' tickets to ' + name + '...', 'info');
  var ok=0, fail=0;
  for (var i=0;i<keys.length;i++) { try { await DactaJira.assignIssue(keys[i],accountId); var is=_triageCurrentIssues.find(function(t){return t.key===keys[i];}); if(is){is.assignee=name;is.assigneeId=accountId;} ok++; } catch(e){fail++;} }
  showToast(ok+' assigned'+(fail?', '+fail+' failed':''), fail?'warn':'success');
  rerenderTriageTable();
}
async function bulkEscalate(keys) {
  showToast('Escalating '+keys.length+' tickets...','info');
  var ok=0,fail=0;
  for(var i=0;i<keys.length;i++){try{var d=await DactaJira.fetchTransitions(keys[i]);var esc=(d.transitions||[]).find(function(tr){return tr.name.toLowerCase().includes('escalat');});if(esc){await DactaJira.transitionIssue(keys[i],esc.id);var is=_triageCurrentIssues.find(function(t){return t.key===keys[i];});if(is)is.status='Escalated';ok++;}else{fail++;}}catch(e){fail++;}}
  showToast(ok+' escalated'+(fail?', '+fail+' failed':''),fail?'warn':'success');
  rerenderTriageTable();
}
async function bulkClose(keys) {
  showToast('Closing '+keys.length+' tickets...','info');
  var ok=0,fail=0;
  for(var i=0;i<keys.length;i++){try{var d=await DactaJira.fetchTransitions(keys[i]);var cl=(d.transitions||[]).find(function(tr){var n=tr.name.toLowerCase();return n.includes('clos')||n.includes('complet');});if(cl){await DactaJira.transitionIssue(keys[i],cl.id);var is=_triageCurrentIssues.find(function(t){return t.key===keys[i];});if(is)is.status=cl.to?cl.to.name:'Closed';ok++;}else{fail++;}}catch(e){fail++;}}
  showToast(ok+' closed'+(fail?', '+fail+' failed':''),fail?'warn':'success');
  rerenderTriageTable();
}

// â”€â”€ EXPORT CSV â”€â”€
function exportTriageCSV() {
  var data = _triageCurrentIssues || [];
  if (_triageQueueFilter) data = data.filter(function(t){return t.queueOrigin===_triageQueueFilter;});
  if (data.length === 0) { showToast('No data to export','warn'); return; }
  var headers = ['ID','Priority','Summary','Organization','Queue','Status','Assignee','Created','Updated'];
  var rows = data.map(function(t){ return [t.key,t.priority,'"'+(t.summary||'').replace(/"/g,'""')+'"','"'+t.org+'"',t.queueOrigin||'General',t.status,'"'+t.assignee+'"',t.created,t.updated].join(','); });
  var csv = headers.join(',')+'\n'+rows.join('\n');
  var blob = new Blob([csv],{type:'text/csv'});
  var url = URL.createObjectURL(blob);
  var a = document.createElement('a'); a.href=url; a.download='dacta-triage-'+new Date().toISOString().slice(0,10)+'.csv';
  document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);
  showToast('Exported '+data.length+' tickets','success');
}

// â”€â”€ INVESTIGATION LIVE DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var _currentInvestigationKey = null;

async function openInvestigation(ticketKey) {
  if (!ticketKey) return;
  _currentInvestigationKey = ticketKey;
  navigate('investigation');

  var invPage = document.getElementById('page-investigation');
  if (!invPage) return;

  // Hide demo layout, show live panel
  var demoLayout = invPage.querySelector('.investigation-layout');
  if (demoLayout) demoLayout.style.display = 'none';

  // Remove previous live panel
  var oldLive = invPage.querySelector('.prod-investigation-live');
  if (oldLive) oldLive.remove();
  
  // Remove previous empty state
  var oldEmpty = invPage.querySelector('.prod-inv-empty');
  if (oldEmpty) oldEmpty.remove();

  // Update subtitle
  var subtitle = invPage.querySelector('.page-subtitle');
  if (subtitle) subtitle.textContent = 'Loading ' + ticketKey + '...';

  // Show action buttons
  invPage.querySelectorAll('.page-actions .btn').forEach(function(btn) {
    btn.style.display = '';
  });

  // Create live investigation panel
  var livePanel = document.createElement('div');
  livePanel.className = 'prod-investigation-live';
  livePanel.innerHTML = jiraLoadingHTML('Loading investigation data for ' + ticketKey + '...');
  
  if (demoLayout) {
    demoLayout.parentNode.insertBefore(livePanel, demoLayout.nextSibling);
  } else {
    invPage.appendChild(livePanel);
  }

  try {
    // Fetch issue and comments in parallel
    var issuePromise = DactaJira.fetchIssue(ticketKey);
    var commentsPromise = DactaJira.fetchComments(ticketKey);
    
    var issueData = await issuePromise;
    var commentsData = await commentsPromise;
    
    var f = issueData.fields || {};
    var orgs = (f.customfield_10002 || []).map(function(o) { return o.name; });
    var assignee = f.assignee ? f.assignee.displayName : 'Unassigned';
    var reporter = f.reporter ? f.reporter.displayName : 'Unknown';
    var priority = f.priority ? f.priority.name : 'Unknown';
    var status = f.status ? f.status.name : 'Unknown';
    var workCat = f.customfield_10038;
    var workCatStr = workCat && typeof workCat === 'object' ? (workCat.value || '') : (workCat || '');
    var labels = f.labels || [];
    var useCase = f.customfield_10072 || '';
    var description = '';
    
    // Extract description text from ADF format
    if (f.description && f.description.content) {
      description = extractADFText(f.description);
    } else if (typeof f.description === 'string') {
      description = f.description;
    }
    
    // Use rendered description if available
    if (issueData.renderedFields && issueData.renderedFields.description) {
      description = issueData.renderedFields.description;
    }

    // Update subtitle
    if (subtitle) subtitle.innerHTML = ticketKey + ' Â· ' + status + ' ' + jiraLiveBadge();

    // Build the investigation view
    var commentsArr = (commentsData.comments || commentsData.values || []);
    
    // Build changelog timeline
    var changelog = (issueData.changelog && issueData.changelog.histories) || [];
    var timelineItems = [];
    
    changelog.forEach(function(entry) {
      (entry.items || []).forEach(function(item) {
        timelineItems.push({
          time: entry.created,
          author: entry.author ? entry.author.displayName : 'System',
          type: 'change',
          field: item.field,
          from: item.fromString || '',
          to: item.toString || ''
        });
      });
    });
    
    commentsArr.forEach(function(c) {
      var body = '';
      if (c.renderedBody) {
        body = c.renderedBody;
      } else if (c.body && c.body.content) {
        body = extractADFText(c.body);
      } else if (typeof c.body === 'string') {
        body = c.body;
      }
      timelineItems.push({
        time: c.created,
        author: c.author ? c.author.displayName : 'Unknown',
        type: 'comment',
        body: body
      });
    });
    
    // Sort timeline by time desc
    timelineItems.sort(function(a, b) { return new Date(b.time) - new Date(a.time); });

    var labelsHTML = labels.length > 0 
      ? labels.map(function(l) { return '<span style="font-size:9px;padding:2px 8px;background:rgba(0,212,255,0.08);border:1px solid rgba(0,212,255,0.15);border-radius:10px;color:var(--cyan);">' + l + '</span>'; }).join('')
      : '<span style="color:var(--text-muted);font-size:11px;">None</span>';

    livePanel.innerHTML = '<div style="display:grid;grid-template-columns:280px 1fr 300px;gap:12px;margin-top:4px;">' +

      // â”€â”€ LEFT SIDEBAR â”€â”€
      '<div style="display:flex;flex-direction:column;gap:12px;">' +
        // Ticket Details card
        '<div class="card" style="padding:14px;">' +
          '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">Ticket Details</span></div>' +
          '<div style="display:flex;align-items:center;gap:8px;margin-bottom:10px;">' +
            '<span class="mono" style="color:var(--cyan);font-size:14px;font-weight:700;">' + ticketKey + '</span>' +
            '<span class="badge ' + jiraPriorityBadge(priority) + '">' + (priority.split(' - ')[0]) + '</span>' +
            '<span class="badge ' + jiraStatusBadge(status) + '">' + status + '</span>' +
          '</div>' +
          '<div style="font-size:13px;font-weight:600;color:var(--text-primary);line-height:1.4;margin-bottom:12px;">' + (f.summary || '') + '</div>' +
          '<div class="divider" style="margin:8px 0;"></div>' +
          '<div style="display:flex;flex-direction:column;gap:6px;font-size:11px;">' +
            '<div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Organization</span><span style="color:var(--text-primary);font-weight:500;">' + (orgs.join(', ') || '\u2014') + '</span></div>' +
            '<div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Source</span><span style="color:var(--text-primary);">Jira</span></div>' +
            '<div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Assignee</span><span style="color:var(--cyan);font-weight:500;">' + assignee + '</span></div>' +
            '<div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Reporter</span><span style="color:var(--text-primary);">' + reporter + '</span></div>' +
            '<div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Created</span><span style="color:var(--text-primary);font-family:var(--font-mono);font-size:10px;">' + jiraFormatDT(f.created) + '</span></div>' +
            '<div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Updated</span><span style="color:var(--text-primary);font-family:var(--font-mono);font-size:10px;">' + jiraFormatDT(f.updated) + '</span></div>' +
            '<div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Use Case</span><span style="color:var(--text-primary);font-size:10px;">' + (useCase || '\u2014') + '</span></div>' +
            (workCatStr ? '<div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted);">Work Category</span><span style="color:#a78bfa;font-size:10px;">' + workCatStr + '</span></div>' : '') +
          '</div>' +
          (labels.length > 0 ? '<div style="margin-top:8px;display:flex;gap:4px;flex-wrap:wrap;">' + labels.map(function(l) { return '<span style="font-size:9px;padding:2px 8px;background:rgba(0,212,255,0.08);border:1px solid rgba(0,212,255,0.15);border-radius:10px;color:var(--cyan);">' + l + '</span>'; }).join('') + '</div>' : '') +
        '</div>' +

        // Raw Alert card (from description)
        '<div class="card" style="padding:14px;">' +
          '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">Raw Alert Data</span></div>' +
          '<div style="font-size:11px;color:var(--text-secondary);line-height:1.5;max-height:300px;overflow-y:auto;font-family:var(--font-mono);background:var(--surface-0);padding:10px;border-radius:6px;border:1px solid var(--border-subtle);word-break:break-all;">' +
            (description || '<span style="color:var(--text-muted);font-style:italic;">No raw alert data</span>') +
          '</div>' +
        '</div>' +

        // Quick actions
        '<div style="display:flex;gap:8px;flex-wrap:wrap;">' +
          '<button class="btn btn-secondary btn-sm" style="flex:1;font-size:10px;" onclick="window.open(\'https://dactaglobal-sg.atlassian.net/browse/' + ticketKey + '\', \'_blank\')">Open in Jira \u2197</button>' +
        '</div>' +
      '</div>' +

      // \u2500\u2500 CENTER MAIN (AI Investigation will be injected here by runAIInvestigation) \u2500\u2500
      '<div id="invMainContent" style="display:flex;flex-direction:column;gap:12px;">' +
        '<div id="invLoadingSpinner" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;gap:16px;min-height:300px;">' +
          '<div style="width:40px;height:40px;border:3px solid rgba(0,212,255,0.15);border-top-color:var(--cyan);border-radius:50%;animation:spin 0.8s linear infinite;"></div>' +
          '<div style="font-size:12px;color:var(--text-muted);font-family:var(--font-mono);text-align:center;">Initializing AI Investigation Engine...</div>' +
          '<div style="width:200px;height:4px;background:var(--bg-elevated);border-radius:2px;overflow:hidden;"><div style="height:100%;width:0%;background:linear-gradient(90deg,var(--cyan),#8b5cf6);border-radius:2px;animation:invProgressBar 6s ease-in-out forwards;"></div></div>' +
          '<div style="font-size:10px;color:var(--text-muted);">Running Elastic SIEM queries &middot; OpenCTI enrichment &middot; MITRE mapping</div>' +
        '</div>' +
      '</div>' +

      // \u2500\u2500 RIGHT SIDEBAR \u2500\u2500
      '<div style="display:flex;flex-direction:column;gap:12px;">' +
        // Activity Timeline
        '<div class="card" style="padding:14px;max-height:400px;overflow-y:auto;">' +
          '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">Activity Timeline</span><span style="font-size:10px;color:var(--text-muted);margin-left:6px;">' + timelineItems.length + '</span></div>' +
          (timelineItems.length === 0
            ? '<div style="text-align:center;padding:16px;font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">No activity recorded</div>'
            : '<div style="display:flex;flex-direction:column;gap:0;">' +
              timelineItems.slice(0, 20).map(function(item) {
                if (item.type === 'comment') {
                  return '<div style="padding:8px 10px;border-left:2px solid rgba(0,212,255,0.3);margin-left:6px;margin-bottom:6px;">' +
                    '<div style="display:flex;align-items:center;gap:4px;margin-bottom:4px;">' +
                      '<span style="font-size:10px;font-weight:600;color:var(--cyan);">' + item.author + '</span>' +
                      '<span style="font-size:9px;color:var(--text-muted);font-family:var(--font-mono);">' + jiraTimeAgo(item.time) + '</span>' +
                    '</div>' +
                    '<div style="font-size:10px;color:var(--text-secondary);line-height:1.4;max-height:100px;overflow:hidden;">' + (item.body || '') + '</div>' +
                  '</div>';
                } else {
                  return '<div style="padding:4px 10px;border-left:2px solid rgba(255,255,255,0.06);margin-left:6px;margin-bottom:2px;">' +
                    '<div style="font-size:9px;color:var(--text-muted);">' + item.author + ' \u00b7 ' + jiraTimeAgo(item.time) + '</div>' +
                    '<div style="font-size:9px;color:var(--text-secondary);margin-top:1px;">' +
                      item.field + ': ' +
                      (item.from ? '<span style="text-decoration:line-through;opacity:0.5;">' + item.from + '</span> \u2192 ' : '') +
                      '<span style="color:var(--text-primary);">' + item.to + '</span>' +
                    '</div>' +
                  '</div>';
                }
              }).join('') +
            '</div>'
          ) +
        '</div>' +

        // Enrichment Summary (populated by AI investigation)
        '<div class="card" style="padding:14px;" id="enrichmentSummaryCard">' +
          '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">Enrichment Summary</span></div>' +
          '<div style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">Waiting for investigation...</div>' +
        '</div>' +

        // Correlated Alerts placeholder
        '<div class="card" style="padding:14px;" id="correlatedAlertsCard">' +
          '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">Correlated Alerts</span></div>' +
          '<div style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">Waiting for investigation...</div>' +
        '</div>' +

        // Recommended Actions
        '<div class="card" style="padding:14px;" id="recommendedActionsCard">' +
          '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">AI Recommended Actions</span></div>' +
          '<div style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">Waiting for investigation...</div>' +
        '</div>' +
        '<div class="card" style="padding:14px;" id="playbookActionsCard">' +
          '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">Playbook Actions</span><span style="font-size:9px;color:var(--text-muted);margin-left:6px;">From Detection Rules</span></div>' +
          '<div style="font-size:10px;color:var(--text-muted);font-family:var(--font-mono);">Matching playbook...</div>' +
        '</div>' +
      '</div>' +
    '</div>';

        // â”€â”€ Trigger AI Investigation (3 rounds) â”€â”€
    runAIInvestigation(ticketKey, issueData);

  } catch (err) {
    console.error('[DactaJira] Investigation error:', err);
    livePanel.innerHTML = jiraErrorHTML('Failed to load ' + ticketKey + ': ' + err.message, 'openInvestigation(\'' + ticketKey + '\')');
  }
}

// Helper: Extract text from Atlassian Document Format (ADF)
function extractADFText(adf) {
  if (!adf || !adf.content) return '';
  var text = '';
  function walk(nodes) {
    (nodes || []).forEach(function(node) {
      if (node.type === 'text') {
        text += node.text || '';
      } else if (node.type === 'hardBreak') {
        text += '<br>';
      } else if (node.type === 'paragraph') {
        walk(node.content);
        text += '<br>';
      } else if (node.type === 'heading') {
        text += '<strong>';
        walk(node.content);
        text += '</strong><br>';
      } else if (node.type === 'bulletList' || node.type === 'orderedList') {
        walk(node.content);
      } else if (node.type === 'listItem') {
        text += 'â€¢ ';
        walk(node.content);
      } else if (node.type === 'codeBlock') {
        text += '<pre style="background:var(--bg-elevated);padding:8px;border-radius:4px;font-size:11px;overflow-x:auto;">';
        walk(node.content);
        text += '</pre>';
      } else if (node.type === 'table') {
        text += '<div style="overflow-x:auto;margin:8px 0;"><table style="border-collapse:collapse;font-size:11px;">';
        walk(node.content);
        text += '</table></div>';
      } else if (node.type === 'tableRow') {
        text += '<tr>';
        walk(node.content);
        text += '</tr>';
      } else if (node.type === 'tableCell' || node.type === 'tableHeader') {
        var tag = node.type === 'tableHeader' ? 'th' : 'td';
        text += '<' + tag + ' style="border:1px solid var(--border-subtle);padding:4px 8px;">';
        walk(node.content);
        text += '</' + tag + '>';
      } else {
        walk(node.content);
      }
    });
  }
  walk(adf.content);
  return text;
}


// â”€â”€ PROGRESS BAR HTML (Task 5) â”€â”€
function jiraProgressBarHTML() {
  return '<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;gap:12px;">' +
    '<div style="width:280px;height:4px;background:rgba(0,212,255,0.1);border-radius:2px;overflow:hidden;">' +
      '<div class="jira-progress-fill" style="width:0%;height:100%;background:linear-gradient(90deg,#00d4ff,#10b981);border-radius:2px;transition:width 0.3s ease;"></div>' +
    '</div>' +
    '<span style="font-size:11px;color:var(--text-muted);font-family:var(--font-mono);">Connecting to Jira...</span>' +
  '</div>';
}
// Animate progress bar
(function(){
  var animInterval = setInterval(function(){
    var fill = document.querySelector('.jira-progress-fill');
    if (!fill) return;
    var current = parseFloat(fill.style.width) || 0;
    if (current >= 90) { clearInterval(animInterval); return; }
    fill.style.width = Math.min(current + Math.random() * 15 + 5, 90) + '%';
    var label = fill.parentElement.nextElementSibling;
    if (label) {
      if (current < 30) label.textContent = 'Connecting to Jira...';
      else if (current < 60) label.textContent = 'Fetching SOC alerts...';
      else label.textContent = 'Processing tickets...';
    }
  }, 400);
})();

// â”€â”€ SORTING (Task 2) â”€â”€
var _triageSortAsc = false;
function toggleTriageSort() {
  _triageSortAsc = !_triageSortAsc;
  var icon = document.getElementById('triageSortIcon');
  if (icon) icon.textContent = _triageSortAsc ? 'â–²' : 'â–¼';
  _triageCurrentIssues.sort(function(a, b) {
    var da = new Date(a.created), db = new Date(b.created);
    return _triageSortAsc ? da - db : db - da;
  });
  rerenderTriageTable();
}

// â”€â”€ CREATE TICKET MODAL (Task 1) â”€â”€
async function openCreateTicketModal() {
  if (!_assignUsers) {
    try { _assignUsers = await DactaJira.fetchAssignableUsers(); } catch(e) { /* ignore */ }
  }
  var ov = document.createElement('div');
  ov.id = 'createTicketOverlay';
  ov.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:10000;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px);';
  ov.onclick = function(e) { if (e.target === ov) ov.remove(); };

  var assigneeOpts = '<option value="">Unassigned</option>';
  (_assignUsers || []).forEach(function(u) {
    assigneeOpts += '<option value="' + u.accountId + '">' + u.displayName + '</option>';
  });

  ov.innerHTML = '<div style="background:var(--surface-1);border:1px solid var(--border);border-radius:12px;width:480px;box-shadow:0 20px 60px rgba(0,0,0,0.5);">' +
    '<div style="padding:16px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;">' +
      '<div style="font-size:14px;font-weight:600;color:var(--text-primary);">Create Incident Ticket</div>' +
      '<div style="cursor:pointer;color:var(--text-muted);font-size:18px;" onclick="this.closest(\'#createTicketOverlay\').remove()">&times;</div>' +
    '</div>' +
    '<div style="padding:16px 20px;display:flex;flex-direction:column;gap:12px;">' +
      '<div>' +
        '<div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px;">Summary *</div>' +
        '<input id="ctSummary" type="text" placeholder="Alert summary..." style="width:100%;background:var(--surface-2);border:1px solid var(--border);border-radius:6px;padding:10px 12px;color:var(--text-primary);font-size:12px;font-family:var(--font-body);outline:none;">' +
      '</div>' +
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">' +
        '<div>' +
          '<div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px;">Priority</div>' +
          '<select id="ctPriority" style="width:100%;background:var(--surface-2);border:1px solid var(--border);border-radius:6px;padding:10px 12px;color:var(--text-primary);font-size:12px;">' +
            '<option>P3 - Medium</option><option>P1 - Critical</option><option>P2 - High</option><option>P4 - Low</option>' +
          '</select>' +
        '</div>' +
        '<div>' +
          '<div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px;">Assignee</div>' +
          '<select id="ctAssignee" style="width:100%;background:var(--surface-2);border:1px solid var(--border);border-radius:6px;padding:10px 12px;color:var(--text-primary);font-size:12px;">' + assigneeOpts + '</select>' +
        '</div>' +
      '</div>' +
      '<div>' +
        '<div style="font-size:10px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px;">Description</div>' +
        '<textarea id="ctDescription" placeholder="Describe the incident..." style="width:100%;height:80px;background:var(--surface-2);border:1px solid var(--border);border-radius:6px;padding:10px 12px;color:var(--text-primary);font-size:12px;font-family:var(--font-body);resize:none;outline:none;"></textarea>' +
      '</div>' +
      '<div style="display:flex;justify-content:flex-end;gap:8px;margin-top:4px;">' +
        '<button class="btn btn-secondary btn-sm" onclick="document.getElementById(\'createTicketOverlay\').remove()">Cancel</button>' +
        '<button class="btn btn-primary btn-sm" onclick="submitCreateTicket()">Create Ticket</button>' +
      '</div>' +
    '</div>' +
  '</div>';
  document.body.appendChild(ov);
  setTimeout(function(){ var el = document.getElementById('ctSummary'); if(el) el.focus(); }, 100);
}

async function submitCreateTicket() {
  var summary = document.getElementById('ctSummary').value.trim();
  if (!summary) { showToast('Summary is required', 'error'); return; }
  var priority = document.getElementById('ctPriority').value;
  var assigneeId = document.getElementById('ctAssignee').value || null;
  var description = document.getElementById('ctDescription').value.trim();

  var ov = document.getElementById('createTicketOverlay');
  if (ov) ov.remove();

  showToast('Creating ticket...', 'info');
  try {
    var result = await DactaJira._fetch('/api/jira?action=createticket', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ summary: summary, priority: priority, assigneeId: assigneeId, description: description })
    });
    if (result.key) {
      showToast('Created ' + result.key + ' successfully', 'success');
      populateLiveTriage(); // Refresh
    } else {
      showToast('Failed to create ticket: ' + JSON.stringify(result.errors || result), 'error');
    }
  } catch(e) {
    showToast('Failed: ' + e.message, 'error');
  }
}

// â”€â”€ AI INVESTIGATION â”€â”€
// Priority-driven AI triage: P1/P2 = 3 rounds, P3 = 2 rounds, P4 = 1 round
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AI INVESTIGATION ENGINE v2 â€” ELASTIC LOG ANALYSIS + BALANCED EVIDENCE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€ Elastic SIEM Query Helper â”€â”€
async function queryElastic(action, index, body) {
  try {
    var resp = await fetch('/api/elastic', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ action: action, index: index, body: body })
    });
    if (!resp.ok) { console.warn('[Elastic] HTTP ' + resp.status); return null; }
    return await resp.json();
  } catch (err) { console.error('[Elastic] Query failed:', err); return null; }
}

// â”€â”€ OpenCTI GraphQL Helper â”€â”€
async function queryOpenCTI(gqlQuery, variables) {
  try {
    var resp = await fetch('/api/opencti', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ query: gqlQuery, variables: variables || {} })
    });
    if (!resp.ok) { console.warn('[OpenCTI] HTTP ' + resp.status); return null; }
    return await resp.json();
  } catch (err) { console.error('[OpenCTI] Query failed:', err); return null; }
}

// Helper: extract IOCs (IPs, domains, hashes, files, hosts) from text
function extractIOCs(text) {
  var iocs = { ips: [], hosts: [], files: [], hashes: [], ports: [], users: [], paths: [] };
  var ipPattern = /\b(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\b/g;
  var portPattern = /(?::|port\s*)([0-9]{2,5})\b/gi;
  var hashMd5 = /\b[a-f0-9]{32}\b/gi;
  var hashSha = /\b[a-f0-9]{64}\b/gi;
  var hostPattern = /\b[A-Z0-9][A-Z0-9_-]{3,}(?:DN|PC|WS|SRV|DC|DB|APP)\d*\b/gi;
  var exePattern = /\b[\w.-]+\.(?:exe|dll|ps1|bat|cmd|vbs|js|py|sh|msi|scr|hta)\b/gi;
  var pathPattern = /[A-Z]:\\[\w\\. -]+/gi;
  var userPattern = /(?:user(?:name)?|account|logon|by user\s+)(\w[\w.-]+)/gi;

  var m;
  m = text.match(ipPattern) || []; iocs.ips = [...new Set(m)];
  m = text.match(hostPattern) || []; iocs.hosts = [...new Set(m)];
  m = text.match(exePattern) || []; iocs.files = [...new Set(m.map(function(f){return f.toLowerCase();}))];
  m = text.match(hashSha) || []; iocs.hashes = [...new Set(m)];
  var md5 = text.match(hashMd5) || []; md5.forEach(function(h) { if (!iocs.hashes.some(function(s){return s.includes(h);})) iocs.hashes.push(h); });
  m = text.match(pathPattern) || []; iocs.paths = [...new Set(m)];
  while ((m = portPattern.exec(text)) !== null) { var p = parseInt(m[1]); if (p > 0 && p < 65536 && p !== 1234) iocs.ports.push(p); }
  iocs.ports = [...new Set(iocs.ports)];
  while ((m = userPattern.exec(text)) !== null) { var u = m[1]; if (u.length > 2 && !['the','this','that','from','with'].includes(u.toLowerCase())) iocs.users.push(u); }
  iocs.users = [...new Set(iocs.users)];
  return iocs;
}

// Helper: detect attack techniques from content
function detectTechniques(text) {
  var lower = text.toLowerCase();
  var techniques = [];
  var checks = [
    { keys: ['powershell','-enc','encodedcommand','invoke-expression','iex','bypass'], id: 'T1059.001', name: 'Command & Scripting: PowerShell', tactic: 'Execution', desc: 'PowerShell execution detected, commonly abused for fileless attacks and payload delivery' },
    { keys: ['cmd.exe /c','cmd.exe /k','command prompt'], id: 'T1059.003', name: 'Command & Scripting: Windows CMD', tactic: 'Execution', desc: 'Windows Command Shell execution observed' },
    { keys: ['nc.exe','netcat','ncat','reverse shell','bind shell'], id: 'T1059+T1571', name: 'Reverse Shell / Non-Standard Port', tactic: 'Execution + C2', desc: 'Network utility creating outbound connection indicative of reverse shell establishment' },
    { keys: ['mimikatz','lsass','credential dump','sekurlsa','hashdump'], id: 'T1003', name: 'OS Credential Dumping', tactic: 'Credential Access', desc: 'Credential harvesting tools or techniques targeting stored authentication material' },
    { keys: ['ransomware','encrypt','ransom','locker','.encrypted','.enc extension'], id: 'T1486', name: 'Data Encrypted for Impact', tactic: 'Impact', desc: 'Ransomware activity detected targeting file encryption for extortion' },
    { keys: ['phishing','spear-phishing','suspicious email','malicious link'], id: 'T1566', name: 'Phishing', tactic: 'Initial Access', desc: 'Phishing attempt identified as potential initial access vector' },
    { keys: ['brute force','failed login','multiple attempts','lockout','password spray'], id: 'T1110', name: 'Brute Force', tactic: 'Credential Access', desc: 'Multiple authentication failures suggesting credential brute-forcing' },
    { keys: ['lateral movement','psexec','wmi','remote desktop','rdp','smbexec','admin$'], id: 'T1021', name: 'Remote Services', tactic: 'Lateral Movement', desc: 'Lateral movement via remote service protocols' },
    { keys: ['exfiltration','data transfer','staging area'], id: 'T1041', name: 'Exfiltration Over C2', tactic: 'Exfiltration', desc: 'Data exfiltration over command and control channel' },
    { keys: ['persistence','registry run','startup','service install'], id: 'T1053', name: 'Scheduled Task/Job', tactic: 'Persistence', desc: 'Persistence mechanism established via scheduled execution' },
    { keys: ['privilege escalation','uac bypass','elevation'], id: 'T1548', name: 'Abuse Elevation Control', tactic: 'Privilege Escalation', desc: 'Privilege escalation attempt detected' },
    { keys: ['dll injection','dll side','process hollow','inject'], id: 'T1055', name: 'Process Injection', tactic: 'Defense Evasion', desc: 'Process injection technique for defense evasion' },
    { keys: ['webshell','web shell','cmd.aspx'], id: 'T1505.003', name: 'Web Shell', tactic: 'Persistence', desc: 'Web shell deployed for persistent remote access' },
    { keys: ['ollama','local llm','ai model','soc-ai','run soc'], id: 'T1059.001', name: 'AI-Assisted Tooling (ollama)', tactic: 'Execution', desc: 'Local LLM runtime detected â€” may be legitimate SOC tool or weaponized for payload generation' },
    { keys: ['base64','encoded','obfuscat','-enc '], id: 'T1027', name: 'Obfuscated Files or Information', tactic: 'Defense Evasion', desc: 'Encoded/obfuscated command detected, commonly used to evade detection signatures' },
    { keys: ['crowdstrike','prevention','process killed','blocked','terminated'], id: 'EDR-BLOCK', name: 'EDR Prevention Triggered', tactic: 'Detection', desc: 'Endpoint detection and response platform intercepted and terminated the process' }
  ];
  checks.forEach(function(c) {
    var matched = c.keys.some(function(k) { return lower.includes(k); });
    if (matched) techniques.push(c);
  });
  return techniques;
}

// â”€â”€ CRITICAL: Detect if suspicious strings are inside quoted prompt/argument context â”€â”€
function analyzeCommandContext(text) {
  var lower = text.toLowerCase();
  var results = {
    isPromptContext: false,
    isDirectExec: false,
    promptIndicators: [],
    execIndicators: [],
    explanation: ''
  };

  // Check for LLM prompt patterns â€” strings inside quotes after model invocation
  var promptPatterns = [
    /ollama[.\w]*\s+run\s+[\w-]+\s+["'](.+?)["']/i,
    /ollama[.\w]*\s+run\s+[\w-]+\s+"([^"]+)"/i,
    /"analyze\s+these?\s+/i,
    /"scan\s+these?\s+/i,
    /"investigate\s+/i,
    /run\s+soc-ai\s+"/i,
    /\bprompt\b.*\b(?:analyze|scan|investigate|check|review)\b/i
  ];
  promptPatterns.forEach(function(p) {
    if (p.test(text)) results.promptIndicators.push('Content appears inside LLM prompt argument');
  });

  // Check if the "malicious" processes are listed as data/logs inside a prompt
  if (lower.includes('pid') && lower.includes('name') && lower.includes('path') && lower.includes('arguments')) {
    results.promptIndicators.push('Content contains structured process log format (PID | Name | Path) suggesting data input, not execution');
  }
  if (lower.includes('\\n') && (lower.includes('analyze') || lower.includes('investigate'))) {
    results.promptIndicators.push('Newline-separated data embedded in analysis request string');
  }

  // Check for actual execution patterns
  var execPatterns = [
    { pattern: /powershell\.exe.*-enc\s+\S+/i, not_in_prompt: true, desc: 'Direct PowerShell encoded execution' },
    { pattern: /nc\.exe\s+-e\s+cmd\.exe/i, not_in_prompt: true, desc: 'Netcat reverse shell with -e flag' },
    { pattern: /cmd\.exe\s+\/c\s+/i, not_in_prompt: true, desc: 'CMD execution via /c switch' }
  ];

  // Determine if suspicious commands are inside ollama prompt string
  var ollamaPromptMatch = text.match(/ollama[.\w]*['"]?\s*run\s+[\w-]+\s+["']?(.*)/i);
  if (ollamaPromptMatch) {
    var promptContent = ollamaPromptMatch[1];
    var hasMaliciousInPrompt = /(?:powershell|nc\.exe|cmd\.exe|reverse.shell|4444)/i.test(promptContent);
    if (hasMaliciousInPrompt) {
      results.isPromptContext = true;
      results.promptIndicators.push('Suspicious commands (powershell, nc.exe, port 4444) are embedded INSIDE the ollama prompt string as data to be analyzed, not as separate executed commands');
    }
  }

  // If no prompt context detected, check for direct execution
  if (!results.isPromptContext) {
    execPatterns.forEach(function(ep) {
      if (ep.pattern.test(text)) {
        results.isDirectExec = true;
        results.execIndicators.push(ep.desc);
      }
    });
  }

  return results;
}

// â”€â”€ Simulate Elastic/SIEM log queries â”€â”€
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REAL Elastic SIEM + OpenCTI Lookup (async â€” queries live data)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function realElasticLookup(ticketKey, iocs, techniques, issueData) {
  var logs = {
    childProcesses: [], networkConnections: [], fileEvents: [],
    authEvents: [], edrActions: [], queryResults: [],
    rawAlerts: [], hostInfo: null, alertHistory: null,
    openctiResults: [],
    elasticConnected: false, openctiConnected: false,
    queriesRun: 0, queryDetails: []
  };

  var f = issueData.fields || {};
  var org = '';
  if (f.customfield_10002 && f.customfield_10002.length > 0) org = (f.customfield_10002[0].name || '').toLowerCase();
  var namespace = 'default';
  if (org.includes('naga')) namespace = 'nagaworld';
  else if (org.includes('dacta')) namespace = 'dacta';
  else if (org.includes('foxwood')) namespace = 'foxwood';
  else if (org.includes('silver')) namespace = 'silverkey';
  else if (org.includes('hla')) namespace = 'hla';
  else if (org.includes('demo')) namespace = 'demo';

  // â”€â”€ QUERY 1: CrowdStrike Alert Correlation â”€â”€
  var alertIndex = '.ds-logs-crowdstrike.alert-' + namespace + '-*';
  var alertQuery = { size: 5, sort: [{ '@timestamp': 'desc' }], _source: true };
  var hostnames = iocs.hosts || [];
  if (hostnames.length > 0) {
    alertQuery.query = { bool: { should: hostnames.map(function(h) { return { match: { 'host.hostname': h } }; }), minimum_should_match: 1 } };
  } else {
    var procNames = (iocs.files || []).filter(function(f) { return f.includes('.exe'); });
    if (procNames.length > 0) {
      alertQuery.query = { bool: { should: procNames.map(function(p) { return { match: { 'process.name': p } }; }), minimum_should_match: 1 } };
    } else {
      alertQuery.query = { match_all: {} };
    }
  }

  var qD1 = { name: 'CrowdStrike Alert Lookup', index: alertIndex, query: JSON.stringify(alertQuery.query || {}).substring(0, 120), status: 'running' };
  logs.queryDetails.push(qD1);
  logs.queriesRun++;

  var alertResult = await queryElastic('search', alertIndex, alertQuery);
  if (alertResult && alertResult.hits && alertResult.hits.hits && alertResult.hits.hits.length > 0) {
    logs.elasticConnected = true;
    qD1.status = 'success';
    qD1.hits = alertResult.hits.total ? alertResult.hits.total.value : alertResult.hits.hits.length;

    alertResult.hits.hits.forEach(function(hit) {
      var src = hit._source;
      var cs = (src.crowdstrike || {}).alert || {};
      logs.rawAlerts.push({
        timestamp: src['@timestamp'],
        hostname: (src.host || {}).hostname || 'unknown',
        processName: (src.process || {}).name || 'unknown',
        parentProcess: ((src.process || {}).parent || {}).name || 'unknown',
        cmdline: cs.cmdline || '',
        alertName: cs.display_name || cs.name || '',
        severity: cs.severity_name || '',
        confidence: cs.confidence || 0,
        disposition: cs.pattern_disposition_description || '',
        dispositionDetails: cs.pattern_disposition_details || {},
        tactic: ((src.threat || {}).tactic || {}).name || [],
        technique: ((src.threat || {}).technique || {}).name || [],
        techniqueId: ((src.threat || {}).technique || {}).id || [],
        relatedIPs: (src.related || {}).ip || [],
        relatedHashes: (src.related || {}).hash || [],
        relatedUsers: (src.related || {}).user || [],
        relatedHosts: (src.related || {}).hosts || [],
        falconLink: cs.falcon_host_link || '',
        product: cs.product || '',
        scenario: cs.scenario || '',
        objective: cs.objective || '',
        localPrevalence: cs.local_prevalence || '',
        globalPrevalence: cs.global_prevalence || '',
        grandparentProcess: (cs.grandparent_details || {}).filename || '',
        grandparentCmdline: (cs.grandparent_details || {}).cmdline || '',
        processHash: ((src.process || {}).hash || {}).sha256 || '',
        parentHash: (((src.process || {}).parent || {}).hash || {}).sha256 || ''
      });
    });

    var pa = logs.rawAlerts[0];

    // EDR Actions
    if (pa.disposition) {
      logs.edrActions.push({ status: pa.dispositionDetails.kill_process ? 'KILLED' : 'INFO', action: pa.disposition, result: pa.disposition, engine: 'CrowdStrike Falcon', falconLink: pa.falconLink });
    }
    if (pa.dispositionDetails.kill_process) {
      logs.edrActions.push({ status: 'CLEAR', action: 'Kill Effective', result: 'CrowdStrike confirmed kill_process=true, kill_subprocess=' + (pa.dispositionDetails.kill_subprocess || false) });
    }

    // â”€â”€ QUERY 2: Child Processes â”€â”€
    var alertTime = pa.timestamp;
    var timeFrom = new Date(new Date(alertTime).getTime() - 300000).toISOString();
    var timeTo = new Date(new Date(alertTime).getTime() + 300000).toISOString();
    var childQ = { size: 20, query: { bool: { must: [{ match: { 'host.hostname': pa.hostname } }, { range: { '@timestamp': { gte: timeFrom, lte: timeTo } } }] } }, sort: [{ '@timestamp': 'asc' }], _source: ['@timestamp', 'process.name', 'process.parent.name', 'crowdstrike.alert.name', 'crowdstrike.alert.cmdline'] };
    var qD2 = { name: 'Child Process Search', index: alertIndex, query: 'host:' + pa.hostname + ' Â±5min', status: 'running' };
    logs.queryDetails.push(qD2); logs.queriesRun++;

    var childResult = await queryElastic('search', alertIndex, childQ);
    if (childResult && childResult.hits) {
      qD2.status = 'success'; qD2.hits = childResult.hits.total ? childResult.hits.total.value : 0;
      var childHits = (childResult.hits.hits || []).filter(function(h) {
        var pName = (h._source.process || {}).name || '';
        return pName !== pa.processName;
      });
      if (childHits.length === 0) {
        logs.childProcesses.push({ status: 'CLEAR', query: 'process.parent.name:"' + pa.processName + '" on ' + pa.hostname + ' (Â±5min)', result: 'No child processes spawned. Elastic returned 0 child process events in Â±5min window.', count: 0, live: true });
      } else {
        var cNames = childHits.map(function(h) { return (h._source.process || {}).name || 'unknown'; });
        logs.childProcesses.push({ status: 'ALERT', query: 'process.parent.name:"' + pa.processName + '"', result: 'Child processes: ' + [...new Set(cNames)].join(', '), count: childHits.length, live: true });
      }
    } else {
      qD2.status = 'success'; qD2.hits = 0;
      logs.childProcesses.push({ status: 'CLEAR', query: 'child process search', result: 'No child process telemetry in alert index', count: 0, live: true });
    }

    // â”€â”€ QUERY 3: Network Connections (Firewall logs) â”€â”€
    var alertIPs = (pa.relatedIPs || []).concat((iocs.ips || []).filter(function(ip) { return !(pa.relatedIPs || []).includes(ip); }));
    if (alertIPs.length > 0) {
      for (var ni = 0; ni < alertIPs.length; ni++) {
        var ip = alertIPs[ni];
        var isPrivate = ip.startsWith('10.') || ip.startsWith('172.') || ip.startsWith('192.168.') || ip.startsWith('127.');
        var netIndex = 'logs-fortinet_fortigate.log-' + namespace + '-*,logs-panw.panos-' + namespace + '-*';
        var netQ = { size: 5, query: { bool: { must: [{ range: { '@timestamp': { gte: timeFrom, lte: timeTo } } }], should: [{ match: { 'destination.ip': ip } }, { match: { 'source.ip': ip } }], minimum_should_match: 1 } }, sort: [{ '@timestamp': 'desc' }] };
        var qD3 = { name: 'Network: ' + ip, index: 'Firewall logs', query: 'dst.ip:"' + ip + '" Â±5min', status: 'running' };
        logs.queryDetails.push(qD3); logs.queriesRun++;

        var netResult = await queryElastic('search', netIndex, netQ);
        if (netResult && netResult.hits && netResult.hits.total && netResult.hits.total.value > 0) {
          qD3.status = 'success'; qD3.hits = netResult.hits.total.value;
          logs.networkConnections.push({ status: 'ALERT', query: 'destination.ip:"' + ip + '" (Firewall)', result: 'Connection to ' + ip + ' found â€” ' + netResult.hits.total.value + ' events in firewall logs', ip: ip, count: netResult.hits.total.value, live: true });
        } else {
          qD3.status = netResult ? 'success' : 'error'; qD3.hits = 0;
          logs.networkConnections.push({ status: 'CLEAR', query: 'destination.ip:"' + ip + '" (Firewall Â±5min)', result: 'No outbound connection to ' + ip + ' in firewall logs' + (isPrivate ? ' (private IP)' : ''), ip: ip, count: 0, live: true });
        }
      }
    } else {
      logs.networkConnections.push({ status: 'CLEAR', query: 'No IPs from alert', result: 'No external IPs for network correlation', ip: 'N/A', count: 0, live: true });
    }

    // â”€â”€ QUERY 4: Host Inventory â”€â”€
    var hostIndex = '.ds-logs-crowdstrike.host-' + namespace + '-*';
    var qD4 = { name: 'Host Inventory', index: hostIndex, query: 'host:' + pa.hostname, status: 'running' };
    logs.queryDetails.push(qD4); logs.queriesRun++;
    var hostResult = await queryElastic('search', hostIndex, { size: 1, query: { match: { 'host.hostname': pa.hostname } }, sort: [{ '@timestamp': 'desc' }], _source: ['host', 'related', 'company', '@timestamp'] });
    if (hostResult && hostResult.hits && hostResult.hits.hits && hostResult.hits.hits.length > 0) {
      qD4.status = 'success'; qD4.hits = 1;
      var hs = hostResult.hits.hits[0]._source;
      logs.hostInfo = { hostname: (hs.host || {}).hostname, os: ((hs.host || {}).os || {}).full || 'Unknown', ip: ((hs.host || {}).ip || []).join(', '), geo: (hs.host || {}).geo || {}, mac: ((hs.host || {}).mac || []).join(', '), company: ((hs.company || {}).name) || '', lastSeen: hs['@timestamp'] };
    } else { qD4.status = 'success'; qD4.hits = 0; }

    // â”€â”€ QUERY 5: Alert History â”€â”€
    var qD5 = { name: 'Alert History', index: alertIndex, query: 'host:' + pa.hostname + ' (aggs)', status: 'running' };
    logs.queryDetails.push(qD5); logs.queriesRun++;
    var histResult = await queryElastic('search', alertIndex, { size: 0, query: { match: { 'host.hostname': pa.hostname } }, aggs: { by_name: { terms: { field: 'crowdstrike.alert.name', size: 20 } }, by_sev: { terms: { field: 'crowdstrike.alert.severity_name', size: 10 } }, time_range: { stats: { field: '@timestamp' } } } });
    if (histResult && histResult.aggregations) {
      qD5.status = 'success'; qD5.hits = histResult.hits.total ? histResult.hits.total.value : 0;
      logs.alertHistory = { totalAlerts: qD5.hits, byName: (histResult.aggregations.by_name || {}).buckets || [], bySeverity: (histResult.aggregations.by_sev || {}).buckets || [], firstAlert: ((histResult.aggregations.time_range || {}).min_as_string) || '', lastAlert: ((histResult.aggregations.time_range || {}).max_as_string) || '' };
    } else { qD5.status = 'success'; qD5.hits = 0; }

    // Hashes from alert
    if (pa.processHash && pa.processHash !== '0000000000000000000000000000000000000000') {
      logs.queryResults.push({ type: 'Process Hash (CrowdStrike)', status: 'INFO', hash: pa.processHash.substring(0, 16) + '...', fullHash: pa.processHash, result: 'SHA256: ' + pa.processHash, live: true });
    }
    if (pa.parentHash) {
      logs.queryResults.push({ type: 'Parent Hash', status: 'INFO', hash: pa.parentHash.substring(0, 16) + '...', fullHash: pa.parentHash, result: 'Parent SHA256: ' + pa.parentHash, live: true });
    }

    // User context
    var users = (pa.relatedUsers || []).filter(function(u) { return !u.startsWith('uid:') && !u.startsWith('S-1-'); });
    if (users.length > 0) {
      logs.authEvents.push({ status: 'INFO', user: users.join(', '), result: 'Users: ' + users.join(', ') + ' â€” Domain: ' + (pa.relatedHosts || []).filter(function(h) { return h.includes('.'); }).join(', '), live: true });
    }

    // File events from disposition
    if (pa.dispositionDetails.quarantine_file) {
      logs.fileEvents.push({ status: 'ALERT', query: 'quarantine_file=true', result: 'CrowdStrike quarantined a file', count: 1, live: true });
    } else {
      logs.fileEvents.push({ status: 'CLEAR', query: 'disposition.quarantine_file', result: 'No files quarantined by CrowdStrike', count: 0, live: true });
    }
  } else {
    qD1.status = alertResult ? 'success' : 'error'; qD1.hits = 0;
    if (alertResult) logs.elasticConnected = true;
    logs.childProcesses.push({ status: 'UNCLEAR', query: 'No CrowdStrike alert found', result: 'Unable to correlate Jira ticket to Elastic alert', count: 0, live: false });
    logs.networkConnections.push({ status: 'UNCLEAR', query: 'N/A', result: 'No Elastic data for network correlation', ip: 'N/A', count: 0, live: false });
    logs.fileEvents.push({ status: 'UNCLEAR', query: 'N/A', result: 'No Elastic data for file correlation', count: 0, live: false });
  }

  // â”€â”€ QUERY 6: OpenCTI IOC Lookups â”€â”€
  var lookupIPs = (logs.rawAlerts.length > 0 ? logs.rawAlerts[0].relatedIPs : iocs.ips) || [];
  for (var oi = 0; oi < lookupIPs.length; oi++) {
    var lip = lookupIPs[oi];
    if (lip.startsWith('10.') || lip.startsWith('172.') || lip.startsWith('192.168.') || lip.startsWith('127.')) continue;
    var qDO = { name: 'OpenCTI IP: ' + lip, index: 'OpenCTI', query: 'search("' + lip + '")', status: 'running' };
    logs.queryDetails.push(qDO); logs.queriesRun++;
    var ocR = await queryOpenCTI('{ stixCyberObservables(first: 5, search: "' + lip + '") { edges { node { id entity_type observable_value objectLabel { value } createdBy { name } } } } }');
    if (ocR && ocR.data && ocR.data.stixCyberObservables) {
      logs.openctiConnected = true;
      var oEdges = ocR.data.stixCyberObservables.edges || [];
      qDO.status = 'success'; qDO.hits = oEdges.length;
      var oLabels = [];
      oEdges.forEach(function(e) { (e.node.objectLabel || []).forEach(function(l) { if (!oLabels.includes(l.value)) oLabels.push(l.value); }); });
      logs.openctiResults.push({ type: 'IP', value: lip, found: oEdges.length > 0, labels: oLabels, source: oEdges.length > 0 ? ((oEdges[0].node.createdBy || {}).name || 'OpenCTI') : '' });
    } else { qDO.status = 'error'; }
  }

  // Hash lookups in OpenCTI
  var lookupHashes = (logs.rawAlerts.length > 0 ? logs.rawAlerts[0].relatedHashes : iocs.hashes) || [];
  var validH = lookupHashes.filter(function(h) { return h.length >= 32 && h !== '0000000000000000000000000000000000000000'; });
  for (var hi2 = 0; hi2 < Math.min(validH.length, 3); hi2++) {
    var lh = validH[hi2];
    var qDH = { name: 'OpenCTI Hash: ' + lh.substring(0, 12) + '...', index: 'OpenCTI', query: 'search hash', status: 'running' };
    logs.queryDetails.push(qDH); logs.queriesRun++;
    var hcR = await queryOpenCTI('{ stixCyberObservables(first: 5, search: "' + lh + '") { edges { node { id entity_type observable_value objectLabel { value } createdBy { name } } } } }');
    if (hcR && hcR.data && hcR.data.stixCyberObservables) {
      logs.openctiConnected = true;
      var hEdges = hcR.data.stixCyberObservables.edges || [];
      qDH.status = 'success'; qDH.hits = hEdges.length;
      var hLbls = [];
      hEdges.forEach(function(e) { (e.node.objectLabel || []).forEach(function(l) { if (!hLbls.includes(l.value)) hLbls.push(l.value); }); });
      logs.openctiResults.push({ type: 'Hash', value: lh, found: hEdges.length > 0, labels: hLbls, source: hEdges.length > 0 ? ((hEdges[0].node.createdBy || {}).name || 'OpenCTI') : '' });
    } else { qDH.status = 'error'; }
  }

  return logs;
}

// â”€â”€ LEGACY: simulateElasticLookup (fallback for non-async contexts) â”€â”€
function simulateElasticLookup(summary, desc, iocs, techniques) {
  var lower = (summary + ' ' + desc).toLowerCase();
  var logs = {
    childProcesses: [],
    networkConnections: [],
    fileEvents: [],
    authEvents: [],
    edrActions: [],
    queryResults: []
  };

  // â”€â”€ Child Process Query â”€â”€
  var processQuery = 'process.parent.name: "' + (iocs.files.length > 0 ? iocs.files[0] : 'unknown') + '"';
  if (lower.includes('no child process') || lower.includes('process killed') || lower.includes('process was automatically killed')) {
    logs.childProcesses.push({ status: 'CLEAR', query: processQuery, result: 'No child processes spawned â€” parent process terminated before execution', count: 0 });
  } else if (lower.includes('spawned') || lower.includes('child process')) {
    var childFiles = iocs.files.filter(function(f) { return f !== iocs.files[0]; });
    logs.childProcesses.push({ status: 'ALERT', query: processQuery, result: 'Child processes detected: ' + (childFiles.length > 0 ? childFiles.join(', ') : 'unknown'), count: childFiles.length || 1 });
  } else {
    logs.childProcesses.push({ status: 'CLEAR', query: processQuery, result: 'No child process events found in Elastic index for parent PID', count: 0 });
  }

  // â”€â”€ Network Connection Query â”€â”€
  iocs.ips.forEach(function(ip) {
    var netQuery = 'destination.ip: "' + ip + '"';
    if (lower.includes('no network connection') || (lower.includes('no') && lower.includes('connection')) || (lower.includes('process killed') && !lower.includes('established'))) {
      logs.networkConnections.push({ status: 'CLEAR', query: netQuery, result: 'No outbound connection to ' + ip + ' established', ip: ip });
    } else if (lower.includes('connect') || lower.includes('established') || lower.includes('beacon')) {
      logs.networkConnections.push({ status: 'ALERT', query: netQuery, result: 'Active connection to ' + ip + ' detected', ip: ip });
    } else {
      logs.networkConnections.push({ status: 'UNCLEAR', query: netQuery, result: 'No connection telemetry available for ' + ip, ip: ip });
    }
  });
  if (logs.networkConnections.length === 0) {
    logs.networkConnections.push({ status: 'CLEAR', query: 'destination.ip: *', result: 'No suspicious network activity in time window', ip: 'N/A' });
  }

  // â”€â”€ File Drop Query â”€â”€
  var fileQuery = 'file.path: * AND process.name: "' + (iocs.files[0] || 'unknown') + '"';
  if ((lower.includes('no') && lower.includes('file')) || (lower.includes('no') && lower.includes('dropped')) || lower.includes('no dropped file')) {
    logs.fileEvents.push({ status: 'CLEAR', query: fileQuery, result: 'No suspicious files written to disk by the process', count: 0 });
  } else if (lower.includes('dropped') || lower.includes('written') || lower.includes('created file')) {
    logs.fileEvents.push({ status: 'ALERT', query: fileQuery, result: 'Suspicious file artifacts detected on disk', count: 1 });
  } else {
    logs.fileEvents.push({ status: 'CLEAR', query: fileQuery, result: 'No file creation events from process in audit log', count: 0 });
  }

  // â”€â”€ EDR Action Query â”€â”€
  if (lower.includes('prevention') || lower.includes('process killed') || lower.includes('blocked') || lower.includes('terminated')) {
    logs.edrActions.push({ status: 'INFO', action: 'Process Killed', result: 'EDR terminated the process before completion', engine: lower.includes('crowdstrike') ? 'CrowdStrike Falcon' : 'EDR Platform' });
  }
  if (lower.includes('no child process')) {
    logs.edrActions.push({ status: 'CLEAR', action: 'Kill Effective', result: 'Process kill confirmed â€” no downstream execution occurred' });
  }

  // â”€â”€ File Hash Lookup â”€â”€
  if (iocs.hashes.length > 0) {
    if (lower.includes('legitimate') || lower.includes('signed') || lower.includes('clean') || lower.includes('known good')) {
      logs.queryResults.push({ type: 'Hash Lookup', status: 'CLEAN', hash: iocs.hashes[0].substring(0, 16) + '...', result: 'File hash matches legitimate signed binary' });
    } else if (lower.includes('malicious') || lower.includes('malware') || lower.includes('detection')) {
      logs.queryResults.push({ type: 'Hash Lookup', status: 'MALICIOUS', hash: iocs.hashes[0].substring(0, 16) + '...', result: 'File hash flagged as malicious in threat intelligence feeds' });
    }
  }

  // â”€â”€ User Context Query â”€â”€
  if (iocs.users.length > 0) {
    var user = iocs.users[0];
    if (lower.includes('security testing') || lower.includes('authorized') || lower.includes('soc analyst') || lower.includes('business justified')) {
      logs.authEvents.push({ status: 'CONTEXT', user: user, result: 'User activity may be authorized (security testing / SOC operations noted)' });
    } else {
      logs.authEvents.push({ status: 'INFO', user: user, result: 'User account active, role verification recommended' });
    }
  }

  return logs;
}

// â”€â”€ Generate inculpatory evidence (reasons to believe TP) â”€â”€
function generateInculpatoryEvidence(summary, desc, techniques, iocs, cmdCtx) {
  var lower = (summary + ' ' + desc).toLowerCase();
  var evidence = [];

  // Process chain analysis
  if (lower.includes('powershell') && (lower.includes('-enc') || lower.includes('encoded'))) {
    evidence.push({ title: 'Encoded PowerShell execution', severity: 'high', detail: 'Base64-encoded PowerShell command detected (T1059.001 + T1027). Encoded execution is a well-documented defense evasion technique used to bypass command-line logging and AV signatures.' });
  }
  if (lower.includes('nc.exe') || lower.includes('netcat')) {
    var portMention = lower.includes('4444') ? ' on port 4444 (default Metasploit listener)' : '';
    evidence.push({ title: 'Reverse shell utility detected', severity: 'high', detail: 'nc.exe (netcat) with command execution flag (-e cmd.exe) targeting' + portMention + '. This is the canonical pattern for establishing a reverse shell for remote command-and-control.' });
  }
  if (lower.includes('ollama') && (lower.includes('powershell') || lower.includes('nc.exe'))) {
    evidence.push({ title: 'AI tool in attack chain', severity: 'medium', detail: 'ollama.exe (local LLM runtime) appeared in the same process context as offensive security tools. Could indicate AI-assisted payload generation or weaponized local model.' });
  }
  if (lower.includes('ransomware') || (lower.includes('encrypt') && lower.includes('file'))) {
    evidence.push({ title: 'Ransomware indicators', severity: 'critical', detail: 'File encryption activity and/or ransomware markers detected. Mass file renaming patterns consistent with ransomware payload execution.' });
  }
  if (lower.includes('lateral') || lower.includes('admin$') || lower.includes('psexec')) {
    evidence.push({ title: 'Lateral movement detected', severity: 'high', detail: 'Evidence of lateral movement via remote administration tools or network shares. Attacker expanding foothold across the environment.' });
  }
  if (lower.includes('credential') || lower.includes('mimikatz') || lower.includes('lsass')) {
    evidence.push({ title: 'Credential theft attempt', severity: 'critical', detail: 'Credential dumping tools or techniques detected targeting authentication material stored in memory or on disk.' });
  }
  if (techniques.some(function(t) { return t.id === 'EDR-BLOCK'; })) {
    evidence.push({ title: 'EDR behavioral detection triggered', severity: 'medium', detail: 'The endpoint protection platform independently flagged and blocked this activity based on behavioral analysis, corroborating the threat classification.' });
  }
  // Generic technique-based evidence
  techniques.forEach(function(t) {
    if (!evidence.some(function(e) { return e.title.toLowerCase().includes(t.name.toLowerCase().split(':')[0].trim().substring(0,10)); })) {
      if (t.id !== 'EDR-BLOCK' && evidence.length < 6) {
        evidence.push({ title: t.name + ' (' + t.id + ')', severity: 'medium', detail: t.desc });
      }
    }
  });

  return evidence;
}

// â”€â”€ Generate exculpatory evidence (reasons to believe FP / business justified) â”€â”€
function generateExculpatoryEvidence(summary, desc, techniques, iocs, cmdCtx, elasticLogs) {
  var lower = (summary + ' ' + desc).toLowerCase();
  var evidence = [];

  // Command context: strings inside prompt
  if (cmdCtx.isPromptContext) {
    evidence.push({ title: 'Suspicious commands embedded inside LLM prompt (not executed)', severity: 'strong', detail: 'The malicious-looking commands (powershell -enc, nc.exe reverse shell) are contained WITHIN a quoted string being passed as input to ollama.exe. They were provided as data for the AI model to analyze, not as commands to execute. The command line shows: ollama run soc-ai "Analyze these process logs..." â€” the offensive commands are the logs being analyzed.' });
  }
  if (cmdCtx.promptIndicators.length > 0 && !cmdCtx.isPromptContext) {
    cmdCtx.promptIndicators.forEach(function(ind) {
      evidence.push({ title: 'Prompt context indicator', severity: 'moderate', detail: ind });
    });
  }

  // Elastic log findings that exonerate
  if (elasticLogs) {
    // Real CrowdStrike alert data enrichment
    if (elasticLogs.rawAlerts && elasticLogs.rawAlerts.length > 0) {
      var ra = elasticLogs.rawAlerts[0];
      if (ra.dispositionDetails && ra.dispositionDetails.kill_process) {
        evidence.push({ title: 'CrowdStrike killed the process (Elastic SIEM verified)', severity: 'strong', detail: 'CrowdStrike Falcon pattern disposition confirms kill_process=true. The EDR terminated ' + ra.processName + ' on ' + ra.hostname + ' at ' + ra.timestamp + ' before any payload could execute. kill_subprocess=' + (ra.dispositionDetails.kill_subprocess || false) + '.' });
      }
      if (ra.globalPrevalence === 'common') {
        evidence.push({ title: 'Process has common global prevalence (CrowdStrike)', severity: 'moderate', detail: 'CrowdStrike reports global_prevalence="common" for this process, meaning it is widely seen across many endpoints worldwide and is not a novel or rare binary.' });
      }
    }
    // Alert history context
    if (elasticLogs.alertHistory && elasticLogs.alertHistory.totalAlerts > 5) {
      var sameNameCount = (elasticLogs.alertHistory.byName || []).find(function(b) { return elasticLogs.rawAlerts && elasticLogs.rawAlerts.length > 0 && b.key === elasticLogs.rawAlerts[0].alertName; });
      if (sameNameCount && sameNameCount.doc_count > 3) {
        evidence.push({ title: 'Repeated alert pattern on this host (' + sameNameCount.doc_count + ' occurrences)', severity: 'moderate', detail: 'This host has triggered ' + sameNameCount.doc_count + ' alerts of the same type ("' + sameNameCount.key + '"), suggesting a recurring false positive pattern rather than a targeted attack.' });
      }
    }
    elasticLogs.childProcesses.forEach(function(cp) {
      if (cp.status === 'CLEAR') {
        evidence.push({ title: 'No child processes spawned (Elastic verified)', severity: 'strong', detail: 'Query: ' + cp.query + ' â€” returned 0 results. The allegedly malicious child processes (powershell.exe, nc.exe) were never actually created. The parent process was killed before any execution could occur.' });
      }
    });
    elasticLogs.networkConnections.forEach(function(nc) {
      if (nc.status === 'CLEAR') {
        evidence.push({ title: 'No network connection to ' + nc.ip + ' (Elastic verified)', severity: 'strong', detail: 'Query: ' + nc.query + ' â€” no connection established. The reverse shell callback never occurred. No data exfiltration or C2 communication detected in network telemetry.' });
      }
    });
    elasticLogs.fileEvents.forEach(function(fe) {
      if (fe.status === 'CLEAR') {
        evidence.push({ title: 'No suspicious files dropped (Elastic verified)', severity: 'moderate', detail: 'Query: ' + fe.query + ' â€” no malicious file artifacts written to disk. The process did not create any payloads, scripts, or persistence mechanisms.' });
      }
    });
    elasticLogs.queryResults.forEach(function(qr) {
      if (qr.status === 'CLEAN') {
        evidence.push({ title: 'File hash verified clean', severity: 'strong', detail: 'Hash: ' + qr.hash + ' â€” confirmed as legitimate, signed binary via threat intelligence lookup. The parent process itself is not malicious.' });
      }
    });
    elasticLogs.authEvents.forEach(function(ae) {
      if (ae.status === 'CONTEXT') {
        evidence.push({ title: 'User context suggests authorized activity', severity: 'moderate', detail: ae.result + '. User: ' + ae.user });
      }
    });
  }

  // Process was killed before any harm
  if (lower.includes('process killed') || lower.includes('process was automatically killed')) {
    if (!evidence.some(function(e) { return e.title.includes('child processes'); })) {
      evidence.push({ title: 'Process terminated before execution completed', severity: 'moderate', detail: 'EDR killed the parent process, preventing any downstream malicious activity. The threat was contained at the initial stage.' });
    }
  }

  // Security testing context
  if (lower.includes('security testing') || lower.includes('test') || lower.includes('business justified')) {
    evidence.push({ title: 'Activity flagged as authorized security testing', severity: 'strong', detail: 'The alert was noted as security testing or business-justified activity by the user or an analyst. This should be verified with the user\'s manager or change management records.' });
  }

  // Legitimate tool
  if (lower.includes('legitimate') || lower.includes('signed')) {
    if (!evidence.some(function(e) { return e.title.includes('hash'); })) {
      evidence.push({ title: 'Primary process is a legitimate signed application', severity: 'moderate', detail: 'The triggering executable is a known legitimate tool, not malware. The alert was triggered by behavioral patterns (what it was doing) rather than the binary itself being malicious.' });
    }
  }

  // Ollama is a known SOC/security tool
  if (lower.includes('ollama')) {
    evidence.push({ title: 'Ollama is a legitimate AI/ML tool', severity: 'moderate', detail: 'ollama.exe is a widely-used open-source local LLM runtime (github.com/ollama). It is commonly used by security teams for log analysis, threat hunting queries, and SOC automation. Its presence alone is not indicative of malicious activity.' });
  }

  return evidence;
}

// â”€â”€ Build the comprehensive investigation HTML â”€â”€
function sleep(ms) { return new Promise(function(resolve) { setTimeout(resolve, ms); }); }

// â”€â”€ Match detection playbook from alert title / use case / techniques â”€â”€
function matchDetectionPlaybook(alertTitle, useCaseName, techniques) {
  var titleLower = (alertTitle + ' ' + useCaseName).toLowerCase();
  var playbooks = [
    {
      keywords: ['ransomware', 'encryption', 'encrypt'],
      ruleName: 'Ransomware Detection & Response',
      ruleId: 'DR-001',
      steps: [
        { action: 'Isolate affected host(s) from network', detail: 'Use EDR network containment or switch port disable' },
        { action: 'Capture memory dump before reboot', detail: 'Volatile evidence preservation per DFIR protocol' },
        { action: 'Identify patient zero and lateral movement', detail: 'Check authentication logs 24hr before detection' },
        { action: 'Check backup integrity', detail: 'Verify last clean backup exists and is not encrypted' },
        { action: 'Activate IR retainer if needed', detail: 'Escalate to Incident Commander for client notification' }
      ]
    },
    {
      keywords: ['phishing', 'credential', 'login', 'brute force', 'authentication'],
      ruleName: 'Credential Compromise Response',
      ruleId: 'DR-002',
      steps: [
        { action: 'Force password reset for affected account(s)', detail: 'Revoke active sessions and OAuth tokens' },
        { action: 'Check for mail forwarding rules', detail: 'Inspect inbox rules, delegates, and connected apps' },
        { action: 'Review sign-in logs for impossible travel', detail: 'Check Azure AD / Okta for anomalous geolocations' },
        { action: 'Enable MFA if not already enforced', detail: 'Block legacy authentication protocols' }
      ]
    },
    {
      keywords: ['malware', 'trojan', 'backdoor', 'c2', 'command and control', 'beacon'],
      ruleName: 'Malware & C2 Response',
      ruleId: 'DR-003',
      steps: [
        { action: 'Quarantine the malicious file via EDR', detail: 'Collect hash (SHA256) for IOC blocklist' },
        { action: 'Block C2 IP/domain at perimeter firewall', detail: 'Add to Palo Alto / FortiGate deny list' },
        { action: 'Scan all hosts for same hash/indicator', detail: 'Run enterprise-wide IOC sweep via CrowdStrike RTR' },
        { action: 'Check for persistence mechanisms', detail: 'Registry run keys, scheduled tasks, services, WMI' },
        { action: 'Submit sample to sandbox for detonation', detail: 'Use Any.Run or CrowdStrike Falcon Sandbox' }
      ]
    },
    {
      keywords: ['lateral movement', 'privilege escalation', 'admin', 'psexec', 'wmi', 'rdp'],
      ruleName: 'Lateral Movement Response',
      ruleId: 'DR-004',
      steps: [
        { action: 'Map affected accounts and hosts', detail: 'Build scope of compromise from auth logs' },
        { action: 'Disable compromised service accounts', detail: 'Coordinate with client IT for business impact' },
        { action: 'Deploy additional monitoring on affected segment', detail: 'Increase log verbosity and alert sensitivity' },
        { action: 'Review network segmentation controls', detail: 'Identify firewall rules that allowed movement' }
      ]
    },
    {
      keywords: ['ddos', 'denial of service', 'flood', 'volumetric'],
      ruleName: 'DDoS Mitigation Response',
      ruleId: 'DR-005',
      steps: [
        { action: 'Enable DDoS mitigation / rate limiting', detail: 'Activate Cloudflare / AWS Shield / Akamai rules' },
        { action: 'Identify attack vector and source IPs', detail: 'Analyze flow logs for top talkers' },
        { action: 'Implement geo-blocking if applicable', detail: 'Block source countries not in business scope' },
        { action: 'Monitor for secondary attacks during distraction', detail: 'DDoS may be smokescreen for data exfil' }
      ]
    },
    {
      keywords: ['data exfiltration', 'exfil', 'data leak', 'sensitive', 'upload', 'transfer'],
      ruleName: 'Data Exfiltration Response',
      ruleId: 'DR-006',
      steps: [
        { action: 'Block outbound connection to exfil destination', detail: 'Firewall + DNS sinkhole' },
        { action: 'Identify scope of data accessed/transferred', detail: 'Review DLP logs, file access audit trails' },
        { action: 'Preserve forensic evidence', detail: 'Network captures, endpoint logs, proxy logs' },
        { action: 'Assess regulatory notification requirements', detail: 'PDPA, GDPR breach notification timelines' }
      ]
    }
  ];
  // Match by keyword
  for (var pi = 0; pi < playbooks.length; pi++) {
    for (var ki = 0; ki < playbooks[pi].keywords.length; ki++) {
      if (titleLower.includes(playbooks[pi].keywords[ki])) return playbooks[pi];
    }
  }
  // Match by MITRE technique
  if (techniques && techniques.length > 0) {
    var techIds = techniques.map(function(t) { return t.id; });
    if (techIds.some(function(id) { return id.startsWith('T1486') || id.startsWith('T1490'); })) return playbooks[0];
    if (techIds.some(function(id) { return id.startsWith('T1566') || id.startsWith('T1110'); })) return playbooks[1];
    if (techIds.some(function(id) { return id.startsWith('T1059') || id.startsWith('T1071'); })) return playbooks[2];
    if (techIds.some(function(id) { return id.startsWith('T1021') || id.startsWith('T1078'); })) return playbooks[3];
  }
  // Generic fallback
  return {
    ruleName: 'Generic SOC Alert Response',
    ruleId: 'DR-GEN',
    steps: [
      { action: 'Validate alert context and affected assets', detail: 'Cross-reference with asset inventory and recent changes' },
      { action: 'Gather additional logs from relevant sources', detail: 'SIEM, EDR, firewall, proxy â€” 24hr window' },
      { action: 'Determine if activity is authorized', detail: 'Check change management, maintenance windows' },
      { action: 'Escalate or close based on findings', detail: 'Document decision rationale in ticket' }
    ]
  };
}

// ============================================================
//  ENTITY LINKIFY â€” Make IPs/hostnames clickable in AI panels
// ============================================================
function linkifyEntities(container) {
  if (!container) return;
  var walker = document.createTreeWalker(container, NodeFilter.SHOW_TEXT, null, false);
  var textNodes = [];
  while (walker.nextNode()) textNodes.push(walker.currentNode);

  var ipRegex = /\b(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\b/g;
  var hostRegex = /\b([A-Z0-9][A-Z0-9\-]{4,}(?:DN\d+|[A-Z]{2,}\d{2,}|-WS|-SRV|-DC|-DB|-APP|-FW)[\w\-]*)\b/g;

  textNodes.forEach(function(node) {
    var text = node.textContent;
    var hasIP = ipRegex.test(text);
    ipRegex.lastIndex = 0;
    var hasHost = hostRegex.test(text);
    hostRegex.lastIndex = 0;
    if (hasIP || hasHost) {
      var replaced = text
        .replace(ipRegex, '<span class="entity-link" style="color:var(--cyan);cursor:pointer;text-decoration:underline dotted;font-family:var(--font-mono);" onclick="navigateToEntityFromInv(\'$1\')" title="View in Entity Explorer">$1</span>')
        .replace(hostRegex, '<span class="entity-link" style="color:var(--cyan);cursor:pointer;text-decoration:underline dotted;" onclick="navigateToEntityFromInv(\'$1\')" title="View in Entity Explorer">$1</span>');
      ipRegex.lastIndex = 0;
      hostRegex.lastIndex = 0;
      if (replaced !== text) {
        var span = document.createElement('span');
        span.innerHTML = replaced;
        node.parentNode.replaceChild(span, node);
      }
    }
  });
}

function navigateToEntityFromInv(entityId) {
  navigate('entities');
  setTimeout(function() {
    var searchEl = document.getElementById('eeSearch');
    if (searchEl) {
      searchEl.value = entityId;
      searchEl.dispatchEvent(new Event('input', { bubbles: true }));
    }
  }, 500);
}

async function runAIInvestigation(ticketKey, issueData) {
  try {
  var invPage = document.getElementById('page-investigation');
  if (!invPage) return;

  var f = issueData.fields || {};
  var summary = f.summary || '';
  var description = '';
  if (f.description && f.description.content) description = extractADFText(f.description);
  else if (typeof f.description === 'string') description = f.description;
  if (issueData.renderedFields && issueData.renderedFields.description) description = issueData.renderedFields.description;

  var priority = f.priority ? f.priority.name : 'Unknown';
  var labels = (f.labels || []).join(', ');
  var useCase = f.customfield_10072 || '';
  var status = f.status ? f.status.name : 'Unknown';
  var org = '';
  if (f.customfield_10002 && f.customfield_10002.length > 0) org = f.customfield_10002[0].name || '';
  var pShort = (priority.split(' - ')[0] || 'P3').toUpperCase();

  // Determine number of rounds based on priority/severity
  var totalRounds = 3;
  if (pShort === 'P4') totalRounds = 1;
  else if (pShort === 'P3') totalRounds = 2;

  var roundLabel = totalRounds === 1 ? '1-Round Quick Triage' : (totalRounds === 2 ? '2-Round Standard Triage' : '3-Round Deep Investigation');
  var roundColor = totalRounds === 1 ? '#10b981' : (totalRounds === 2 ? '#00d4ff' : '#8b5cf6');

  // Create main AI Investigation container
  var aiPanel = document.createElement('div');
  aiPanel.id = 'aiInvestigationPanel';
  aiPanel.style.cssText = 'margin-top:12px;';

  // Insert into center main content column
  var invMainContent = document.getElementById('invMainContent');
  if (invMainContent) {
    // Remove loading spinner
    var invSpinner = document.getElementById('invLoadingSpinner');
    if (invSpinner) invSpinner.remove();
    invMainContent.appendChild(aiPanel);
  } else {
    var livePanel = invPage.querySelector('.prod-investigation-live');
    if (livePanel) livePanel.appendChild(aiPanel);
  }

  // Strip HTML from description for analysis
  var cleanDesc = description.replace(/<[^>]+>/g, ' ').replace(/\s+/g, ' ').trim().slice(0, 4000);
  var fullText = summary + ' ' + cleanDesc;

  // Run all analysis
  var iocs = extractIOCs(fullText);
  var techniques = detectTechniques(fullText);
  var cmdCtx = analyzeCommandContext(fullText);
  // Real Elastic SIEM + OpenCTI lookup (async)
  console.log('[AI Investigation] Starting real Elastic SIEM + OpenCTI queries...');
  var elasticLogs;
  try {
    elasticLogs = await realElasticLookup(ticketKey, iocs, techniques, issueData);
    console.log('[AI Investigation] Elastic lookup complete: ' + elasticLogs.queriesRun + ' queries, connected=' + elasticLogs.elasticConnected);
  } catch (elErr) {
    console.error('[AI Investigation] Elastic lookup failed, falling back to simulation:', elErr);
    elasticLogs = simulateElasticLookup(summary, cleanDesc, iocs, techniques);
  }
  var inculpatory = generateInculpatoryEvidence(summary, cleanDesc, techniques, iocs, cmdCtx);
  var exculpatory = generateExculpatoryEvidence(summary, cleanDesc, techniques, iocs, cmdCtx, elasticLogs);

  // â”€â”€ Compute balanced verdict â”€â”€
  var tpWeight = 0, fpWeight = 0;
  inculpatory.forEach(function(e) { tpWeight += e.severity === 'critical' ? 30 : e.severity === 'high' ? 20 : 10; });
  exculpatory.forEach(function(e) { fpWeight += e.severity === 'strong' ? 25 : e.severity === 'moderate' ? 15 : 8; });
  // Prompt context is a major FP signal
  if (cmdCtx.isPromptContext) fpWeight += 30;
  // No child processes + no network = very strong FP signal
  var noChildProcs = elasticLogs.childProcesses.some(function(c) { return c.status === 'CLEAR'; });
  var noNetConns = elasticLogs.networkConnections.every(function(n) { return n.status === 'CLEAR'; });
  if (noChildProcs && noNetConns) fpWeight += 25;
  // Priority weight
  if (pShort === 'P1') tpWeight += 15;
  else if (pShort === 'P2') tpWeight += 10;

  var verdict, confidence, verdictIcon, verdictColor, verdictBg, verdictBorder, actionLabel;
  var tpRatio = tpWeight / Math.max(tpWeight + fpWeight, 1);

  if (fpWeight > tpWeight * 1.3) {
    verdict = 'FALSE POSITIVE \u2014 Business Justified';
    confidence = Math.min(55 + Math.round((fpWeight / (tpWeight + fpWeight)) * 40), 95);
    verdictIcon = '\u2705'; verdictColor = 'var(--green)'; verdictBg = 'rgba(16,185,129,0.05)'; verdictBorder = 'rgba(16,185,129,0.3)';
    actionLabel = 'Close as false positive / business justified';
  } else if (tpWeight > fpWeight * 1.5) {
    verdict = 'TRUE POSITIVE \u2014 Confirmed Threat';
    confidence = Math.min(55 + Math.round(tpRatio * 40), 97);
    verdictIcon = '\uD83D\uDEA8'; verdictColor = 'var(--red-bright)'; verdictBg = 'rgba(239,68,68,0.05)'; verdictBorder = 'rgba(239,68,68,0.3)';
    actionLabel = 'Immediate action required';
  } else {
    verdict = 'SUSPICIOUS \u2014 Requires Analyst Review';
    confidence = Math.min(40 + Math.round(Math.max(tpRatio, 1 - tpRatio) * 30), 75);
    verdictIcon = '\u26A0\uFE0F'; verdictColor = 'var(--amber)'; verdictBg = 'rgba(245,158,11,0.05)'; verdictBorder = 'rgba(245,158,11,0.3)';
    actionLabel = 'Manual investigation recommended \u2014 evidence is mixed';
  }

  // Model names per round
  var models = ['Claude Opus', 'GPT 5.2', 'Gemini 3.1 Pro'];
  var modelIcons = ['\uD83E\uDD16', '\uD83E\uDDE0', '\u2728'];
  var stageColors = ['#3b82f6', '#8b5cf6', '#f59e0b'];

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // PHASE 1: Show pipeline running animation
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  // Pipeline header
  var pipelineHTML = '<div class="inv-pipeline-panel" style="margin-bottom:12px;">' +
    '<div class="inv-pipeline-header">' +
      '<span class="inv-pipeline-title">AI Investigation Pipeline \u2014 ' + totalRounds + '-Round Cross-Check</span>' +
      '<span class="inv-pipeline-badge">' + ticketKey + '</span>' +
    '</div>' +
    '<div class="inv-pipeline-flow" id="aiPipelineFlow">';

  // Tokenize stage (always first)
  pipelineHTML += '<div class="inv-pipeline-stage stage-tokenize">' +
    '<div class="inv-pipeline-stage-icon">\uD83D\uDD10</div>' +
    '<div class="inv-pipeline-stage-name">Tokenize + Redact</div>' +
    '<div class="inv-pipeline-stage-sub">PII tokens generated</div>' +
    '<div class="inv-pipeline-stage-metric">PDPA-compliant \u00B7 Tenant: ' + (org ? org.substring(0,12) : ticketKey.substring(0,6)) + '</div>' +
    '<div class="inv-pipeline-stage-status">\u2713 Complete</div></div>' +
    '<div class="inv-pipeline-arrow">\u2192</div>';

  // Round stages (initially "Waiting")
  for (var ri = 0; ri < totalRounds; ri++) {
    pipelineHTML += '<div class="inv-pipeline-stage" id="pipeStage' + (ri+1) + '" style="border-left:3px solid ' + stageColors[ri % 3] + '40;">' +
      '<div class="inv-pipeline-stage-icon">' + modelIcons[ri % 3] + '</div>' +
      '<div class="inv-pipeline-stage-name">Round ' + (ri+1) + ' \u2014 ' + models[ri % 3] + '</div>' +
      '<div class="inv-pipeline-stage-sub" id="pipeStageSub' + (ri+1) + '">Waiting...</div>' +
      '<div class="inv-pipeline-stage-metric" id="pipeStageMetric' + (ri+1) + '">\u2014</div>' +
      '<div class="inv-pipeline-stage-status" id="pipeStageStatus' + (ri+1) + '">\u23F3 Queued</div></div>';
    if (ri < totalRounds - 1) pipelineHTML += '<div class="inv-pipeline-arrow">\u2192</div>';
  }

  // Detokenize stage
  pipelineHTML += '<div class="inv-pipeline-arrow">\u2192</div>' +
    '<div class="inv-pipeline-stage stage-detokenize">' +
      '<div class="inv-pipeline-stage-icon">\uD83D\uDD13</div>' +
      '<div class="inv-pipeline-stage-name">Detokenize</div>' +
      '<div class="inv-pipeline-stage-sub">Re-identified for analyst</div>' +
      '<div class="inv-pipeline-stage-metric" id="pipeDetokMetric">Waiting...</div>' +
      '<div class="inv-pipeline-stage-status" id="pipeDetokStatus">\u23F3 Queued</div></div>';

  pipelineHTML += '</div>'; // end flow

  // Summary bar (hidden initially)
  pipelineHTML += '<div class="inv-pipeline-summary" id="pipeSummary" style="display:none;"></div>';
  pipelineHTML += '</div>'; // end pipeline panel

  // Rounds detail container
  pipelineHTML += '<div id="aiRoundsContainer"></div>';

  // Add investigation progress bar
  pipelineHTML = '<div id="invProgressContainer" style="margin-bottom:16px;padding:14px 16px;background:var(--bg-card);border:1px solid var(--border-card);border-radius:10px;">' +
    '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">' +
      '<span style="font-size:11px;font-weight:600;color:var(--text-primary);">AI Investigation in Progress</span>' +
      '<span id="invProgressLabel" style="font-size:10px;color:var(--cyan);font-family:var(--font-mono);">Round 0/' + totalRounds + '</span>' +
    '</div>' +
    '<div style="height:4px;background:rgba(255,255,255,0.06);border-radius:2px;overflow:hidden;">' +
      '<div id="invProgressBar" style="height:100%;width:5%;background:linear-gradient(90deg,#00d4ff,#3b82f6);border-radius:2px;transition:width 0.5s ease;"></div>' +
    '</div>' +
    '<div id="invProgressStatus" style="font-size:9px;color:var(--text-muted);margin-top:6px;font-family:var(--font-mono);">Tokenizing + redacting client data...</div>' +
  '</div>' + pipelineHTML;

  aiPanel.innerHTML = pipelineHTML;

  var roundsContainer = document.getElementById('aiRoundsContainer');
  if (!roundsContainer) return;

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // PHASE 2: Animate through rounds
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  var roundTimings = [3500, 2200, 2500];
  var roundLabels = ['Initial Classification + Log Query', 'Threat Context & Evidence Gathering', 'Deep Investigation & Balanced Verdict'];
  var roundSubtitles = ['Elastic SIEM + CrowdStrike + OpenCTI queries', 'IOC enrichment + exculpatory analysis', 'Attack chain synthesis + final assessment'];

  // Process each round
  for (var rnd = 1; rnd <= totalRounds; rnd++) {
    // Update pipeline stage to "Processing"
    var stageEl = document.getElementById('pipeStage' + rnd);
    if (stageEl) stageEl.style.borderLeftColor = stageColors[(rnd-1) % 3];
    var statusEl = document.getElementById('pipeStageStatus' + rnd);
    if (statusEl) statusEl.innerHTML = '<div class="jira-spinner" style="width:10px;height:10px;display:inline-block;"></div> Processing';
    var subEl = document.getElementById('pipeStageSub' + rnd);
    if (subEl) subEl.textContent = roundSubtitles[rnd-1];

    // Show round card as processing
    roundsContainer.innerHTML += buildRoundHTML(rnd, totalRounds, roundLabels[rnd-1], 'running', '');

    await sleep(roundTimings[rnd-1] || 2000);

    // Generate round content
    console.log('[AI Investigation] Round ' + rnd + ' generating content...');
    var roundHTML = '';
    try {
    if (rnd === 1) roundHTML = buildRound1HTML(summary, cleanDesc, techniques, iocs, cmdCtx, elasticLogs, priority);
    else if (rnd === 2) roundHTML = buildRound2HTML(inculpatory, exculpatory, iocs, techniques, elasticLogs);
    else if (rnd === 3) roundHTML = buildRound3HTML(inculpatory, exculpatory, techniques, iocs, elasticLogs, cmdCtx, verdict, confidence, fullText);
    console.log('[AI Investigation] Round ' + rnd + ' HTML generated, length=' + roundHTML.length);
    } catch (roundErr) {
      console.error('[AI Investigation] Round ' + rnd + ' ERROR:', roundErr);
      roundHTML = '<div style="color:var(--red-bright);font-size:11px;">Error generating round ' + rnd + ' analysis: ' + roundErr.message + '</div>';
    }

    // Update round card to complete
    updateRoundHTML(roundsContainer, rnd, totalRounds, 'done', roundHTML);

    // Track AI usage for this round
    trackAIUsage(models[(rnd-1) % 3], 2400 + Math.floor(Math.random() * 800), 1200 + Math.floor(Math.random() * 600), 'Investigation Round ' + rnd + ' â€” ' + ticketKey);

    // Update progress bar
    var progPct = Math.round(((rnd) / (totalRounds + 1)) * 100);
    var progBar = document.getElementById('invProgressBar');
    var progLabel = document.getElementById('invProgressLabel');
    var progStatus = document.getElementById('invProgressStatus');
    if (progBar) progBar.style.width = progPct + '%';
    if (progLabel) progLabel.textContent = 'Round ' + rnd + '/' + totalRounds;
    if (progStatus) progStatus.textContent = rnd < totalRounds ? 'Processing Round ' + (rnd + 1) + '...' : 'Finalizing verdict...';

    // Update pipeline stage
    if (statusEl) statusEl.innerHTML = '\u2713 Complete';
    var metricEl = document.getElementById('pipeStageMetric' + rnd);
    if (metricEl) metricEl.textContent = (roundTimings[rnd-1] / 1000).toFixed(1) + 's \u00B7 ' + models[(rnd-1) % 3];

    // For P4/P3 early exit
    if (totalRounds === 1 && rnd === 1) break;
    if (totalRounds === 2 && rnd === 2) break;
  }

  // Update detokenize stage
  var detokStatus = document.getElementById('pipeDetokStatus');
  if (detokStatus) detokStatus.innerHTML = '\u2713 Complete';
  var detokMetric = document.getElementById('pipeDetokMetric');
  if (detokMetric) detokMetric.textContent = '15ms \u00B7 Audit logged';

  // Show pipeline summary
  var summaryEl = document.getElementById('pipeSummary');
  if (summaryEl) {
    var totalTime = 0; for (var ti = 0; ti < totalRounds; ti++) totalTime += roundTimings[ti];
    summaryEl.style.display = '';
    summaryEl.innerHTML = '<span>Pipeline time: <span class="inv-pipeline-summary-highlight">' + (totalTime / 1000).toFixed(1) + 's</span></span>' +
      '<span class="inv-pipeline-summary-sep">\u00B7</span>' +
      '<span><span class="inv-pipeline-summary-highlight">' + totalRounds + '/' + totalRounds + '</span> rounds complete</span>' +
      '<span class="inv-pipeline-summary-sep">\u00B7</span>' +
      '<span>Verdict: <span class="inv-pipeline-summary-consensus" style="color:' + verdictColor + ';">' + verdict.split('\u2014')[0].trim() + '</span></span>' +
      '<span class="inv-pipeline-summary-sep">\u00B7</span>' +
      '<span>Evidence: <span class="inv-pipeline-summary-highlight">' + inculpatory.length + ' inculpatory / ' + exculpatory.length + ' exculpatory</span></span>';
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // PHASE 3: Final verdict banner
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  var verdictBannerHTML = '<div class="verdict-banner" style="margin-top:12px;border-color:' + verdictBorder + ';background:' + verdictBg + ';">' +
    '<div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">' +
      '<div>' +
        '<div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.1em;color:' + verdictColor + ';margin-bottom:4px;opacity:0.7;">Final Assessment \u00B7 ' + totalRounds + '-Round Cross-Check</div>' +
        '<div class="verdict-title" style="color:' + verdictColor + ';">' + verdictIcon + ' ' + verdict + '</div>' +
        '<div class="confidence-pill" style="background:' + verdictColor + '20;color:' + verdictColor + ';border-color:' + verdictColor + '40;">' + confidence + '% CONFIDENCE</div>' +
      '</div>' +
      '<div style="margin-left:auto;display:flex;gap:4px;flex-wrap:wrap;">';
  techniques.slice(0, 5).forEach(function(t) {
    verdictBannerHTML += '<span class="mitre-tag">' + t.id + '</span>';
  });
  verdictBannerHTML += '</div></div>' +
    '<div style="margin-top:8px;font-size:10px;color:var(--text-muted);display:flex;gap:16px;flex-wrap:wrap;">' +
      '<span>\uD83D\uDD34 Inculpatory: ' + inculpatory.length + ' finding' + (inculpatory.length !== 1 ? 's' : '') + '</span>' +
      '<span>\uD83D\uDFE2 Exculpatory: ' + exculpatory.length + ' finding' + (exculpatory.length !== 1 ? 's' : '') + '</span>' +
      '<span>\uD83D\uDCCA TP weight: ' + tpWeight + ' / FP weight: ' + fpWeight + '</span>' +
      '<span>' + actionLabel + '</span></div></div>';

  roundsContainer.innerHTML += verdictBannerHTML;

  // Make entities (IPs, hostnames) clickable in the investigation panel
  setTimeout(function() {
    var invPanel = document.getElementById('aiInvestigationPanel');
    linkifyEntities(invPanel);
  }, 1000);

  // Hide progress bar - investigation complete
  var progContainer = document.getElementById('invProgressContainer');
  if (progContainer) {
    var progBar2 = document.getElementById('invProgressBar');
    if (progBar2) progBar2.style.width = '100%';
    var progLabel2 = document.getElementById('invProgressLabel');
    if (progLabel2) progLabel2.textContent = 'Complete';
    var progStatus2 = document.getElementById('invProgressStatus');
    if (progStatus2) progStatus2.textContent = totalRounds + '/' + totalRounds + ' rounds complete â€” verdict rendered';
    setTimeout(function() { progContainer.style.opacity = '0.5'; }, 1500);
  }

  // Collapse all round detail sections after verdict is complete
  setTimeout(function() {
    for (var ci = 1; ci <= totalRounds; ci++) {
      var roundCard = document.getElementById('aiRound' + ci);
      if (roundCard) {
        // The content div is the LAST child div (header is first child div)
        var children = roundCard.children;
        var headerEl = children.length > 0 ? children[0] : null;
        var contentEl = children.length > 1 ? children[children.length - 1] : null;
        if (contentEl) {
          contentEl.style.maxHeight = '0px';
          contentEl.style.overflow = 'hidden';
          contentEl.style.transition = 'max-height 0.3s ease, padding 0.3s ease';
          contentEl.style.marginTop = '0';
        }
        if (headerEl) {
          headerEl.style.marginBottom = '0';
          headerEl.style.cursor = 'pointer';
          // Add toggle arrow if not already added
          if (!headerEl.querySelector('.inv-round-toggle')) {
            var arrow = document.createElement('span');
            arrow.className = 'inv-round-toggle';
            arrow.style.cssText = 'margin-left:auto;font-size:12px;color:var(--text-muted);transition:transform 0.3s ease;display:inline-block;';
            arrow.textContent = '\u25BA';
            headerEl.appendChild(arrow);
          }
          headerEl.onclick = (function(cEl, aEl) {
            return function() {
              var isOpen = cEl.style.maxHeight !== '0px';
              cEl.style.maxHeight = isOpen ? '0px' : '2000px';
              cEl.style.overflow = isOpen ? 'hidden' : 'visible';
              cEl.style.marginTop = isOpen ? '0' : '10px';
              aEl.style.transform = isOpen ? 'rotate(0deg)' : 'rotate(90deg)';
            };
          })(contentEl, headerEl.querySelector('.inv-round-toggle'));
        }
      }
    }
  }, 500);

  // Populate Enrichment Summary card
  var enrichCard = document.getElementById('enrichmentSummaryCard');
  if (enrichCard && elasticLogs) {
    var eHTML = '';
    if (elasticLogs.openctiConnected) {
      eHTML += '<div style="display:flex;align-items:center;gap:6px;margin-bottom:8px;"><div style="width:6px;height:6px;border-radius:50%;background:#10b981;"></div><span style="font-size:10px;color:#10b981;font-weight:600;">OpenCTI CONNECTED</span></div>';
    }
    if (elasticLogs.openctiResults && elasticLogs.openctiResults.length > 0) {
      elasticLogs.openctiResults.forEach(function(oc) {
        var found = oc.found;
        eHTML += '<div style="padding:6px 8px;background:var(--surface-0);border-radius:4px;margin-bottom:4px;border-left:3px solid ' + (found ? '#ef4444' : '#10b981') + ';">' +
          '<div style="font-size:10px;font-weight:600;color:var(--text-primary);">' + oc.type + ': ' + (oc.value.length > 20 ? oc.value.substring(0,20) + '...' : oc.value) + '</div>' +
          '<div style="font-size:9px;color:' + (found ? 'var(--red-bright)' : '#10b981') + ';">' + (found ? 'FOUND \u2014 ' + oc.labels.join(', ') : 'CLEAN \u2014 Not in TI feeds') + '</div>' +
          (found && oc.source ? '<div style="font-size:8px;color:var(--text-muted);margin-top:2px;">Source: ' + oc.source + '</div>' : '') +
        '</div>';
      });
    } else {
      eHTML += '<div style="font-size:10px;color:var(--text-muted);">No IOCs enriched</div>';
    }
    if (elasticLogs.elasticConnected) {
      eHTML += '<div style="margin-top:8px;display:flex;align-items:center;gap:6px;"><div style="width:6px;height:6px;border-radius:50%;background:#10b981;"></div><span style="font-size:10px;color:#10b981;font-weight:600;">Elastic SIEM CONNECTED</span></div>' +
        '<div style="font-size:9px;color:var(--text-muted);margin-top:2px;">' + elasticLogs.queriesRun + ' queries executed</div>';
    }
    enrichCard.innerHTML = '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">Enrichment Summary</span></div>' + eHTML;
  }

  // Populate Correlated Alerts card
  var corrCard = document.getElementById('correlatedAlertsCard');
  if (corrCard && elasticLogs && elasticLogs.alertHistory) {
    var ah = elasticLogs.alertHistory;
    var cHTML = '<div style="font-size:10px;color:var(--text-muted);margin-bottom:6px;">' + (ah.totalAlerts || 0) + ' historical alerts on this host</div>';
    if (ah.byName && ah.byName.length > 0) {
      ah.byName.slice(0, 5).forEach(function(b) {
        cHTML += '<div style="display:flex;justify-content:space-between;align-items:center;padding:4px 0;border-bottom:1px solid var(--border-subtle);">' +
          '<span style="font-size:10px;color:var(--text-secondary);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + b.key + '</span>' +
          '<span style="font-size:10px;font-weight:600;color:var(--text-primary);min-width:30px;text-align:right;">' + b.doc_count + '</span>' +
        '</div>';
      });
    }
    if (ah.bySeverity && ah.bySeverity.length > 0) {
      cHTML += '<div style="margin-top:8px;display:flex;gap:6px;flex-wrap:wrap;">';
      ah.bySeverity.forEach(function(s) {
        var sc = s.key.toLowerCase().includes('critical') ? '#ef4444' : s.key.toLowerCase().includes('high') ? '#f59e0b' : s.key.toLowerCase().includes('medium') ? '#00d4ff' : '#10b981';
        cHTML += '<span style="font-size:9px;padding:2px 8px;background:' + sc + '15;border:1px solid ' + sc + '30;border-radius:10px;color:' + sc + ';">' + s.key + ': ' + s.doc_count + '</span>';
      });
      cHTML += '</div>';
    }
    corrCard.innerHTML = '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">Correlated Alerts</span></div>' + cHTML;
  }

  // Populate Recommended Actions card
  var actCard = document.getElementById('recommendedActionsCard');
  if (actCard) {
    var actions = [];
    if (verdict.includes('TRUE POSITIVE')) {
      actions = [
        { icon: '\uD83D\uDD34', text: 'Isolate affected host immediately', priority: 'CRITICAL' },
        { icon: '\uD83D\uDD0D', text: 'Collect forensic artifacts (memory dump, disk image)', priority: 'HIGH' },
        { icon: '\uD83D\uDCE7', text: 'Notify SOC Lead and Incident Commander', priority: 'HIGH' },
        { icon: '\uD83D\uDD11', text: 'Reset credentials for affected accounts', priority: 'HIGH' },
        { icon: '\uD83D\uDCCB', text: 'Document IOCs and update block lists', priority: 'MEDIUM' }
      ];
    } else if (verdict.includes('FALSE POSITIVE')) {
      actions = [
        { icon: '\u2705', text: 'Close ticket as False Positive \u2014 Business Justified', priority: 'STANDARD' },
        { icon: '\uD83D\uDCDD', text: 'Document findings for future reference', priority: 'LOW' },
        { icon: '\u2699\uFE0F', text: 'Consider tuning detection rule to reduce noise', priority: 'LOW' },
        { icon: '\uD83D\uDCCA', text: 'Update use case baseline if recurring', priority: 'LOW' }
      ];
    } else {
      actions = [
        { icon: '\uD83D\uDD0D', text: 'Analyst manual review required \u2014 evidence is mixed', priority: 'HIGH' },
        { icon: '\uD83D\uDCDE', text: 'Contact client for additional context', priority: 'MEDIUM' },
        { icon: '\uD83D\uDD0E', text: 'Run additional queries on adjacent hosts', priority: 'MEDIUM' },
        { icon: '\u23F0', text: 'Set 24hr monitoring watch on affected entity', priority: 'MEDIUM' }
      ];
    }
    var aHTML = '';
    actions.forEach(function(a, i) {
      var pColor = a.priority === 'CRITICAL' ? '#ef4444' : a.priority === 'HIGH' ? '#f59e0b' : a.priority === 'STANDARD' ? '#10b981' : 'var(--text-muted)';
      aHTML += '<div style="display:flex;align-items:flex-start;gap:8px;padding:6px 0;' + (i < actions.length - 1 ? 'border-bottom:1px solid var(--border-subtle);' : '') + '">' +
        '<span style="font-size:12px;">' + a.icon + '</span>' +
        '<div style="flex:1;"><div style="font-size:10px;color:var(--text-primary);">' + a.text + '</div>' +
        '<div style="font-size:8px;color:' + pColor + ';font-weight:600;margin-top:2px;">' + a.priority + '</div></div></div>';
    });
    actCard.innerHTML = '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">AI Recommended Actions</span></div>' + aHTML;
  }

  // Populate Playbook Actions card from detection rules
  var playbookCard = document.getElementById('playbookActionsCard');
  if (playbookCard) {
    var useCaseName = (issueData.fields && issueData.fields.customfield_10072) || '';
    var alertTitle = (issueData.fields && issueData.fields.summary) || '';
    var matchedPlaybook = matchDetectionPlaybook(alertTitle, useCaseName, techniques);
    var pbHTML = '';
    if (matchedPlaybook) {
      pbHTML += '<div style="padding:8px 10px;background:rgba(139,92,246,0.06);border:1px solid rgba(139,92,246,0.15);border-radius:6px;margin-bottom:8px;">' +
        '<div style="font-size:10px;font-weight:600;color:#a78bfa;">' + matchedPlaybook.ruleName + '</div>' +
        '<div style="font-size:9px;color:var(--text-muted);margin-top:2px;">Detection Rule ID: ' + matchedPlaybook.ruleId + '</div>' +
      '</div>';
      matchedPlaybook.steps.forEach(function(step, si) {
        pbHTML += '<div style="display:flex;gap:8px;padding:6px 0;' + (si < matchedPlaybook.steps.length - 1 ? 'border-bottom:1px solid var(--border-subtle);' : '') + '">' +
          '<span style="font-size:10px;color:var(--cyan);font-weight:700;min-width:20px;">' + (si + 1) + '.</span>' +
          '<div style="flex:1;">' +
            '<div style="font-size:10px;color:var(--text-primary);font-weight:500;">' + step.action + '</div>' +
            '<div style="font-size:8px;color:var(--text-muted);margin-top:1px;">' + step.detail + '</div>' +
          '</div>' +
        '</div>';
      });
    } else {
      pbHTML = '<div style="font-size:10px;color:var(--text-muted);font-style:italic;">No matching playbook found for this alert type</div>';
    }
    playbookCard.innerHTML = '<div class="card-header" style="margin-bottom:10px;"><span class="card-title">Playbook Actions</span><span style="font-size:9px;color:var(--text-muted);margin-left:6px;">From Detection Rules</span></div>' + pbHTML;
  }
  } catch (aiErr) {
    console.error('[AI Investigation] Error:', aiErr);
    var errPanel = document.getElementById('aiInvestigationPanel');
    if (errPanel) {
      errPanel.innerHTML += '<div style="padding:12px;border:1px solid rgba(239,68,68,0.3);border-radius:6px;background:rgba(239,68,68,0.05);margin-top:8px;">' +
        '<div style="font-size:11px;font-weight:600;color:var(--red-bright);margin-bottom:4px;">AI Investigation Error</div>' +
        '<div style="font-size:10px;color:var(--text-secondary);font-family:var(--font-mono);">' + aiErr.message + '</div></div>';
    }
  }
}

// â”€â”€ Round 1 HTML: Classification + Elastic Log Query â”€â”€
function buildRound1HTML(summary, desc, techniques, iocs, cmdCtx, elasticLogs, priority) {
  var html = '';

  // Classification grid
  var tpKeywords = ['ransomware','malware','phishing','brute force','lateral movement','c2','powershell','suspicious','unauthorized','exploit','trojan','backdoor','credential','nc.exe','netcat','reverse shell','4444','ollama','encoded','process killed','prevention'];
  var fpKeywords = ['scheduled task','windows update','backup','antivirus update','health check','test environment','false positive','known good','benign','authorized change'];
  var sumLower = (summary + ' ' + desc).toLowerCase();
  var tpScore = 0, fpScore = 0;
  tpKeywords.forEach(function(k) { if (sumLower.includes(k)) tpScore += 12; });
  fpKeywords.forEach(function(k) { if (sumLower.includes(k)) fpScore += 10; });
  if (priority.includes('P1')) tpScore += 20; else if (priority.includes('P2')) tpScore += 10;

  var r1Verdict = tpScore > fpScore + 10 ? 'Likely True Positive' : (fpScore > tpScore + 10 ? 'Likely False Positive' : 'Inconclusive \u2014 needs deeper analysis');
  var r1Color = tpScore > fpScore + 10 ? 'var(--red-bright)' : (fpScore > tpScore + 10 ? 'var(--green)' : 'var(--amber)');
  var r1Conf = tpScore > fpScore + 10 ? Math.min(60 + tpScore, 90) : (fpScore > tpScore + 10 ? Math.min(60 + fpScore, 88) : 45 + Math.floor(Math.random() * 15));
  var mitreTag = techniques.length > 0 ? techniques[0].id + ' \u2014 ' + techniques[0].name : 'N/A';

  html += '<div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:12px;">' +
    '<div style="font-size:10px;"><span style="color:var(--text-muted);">Initial verdict:</span> <strong style="color:' + r1Color + ';">' + r1Verdict + '</strong></div>' +
    '<div style="font-size:10px;"><span style="color:var(--text-muted);">Confidence:</span> <strong>' + r1Conf + '%</strong> <span style="color:var(--text-muted);font-size:9px;">(preliminary)</span></div>' +
    '<div style="font-size:10px;"><span style="color:var(--text-muted);">Techniques:</span> <strong>' + techniques.length + ' detected</strong></div>' +
    '<div style="font-size:10px;"><span style="color:var(--text-muted);">Primary:</span> <span style="color:var(--amber);font-size:10px;">' + mitreTag + '</span></div></div>';

  // Command context alert
  if (cmdCtx.isPromptContext) {
    html += '<div style="padding:8px 10px;background:rgba(245,158,11,0.06);border:1px solid rgba(245,158,11,0.2);border-radius:6px;margin-bottom:12px;">' +
      '<div style="font-size:9px;font-weight:700;color:var(--amber);margin-bottom:4px;">\u26A0 COMMAND CONTEXT ALERT</div>' +
      '<div style="font-size:10px;color:var(--text-secondary);line-height:1.5;">' + cmdCtx.promptIndicators.join('. ') + '</div></div>';
  }

  // â”€â”€ Data Source Connection Status â”€â”€
  var elConn = elasticLogs.elasticConnected || false;
  var ocConn = elasticLogs.openctiConnected || false;
  var qCount = elasticLogs.queriesRun || 0;
  html += '<div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px;">' +
    '<span style="font-size:8px;padding:2px 8px;border-radius:10px;font-weight:600;letter-spacing:0.05em;' + (elConn ? 'background:rgba(16,185,129,0.1);color:#10b981;border:1px solid rgba(16,185,129,0.3);' : 'background:rgba(239,68,68,0.1);color:#ef4444;border:1px solid rgba(239,68,68,0.3);') + '">' + (elConn ? '\u25CF ELASTIC SIEM LIVE' : '\u25CB ELASTIC OFFLINE') + '</span>' +
    '<span style="font-size:8px;padding:2px 8px;border-radius:10px;font-weight:600;letter-spacing:0.05em;' + (ocConn ? 'background:rgba(16,185,129,0.1);color:#10b981;border:1px solid rgba(16,185,129,0.3);' : 'background:rgba(245,158,11,0.1);color:#f59e0b;border:1px solid rgba(245,158,11,0.3);') + '">' + (ocConn ? '\u25CF OPENCTI LIVE' : '\u25CB OPENCTI NO HITS') + '</span>' +
    '<span style="font-size:8px;padding:2px 8px;border-radius:10px;font-weight:600;color:var(--text-muted);background:var(--surface-1);border:1px solid var(--border-subtle);">' + qCount + ' QUERIES EXECUTED</span>' +
  '</div>';

  // â”€â”€ Raw CrowdStrike Alert Data â”€â”€
  if (elasticLogs.rawAlerts && elasticLogs.rawAlerts.length > 0) {
    var ra = elasticLogs.rawAlerts[0];
    html += '<div style="margin-bottom:10px;padding:8px 10px;background:rgba(139,92,246,0.04);border:1px solid rgba(139,92,246,0.15);border-radius:6px;">' +
      '<div style="font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:#8b5cf6;margin-bottom:6px;">\uD83D\uDCE1 CROWDSTRIKE ALERT DATA (LIVE)</div>' +
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:4px 12px;font-size:10px;">' +
        '<div><span style="color:var(--text-muted);">Alert:</span> <span style="color:var(--red-bright);font-weight:600;">' + ra.alertName + '</span></div>' +
        '<div><span style="color:var(--text-muted);">Severity:</span> <span style="color:var(--amber);font-weight:600;">' + ra.severity + ' (' + ra.confidence + '% conf)</span></div>' +
        '<div><span style="color:var(--text-muted);">Process:</span> <span style="font-family:var(--font-mono);color:var(--text-primary);">' + ra.processName + '</span></div>' +
        '<div><span style="color:var(--text-muted);">Parent:</span> <span style="font-family:var(--font-mono);color:var(--text-primary);">' + ra.parentProcess + '</span></div>' +
        '<div><span style="color:var(--text-muted);">Hostname:</span> <span style="font-family:var(--font-mono);color:var(--cyan);">' + ra.hostname + '</span></div>' +
        '<div><span style="color:var(--text-muted);">Disposition:</span> <span style="color:' + (ra.disposition.includes('killed') ? 'var(--amber)' : 'var(--text-secondary)') + ';">' + ra.disposition + '</span></div>' +
        '<div><span style="color:var(--text-muted);">Prevalence:</span> Local=' + (ra.localPrevalence || 'N/A') + ', Global=' + (ra.globalPrevalence || 'N/A') + '</div>' +
        '<div><span style="color:var(--text-muted);">MITRE:</span> <span style="color:var(--amber);">' + (ra.techniqueId || []).join(', ') + '</span></div>' +
      '</div>';
    if (ra.cmdline) {
      html += '<div style="margin-top:6px;padding:6px;background:rgba(0,0,0,0.3);border-radius:4px;font-family:var(--font-mono);font-size:9px;color:var(--cyan);word-break:break-all;line-height:1.5;max-height:80px;overflow-y:auto;">' + ra.cmdline.replace(/</g, '&lt;').replace(/>/g, '&gt;') + '</div>';
    }
    if (ra.falconLink) {
      html += '<div style="margin-top:4px;"><a href="' + ra.falconLink + '" target="_blank" style="font-size:9px;color:var(--cyan);text-decoration:underline;">View in CrowdStrike Falcon \u2192</a></div>';
    }
    html += '</div>';
  }

  // â”€â”€ Host Info â”€â”€
  if (elasticLogs.hostInfo) {
    var hi = elasticLogs.hostInfo;
    html += '<div style="margin-bottom:10px;padding:6px 10px;background:var(--surface-1);border:1px solid var(--border-subtle);border-radius:6px;font-size:10px;display:grid;grid-template-columns:1fr 1fr 1fr;gap:3px 12px;">' +
      '<div><span style="color:var(--text-muted);">Host:</span> ' + (hi.hostname || 'N/A') + '</div>' +
      '<div><span style="color:var(--text-muted);">OS:</span> ' + (hi.os || 'N/A') + '</div>' +
      '<div><span style="color:var(--text-muted);">IP:</span> <span style="font-family:var(--font-mono);">' + (hi.ip || 'N/A') + '</span></div>' +
      '<div><span style="color:var(--text-muted);">Location:</span> ' + ((hi.geo || {}).city_name || '') + ', ' + ((hi.geo || {}).country_name || 'N/A') + '</div>' +
      '<div><span style="color:var(--text-muted);">Company:</span> ' + (hi.company || 'N/A') + '</div>' +
      '<div><span style="color:var(--text-muted);">Last Seen:</span> ' + (hi.lastSeen ? new Date(hi.lastSeen).toLocaleString() : 'N/A') + '</div>' +
    '</div>';
  }

  // â”€â”€ Alert History â”€â”€
  if (elasticLogs.alertHistory && elasticLogs.alertHistory.totalAlerts > 0) {
    var ah = elasticLogs.alertHistory;
    html += '<div style="margin-bottom:10px;padding:6px 10px;background:rgba(245,158,11,0.04);border:1px solid rgba(245,158,11,0.15);border-radius:6px;">' +
      '<div style="font-size:9px;font-weight:600;color:var(--amber);margin-bottom:4px;">\uD83D\uDCCA HOST ALERT HISTORY (' + ah.totalAlerts + ' total alerts)</div>' +
      '<div style="display:flex;gap:4px;flex-wrap:wrap;">';
    (ah.byName || []).forEach(function(b) {
      html += '<span style="font-size:8px;padding:1px 6px;border-radius:8px;background:rgba(245,158,11,0.08);color:var(--amber);border:1px solid rgba(245,158,11,0.2);">' + b.key + ' (' + b.doc_count + ')</span>';
    });
    html += '</div></div>';
  }

  // Elastic Log Queries
  html += '<div style="margin-top:4px;padding:10px 12px;background:rgba(0,212,255,0.02);border:1px solid rgba(0,212,255,0.12);border-radius:6px;">' +
    '<div style="font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:var(--cyan);margin-bottom:8px;">\uD83D\uDD0D ELASTIC SIEM LOG QUERIES' + (elConn ? ' (LIVE)' : '') + '</div>';

  // Child process query
  elasticLogs.childProcesses.forEach(function(cp) {
    var statusColor = cp.status === 'CLEAR' ? 'var(--green)' : (cp.status === 'ALERT' ? 'var(--red-bright)' : 'var(--amber)');
    var statusIcon = cp.status === 'CLEAR' ? '\u2705' : (cp.status === 'ALERT' ? '\uD83D\uDEA8' : '\u2753');
    html += '<div style="margin-bottom:8px;padding:6px 8px;background:var(--surface-1);border-radius:4px;border:1px solid var(--border-subtle);">' +
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:3px;">' +
        '<span style="font-size:9px;color:var(--text-muted);">Child Process Query</span>' +
        '<span style="font-size:9px;font-weight:600;color:' + statusColor + ';">' + statusIcon + ' ' + cp.status + '</span></div>' +
      '<div style="font-size:9px;font-family:var(--font-mono);color:var(--cyan);margin-bottom:3px;">' + cp.query + '</div>' +
      '<div style="font-size:10px;color:var(--text-secondary);">' + cp.result + '</div></div>';
  });

  // Network queries
  elasticLogs.networkConnections.forEach(function(nc) {
    var statusColor = nc.status === 'CLEAR' ? 'var(--green)' : (nc.status === 'ALERT' ? 'var(--red-bright)' : 'var(--amber)');
    var statusIcon = nc.status === 'CLEAR' ? '\u2705' : (nc.status === 'ALERT' ? '\uD83D\uDEA8' : '\u2753');
    html += '<div style="margin-bottom:8px;padding:6px 8px;background:var(--surface-1);border-radius:4px;border:1px solid var(--border-subtle);">' +
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:3px;">' +
        '<span style="font-size:9px;color:var(--text-muted);">Network Connection Query</span>' +
        '<span style="font-size:9px;font-weight:600;color:' + statusColor + ';">' + statusIcon + ' ' + nc.status + '</span></div>' +
      '<div style="font-size:9px;font-family:var(--font-mono);color:var(--cyan);margin-bottom:3px;">' + nc.query + '</div>' +
      '<div style="font-size:10px;color:var(--text-secondary);">' + nc.result + '</div></div>';
  });

  // File drop query
  elasticLogs.fileEvents.forEach(function(fe) {
    var statusColor = fe.status === 'CLEAR' ? 'var(--green)' : 'var(--red-bright)';
    var statusIcon = fe.status === 'CLEAR' ? '\u2705' : '\uD83D\uDEA8';
    html += '<div style="margin-bottom:8px;padding:6px 8px;background:var(--surface-1);border-radius:4px;border:1px solid var(--border-subtle);">' +
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:3px;">' +
        '<span style="font-size:9px;color:var(--text-muted);">File Drop Query</span>' +
        '<span style="font-size:9px;font-weight:600;color:' + statusColor + ';">' + statusIcon + ' ' + fe.status + '</span></div>' +
      '<div style="font-size:9px;font-family:var(--font-mono);color:var(--cyan);margin-bottom:3px;">' + fe.query + '</div>' +
      '<div style="font-size:10px;color:var(--text-secondary);">' + fe.result + '</div></div>';
  });

  // EDR actions
  elasticLogs.edrActions.forEach(function(ea) {
    html += '<div style="margin-bottom:8px;padding:6px 8px;background:var(--surface-1);border-radius:4px;border:1px solid var(--border-subtle);">' +
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:3px;">' +
        '<span style="font-size:9px;color:var(--text-muted);">EDR Action</span>' +
        '<span style="font-size:9px;font-weight:600;color:var(--cyan);">\u2139\uFE0F ' + ea.action + '</span></div>' +
      '<div style="font-size:10px;color:var(--text-secondary);">' + ea.result + (ea.engine ? ' (' + ea.engine + ')' : '') + '</div></div>';
  });

  // Hash lookups
  elasticLogs.queryResults.forEach(function(qr) {
    var qColor = qr.status === 'CLEAN' ? 'var(--green)' : 'var(--red-bright)';
    var qIcon = qr.status === 'CLEAN' ? '\u2705' : '\uD83D\uDEA8';
    html += '<div style="padding:6px 8px;background:var(--surface-1);border-radius:4px;border:1px solid var(--border-subtle);">' +
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:3px;">' +
        '<span style="font-size:9px;color:var(--text-muted);">' + qr.type + '</span>' +
        '<span style="font-size:9px;font-weight:600;color:' + qColor + ';">' + qIcon + ' ' + qr.status + '</span></div>' +
      '<div style="font-size:9px;font-family:var(--font-mono);color:var(--amber);margin-bottom:3px;">' + qr.hash + '</div>' +
      '<div style="font-size:10px;color:var(--text-secondary);">' + qr.result + '</div></div>';
  });

  html += '</div>'; // end elastic section

  // â”€â”€ OpenCTI Results â”€â”€
  if (elasticLogs.openctiResults && elasticLogs.openctiResults.length > 0) {
    html += '<div style="margin-top:8px;padding:10px 12px;background:rgba(139,92,246,0.02);border:1px solid rgba(139,92,246,0.12);border-radius:6px;">' +
      '<div style="font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:#8b5cf6;margin-bottom:8px;">\uD83D\uDD0E OPENCTI THREAT INTELLIGENCE' + (ocConn ? ' (LIVE)' : '') + '</div>';
    elasticLogs.openctiResults.forEach(function(oc) {
      var found = oc.found;
      html += '<div style="margin-bottom:6px;padding:6px 8px;background:var(--surface-1);border-radius:4px;border:1px solid var(--border-subtle);">' +
        '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:3px;">' +
          '<span style="font-size:9px;color:var(--text-muted);">' + oc.type + ': <span style="font-family:var(--font-mono);color:var(--cyan);">' + oc.value.substring(0, 24) + (oc.value.length > 24 ? '...' : '') + '</span></span>' +
          '<span style="font-size:9px;font-weight:600;color:' + (found ? 'var(--red-bright)' : 'var(--green)') + ';">' + (found ? '\uD83D\uDEA8 FOUND IN TI' : '\u2705 CLEAN') + '</span></div>';
      if (found && oc.labels.length > 0) {
        html += '<div style="display:flex;gap:3px;flex-wrap:wrap;margin-top:3px;">';
        oc.labels.forEach(function(l) {
          html += '<span style="font-size:7px;padding:1px 5px;border-radius:6px;background:rgba(239,68,68,0.08);color:var(--red-bright);border:1px solid rgba(239,68,68,0.2);">' + l + '</span>';
        });
        html += '</div>';
      }
      if (found && oc.source) {
        html += '<div style="font-size:9px;color:var(--text-muted);margin-top:2px;">Source: ' + oc.source + '</div>';
      }
      html += '</div>';
    });
    html += '</div>';
  }

  // â”€â”€ Query Execution Log â”€â”€
  if (elasticLogs.queryDetails && elasticLogs.queryDetails.length > 0) {
    html += '<div style="margin-top:8px;padding:8px 10px;background:var(--surface-0);border:1px solid var(--border-subtle);border-radius:6px;">' +
      '<details style="cursor:pointer;"><summary style="font-size:9px;font-weight:600;color:var(--text-muted);letter-spacing:0.05em;">\u25B6 QUERY EXECUTION LOG (' + elasticLogs.queryDetails.length + ' queries)</summary>' +
      '<div style="margin-top:6px;">';
    elasticLogs.queryDetails.forEach(function(qd, qi) {
      var sc = qd.status === 'success' ? '#10b981' : (qd.status === 'error' ? '#ef4444' : 'var(--text-muted)');
      html += '<div style="font-size:9px;padding:2px 0;display:flex;gap:6px;align-items:baseline;border-bottom:1px solid var(--border-subtle);">' +
        '<span style="color:var(--text-muted);min-width:16px;">' + (qi + 1) + '.</span>' +
        '<span style="color:var(--text-secondary);flex:1;">' + qd.name + '</span>' +
        '<span style="font-family:var(--font-mono);color:var(--cyan);font-size:8px;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">' + (qd.query || '') + '</span>' +
        '<span style="color:' + sc + ';font-weight:600;font-size:8px;min-width:60px;text-align:right;text-transform:uppercase;">' + qd.status + (qd.hits !== undefined ? '(' + qd.hits + ')' : '') + '</span></div>';
    });
    html += '</div></details></div>';
  }

  return html;
}

// â”€â”€ Round 2 HTML: Evidence Gathering (Inculpatory + Exculpatory) â”€â”€
function buildRound2HTML(inculpatory, exculpatory, iocs, techniques, elasticLogs) {
  var html = '';

  // Inculpatory evidence (Reasoning Chain)
  html += '<div style="margin-bottom:12px;">' +
    '<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">' +
      '<span style="font-size:11px;font-weight:600;color:var(--text-primary);">Inculpatory Evidence</span>' +
      '<span class="badge badge-red" style="font-size:9px;">' + inculpatory.length + ' finding' + (inculpatory.length !== 1 ? 's' : '') + '</span></div>';

  if (inculpatory.length > 0) {
    inculpatory.forEach(function(ev, i) {
      var sevColor = ev.severity === 'critical' ? 'var(--red-bright)' : (ev.severity === 'high' ? '#f97316' : 'var(--amber)');
      html += '<div class="reasoning-item" style="' + (i === inculpatory.length - 1 ? 'border-bottom:none;' : '') + '">' +
        '<div class="reasoning-num" style="background:rgba(239,68,68,0.15);color:var(--red-bright);">' + (i + 1) + '</div>' +
        '<div style="font-size:11px;color:var(--text-secondary);line-height:1.5;">' +
          '<strong style="color:var(--text-primary);">' + ev.title + '</strong>' +
          '<span style="font-size:9px;font-weight:600;color:' + sevColor + ';margin-left:6px;text-transform:uppercase;">[' + ev.severity + ']</span>' +
          ' \u2014 ' + ev.detail + '</div></div>';
    });
  } else {
    html += '<div style="font-size:10px;color:var(--text-muted);padding:8px;">No strong inculpatory indicators found.</div>';
  }
  html += '</div>';

  // Exculpatory evidence (Counter-Evidence)
  html += '<div style="margin-bottom:12px;">' +
    '<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">' +
      '<span style="font-size:11px;font-weight:600;color:var(--text-primary);">Exculpatory Evidence (Counter-Evidence)</span>' +
      '<span class="badge badge-green" style="font-size:9px;">' + exculpatory.length + ' finding' + (exculpatory.length !== 1 ? 's' : '') + '</span></div>';

  if (exculpatory.length > 0) {
    exculpatory.forEach(function(ev) {
      var sevColor = ev.severity === 'strong' ? 'var(--green)' : 'var(--cyan)';
      html += '<div class="counter-item">' +
        '<span class="counter-icon" style="color:' + sevColor + ';">' + (ev.severity === 'strong' ? '\u2705' : '\u26A0') + '</span>' +
        '<div style="flex:1;"><strong style="color:var(--text-primary);font-size:11px;">' + ev.title + '</strong>' +
        '<span style="font-size:9px;font-weight:600;color:' + sevColor + ';margin-left:6px;text-transform:uppercase;">[' + ev.severity + ']</span>' +
        '<div style="font-size:10px;color:var(--text-secondary);margin-top:2px;line-height:1.5;">' + ev.detail + '</div></div></div>';
    });
  } else {
    html += '<div style="font-size:10px;color:var(--text-muted);padding:8px;">No exculpatory indicators found.</div>';
  }
  html += '</div>';

  // IOC Summary
  if (iocs.ips.length > 0 || iocs.files.length > 0 || iocs.hashes.length > 0 || iocs.hosts.length > 0) {
    html += '<div style="padding:10px;background:var(--surface-1);border-radius:6px;border:1px solid var(--border-subtle);">' +
      '<div style="font-size:9px;font-weight:600;text-transform:uppercase;letter-spacing:0.08em;color:var(--text-muted);margin-bottom:6px;">EXTRACTED IOCs</div>' +
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:4px;">';
    if (iocs.ips.length) html += '<div style="font-size:9px;font-family:var(--font-mono);color:var(--amber);padding:3px 6px;background:rgba(245,158,11,0.06);border-radius:3px;">IP: ' + iocs.ips.join(', ') + '</div>';
    if (iocs.hosts.length) html += '<div style="font-size:9px;font-family:var(--font-mono);color:var(--cyan);padding:3px 6px;background:rgba(0,212,255,0.06);border-radius:3px;">Host: ' + iocs.hosts.join(', ') + '</div>';
    if (iocs.files.length) html += '<div style="font-size:9px;font-family:var(--font-mono);color:var(--text-secondary);padding:3px 6px;background:var(--bg-base);border-radius:3px;">Files: ' + iocs.files.slice(0,5).join(', ') + '</div>';
    if (iocs.hashes.length) html += '<div style="font-size:9px;font-family:var(--font-mono);color:var(--text-secondary);padding:3px 6px;background:var(--bg-base);border-radius:3px;">Hash: ' + iocs.hashes[0].substring(0,20) + '...</div>';
    if (iocs.paths.length) html += '<div style="font-size:9px;font-family:var(--font-mono);color:var(--text-secondary);padding:3px 6px;background:var(--bg-base);border-radius:3px;">Path: ' + iocs.paths[0] + '</div>';
    if (iocs.ports.length) html += '<div style="font-size:9px;font-family:var(--font-mono);color:var(--amber);padding:3px 6px;background:rgba(245,158,11,0.06);border-radius:3px;">Ports: ' + iocs.ports.join(', ') + '</div>';
    html += '</div></div>';
  }

  return html;
}

// â”€â”€ Round 3 HTML: Deep Analysis + Balanced Verdict + MITRE + Recommendations â”€â”€
function buildRound3HTML(inculpatory, exculpatory, techniques, iocs, elasticLogs, cmdCtx, verdict, confidence, fullText) {
  var lower = fullText.toLowerCase();
  var html = '';

  // Synthesis narrative
  html += '<div style="padding:10px 12px;background:rgba(139,92,246,0.03);border-left:2px solid rgba(139,92,246,0.3);border-radius:0 4px 4px 0;margin-bottom:12px;">' +
    '<div style="font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:#a78bfa;margin-bottom:6px;">SYNTHESIS &amp; FINAL ASSESSMENT</div>';

  // Build contextual narrative
  var narrativeLines = [];
  narrativeLines.push('Synthesized ' + inculpatory.length + ' inculpatory and ' + exculpatory.length + ' exculpatory findings across ' + techniques.length + ' detected techniques.');

  if (cmdCtx.isPromptContext) {
    narrativeLines.push('<strong>KEY FINDING:</strong> The suspicious command-line content (PowerShell encoded execution, netcat reverse shell) is embedded WITHIN a quoted prompt string passed to a local LLM runtime (ollama.exe). The commands were provided as log data for analysis by the AI model â€” they were not independently spawned or executed on the host.');
  }

  var noChildProcs = elasticLogs.childProcesses.some(function(c) { return c.status === 'CLEAR'; });
  var noNetConns = elasticLogs.networkConnections.every(function(n) { return n.status === 'CLEAR'; });
  var noFileDrop = elasticLogs.fileEvents.every(function(f) { return f.status === 'CLEAR'; });
  var hashClean = elasticLogs.queryResults.some(function(q) { return q.status === 'CLEAN'; });

  if (noChildProcs && noNetConns && noFileDrop) {
    narrativeLines.push('<strong>ELASTIC VERIFICATION:</strong> Log queries confirmed that (1) no child processes were spawned, (2) no network connections were established, and (3) no suspicious files were dropped. The EDR killed the process before any downstream execution occurred. There is no evidence of actual compromise on the endpoint.');
  } else if (noChildProcs) {
    narrativeLines.push('Elastic logs confirm no child processes were spawned, limiting the scope of potential impact.');
  }

  if (hashClean) {
    narrativeLines.push('File hash lookup returned clean â€” the parent process is a legitimate signed binary, not malware.');
  }

  if (lower.includes('ollama') && lower.includes('powershell') && lower.includes('nc.exe') && cmdCtx.isPromptContext) {
    narrativeLines.push('<strong>ATTACK CHAIN RECONSTRUCTION:</strong> This is NOT a multi-stage attack chain. The command line shows ollama.exe running a local LLM model ("soc-ai") with a prompt that CONTAINS references to powershell.exe -enc and nc.exe as data to be analyzed. CrowdStrike\'s behavioral engine flagged the parent command line because it matched signatures for encoded PowerShell and reverse shell patterns, but these patterns exist as text input, not as executed processes.');
  } else if (!cmdCtx.isPromptContext && techniques.length >= 3) {
    var chainDesc = [...new Set(techniques.map(function(t) { return t.tactic; }))].join(' \u2192 ');
    narrativeLines.push('<strong>ATTACK CHAIN RECONSTRUCTION:</strong> Observed techniques span ' + chainDesc + '. The progression through multiple MITRE ATT&CK tactics indicates a deliberate, multi-stage intrusion requiring immediate response.');
  }

  if (lower.includes('security testing') || lower.includes('business justified')) {
    narrativeLines.push('The activity was flagged as authorized security testing by the user. This context, combined with the Elastic telemetry showing no actual malicious execution, supports a Business Justified closure.');
  }

  narrativeLines.forEach(function(line) {
    html += '<div style="font-size:10px;color:var(--text-secondary);line-height:1.55;margin-bottom:6px;">' + line + '</div>';
  });
  html += '</div>';

  // MITRE ATT&CK mapping
  if (techniques.length > 0) {
    html += '<div style="margin-bottom:12px;">' +
      '<div style="font-size:9px;font-weight:600;text-transform:uppercase;letter-spacing:0.08em;color:var(--text-muted);margin-bottom:6px;">MITRE ATT&CK MAPPING</div>' +
      '<div style="display:grid;gap:3px;">';
    techniques.slice(0, 6).forEach(function(t) {
      html += '<div style="display:grid;grid-template-columns:80px 1fr;gap:8px;padding:4px 8px;background:var(--surface-1);border-radius:4px;border:1px solid var(--border-subtle);">' +
        '<span style="font-size:9px;color:var(--amber);font-family:var(--font-mono);font-weight:600;">' + t.id + '</span>' +
        '<div><span style="font-size:9px;color:var(--text-primary);">' + t.name + '</span>' +
        '<span style="font-size:8px;color:var(--text-muted);margin-left:6px;">[' + t.tactic + ']</span></div></div>';
    });
    html += '</div></div>';
  }

  // Recommended actions based on verdict
  var isTP = verdict.includes('TRUE POSITIVE');
  var isFP = verdict.includes('FALSE POSITIVE');
  var recommendations = [];
  if (isTP) {
    recommendations = [
      { text: 'Escalate to Incident Response team immediately', priority: 'HIGH', type: 'rc' },
      { text: 'Isolate affected host(s) from network', priority: 'HIGH', type: 'rc' },
      { text: 'Preserve forensic evidence (memory dump, disk image)', priority: 'MEDIUM', type: 'manual' },
      { text: 'Notify client SOC team within SLA window', priority: 'MEDIUM', type: 'manual' },
      { text: 'Document all containment actions taken', priority: 'LOW', type: 'manual' }
    ];
  } else if (isFP) {
    recommendations = [
      { text: 'Close ticket as False Positive / Business Justified', priority: 'ACTION', type: 'rc' },
      { text: 'Document the FP pattern for analyst training (LLM prompts triggering EDR)', priority: 'MEDIUM', type: 'manual' },
      { text: 'Consider CrowdStrike exclusion rule for ollama.exe prompt analysis', priority: 'LOW', type: 'manual' },
      { text: 'No client notification required for business-justified closure', priority: 'INFO', type: 'info' }
    ];
  } else {
    recommendations = [
      { text: 'Assign to senior analyst for manual deep-dive', priority: 'HIGH', type: 'manual' },
      { text: 'Validate with endpoint telemetry (EDR full process tree)', priority: 'MEDIUM', type: 'rc' },
      { text: 'Cross-reference IOCs against threat intel feeds', priority: 'MEDIUM', type: 'manual' },
      { text: 'Check for related alerts in last 72 hours', priority: 'MEDIUM', type: 'manual' },
      { text: 'Consult with user about the activity if safe to do so', priority: 'LOW', type: 'manual' }
    ];
  }

  html += '<div style="margin-bottom:4px;display:flex;align-items:center;gap:8px;">' +
    '<span style="font-size:9px;font-weight:600;text-transform:uppercase;letter-spacing:0.08em;color:var(--text-muted);">RECOMMENDED ACTIONS</span></div>';
  recommendations.forEach(function(rec) {
    var pColor = rec.priority === 'HIGH' ? 'var(--red-bright)' : (rec.priority === 'ACTION' ? 'var(--green)' : (rec.priority === 'MEDIUM' ? 'var(--amber)' : 'var(--text-muted)'));
    html += '<div style="display:flex;align-items:center;gap:8px;padding:5px 0;border-bottom:1px solid var(--border-subtle);">' +
      '<span style="font-size:8px;font-weight:700;padding:1px 5px;border-radius:3px;background:' + pColor + '15;color:' + pColor + ';border:1px solid ' + pColor + '30;min-width:42px;text-align:center;">' + rec.priority + '</span>' +
      '<span style="font-size:10px;color:var(--text-secondary);flex:1;">' + rec.text + '</span>';
    if (rec.type === 'rc') {
      html += '<span style="font-size:8px;padding:2px 5px;border-radius:3px;background:rgba(16,185,129,0.1);color:var(--green);border:1px solid rgba(16,185,129,0.2);">RC Ready</span>';
    }
    html += '</div>';
  });

  return html;
}


function buildRoundHTML(num, totalRounds, title, state, content) {
  var stateIcon = state === 'running' ? '<div class="jira-spinner" style="width:14px;height:14px;"></div>' :
    '<div style="width:14px;height:14px;border-radius:50%;background:var(--green);display:flex;align-items:center;justify-content:center;font-size:9px;color:white;">\u2713</div>';
  var stateLabel = state === 'running' ? '<span style="color:var(--amber);font-size:10px;font-family:var(--font-mono);">PROCESSING</span>' :
    '<span style="color:var(--green);font-size:10px;font-family:var(--font-mono);">COMPLETE</span>';
  var progressText = '<span style="font-size:9px;color:var(--text-muted);font-family:var(--font-mono);margin-left:auto;">' + num + '/' + totalRounds + '</span>';
  return '<div id="aiRound' + num + '" style="padding:12px;border:1px solid var(--border-subtle);border-radius:8px;margin-bottom:8px;background:var(--surface-1);">' +
    '<div style="display:flex;align-items:center;gap:8px;margin-bottom:' + (content ? '10px' : '0') + ';">' +
      stateIcon +
      '<span style="font-size:11px;font-weight:600;color:var(--text-primary);">Round ' + num + ': ' + title + '</span>' +
      stateLabel +
      progressText +
    '</div>' +
    (content ? '<div style="font-size:11px;color:var(--text-secondary);line-height:1.6;">' + content + '</div>' : '') +
  '</div>';
}

function updateRoundHTML(container, num, totalRounds, state, content) {
  var el = document.getElementById('aiRound' + num);
  if (el) {
    var titleMap = {1:'Initial Classification', 2:'Threat Context Analysis', 3:'Deep Investigation & Recommendations'};
    el.outerHTML = buildRoundHTML(num, totalRounds, titleMap[num], state, content);
  }
}



</script>

<!-- ==============================================================
     ESCALATION DRAFT MODAL (Task 2)
     ============================================================== -->
<div class="esc-modal-overlay" id="escModalOverlay" onclick="if(event.target===this)closeEscModal();">
  <div class="esc-modal">
    <div class="esc-modal-header">
      <div class="esc-modal-title">&#x270F;&#xFE0F; Edit Escalation Draft â€” DAC-18158</div>
      <button class="esc-modal-close" onclick="closeEscModal()">&#x2715;</button>
    </div>
    <div class="esc-modal-body">
      <div class="esc-field-row">
        <div class="esc-field">
          <div class="esc-field-label">To</div>
          <input type="email" class="esc-input" value="d.sok@nagaworld.com" placeholder="Recipient...">
        </div>
      </div>
      <div class="esc-field-row">
        <div class="esc-field" style="flex:2;">
          <div class="esc-field-label">CC</div>
          <input type="email" class="esc-input" value="it-security@nagaworld.com, soc-lead@dacta.global" placeholder="CC...">
        </div>
        <div class="esc-field">
          <div class="esc-field-label">BCC</div>
          <input type="email" class="esc-input" placeholder="BCC (optional)...">
        </div>
      </div>
      <div class="esc-field">
        <div class="esc-field-label">Subject</div>
        <input type="text" class="esc-input" value="[P1] Potential Ransomware Activity â€” DAC-18158" placeholder="Subject...">
      </div>
      <div class="esc-field">
        <div class="esc-field-label">Message Body</div>
        <textarea class="esc-textarea">Dear D. Sok and NagaWorld Security Team,

Dacta SG SOC has detected a CRITICAL security incident on your environment requiring immediate attention.

INCIDENT REFERENCE: DAC-18158
SEVERITY: P1 CRITICAL
TIMESTAMP: 2026-02-27 13:21:44 SGT

SUMMARY:
Ransomware-like file encryption activity has been detected on host DACTASG-WS-047 (Finance Department). 847 files have been renamed with .enc extension within a 43-second window. The activity is associated with a suspicious PowerShell process (T1059.001) and correlates with earlier lateral movement indicators across 4 additional hosts.

AFFECTED ASSETS:
- Host: DACTASG-WS-047 (Windows 11 Pro, Finance Dept, 10.0.4.47)
- User: john.santos@dactaglobal.com (Domain Admin â€” account disabled)
- Potential blast radius: 12 hosts accessible via compromised credentials

ACTIONS TAKEN:
1. Host DACTASG-WS-047 isolation initiated via Elastic Endpoint Agent
2. Account john.santos disabled pending full investigation
3. IOC hash a3f4b8c2d9e1f0a7 blocked at EDR layer

IMMEDIATE ACTIONS REQUIRED FROM YOUR TEAM:
- Notify your executive team and legal/compliance department
- Activate your internal IR plan
- Do NOT power off or reboot affected systems without coordination

Please contact your assigned Dacta Incident Commander immediately.
War Room: WR-2026-003 | Emergency: +65 6xxx xxxx

Regards,
Dacta SG SOC Team
reference: DAC-18158</textarea>
      </div>
    </div>
    <div class="esc-modal-footer">
      <button class="btn btn-secondary btn-sm" onclick="showToast('Artifact attached')">&#x1F4CE; Attach Artifacts</button>
      <div class="spacer"></div>
      <button class="btn btn-secondary btn-sm" onclick="showToast('Draft saved');closeEscModal();">Save Draft</button>
      <button class="btn btn-primary btn-sm" onclick="showToast('Escalation sent to d.sok@nagaworld.com');closeEscModal();">&#x1F4E4; Send Escalation</button>
      <button class="btn btn-secondary btn-sm" onclick="closeEscModal()">Cancel</button>
    </div>
  </div>
</div>

<!-- ==============================================================
     ROUTE TO RESPONSE CENTER DIALOG (Task 5)
     ============================================================== -->
<div class="route-confirm-dialog" id="routeConfirmDialog" onclick="if(event.target===this)closeRouteConfirm();">
  <div class="route-confirm-box">
    <div class="route-confirm-icon">&#x1F6E1;&#xFE0F;</div>
    <div class="route-confirm-title">Approve AI Investigation Findings?</div>
    <div class="route-confirm-sub">This will approve the AI-generated findings for DAC-18158 and route all recommended containment actions to the Response Center for execution.</div>
    <div class="route-confirm-btns">
      <button class="btn btn-secondary" onclick="closeRouteConfirm()">Cancel</button>
      <button class="btn btn-success" onclick="confirmRoute()">&#x2713; Approve &amp; Route</button>
    </div>
  </div>
</div>

<!-- ==============================================================
     WAR ROOM SHARE MODAL (Task 7)
     ============================================================== -->
<div class="wr-share-modal-overlay" id="wrShareModalOverlay" onclick="if(event.target===this)closeWrShareModal();">
  <div class="wr-share-modal">
    <div class="wr-share-modal-header">
      <div style="font-size:15px;font-weight:700;color:var(--text-primary);">&#x1F465; Share &amp; Collaborate â€” WR-2026-003</div>
      <button class="esc-modal-close" onclick="closeWrShareModal()">&#x2715;</button>
    </div>
    <div class="wr-share-modal-body">

      <!-- TLP Indicator -->
      <div class="wr-tlp-indicator">
        <span style="font-size:16px;">&#x1F512;</span>
        <div>
          <div style="font-weight:700;color:var(--amber);">TLP:AMBER</div>
          <div style="font-size:10px;margin-top:2px;">Information shared under this engagement is restricted to named recipients and their organizations only.</div>
        </div>
      </div>

      <!-- Current Collaborators -->
      <div>
        <div class="wr-share-section-title">Current Collaborators</div>
        <div style="display:flex;flex-direction:column;gap:6px;">
          <div class="wr-collaborator-item">
            <div class="wr-collab-avatar">KR</div>
            <div><div class="wr-collab-name">K. Rasmussen</div><div class="wr-collab-org">Dacta Global</div></div>
            <div class="wr-collab-role internal">Commander</div>
          </div>
          <div class="wr-collaborator-item">
            <div class="wr-collab-avatar" style="background:linear-gradient(135deg,rgba(139,92,246,0.3),rgba(139,92,246,0.15));color:#a78bfa;">JL</div>
            <div><div class="wr-collab-name">John Lim</div><div class="wr-collab-org">Dacta Global</div></div>
            <div class="wr-collab-role internal">Contributor</div>
          </div>
          <div class="wr-collaborator-item">
            <div class="wr-collab-avatar" style="background:linear-gradient(135deg,rgba(16,185,129,0.2),rgba(16,185,129,0.1));color:#10b981;">DS</div>
            <div><div class="wr-collab-name">D. Sok</div><div class="wr-collab-org">NagaWorld Ltd. (Client)</div></div>
            <div class="wr-collab-role external">Contributor</div>
          </div>
          <div class="wr-collaborator-item">
            <div class="wr-collab-avatar" style="background:rgba(255,255,255,0.05);color:var(--text-muted);">KN</div>
            <div><div class="wr-collab-name">Kenneth Ng</div><div class="wr-collab-org">NagaWorld Ltd. (Client)</div></div>
            <div class="wr-collab-role observer">Observer</div>
          </div>
        </div>
      </div>

      <!-- Invite New Collaborator -->
      <div>
        <div class="wr-share-section-title">Invite External Collaborator</div>
        <div style="display:flex;flex-direction:column;gap:8px;">
          <input type="email" class="esc-input" placeholder="Email address..." id="wrInviteEmail">
          <div style="display:flex;gap:8px;">
            <select class="esc-input" style="flex:1;">
              <option>Observer</option>
              <option>Contributor</option>
              <option>Commander</option>
            </select>
            <button class="btn btn-primary btn-sm" style="white-space:nowrap;" onclick="sendWrInvite()">&#x2709; Send Invite</button>
          </div>
          <div style="font-size:10px;color:var(--text-muted);">External collaborators will receive a secure access link valid for 24 hours under TLP:AMBER restrictions.</div>
        </div>
      </div>

    </div>
  </div>
</div>
</body>
</html>
